const mb="modulepreload",yb=function(t){return"/"+t},Ch={},wb=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let c=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=c(n.map(l=>{if(l=yb(l),l in Ch)return;Ch[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":mb,u||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((f,g)=>{h.addEventListener("load",f),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};var Oo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ro={exports:{}},_h;function vb(){return _h||(_h=1,function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Oo<"u"&&Oo,r=function(){function s(){this.fetch=!1,this.DOMException=n.DOMException}return s.prototype=n,new s}();(function(s){(function(o){var a=typeof s<"u"&&s||typeof self<"u"&&self||typeof Oo<"u"&&Oo||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(A){return A&&DataView.prototype.isPrototypeOf(A)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(A){return A&&u.indexOf(Object.prototype.toString.call(A))>-1};function h(A){if(typeof A!="string"&&(A=String(A)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(A)||A==="")throw new TypeError('Invalid character in header field name: "'+A+'"');return A.toLowerCase()}function f(A){return typeof A!="string"&&(A=String(A)),A}function g(A){var T={next:function(){var F=A.shift();return{done:F===void 0,value:F}}};return c.iterable&&(T[Symbol.iterator]=function(){return T}),T}function p(A){this.map={},A instanceof p?A.forEach(function(T,F){this.append(F,T)},this):Array.isArray(A)?A.forEach(function(T){if(T.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+T.length);this.append(T[0],T[1])},this):A&&Object.getOwnPropertyNames(A).forEach(function(T){this.append(T,A[T])},this)}p.prototype.append=function(A,T){A=h(A),T=f(T);var F=this.map[A];this.map[A]=F?F+", "+T:T},p.prototype.delete=function(A){delete this.map[h(A)]},p.prototype.get=function(A){return A=h(A),this.has(A)?this.map[A]:null},p.prototype.has=function(A){return this.map.hasOwnProperty(h(A))},p.prototype.set=function(A,T){this.map[h(A)]=f(T)},p.prototype.forEach=function(A,T){for(var F in this.map)this.map.hasOwnProperty(F)&&A.call(T,this.map[F],F,this)},p.prototype.keys=function(){var A=[];return this.forEach(function(T,F){A.push(F)}),g(A)},p.prototype.values=function(){var A=[];return this.forEach(function(T){A.push(T)}),g(A)},p.prototype.entries=function(){var A=[];return this.forEach(function(T,F){A.push([F,T])}),g(A)},c.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function y(A){if(!A._noBody){if(A.bodyUsed)return Promise.reject(new TypeError("Already read"));A.bodyUsed=!0}}function m(A){return new Promise(function(T,F){A.onload=function(){T(A.result)},A.onerror=function(){F(A.error)}})}function C(A){var T=new FileReader,F=m(T);return T.readAsArrayBuffer(A),F}function v(A){var T=new FileReader,F=m(T),w=/charset=([A-Za-z0-9_-]+)/.exec(A.type),S=w?w[1]:"utf-8";return T.readAsText(A,S),F}function I(A){for(var T=new Uint8Array(A),F=new Array(T.length),w=0;w<T.length;w++)F[w]=String.fromCharCode(T[w]);return F.join("")}function R(A){if(A.slice)return A.slice(0);var T=new Uint8Array(A.byteLength);return T.set(new Uint8Array(A)),T.buffer}function L(){return this.bodyUsed=!1,this._initBody=function(A){this.bodyUsed=this.bodyUsed,this._bodyInit=A,A?typeof A=="string"?this._bodyText=A:c.blob&&Blob.prototype.isPrototypeOf(A)?this._bodyBlob=A:c.formData&&FormData.prototype.isPrototypeOf(A)?this._bodyFormData=A:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(A)?this._bodyText=A.toString():c.arrayBuffer&&c.blob&&l(A)?(this._bodyArrayBuffer=R(A.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(A)||d(A))?this._bodyArrayBuffer=R(A):this._bodyText=A=Object.prototype.toString.call(A):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof A=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(A)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var A=y(this);if(A)return A;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var A=y(this);return A||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(C);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var A=y(this);if(A)return A;if(this._bodyBlob)return v(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(I(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(B)}),this.json=function(){return this.text().then(JSON.parse)},this}var z=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function j(A){var T=A.toUpperCase();return z.indexOf(T)>-1?T:A}function D(A,T){if(!(this instanceof D))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');T=T||{};var F=T.body;if(A instanceof D){if(A.bodyUsed)throw new TypeError("Already read");this.url=A.url,this.credentials=A.credentials,T.headers||(this.headers=new p(A.headers)),this.method=A.method,this.mode=A.mode,this.signal=A.signal,!F&&A._bodyInit!=null&&(F=A._bodyInit,A.bodyUsed=!0)}else this.url=String(A);if(this.credentials=T.credentials||this.credentials||"same-origin",(T.headers||!this.headers)&&(this.headers=new p(T.headers)),this.method=j(T.method||this.method||"GET"),this.mode=T.mode||this.mode||null,this.signal=T.signal||this.signal||function(){if("AbortController"in a){var _=new AbortController;return _.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&F)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(F),(this.method==="GET"||this.method==="HEAD")&&(T.cache==="no-store"||T.cache==="no-cache")){var w=/([?&])_=[^&]*/;if(w.test(this.url))this.url=this.url.replace(w,"$1_="+new Date().getTime());else{var S=/\?/;this.url+=(S.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function B(A){var T=new FormData;return A.trim().split("&").forEach(function(F){if(F){var w=F.split("="),S=w.shift().replace(/\+/g," "),_=w.join("=").replace(/\+/g," ");T.append(decodeURIComponent(S),decodeURIComponent(_))}}),T}function $(A){var T=new p,F=A.replace(/\r?\n[\t ]+/g," ");return F.split("\r").map(function(w){return w.indexOf(`
`)===0?w.substr(1,w.length):w}).forEach(function(w){var S=w.split(":"),_=S.shift().trim();if(_){var k=S.join(":").trim();try{T.append(_,k)}catch(E){console.warn("Response "+E.message)}}}),T}L.call(D.prototype);function U(A,T){if(!(this instanceof U))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(T||(T={}),this.type="default",this.status=T.status===void 0?200:T.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=T.statusText===void 0?"":""+T.statusText,this.headers=new p(T.headers),this.url=T.url||"",this._initBody(A)}L.call(U.prototype),U.prototype.clone=function(){return new U(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},U.error=function(){var A=new U(null,{status:200,statusText:""});return A.ok=!1,A.status=0,A.type="error",A};var M=[301,302,303,307,308];U.redirect=function(A,T){if(M.indexOf(T)===-1)throw new RangeError("Invalid status code");return new U(null,{status:T,headers:{location:A}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(T,F){this.message=T,this.name=F;var w=Error(T);this.stack=w.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function O(A,T){return new Promise(function(F,w){var S=new D(A,T);if(S.signal&&S.signal.aborted)return w(new o.DOMException("Aborted","AbortError"));var _=new XMLHttpRequest;function k(){_.abort()}_.onload=function(){var x={statusText:_.statusText,headers:$(_.getAllResponseHeaders()||"")};S.url.indexOf("file://")===0&&(_.status<200||_.status>599)?x.status=200:x.status=_.status,x.url="responseURL"in _?_.responseURL:x.headers.get("X-Request-URL");var P="response"in _?_.response:_.responseText;setTimeout(function(){F(new U(P,x))},0)},_.onerror=function(){setTimeout(function(){w(new TypeError("Network request failed"))},0)},_.ontimeout=function(){setTimeout(function(){w(new TypeError("Network request timed out"))},0)},_.onabort=function(){setTimeout(function(){w(new o.DOMException("Aborted","AbortError"))},0)};function E(x){try{return x===""&&a.location.href?a.location.href:x}catch{return x}}if(_.open(S.method,E(S.url),!0),S.credentials==="include"?_.withCredentials=!0:S.credentials==="omit"&&(_.withCredentials=!1),"responseType"in _&&(c.blob?_.responseType="blob":c.arrayBuffer&&(_.responseType="arraybuffer")),T&&typeof T.headers=="object"&&!(T.headers instanceof p||a.Headers&&T.headers instanceof a.Headers)){var b=[];Object.getOwnPropertyNames(T.headers).forEach(function(x){b.push(h(x)),_.setRequestHeader(x,f(T.headers[x]))}),S.headers.forEach(function(x,P){b.indexOf(P)===-1&&_.setRequestHeader(P,x)})}else S.headers.forEach(function(x,P){_.setRequestHeader(P,x)});S.signal&&(S.signal.addEventListener("abort",k),_.onreadystatechange=function(){_.readyState===4&&S.signal.removeEventListener("abort",k)}),_.send(typeof S._bodyInit>"u"?null:S._bodyInit)})}return O.polyfill=!0,a.fetch||(a.fetch=O,a.Headers=p,a.Request=D,a.Response=U),o.Headers=p,o.Request=D,o.Response=U,o.fetch=O,o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=n.fetch?n:r;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,t.exports=e}(Ro,Ro.exports)),Ro.exports}var bb=vb();const pg=hd(bb);var No={exports:{}},Qc,xh;function Eb(){if(xh)return Qc;xh=1;var t=1e3,e=t*60,n=e*60,r=n*24,i=r*7,s=r*365.25;Qc=function(u,d){d=d||{};var h=typeof u;if(h==="string"&&u.length>0)return o(u);if(h==="number"&&isFinite(u))return d.long?c(u):a(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function o(u){if(u=String(u),!(u.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(d){var h=parseFloat(d[1]),f=(d[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return h*s;case"weeks":case"week":case"w":return h*i;case"days":case"day":case"d":return h*r;case"hours":case"hour":case"hrs":case"hr":case"h":return h*n;case"minutes":case"minute":case"mins":case"min":case"m":return h*e;case"seconds":case"second":case"secs":case"sec":case"s":return h*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}}}function a(u){var d=Math.abs(u);return d>=r?Math.round(u/r)+"d":d>=n?Math.round(u/n)+"h":d>=e?Math.round(u/e)+"m":d>=t?Math.round(u/t)+"s":u+"ms"}function c(u){var d=Math.abs(u);return d>=r?l(u,d,r,"day"):d>=n?l(u,d,n,"hour"):d>=e?l(u,d,e,"minute"):d>=t?l(u,d,t,"second"):u+" ms"}function l(u,d,h,f){var g=d>=h*1.5;return Math.round(u/h)+" "+f+(g?"s":"")}return Qc}var Jc,kh;function Ab(){if(kh)return Jc;kh=1;function t(e){r.debug=r,r.default=r,r.coerce=l,r.disable=a,r.enable=s,r.enabled=c,r.humanize=Eb(),r.destroy=u,Object.keys(e).forEach(d=>{r[d]=e[d]}),r.names=[],r.skips=[],r.formatters={};function n(d){let h=0;for(let f=0;f<d.length;f++)h=(h<<5)-h+d.charCodeAt(f),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=n;function r(d){let h,f=null,g,p;function y(...m){if(!y.enabled)return;const C=y,v=Number(new Date),I=v-(h||v);C.diff=I,C.prev=h,C.curr=v,h=v,m[0]=r.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let R=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(z,j)=>{if(z==="%%")return"%";R++;const D=r.formatters[j];if(typeof D=="function"){const B=m[R];z=D.call(C,B),m.splice(R,1),R--}return z}),r.formatArgs.call(C,m),(C.log||r.log).apply(C,m)}return y.namespace=d,y.useColors=r.useColors(),y.color=r.selectColor(d),y.extend=i,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(g!==r.namespaces&&(g=r.namespaces,p=r.enabled(d)),p),set:m=>{f=m}}),typeof r.init=="function"&&r.init(y),y}function i(d,h){const f=r(this.namespace+(typeof h>"u"?":":h)+d);return f.log=this.log,f}function s(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];const h=(typeof d=="string"?d:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const f of h)f[0]==="-"?r.skips.push(f.slice(1)):r.names.push(f)}function o(d,h){let f=0,g=0,p=-1,y=0;for(;f<d.length;)if(g<h.length&&(h[g]===d[f]||h[g]==="*"))h[g]==="*"?(p=g,y=f,g++):(f++,g++);else if(p!==-1)g=p+1,y++,f=y;else return!1;for(;g<h.length&&h[g]==="*";)g++;return g===h.length}function a(){const d=[...r.names,...r.skips.map(h=>"-"+h)].join(",");return r.enable(""),d}function c(d){for(const h of r.skips)if(o(d,h))return!1;for(const h of r.names)if(o(d,h))return!0;return!1}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return Jc=t,Jc}var Ph;function Sb(){return Ph||(Ph=1,function(t,e){var n={};e.formatArgs=i,e.save=s,e.load=o,e.useColors=r,e.storage=a(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,h=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(d++,f==="%c"&&(h=d))}),l.splice(h,0,u)}e.log=console.debug||console.log||(()=>{});function s(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function o(){let l;try{l=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l=n.DEBUG),l}function a(){try{return localStorage}catch{}}t.exports=Ab()(e);const{formatters:c}=t.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}(No,No.exports)),No.exports}var Cb=Sb();const Tt=hd(Cb);var Yc,Th;function _b(){if(Th)return Yc;Th=1;var t=Object.defineProperty,e=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,r=Object.prototype.hasOwnProperty,i=(D,B)=>{for(var $ in B)t(D,$,{get:B[$],enumerable:!0})},s=(D,B,$,U)=>{if(B&&typeof B=="object"||typeof B=="function")for(let M of n(B))!r.call(D,M)&&M!==$&&t(D,M,{get:()=>B[M],enumerable:!(U=e(B,M))||U.enumerable});return D},o=D=>s(t({},"__esModule",{value:!0}),D),a={};i(a,{createFinalURL:()=>L,createPathBasedClient:()=>p,createQuerySerializer:()=>v,default:()=>d,defaultBodySerializer:()=>R,defaultPathSerializer:()=>I,mergeHeaders:()=>z,randomID:()=>u,removeTrailingSlash:()=>j,serializeArrayParam:()=>C,serializeObjectParam:()=>m,serializePrimitiveParam:()=>y,wrapAsPathBasedClient:()=>g}),Yc=o(a);var c=/\{[^{}]+\}/g,l=()=>typeof process=="object"&&Number.parseInt(process?.versions?.node?.substring(0,2))>=18&&process.versions.undici;function u(){return Math.random().toString(36).slice(2,11)}function d(D){let{baseUrl:B="",Request:$=globalThis.Request,fetch:U=globalThis.fetch,querySerializer:M,bodySerializer:O,headers:A,requestInitExt:T=void 0,...F}={...D};T=l()?T:void 0,B=j(B);const w=[];async function S(_,k){const{baseUrl:E,fetch:b=U,Request:x=$,headers:P,params:N={},parseAs:H="json",querySerializer:K,bodySerializer:V=O??R,body:q,...Y}=k||{};let Z=B;E&&(Z=j(E)??B);let ie=typeof M=="function"?M:v(M);K&&(ie=typeof K=="function"?K:v({...typeof M=="object"?M:{},...K}));const oe=q===void 0?void 0:V(q,z(A,P,N.header)),pe=z(oe===void 0||oe instanceof FormData?{}:{"Content-Type":"application/json"},A,P,N.header),se={redirect:"follow",...F,...Y,body:oe,headers:pe};let ae,fe,le=new $(L(_,{baseUrl:Z,params:N,querySerializer:ie}),se),ye;for(const ge in Y)ge in le||(le[ge]=Y[ge]);if(w.length){ae=u(),fe=Object.freeze({baseUrl:Z,fetch:b,parseAs:H,querySerializer:ie,bodySerializer:V});for(const ge of w)if(ge&&typeof ge=="object"&&typeof ge.onRequest=="function"){const we=await ge.onRequest({request:le,schemaPath:_,params:N,options:fe,id:ae});if(we)if(we instanceof $)le=we;else if(we instanceof Response){ye=we;break}else throw new Error("onRequest: must return new Request() or Response() when modifying the request")}}if(!ye){try{ye=await b(le,T)}catch(ge){let we=ge;if(w.length)for(let Ee=w.length-1;Ee>=0;Ee--){const je=w[Ee];if(je&&typeof je=="object"&&typeof je.onError=="function"){const st=await je.onError({request:le,error:we,schemaPath:_,params:N,options:fe,id:ae});if(st){if(st instanceof Response){we=void 0,ye=st;break}if(st instanceof Error){we=st;continue}throw new Error("onError: must return new Response() or instance of Error")}}}if(we)throw we}if(w.length)for(let ge=w.length-1;ge>=0;ge--){const we=w[ge];if(we&&typeof we=="object"&&typeof we.onResponse=="function"){const Ee=await we.onResponse({request:le,response:ye,schemaPath:_,params:N,options:fe,id:ae});if(Ee){if(!(Ee instanceof Response))throw new Error("onResponse: must return new Response() when modifying the response");ye=Ee}}}}if(ye.status===204||le.method==="HEAD"||ye.headers.get("Content-Length")==="0")return ye.ok?{data:void 0,response:ye}:{error:void 0,response:ye};if(ye.ok)return H==="stream"?{data:ye.body,response:ye}:{data:await ye[H](),response:ye};let Ae=await ye.text();try{Ae=JSON.parse(Ae)}catch{}return{error:Ae,response:ye}}return{request(_,k,E){return S(k,{...E,method:_.toUpperCase()})},GET(_,k){return S(_,{...k,method:"GET"})},PUT(_,k){return S(_,{...k,method:"PUT"})},POST(_,k){return S(_,{...k,method:"POST"})},DELETE(_,k){return S(_,{...k,method:"DELETE"})},OPTIONS(_,k){return S(_,{...k,method:"OPTIONS"})},HEAD(_,k){return S(_,{...k,method:"HEAD"})},PATCH(_,k){return S(_,{...k,method:"PATCH"})},TRACE(_,k){return S(_,{...k,method:"TRACE"})},use(..._){for(const k of _)if(k){if(typeof k!="object"||!("onRequest"in k||"onResponse"in k||"onError"in k))throw new Error("Middleware must be an object with one of `onRequest()`, `onResponse() or `onError()`");w.push(k)}},eject(..._){for(const k of _){const E=w.indexOf(k);E!==-1&&w.splice(E,1)}}}}var h=class{constructor(D,B){this.client=D,this.url=B}GET=D=>this.client.GET(this.url,D);PUT=D=>this.client.PUT(this.url,D);POST=D=>this.client.POST(this.url,D);DELETE=D=>this.client.DELETE(this.url,D);OPTIONS=D=>this.client.OPTIONS(this.url,D);HEAD=D=>this.client.HEAD(this.url,D);PATCH=D=>this.client.PATCH(this.url,D);TRACE=D=>this.client.TRACE(this.url,D)},f=class{constructor(){this.client=null}get(D,B){const $=new h(D,B);return this.client[B]=$,$}};function g(D){const B=new f,$=new Proxy(D,B);function U(){}U.prototype=$;const M=new U;return B.client=M,M}function p(D){return g(d(D))}function y(D,B,$){if(B==null)return"";if(typeof B=="object")throw new Error("Deeply-nested arrays/objects arenâ€™t supported. Provide your own `querySerializer()` to handle these.");return`${D}=${$?.allowReserved===!0?B:encodeURIComponent(B)}`}function m(D,B,$){if(!B||typeof B!="object")return"";const U=[],M={simple:",",label:".",matrix:";"}[$.style]||"&";if($.style!=="deepObject"&&$.explode===!1){for(const T in B)U.push(T,$.allowReserved===!0?B[T]:encodeURIComponent(B[T]));const A=U.join(",");switch($.style){case"form":return`${D}=${A}`;case"label":return`.${A}`;case"matrix":return`;${D}=${A}`;default:return A}}for(const A in B){const T=$.style==="deepObject"?`${D}[${A}]`:A;U.push(y(T,B[A],$))}const O=U.join(M);return $.style==="label"||$.style==="matrix"?`${M}${O}`:O}function C(D,B,$){if(!Array.isArray(B))return"";if($.explode===!1){const O={form:",",spaceDelimited:"%20",pipeDelimited:"|"}[$.style]||",",A=($.allowReserved===!0?B:B.map(T=>encodeURIComponent(T))).join(O);switch($.style){case"simple":return A;case"label":return`.${A}`;case"matrix":return`;${D}=${A}`;default:return`${D}=${A}`}}const U={simple:",",label:".",matrix:";"}[$.style]||"&",M=[];for(const O of B)$.style==="simple"||$.style==="label"?M.push($.allowReserved===!0?O:encodeURIComponent(O)):M.push(y(D,O,$));return $.style==="label"||$.style==="matrix"?`${U}${M.join(U)}`:M.join(U)}function v(D){return function($){const U=[];if($&&typeof $=="object")for(const M in $){const O=$[M];if(O!=null){if(Array.isArray(O)){if(O.length===0)continue;U.push(C(M,O,{style:"form",explode:!0,...D?.array,allowReserved:D?.allowReserved||!1}));continue}if(typeof O=="object"){U.push(m(M,O,{style:"deepObject",explode:!0,...D?.object,allowReserved:D?.allowReserved||!1}));continue}U.push(y(M,O,D))}}return U.join("&")}}function I(D,B){let $=D;for(const U of D.match(c)??[]){let M=U.substring(1,U.length-1),O=!1,A="simple";if(M.endsWith("*")&&(O=!0,M=M.substring(0,M.length-1)),M.startsWith(".")?(A="label",M=M.substring(1)):M.startsWith(";")&&(A="matrix",M=M.substring(1)),!B||B[M]===void 0||B[M]===null)continue;const T=B[M];if(Array.isArray(T)){$=$.replace(U,C(M,T,{style:A,explode:O}));continue}if(typeof T=="object"){$=$.replace(U,m(M,T,{style:A,explode:O}));continue}if(A==="matrix"){$=$.replace(U,`;${y(M,T)}`);continue}$=$.replace(U,A==="label"?`.${encodeURIComponent(T)}`:encodeURIComponent(T))}return $}function R(D,B){return D instanceof FormData?D:B&&(B.get instanceof Function?B.get("Content-Type")??B.get("content-type"):B["Content-Type"]??B["content-type"])==="application/x-www-form-urlencoded"?new URLSearchParams(D).toString():JSON.stringify(D)}function L(D,B){let $=`${B.baseUrl}${D}`;B.params?.path&&($=I($,B.params.path));let U=B.querySerializer(B.params.query??{});return U.startsWith("?")&&(U=U.substring(1)),U&&($+=`?${U}`),$}function z(...D){const B=new Headers;for(const $ of D){if(!$||typeof $!="object")continue;const U=$ instanceof Headers?$.entries():Object.entries($);for(const[M,O]of U)if(O===null)B.delete(M);else if(Array.isArray(O))for(const A of O)B.append(M,A);else O!==void 0&&B.set(M,O)}return B}function j(D){return D.endsWith("/")?D.substring(0,D.length-1):D}return Yc}var Zc,Ih;function xb(){if(Ih)return Zc;Ih=1;var t={},e=Object.create,n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,a=(L,z)=>{for(var j in z)n(L,j,{get:z[j],enumerable:!0})},c=(L,z,j,D)=>{if(z&&typeof z=="object"||typeof z=="function")for(let B of i(z))!o.call(L,B)&&B!==j&&n(L,B,{get:()=>z[B],enumerable:!(D=r(z,B))||D.enumerable});return L},l=(L,z,j)=>(j=L!=null?e(s(L)):{},c(!L||!L.__esModule?n(j,"default",{value:L,enumerable:!0}):j,L)),u=L=>c(n({},"__esModule",{value:!0}),L),d={};a(d,{analytics:()=>R}),Zc=u(d);var h=l(_b()),f=class{constructor(L){this.batch=[],this.maxTimeoutMs=3e4,this.timeoutId=null,this.isSending=!1,this.batchSize=L.batchSize,this.baseTimeoutMs=L.baseTimeoutMs,this.currentTimeoutMs=L.baseTimeoutMs,this.sendFn=L.sendFn}enqueue(L){this.batch.push(L),this.schedule()}schedule(){this.batch.length>0&&!this.timeoutId&&(this.timeoutId=setTimeout(()=>{this.timeoutId=null,this.flush()},this.currentTimeoutMs))}async flush(){if(this.isSending||this.batch.length===0)return;this.isSending=!0;const L=[...this.batch.slice(0,this.batchSize)];this.batch=this.batch.slice(this.batchSize);try{await this.sendFn(L),this.currentTimeoutMs=this.baseTimeoutMs}catch(z){console.error("Sender: Failed to send batch",z),this.batch=[...L,...this.batch],this.currentTimeoutMs=Math.min(this.currentTimeoutMs*2,this.maxTimeoutMs)}finally{this.isSending=!1,this.schedule()}}},g=f,p=class{constructor(L){this.enabled=!1,this.properties={};const z=(0,h.default)({baseUrl:L}),j=async D=>{const B=await z.POST("/v1/events",{body:D});if(B.response.status!==200)throw new Error(B.error)};this.sender=new g({batchSize:100,baseTimeoutMs:200,sendFn:j})}enable(){this.enabled=!0}setGlobalProperty(L,z){this.properties[L]=z}track(L,z){if(!this.enabled)return;const j={name:L,...this.properties,...z};this.sender.enqueue(j)}},y=p,m,C;typeof process<"u"&&t&&(m=(C=t.METAMASK_ANALYTICS_ENDPOINT)!=null?C:t.NEXT_PUBLIC_METAMASK_ANALYTICS_ENDPOINT);var v=m??"https://mm-sdk-analytics.api.cx.metamask.io/",I=new y(v),R=I;return Zc}var Ze=xb(),Xc={exports:{}};/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */var Oh;function kb(){return Oh||(Oh=1,function(t,e){(function(n){var r=Object.hasOwnProperty,i=Array.isArray?Array.isArray:function(S){return Object.prototype.toString.call(S)==="[object Array]"},s=10,o=typeof process=="object"&&typeof process.nextTick=="function",a=typeof Symbol=="function",c=typeof Reflect=="object",l=typeof setImmediate=="function",u=l?setImmediate:setTimeout,d=a?c&&typeof Reflect.ownKeys=="function"?Reflect.ownKeys:function(w){var S=Object.getOwnPropertyNames(w);return S.push.apply(S,Object.getOwnPropertySymbols(w)),S}:Object.keys;function h(){this._events={},this._conf&&f.call(this,this._conf)}function f(w){w&&(this._conf=w,w.delimiter&&(this.delimiter=w.delimiter),w.maxListeners!==n&&(this._maxListeners=w.maxListeners),w.wildcard&&(this.wildcard=w.wildcard),w.newListener&&(this._newListener=w.newListener),w.removeListener&&(this._removeListener=w.removeListener),w.verboseMemoryLeak&&(this.verboseMemoryLeak=w.verboseMemoryLeak),w.ignoreErrors&&(this.ignoreErrors=w.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function g(w,S){var _="(node) warning: possible EventEmitter memory leak detected. "+w+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(_+=" Event name: "+S+"."),typeof process<"u"&&process.emitWarning){var k=new Error(_);k.name="MaxListenersExceededWarning",k.emitter=this,k.count=w,process.emitWarning(k)}else console.error(_),console.trace&&console.trace()}var p=function(w,S,_){var k=arguments.length;switch(k){case 0:return[];case 1:return[w];case 2:return[w,S];case 3:return[w,S,_];default:for(var E=new Array(k);k--;)E[k]=arguments[k];return E}};function y(w,S){for(var _={},k,E=w.length,b=0,x=0;x<E;x++)k=w[x],_[k]=x<b?S[x]:n;return _}function m(w,S,_){this._emitter=w,this._target=S,this._listeners={},this._listenersCount=0;var k,E;if((_.on||_.off)&&(k=_.on,E=_.off),S.addEventListener?(k=S.addEventListener,E=S.removeEventListener):S.addListener?(k=S.addListener,E=S.removeListener):S.on&&(k=S.on,E=S.off),!k&&!E)throw Error("target does not implement any known event API");if(typeof k!="function")throw TypeError("on method must be a function");if(typeof E!="function")throw TypeError("off method must be a function");this._on=k,this._off=E;var b=w._observers;b?b.push(this):w._observers=[this]}Object.assign(m.prototype,{subscribe:function(w,S,_){var k=this,E=this._target,b=this._emitter,x=this._listeners,P=function(){var N=p.apply(null,arguments),H={data:N,name:S,original:w};if(_){var K=_.call(E,H);K!==!1&&b.emit.apply(b,[H.name].concat(N));return}b.emit.apply(b,[S].concat(N))};if(x[w])throw Error("Event '"+w+"' is already listening");this._listenersCount++,b._newListener&&b._removeListener&&!k._onNewListener?(this._onNewListener=function(N){N===S&&x[w]===null&&(x[w]=P,k._on.call(E,w,P))},b.on("newListener",this._onNewListener),this._onRemoveListener=function(N){N===S&&!b.hasListeners(N)&&x[w]&&(x[w]=null,k._off.call(E,w,P))},x[w]=null,b.on("removeListener",this._onRemoveListener)):(x[w]=P,k._on.call(E,w,P))},unsubscribe:function(w){var S=this,_=this._listeners,k=this._emitter,E,b,x=this._off,P=this._target,N;if(w&&typeof w!="string")throw TypeError("event must be a string");function H(){S._onNewListener&&(k.off("newListener",S._onNewListener),k.off("removeListener",S._onRemoveListener),S._onNewListener=null,S._onRemoveListener=null);var K=j.call(k,S);k._observers.splice(K,1)}if(w){if(E=_[w],!E)return;x.call(P,w,E),delete _[w],--this._listenersCount||H()}else{for(b=d(_),N=b.length;N-- >0;)w=b[N],x.call(P,w,_[w]);this._listeners={},this._listenersCount=0,H()}}});function C(w,S,_,k){var E=Object.assign({},S);if(!w)return E;if(typeof w!="object")throw TypeError("options must be an object");var b=Object.keys(w),x=b.length,P,N,H;function K(q){throw Error('Invalid "'+P+'" option value'+(q?". Reason: "+q:""))}for(var V=0;V<x;V++){if(P=b[V],!r.call(S,P))throw Error('Unknown "'+P+'" option');N=w[P],N!==n&&(H=_[P],E[P]=H?H(N,K):N)}return E}function v(w,S){return(typeof w!="function"||!w.hasOwnProperty("prototype"))&&S("value must be a constructor"),w}function I(w){var S="value must be type of "+w.join("|"),_=w.length,k=w[0],E=w[1];return _===1?function(b,x){if(typeof b===k)return b;x(S)}:_===2?function(b,x){var P=typeof b;if(P===k||P===E)return b;x(S)}:function(b,x){for(var P=typeof b,N=_;N-- >0;)if(P===w[N])return b;x(S)}}var R=I(["function"]),L=I(["object","function"]);function z(w,S,_){var k,E,b=0,x,P=new w(function(N,H,K){_=C(_,{timeout:0,overload:!1},{timeout:function(Z,ie){return Z*=1,(typeof Z!="number"||Z<0||!Number.isFinite(Z))&&ie("timeout must be a positive number"),Z}}),k=!_.overload&&typeof w.prototype.cancel=="function"&&typeof K=="function";function V(){E&&(E=null),b&&(clearTimeout(b),b=0)}var q=function(Z){V(),N(Z)},Y=function(Z){V(),H(Z)};k?S(q,Y,K):(E=[function(Z){Y(Z||Error("canceled"))}],S(q,Y,function(Z){if(x)throw Error("Unable to subscribe on cancel event asynchronously");if(typeof Z!="function")throw TypeError("onCancel callback must be a function");E.push(Z)}),x=!0),_.timeout>0&&(b=setTimeout(function(){var Z=Error("timeout");Z.code="ETIMEDOUT",b=0,P.cancel(Z),H(Z)},_.timeout))});return k||(P.cancel=function(N){if(E){for(var H=E.length,K=1;K<H;K++)E[K](N);E[0](N),E=null}}),P}function j(w){var S=this._observers;if(!S)return-1;for(var _=S.length,k=0;k<_;k++)if(S[k]._target===w)return k;return-1}function D(w,S,_,k,E){if(!_)return null;if(k===0){var b=typeof S;if(b==="string"){var x,P,N=0,H=0,K=this.delimiter,V=K.length;if((P=S.indexOf(K))!==-1){x=new Array(5);do x[N++]=S.slice(H,P),H=P+V;while((P=S.indexOf(K,H))!==-1);x[N++]=S.slice(H),S=x,E=N}else S=[S],E=1}else b==="object"?E=S.length:(S=[S],E=1)}var q=null,Y,Z,ie,oe,pe,se=S[k],ae=S[k+1],fe,le;if(k===E)_._listeners&&(typeof _._listeners=="function"?(w&&w.push(_._listeners),q=[_]):(w&&w.push.apply(w,_._listeners),q=[_]));else if(se==="*"){for(fe=d(_),P=fe.length;P-- >0;)Y=fe[P],Y!=="_listeners"&&(le=D(w,S,_[Y],k+1,E),le&&(q?q.push.apply(q,le):q=le));return q}else if(se==="**"){for(pe=k+1===E||k+2===E&&ae==="*",pe&&_._listeners&&(q=D(w,S,_,E,E)),fe=d(_),P=fe.length;P-- >0;)Y=fe[P],Y!=="_listeners"&&(Y==="*"||Y==="**"?(_[Y]._listeners&&!pe&&(le=D(w,S,_[Y],E,E),le&&(q?q.push.apply(q,le):q=le)),le=D(w,S,_[Y],k,E)):Y===ae?le=D(w,S,_[Y],k+2,E):le=D(w,S,_[Y],k,E),le&&(q?q.push.apply(q,le):q=le));return q}else _[se]&&(q=D(w,S,_[se],k+1,E));if(Z=_["*"],Z&&D(w,S,Z,k+1,E),ie=_["**"],ie)if(k<E)for(ie._listeners&&D(w,S,ie,E,E),fe=d(ie),P=fe.length;P-- >0;)Y=fe[P],Y!=="_listeners"&&(Y===ae?D(w,S,ie[Y],k+2,E):Y===se?D(w,S,ie[Y],k+1,E):(oe={},oe[Y]=ie[Y],D(w,S,{"**":oe},k+1,E)));else ie._listeners?D(w,S,ie,E,E):ie["*"]&&ie["*"]._listeners&&D(w,S,ie["*"],E,E);return q}function B(w,S,_){var k=0,E=0,b,x=this.delimiter,P=x.length,N;if(typeof w=="string")if((b=w.indexOf(x))!==-1){N=new Array(5);do N[k++]=w.slice(E,b),E=b+P;while((b=w.indexOf(x,E))!==-1);N[k++]=w.slice(E)}else N=[w],k=1;else N=w,k=w.length;if(k>1){for(b=0;b+1<k;b++)if(N[b]==="**"&&N[b+1]==="**")return}var H=this.listenerTree,K;for(b=0;b<k;b++)if(K=N[b],H=H[K]||(H[K]={}),b===k-1)return H._listeners?(typeof H._listeners=="function"&&(H._listeners=[H._listeners]),_?H._listeners.unshift(S):H._listeners.push(S),!H._listeners.warned&&this._maxListeners>0&&H._listeners.length>this._maxListeners&&(H._listeners.warned=!0,g.call(this,H._listeners.length,K))):H._listeners=S,!0;return!0}function $(w,S,_,k){for(var E=d(w),b=E.length,x,P,N,H=w._listeners,K;b-- >0;)P=E[b],x=w[P],P==="_listeners"?N=_:N=_?_.concat(P):[P],K=k||typeof P=="symbol",H&&S.push(K?N:N.join(this.delimiter)),typeof x=="object"&&$.call(this,x,S,N,K);return S}function U(w){for(var S=d(w),_=S.length,k,E,b;_-- >0;)E=S[_],k=w[E],k&&(b=!0,E!=="_listeners"&&!U(k)&&delete w[E]);return b}function M(w,S,_){this.emitter=w,this.event=S,this.listener=_}M.prototype.off=function(){return this.emitter.off(this.event,this.listener),this};function O(w,S,_){if(_===!0)E=!0;else if(_===!1)k=!0;else{if(!_||typeof _!="object")throw TypeError("options should be an object or true");var k=_.async,E=_.promisify,b=_.nextTick,x=_.objectify}if(k||b||E){var P=S,N=S._origin||S;if(b&&!o)throw Error("process.nextTick is not supported");E===n&&(E=S.constructor.name==="AsyncFunction"),S=function(){var H=arguments,K=this,V=this.event;return E?b?Promise.resolve():new Promise(function(q){u(q)}).then(function(){return K.event=V,P.apply(K,H)}):(b?process.nextTick:u)(function(){K.event=V,P.apply(K,H)})},S._async=!0,S._origin=N}return[S,x?new M(this,w,S):this]}function A(w){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,f.call(this,w)}A.EventEmitter2=A,A.prototype.listenTo=function(w,S,_){if(typeof w!="object")throw TypeError("target musts be an object");var k=this;_=C(_,{on:n,off:n,reducers:n},{on:R,off:R,reducers:L});function E(b){if(typeof b!="object")throw TypeError("events must be an object");var x=_.reducers,P=j.call(k,w),N;P===-1?N=new m(k,w,_):N=k._observers[P];for(var H=d(b),K=H.length,V,q=typeof x=="function",Y=0;Y<K;Y++)V=H[Y],N.subscribe(V,b[V]||V,q?x:x&&x[V])}return i(S)?E(y(S)):E(typeof S=="string"?y(S.split(/\s+/)):S),this},A.prototype.stopListeningTo=function(w,S){var _=this._observers;if(!_)return!1;var k=_.length,E,b=!1;if(w&&typeof w!="object")throw TypeError("target should be an object");for(;k-- >0;)E=_[k],(!w||E._target===w)&&(E.unsubscribe(S),b=!0);return b},A.prototype.delimiter=".",A.prototype.setMaxListeners=function(w){w!==n&&(this._maxListeners=w,this._conf||(this._conf={}),this._conf.maxListeners=w)},A.prototype.getMaxListeners=function(){return this._maxListeners},A.prototype.event="",A.prototype.once=function(w,S,_){return this._once(w,S,!1,_)},A.prototype.prependOnceListener=function(w,S,_){return this._once(w,S,!0,_)},A.prototype._once=function(w,S,_,k){return this._many(w,1,S,_,k)},A.prototype.many=function(w,S,_,k){return this._many(w,S,_,!1,k)},A.prototype.prependMany=function(w,S,_,k){return this._many(w,S,_,!0,k)},A.prototype._many=function(w,S,_,k,E){var b=this;if(typeof _!="function")throw new Error("many only accepts instances of Function");function x(){return--S===0&&b.off(w,x),_.apply(this,arguments)}return x._origin=_,this._on(w,x,k,E)},A.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||h.call(this);var w=arguments[0],S,_=this.wildcard,k,E,b,x,P;if(w==="newListener"&&!this._newListener&&!this._events.newListener)return!1;if(_&&(S=w,w!=="newListener"&&w!=="removeListener"&&typeof w=="object")){if(E=w.length,a){for(b=0;b<E;b++)if(typeof w[b]=="symbol"){P=!0;break}}P||(w=w.join(this.delimiter))}var N=arguments.length,H;if(this._all&&this._all.length)for(H=this._all.slice(),b=0,E=H.length;b<E;b++)switch(this.event=w,N){case 1:H[b].call(this,w);break;case 2:H[b].call(this,w,arguments[1]);break;case 3:H[b].call(this,w,arguments[1],arguments[2]);break;default:H[b].apply(this,arguments)}if(_)H=[],D.call(this,H,S,this.listenerTree,0,E);else if(H=this._events[w],typeof H=="function"){switch(this.event=w,N){case 1:H.call(this);break;case 2:H.call(this,arguments[1]);break;case 3:H.call(this,arguments[1],arguments[2]);break;default:for(k=new Array(N-1),x=1;x<N;x++)k[x-1]=arguments[x];H.apply(this,k)}return!0}else H&&(H=H.slice());if(H&&H.length){if(N>3)for(k=new Array(N-1),x=1;x<N;x++)k[x-1]=arguments[x];for(b=0,E=H.length;b<E;b++)switch(this.event=w,N){case 1:H[b].call(this);break;case 2:H[b].call(this,arguments[1]);break;case 3:H[b].call(this,arguments[1],arguments[2]);break;default:H[b].apply(this,k)}return!0}else if(!this.ignoreErrors&&!this._all&&w==="error")throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},A.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||h.call(this);var w=arguments[0],S=this.wildcard,_,k,E,b,x,P;if(w==="newListener"&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(S&&(_=w,w!=="newListener"&&w!=="removeListener"&&typeof w=="object")){if(b=w.length,a){for(x=0;x<b;x++)if(typeof w[x]=="symbol"){k=!0;break}}k||(w=w.join(this.delimiter))}var N=[],H=arguments.length,K;if(this._all)for(x=0,b=this._all.length;x<b;x++)switch(this.event=w,H){case 1:N.push(this._all[x].call(this,w));break;case 2:N.push(this._all[x].call(this,w,arguments[1]));break;case 3:N.push(this._all[x].call(this,w,arguments[1],arguments[2]));break;default:N.push(this._all[x].apply(this,arguments))}if(S?(K=[],D.call(this,K,_,this.listenerTree,0)):K=this._events[w],typeof K=="function")switch(this.event=w,H){case 1:N.push(K.call(this));break;case 2:N.push(K.call(this,arguments[1]));break;case 3:N.push(K.call(this,arguments[1],arguments[2]));break;default:for(E=new Array(H-1),P=1;P<H;P++)E[P-1]=arguments[P];N.push(K.apply(this,E))}else if(K&&K.length){if(K=K.slice(),H>3)for(E=new Array(H-1),P=1;P<H;P++)E[P-1]=arguments[P];for(x=0,b=K.length;x<b;x++)switch(this.event=w,H){case 1:N.push(K[x].call(this));break;case 2:N.push(K[x].call(this,arguments[1]));break;case 3:N.push(K[x].call(this,arguments[1],arguments[2]));break;default:N.push(K[x].apply(this,E))}}else if(!this.ignoreErrors&&!this._all&&w==="error")return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(N)},A.prototype.on=function(w,S,_){return this._on(w,S,!1,_)},A.prototype.prependListener=function(w,S,_){return this._on(w,S,!0,_)},A.prototype.onAny=function(w){return this._onAny(w,!1)},A.prototype.prependAny=function(w){return this._onAny(w,!0)},A.prototype.addListener=A.prototype.on,A.prototype._onAny=function(w,S){if(typeof w!="function")throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),S?this._all.unshift(w):this._all.push(w),this},A.prototype._on=function(w,S,_,k){if(typeof w=="function")return this._onAny(w,S),this;if(typeof S!="function")throw new Error("on only accepts instances of Function");this._events||h.call(this);var E=this,b;return k!==n&&(b=O.call(this,w,S,k),S=b[0],E=b[1]),this._newListener&&this.emit("newListener",w,S),this.wildcard?(B.call(this,w,S,_),E):(this._events[w]?(typeof this._events[w]=="function"&&(this._events[w]=[this._events[w]]),_?this._events[w].unshift(S):this._events[w].push(S),!this._events[w].warned&&this._maxListeners>0&&this._events[w].length>this._maxListeners&&(this._events[w].warned=!0,g.call(this,this._events[w].length,w))):this._events[w]=S,E)},A.prototype.off=function(w,S){if(typeof S!="function")throw new Error("removeListener only takes instances of Function");var _,k=[];if(this.wildcard){var E=typeof w=="string"?w.split(this.delimiter):w.slice();if(k=D.call(this,null,E,this.listenerTree,0),!k)return this}else{if(!this._events[w])return this;_=this._events[w],k.push({_listeners:_})}for(var b=0;b<k.length;b++){var x=k[b];if(_=x._listeners,i(_)){for(var P=-1,N=0,H=_.length;N<H;N++)if(_[N]===S||_[N].listener&&_[N].listener===S||_[N]._origin&&_[N]._origin===S){P=N;break}if(P<0)continue;return this.wildcard?x._listeners.splice(P,1):this._events[w].splice(P,1),_.length===0&&(this.wildcard?delete x._listeners:delete this._events[w]),this._removeListener&&this.emit("removeListener",w,S),this}else(_===S||_.listener&&_.listener===S||_._origin&&_._origin===S)&&(this.wildcard?delete x._listeners:delete this._events[w],this._removeListener&&this.emit("removeListener",w,S))}return this.listenerTree&&U(this.listenerTree),this},A.prototype.offAny=function(w){var S=0,_=0,k;if(w&&this._all&&this._all.length>0){for(k=this._all,S=0,_=k.length;S<_;S++)if(w===k[S])return k.splice(S,1),this._removeListener&&this.emit("removeListenerAny",w),this}else{if(k=this._all,this._removeListener)for(S=0,_=k.length;S<_;S++)this.emit("removeListenerAny",k[S]);this._all=[]}return this},A.prototype.removeListener=A.prototype.off,A.prototype.removeAllListeners=function(w){if(w===n)return!this._events||h.call(this),this;if(this.wildcard){var S=D.call(this,null,w,this.listenerTree,0),_,k;if(!S)return this;for(k=0;k<S.length;k++)_=S[k],_._listeners=null;this.listenerTree&&U(this.listenerTree)}else this._events&&(this._events[w]=null);return this},A.prototype.listeners=function(w){var S=this._events,_,k,E,b,x;if(w===n){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!S)return[];for(_=d(S),b=_.length,E=[];b-- >0;)k=S[_[b]],typeof k=="function"?E.push(k):E.push.apply(E,k);return E}else{if(this.wildcard){if(x=this.listenerTree,!x)return[];var P=[],N=typeof w=="string"?w.split(this.delimiter):w.slice();return D.call(this,P,N,x,0),P}return S?(k=S[w],k?typeof k=="function"?[k]:k:[]):[]}},A.prototype.eventNames=function(w){var S=this._events;return this.wildcard?$.call(this,this.listenerTree,[],null,w):S?d(S):[]},A.prototype.listenerCount=function(w){return this.listeners(w).length},A.prototype.hasListeners=function(w){if(this.wildcard){var S=[],_=typeof w=="string"?w.split(this.delimiter):w.slice();return D.call(this,S,_,this.listenerTree,0),S.length>0}var k=this._events,E=this._all;return!!(E&&E.length||k&&(w===n?d(k).length:k[w]))},A.prototype.listenersAny=function(){return this._all?this._all:[]},A.prototype.waitFor=function(w,S){var _=this,k=typeof S;return k==="number"?S={timeout:S}:k==="function"&&(S={filter:S}),S=C(S,{timeout:0,filter:n,handleError:!1,Promise,overload:!1},{filter:R,Promise:v}),z(S.Promise,function(E,b,x){function P(){var N=S.filter;if(!(N&&!N.apply(_,arguments)))if(_.off(w,P),S.handleError){var H=arguments[0];H?b(H):E(p.apply(null,arguments).slice(1))}else E(p.apply(null,arguments))}x(function(){_.off(w,P)}),_._on(w,P,!1)},{timeout:S.timeout,overload:S.overload})};function T(w,S,_){_=C(_,{Promise,timeout:0,overload:!1},{Promise:v});var k=_.Promise;return z(k,function(E,b,x){var P;if(typeof w.addEventListener=="function"){P=function(){E(p.apply(null,arguments))},x(function(){w.removeEventListener(S,P)}),w.addEventListener(S,P,{once:!0});return}var N=function(){H&&w.removeListener("error",H),E(p.apply(null,arguments))},H;S!=="error"&&(H=function(K){w.removeListener(S,N),b(K)},w.once("error",H)),x(function(){H&&w.removeListener("error",H),w.removeListener(S,N)}),w.once(S,N)},{timeout:_.timeout,overload:_.overload})}var F=A.prototype;Object.defineProperties(A,{defaultMaxListeners:{get:function(){return F._maxListeners},set:function(w){if(typeof w!="number"||w<0||Number.isNaN(w))throw TypeError("n must be a non-negative number");F._maxListeners=w},enumerable:!0},once:{value:T,writable:!0,configurable:!0}}),Object.defineProperties(F,{_maxListeners:{value:s,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),t.exports=A})()}(Xc)),Xc.exports}var vc=kb();const Pb=hd(vc);var Mo,Tb=new Uint8Array(16);function Ib(){if(!Mo&&(Mo=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Mo))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Mo(Tb)}const Ob=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function cu(t){return typeof t=="string"&&Ob.test(t)}var ft=[];for(var el=0;el<256;++el)ft.push((el+256).toString(16).substr(1));function Rb(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(ft[t[e+0]]+ft[t[e+1]]+ft[t[e+2]]+ft[t[e+3]]+"-"+ft[t[e+4]]+ft[t[e+5]]+"-"+ft[t[e+6]]+ft[t[e+7]]+"-"+ft[t[e+8]]+ft[t[e+9]]+"-"+ft[t[e+10]]+ft[t[e+11]]+ft[t[e+12]]+ft[t[e+13]]+ft[t[e+14]]+ft[t[e+15]]).toLowerCase();if(!cu(n))throw TypeError("Stringified UUID is invalid");return n}function Nr(t,e,n){t=t||{};var r=t.random||(t.rng||Ib)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Rb(r)}const Hn=Object.create(null);Hn.open="0";Hn.close="1";Hn.ping="2";Hn.pong="3";Hn.message="4";Hn.upgrade="5";Hn.noop="6";const pa=Object.create(null);Object.keys(Hn).forEach(t=>{pa[Hn[t]]=t});const lu={type:"error",data:"parser error"},gg=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",mg=typeof ArrayBuffer=="function",yg=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,fd=({type:t,data:e},n,r)=>gg&&e instanceof Blob?n?r(e):Rh(e,r):mg&&(e instanceof ArrayBuffer||yg(e))?n?r(e):Rh(new Blob([e]),r):r(Hn[t]+(e||"")),Rh=(t,e)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];e("b"+(r||""))},n.readAsDataURL(t)};function Nh(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let tl;function Nb(t,e){if(gg&&t.data instanceof Blob)return t.data.arrayBuffer().then(Nh).then(e);if(mg&&(t.data instanceof ArrayBuffer||yg(t.data)))return e(Nh(t.data));fd(t,!1,n=>{tl||(tl=new TextEncoder),e(tl.encode(n))})}const Mh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Os=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<Mh.length;t++)Os[Mh.charCodeAt(t)]=t;const Mb=t=>{let e=t.length*.75,n=t.length,r,i=0,s,o,a,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const l=new ArrayBuffer(e),u=new Uint8Array(l);for(r=0;r<n;r+=4)s=Os[t.charCodeAt(r)],o=Os[t.charCodeAt(r+1)],a=Os[t.charCodeAt(r+2)],c=Os[t.charCodeAt(r+3)],u[i++]=s<<2|o>>4,u[i++]=(o&15)<<4|a>>2,u[i++]=(a&3)<<6|c&63;return l},Bb=typeof ArrayBuffer=="function",pd=(t,e)=>{if(typeof t!="string")return{type:"message",data:wg(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:Lb(t.substring(1),e)}:pa[n]?t.length>1?{type:pa[n],data:t.substring(1)}:{type:pa[n]}:lu},Lb=(t,e)=>{if(Bb){const n=Mb(t);return wg(n,e)}else return{base64:!0,data:t}},wg=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},vg="",Db=(t,e)=>{const n=t.length,r=new Array(n);let i=0;t.forEach((s,o)=>{fd(s,!1,a=>{r[o]=a,++i===n&&e(r.join(vg))})})},Ub=(t,e)=>{const n=t.split(vg),r=[];for(let i=0;i<n.length;i++){const s=pd(n[i],e);if(r.push(s),s.type==="error")break}return r};function Fb(){return new TransformStream({transform(t,e){Nb(t,n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const s=new DataView(i.buffer);s.setUint8(0,126),s.setUint16(1,r)}else{i=new Uint8Array(9);const s=new DataView(i.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(r))}t.data&&typeof t.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(n)})}})}let nl;function Bo(t){return t.reduce((e,n)=>e+n.length,0)}function Lo(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let r=0;for(let i=0;i<e;i++)n[i]=t[0][r++],r===t[0].length&&(t.shift(),r=0);return t.length&&r<t[0].length&&(t[0]=t[0].slice(r)),n}function Hb(t,e){nl||(nl=new TextDecoder);const n=[];let r=0,i=-1,s=!1;return new TransformStream({transform(o,a){for(n.push(o);;){if(r===0){if(Bo(n)<1)break;const c=Lo(n,1);s=(c[0]&128)===128,i=c[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(Bo(n)<2)break;const c=Lo(n,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(Bo(n)<8)break;const c=Lo(n,8),l=new DataView(c.buffer,c.byteOffset,c.length),u=l.getUint32(0);if(u>Math.pow(2,21)-1){a.enqueue(lu);break}i=u*Math.pow(2,32)+l.getUint32(4),r=3}else{if(Bo(n)<i)break;const c=Lo(n,i);a.enqueue(pd(s?c:nl.decode(c),e)),r=0}if(i===0||i>t){a.enqueue(lu);break}}}})}const bg=4;function rt(t){if(t)return Kb(t)}function Kb(t){for(var e in rt.prototype)t[e]=rt.prototype[e];return t}rt.prototype.on=rt.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};rt.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};rt.prototype.off=rt.prototype.removeListener=rt.prototype.removeAllListeners=rt.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===e||r.fn===e){n.splice(i,1);break}return n.length===0&&delete this._callbacks["$"+t],this};rt.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,e)}return this};rt.prototype.emitReserved=rt.prototype.emit;rt.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};rt.prototype.hasListeners=function(t){return!!this.listeners(t).length};const bc=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0),cn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),$b="arraybuffer";function Eg(t,...e){return e.reduce((n,r)=>(t.hasOwnProperty(r)&&(n[r]=t[r]),n),{})}const jb=cn.setTimeout,zb=cn.clearTimeout;function Ec(t,e){e.useNativeTimers?(t.setTimeoutFn=jb.bind(cn),t.clearTimeoutFn=zb.bind(cn)):(t.setTimeoutFn=cn.setTimeout.bind(cn),t.clearTimeoutFn=cn.clearTimeout.bind(cn))}const Gb=1.33;function Vb(t){return typeof t=="string"?qb(t):Math.ceil((t.byteLength||t.size)*Gb)}function qb(t){let e=0,n=0;for(let r=0,i=t.length;r<i;r++)e=t.charCodeAt(r),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(r++,n+=4);return n}function Ag(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Wb(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function Qb(t){let e={},n=t.split("&");for(let r=0,i=n.length;r<i;r++){let s=n[r].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class Jb extends Error{constructor(e,n,r){super(e),this.description=n,this.context=r,this.type="TransportError"}}class gd extends rt{constructor(e){super(),this.writable=!1,Ec(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,n,r){return super.emitReserved("error",new Jb(e,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const n=pd(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,n={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const n=Wb(e);return n.length?"?"+n:""}}class Yb extends gd{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};Ub(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Db(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=Ag()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(e,n)}}let Sg=!1;try{Sg=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Zb=Sg;function Xb(){}class e1 extends Yb{constructor(e){if(super(e),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,n){const r=this.request({method:"POST",data:e});r.on("success",n),r.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=e}}class Dn extends rt{constructor(e,n,r){super(),this.createRequest=e,Ec(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;const n=Eg(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var i;r.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=Dn.requestsCount++,Dn.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Xb,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Dn.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Dn.requestsCount=0;Dn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Bh);else if(typeof addEventListener=="function"){const t="onpagehide"in cn?"pagehide":"unload";addEventListener(t,Bh,!1)}}function Bh(){for(let t in Dn.requests)Dn.requests.hasOwnProperty(t)&&Dn.requests[t].abort()}const t1=function(){const t=Cg({xdomain:!1});return t&&t.responseType!==null}();class n1 extends e1{constructor(e){super(e);const n=e&&e.forceBase64;this.supportsBinary=t1&&!n}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Dn(Cg,this.uri(),e)}}function Cg(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Zb))return new XMLHttpRequest}catch{}if(!e)try{return new cn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const _g=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class r1 extends gd{get name(){return"websocket"}doOpen(){const e=this.uri(),n=this.opts.protocols,r=_g?{}:Eg(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,n,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],i=n===e.length-1;fd(r,this.supportsBinary,s=>{try{this.doWrite(r,s)}catch{}i&&bc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=Ag()),this.supportsBinary||(n.b64=1),this.createUri(e,n)}}const rl=cn.WebSocket||cn.MozWebSocket;class i1 extends r1{createSocket(e,n,r){return _g?new rl(e,n,r):n?new rl(e,n):new rl(e)}doWrite(e,n){this.ws.send(n)}}class s1 extends gd{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const n=Hb(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(n).getReader(),i=Fb();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const s=()=>{r.read().then(({done:a,value:c})=>{a||(this.onPacket(c),s())}).catch(a=>{})};s();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],i=n===e.length-1;this._writer.write(r).then(()=>{i&&bc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const o1={websocket:i1,webtransport:s1,polling:n1},a1=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,c1=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function uu(t){if(t.length>8e3)throw"URI too long";const e=t,n=t.indexOf("["),r=t.indexOf("]");n!=-1&&r!=-1&&(t=t.substring(0,n)+t.substring(n,r).replace(/:/g,";")+t.substring(r,t.length));let i=a1.exec(t||""),s={},o=14;for(;o--;)s[c1[o]]=i[o]||"";return n!=-1&&r!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=l1(s,s.path),s.queryKey=u1(s,s.query),s}function l1(t,e){const n=/\/{2,9}/g,r=e.replace(n,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function u1(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,s){i&&(n[i]=s)}),n}const du=typeof addEventListener=="function"&&typeof removeEventListener=="function",ga=[];du&&addEventListener("offline",()=>{ga.forEach(t=>t())},!1);class Ur extends rt{constructor(e,n){if(super(),this.binaryType=$b,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(n=e,e=null),e){const r=uu(e);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=uu(n.host).host);Ec(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const i=r.prototype.name;this.transports.push(i),this._transportsByName[i]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Qb(this.opts.query)),du&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ga.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=bg,n.transport=e,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Ur.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(e);n.open(),this.setTransport(n)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Ur.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=e.data,this._onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(n+=Vb(i)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,bc(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,n,r){return this._sendPacket("message",e,n,r),this}send(e,n,r){return this._sendPacket("message",e,n,r),this}_sendPacket(e,n,r,i){if(typeof n=="function"&&(i=n,n=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const s={type:e,data:n,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(Ur.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),du&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=ga.indexOf(this._offlineEventListener);r!==-1&&ga.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this._prevBufferLen=0}}}Ur.protocol=bg;class d1 extends Ur{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let n=this.createTransport(e),r=!1;Ur.priorWebsocketSuccess=!1;const i=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",d=>{if(!r)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Ur.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(u(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=n.name,this.emitReserved("upgradeError",h)}}))};function s(){r||(r=!0,u(),n.close(),n=null)}const o=d=>{const h=new Error("probe error: "+d);h.transport=n.name,s(),this.emitReserved("upgradeError",h)};function a(){o("transport closed")}function c(){o("socket closed")}function l(d){n&&d.name!==n.name&&s()}const u=()=>{n.removeListener("open",i),n.removeListener("error",o),n.removeListener("close",a),this.off("close",c),this.off("upgrading",l)};n.once("open",i),n.once("error",o),n.once("close",a),this.once("close",c),this.once("upgrading",l),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const n=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&n.push(e[r]);return n}}let h1=class extends d1{constructor(e,n={}){const r=typeof e=="object"?e:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(i=>o1[i]).filter(i=>!!i)),super(e,r)}};function f1(t,e="",n){let r=t;n=n||typeof location<"u"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n<"u"?t=n.protocol+"//"+t:t="https://"+t),r=uu(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const s=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port+e,r.href=r.protocol+"://"+s+(n&&n.port===r.port?"":":"+r.port),r}const p1=typeof ArrayBuffer=="function",g1=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,xg=Object.prototype.toString,m1=typeof Blob=="function"||typeof Blob<"u"&&xg.call(Blob)==="[object BlobConstructor]",y1=typeof File=="function"||typeof File<"u"&&xg.call(File)==="[object FileConstructor]";function md(t){return p1&&(t instanceof ArrayBuffer||g1(t))||m1&&t instanceof Blob||y1&&t instanceof File}function ma(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(ma(t[n]))return!0;return!1}if(md(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return ma(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&ma(t[n]))return!0;return!1}function w1(t){const e=[],n=t.data,r=t;return r.data=hu(n,e),r.attachments=e.length,{packet:r,buffers:e}}function hu(t,e){if(!t)return t;if(md(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=hu(t[r],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=hu(t[r],e));return n}return t}function v1(t,e){return t.data=fu(t.data,e),delete t.attachments,t}function fu(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=fu(t[n],e);else if(typeof t=="object")for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=fu(t[n],e));return t}const b1=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],E1=5;var Pe;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Pe||(Pe={}));class A1{constructor(e){this.replacer=e}encode(e){return(e.type===Pe.EVENT||e.type===Pe.ACK)&&ma(e)?this.encodeAsBinary({type:e.type===Pe.EVENT?Pe.BINARY_EVENT:Pe.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===Pe.BINARY_EVENT||e.type===Pe.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data,this.replacer)),n}encodeAsBinary(e){const n=w1(e),r=this.encodeAsString(n.packet),i=n.buffers;return i.unshift(r),i}}function Lh(t){return Object.prototype.toString.call(t)==="[object Object]"}class yd extends rt{constructor(e){super(),this.reviver=e}add(e){let n;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(e);const r=n.type===Pe.BINARY_EVENT;r||n.type===Pe.BINARY_ACK?(n.type=r?Pe.EVENT:Pe.ACK,this.reconstructor=new S1(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(md(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const r={type:Number(e.charAt(0))};if(Pe[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===Pe.BINARY_EVENT||r.type===Pe.BINARY_ACK){const s=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const o=e.substring(s,n);if(o!=Number(o)||e.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(n+1)==="/"){const s=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););r.nsp=e.substring(s,n)}else r.nsp="/";const i=e.charAt(n+1);if(i!==""&&Number(i)==i){const s=n+1;for(;++n;){const o=e.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===e.length)break}r.id=Number(e.substring(s,n+1))}if(e.charAt(++n)){const s=this.tryParse(e.substr(n));if(yd.isPayloadValid(r.type,s))r.data=s;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,n){switch(e){case Pe.CONNECT:return Lh(n);case Pe.DISCONNECT:return n===void 0;case Pe.CONNECT_ERROR:return typeof n=="string"||Lh(n);case Pe.EVENT:case Pe.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&b1.indexOf(n[0])===-1);case Pe.ACK:case Pe.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class S1{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=v1(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const C1=Object.freeze(Object.defineProperty({__proto__:null,Decoder:yd,Encoder:A1,get PacketType(){return Pe},protocol:E1},Symbol.toStringTag,{value:"Module"}));function mn(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const _1=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class kg extends rt{constructor(e,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[mn(e,"open",this.onopen.bind(this)),mn(e,"packet",this.onpacket.bind(this)),mn(e,"error",this.onerror.bind(this)),mn(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){var r,i,s;if(_1.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const o={type:Pe.EVENT,data:n};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const u=this.ids++,d=n.pop();this._registerAckCallback(u,d),o.id=u}const a=(i=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!a||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,n){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[e]=n;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);n.call(this,new Error("operation has timed out"))},i),o=(...a)=>{this.io.clearTimeoutFn(s),n.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...n){return new Promise((r,i)=>{const s=(o,a)=>o?i(o):r(a);s.withError=!0,n.push(s),this.emit(e,...n)})}_addToQueue(e){let n;typeof e[e.length-1]=="function"&&(n=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...s)=>r!==this._queue[0]?void 0:(i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(i)):(this._queue.shift(),n&&n(null,...s)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!e||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Pe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){const r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Pe.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Pe.EVENT:case Pe.BINARY_EVENT:this.onevent(e);break;case Pe.ACK:case Pe.BINARY_ACK:this.onack(e);break;case Pe.DISCONNECT:this.ondisconnect();break;case Pe.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const n=this;let r=!1;return function(...i){r||(r=!0,n.packet({type:Pe.ACK,id:e,data:i}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(delete this.acks[e.id],n.withError&&e.data.unshift(null),n.apply(this,e.data))}onconnect(e,n){this.id=e,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Pe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,e.data)}}}function ms(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ms.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-n:t+n}return Math.min(t,this.max)|0};ms.prototype.reset=function(){this.attempts=0};ms.prototype.setMin=function(t){this.ms=t};ms.prototype.setMax=function(t){this.max=t};ms.prototype.setJitter=function(t){this.jitter=t};class pu extends rt{constructor(e,n){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,Ec(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new ms({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const i=n.parser||C1;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new h1(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=mn(n,"open",function(){r.onopen(),e&&e()}),s=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=mn(n,"error",s);if(this._timeout!==!1){const a=this._timeout,c=this.setTimeoutFn(()=>{i(),s(new Error("timeout")),n.close()},a);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(mn(e,"ping",this.onping.bind(this)),mn(e,"data",this.ondata.bind(this)),mn(e,"error",this.onerror.bind(this)),mn(e,"close",this.onclose.bind(this)),mn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(n){this.onclose("parse error",n)}}ondecoded(e){bc(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,n){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new kg(this,e,n),this.nsps[e]=r),r}_destroy(e){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let r=0;r<n.length;r++)this.engine.write(n[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const As={};function ya(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=f1(t,e.path||"/socket.io"),r=n.source,i=n.id,s=n.path,o=As[i]&&s in As[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let c;return a?c=new pu(r,e):(As[i]||(As[i]=new pu(r,e)),c=As[i]),n.query&&!e.query&&(e.query=n.queryKey),c.socket(n.path,e)}Object.assign(ya,{Manager:pu,Socket:kg,io:ya,connect:ya});function X(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{c(r.next(l))}catch(u){s(u)}}function a(l){try{c(r.throw(l))}catch(u){s(u)}}function c(l){var u;l.done?i(l.value):(u=l.value,u instanceof n?u:new n(function(d){d(u)})).then(o,a)}c((r=r.apply(t,e||[])).next())})}var Nt=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},Pn=[],rn=[],x1=typeof Uint8Array<"u"?Uint8Array:Array,wd=!1;function Pg(){wd=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0;e<64;++e)Pn[e]=t[e],rn[t.charCodeAt(e)]=e;rn[45]=62,rn[95]=63}function k1(t,e,n){for(var r,i,s=[],o=e;o<n;o+=3)r=(t[o]<<16)+(t[o+1]<<8)+t[o+2],s.push(Pn[(i=r)>>18&63]+Pn[i>>12&63]+Pn[i>>6&63]+Pn[63&i]);return s.join("")}function Dh(t){var e;wd||Pg();for(var n=t.length,r=n%3,i="",s=[],o=16383,a=0,c=n-r;a<c;a+=o)s.push(k1(t,a,a+o>c?c:a+o));return r===1?(e=t[n-1],i+=Pn[e>>2],i+=Pn[e<<4&63],i+="=="):r===2&&(e=(t[n-2]<<8)+t[n-1],i+=Pn[e>>10],i+=Pn[e>>4&63],i+=Pn[e<<2&63],i+="="),s.push(i),s.join("")}function Do(t,e,n,r,i){var s,o,a=8*i-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?i-1:0,h=n?-1:1,f=t[e+d];for(d+=h,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+t[e+d],d+=h,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=r;u>0;o=256*o+t[e+d],d+=h,u-=8);if(s===0)s=1-l;else{if(s===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),s-=l}return(f?-1:1)*o*Math.pow(2,s-r)}function Tg(t,e,n,r,i,s){var o,a,c,l=8*s-i-1,u=(1<<l)-1,d=u>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:s-1,g=r?1:-1,p=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),(e+=o+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(o++,c/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*c-1)*Math.pow(2,i),o+=d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;t[n+f]=255&a,f+=g,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;t[n+f]=255&o,f+=g,o/=256,l-=8);t[n+f-g]|=128*p}var P1={}.toString,Ig=Array.isArray||function(t){return P1.call(t)=="[object Array]"};ee.TYPED_ARRAY_SUPPORT=Nt.TYPED_ARRAY_SUPPORT===void 0||Nt.TYPED_ARRAY_SUPPORT;var T1=Da();function Da(){return ee.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Zn(t,e){if(Da()<e)throw new RangeError("Invalid typed array length");return ee.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=ee.prototype:(t===null&&(t=new ee(e)),t.length=e),t}function ee(t,e,n){if(!(ee.TYPED_ARRAY_SUPPORT||this instanceof ee))return new ee(t,e,n);if(typeof t=="number"){if(typeof e=="string")throw new Error("If encoding is specified then the first argument must be a string");return gu(this,t)}return Og(this,t,e,n)}function Og(t,e,n,r){if(typeof e=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer?function(i,s,o,a){if(s.byteLength,o<0||s.byteLength<o)throw new RangeError("'offset' is out of bounds");if(s.byteLength<o+(a||0))throw new RangeError("'length' is out of bounds");return s=o===void 0&&a===void 0?new Uint8Array(s):a===void 0?new Uint8Array(s,o):new Uint8Array(s,o,a),ee.TYPED_ARRAY_SUPPORT?(i=s).__proto__=ee.prototype:i=il(i,s),i}(t,e,n,r):typeof e=="string"?function(i,s,o){if(typeof o=="string"&&o!==""||(o="utf8"),!ee.isEncoding(o))throw new TypeError('"encoding" must be a valid string encoding');var a=0|Ng(s,o);i=Zn(i,a);var c=i.write(s,o);return c!==a&&(i=i.slice(0,c)),i}(t,e,n):function(i,s){if(Tn(s)){var o=0|vd(s.length);return(i=Zn(i,o)).length===0||s.copy(i,0,0,o),i}if(s){if(typeof ArrayBuffer<"u"&&s.buffer instanceof ArrayBuffer||"length"in s)return typeof s.length!="number"||(a=s.length)!=a?Zn(i,0):il(i,s);if(s.type==="Buffer"&&Ig(s.data))return il(i,s.data)}var a;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function Rg(t){if(typeof t!="number")throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function gu(t,e){if(Rg(e),t=Zn(t,e<0?0:0|vd(e)),!ee.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function il(t,e){var n=e.length<0?0:0|vd(e.length);t=Zn(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function vd(t){if(t>=Da())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Da().toString(16)+" bytes");return 0|t}function Tn(t){return!(t==null||!t._isBuffer)}function Ng(t,e){if(Tn(t))return t.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;typeof t!="string"&&(t=""+t);var n=t.length;if(n===0)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Ua(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Dg(t).length;default:if(r)return Ua(t).length;e=(""+e).toLowerCase(),r=!0}}function I1(t,e,n){var r=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((n===void 0||n>this.length)&&(n=this.length),n<=0)||(n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return F1(this,e,n);case"utf8":case"utf-8":return Bg(this,e,n);case"ascii":return D1(this,e,n);case"latin1":case"binary":return U1(this,e,n);case"base64":return L1(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H1(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function Wr(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function Uh(t,e,n,r,i){if(t.length===0)return-1;if(typeof n=="string"?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if(typeof e=="string"&&(e=ee.from(e,r)),Tn(e))return e.length===0?-1:Fh(t,e,n,r,i);if(typeof e=="number")return e&=255,ee.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):Fh(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function Fh(t,e,n,r,i){var s,o=1,a=t.length,c=e.length;if(r!==void 0&&((r=String(r).toLowerCase())==="ucs2"||r==="ucs-2"||r==="utf16le"||r==="utf-16le")){if(t.length<2||e.length<2)return-1;o=2,a/=2,c/=2,n/=2}function l(f,g){return o===1?f[g]:f.readUInt16BE(g*o)}if(i){var u=-1;for(s=n;s<a;s++)if(l(t,s)===l(e,u===-1?0:s-u)){if(u===-1&&(u=s),s-u+1===c)return u*o}else u!==-1&&(s-=s-u),u=-1}else for(n+c>a&&(n=a-c),s=n;s>=0;s--){for(var d=!0,h=0;h<c;h++)if(l(t,s+h)!==l(e,h)){d=!1;break}if(d)return s}return-1}function O1(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var o=0;o<r;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function R1(t,e,n,r){return Ac(Ua(e,t.length-n),t,n,r)}function Mg(t,e,n,r){return Ac(function(i){for(var s=[],o=0;o<i.length;++o)s.push(255&i.charCodeAt(o));return s}(e),t,n,r)}function N1(t,e,n,r){return Mg(t,e,n,r)}function M1(t,e,n,r){return Ac(Dg(e),t,n,r)}function B1(t,e,n,r){return Ac(function(i,s){for(var o,a,c,l=[],u=0;u<i.length&&!((s-=2)<0);++u)a=(o=i.charCodeAt(u))>>8,c=o%256,l.push(c),l.push(a);return l}(e,t.length-n),t,n,r)}function L1(t,e,n){return e===0&&n===t.length?Dh(t):Dh(t.slice(e,n))}function Bg(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var s,o,a,c,l=t[i],u=null,d=l>239?4:l>223?3:l>191?2:1;if(i+d<=n)switch(d){case 1:l<128&&(u=l);break;case 2:(192&(s=t[i+1]))==128&&(c=(31&l)<<6|63&s)>127&&(u=c);break;case 3:s=t[i+1],o=t[i+2],(192&s)==128&&(192&o)==128&&(c=(15&l)<<12|(63&s)<<6|63&o)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:s=t[i+1],o=t[i+2],a=t[i+3],(192&s)==128&&(192&o)==128&&(192&a)==128&&(c=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(u=c)}u===null?(u=65533,d=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=d}return function(h){var f=h.length;if(f<=Hh)return String.fromCharCode.apply(String,h);for(var g="",p=0;p<f;)g+=String.fromCharCode.apply(String,h.slice(p,p+=Hh));return g}(r)}ee.poolSize=8192,ee._augment=function(t){return t.__proto__=ee.prototype,t},ee.from=function(t,e,n){return Og(null,t,e,n)},ee.TYPED_ARRAY_SUPPORT&&(ee.prototype.__proto__=Uint8Array.prototype,ee.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&ee[Symbol.species]),ee.alloc=function(t,e,n){return function(r,i,s,o){return Rg(i),i<=0?Zn(r,i):s!==void 0?typeof o=="string"?Zn(r,i).fill(s,o):Zn(r,i).fill(s):Zn(r,i)}(null,t,e,n)},ee.allocUnsafe=function(t){return gu(null,t)},ee.allocUnsafeSlow=function(t){return gu(null,t)},ee.isBuffer=Ug,ee.compare=function(t,e){if(!Tn(t)||!Tn(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},ee.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},ee.concat=function(t,e){if(!Ig(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return ee.alloc(0);var n;if(e===void 0)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=ee.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!Tn(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},ee.byteLength=Ng,ee.prototype._isBuffer=!0,ee.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Wr(this,e,e+1);return this},ee.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Wr(this,e,e+3),Wr(this,e+1,e+2);return this},ee.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Wr(this,e,e+7),Wr(this,e+1,e+6),Wr(this,e+2,e+5),Wr(this,e+3,e+4);return this},ee.prototype.toString=function(){var t=0|this.length;return t===0?"":arguments.length===0?Bg(this,0,t):I1.apply(this,arguments)},ee.prototype.equals=function(t){if(!Tn(t))throw new TypeError("Argument must be a Buffer");return this===t||ee.compare(this,t)===0},ee.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},ee.prototype.compare=function(t,e,n,r,i){if(!Tn(t))throw new TypeError("Argument must be a Buffer");if(e===void 0&&(e=0),n===void 0&&(n=t?t.length:0),r===void 0&&(r=0),i===void 0&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),c=this.slice(r,i),l=t.slice(e,n),u=0;u<a;++u)if(c[u]!==l[u]){s=c[u],o=l[u];break}return s<o?-1:o<s?1:0},ee.prototype.includes=function(t,e,n){return this.indexOf(t,e,n)!==-1},ee.prototype.indexOf=function(t,e,n){return Uh(this,t,e,n,!0)},ee.prototype.lastIndexOf=function(t,e,n){return Uh(this,t,e,n,!1)},ee.prototype.write=function(t,e,n,r){if(e===void 0)r="utf8",n=this.length,e=0;else if(n===void 0&&typeof e=="string")r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,r===void 0&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((n===void 0||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return O1(this,t,e,n);case"utf8":case"utf-8":return R1(this,t,e,n);case"ascii":return Mg(this,t,e,n);case"latin1":case"binary":return N1(this,t,e,n);case"base64":return M1(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B1(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},ee.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Hh=4096;function D1(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function U1(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function F1(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",s=e;s<n;++s)i+=$1(t[s]);return i}function H1(t,e,n){for(var r=t.slice(e,n),i="",s=0;s<r.length;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function ot(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Mt(t,e,n,r,i,s){if(!Tn(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function Uo(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,s=Math.min(t.length-n,2);i<s;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function Fo(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,s=Math.min(t.length-n,4);i<s;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function Lg(t,e,n,r,i,s){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Kh(t,e,n,r,i){return i||Lg(t,0,n,4),Tg(t,e,n,r,23,4),n+4}function $h(t,e,n,r,i){return i||Lg(t,0,n,8),Tg(t,e,n,r,52,8),n+8}ee.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=e===void 0?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),ee.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=ee.prototype;else{var i=e-t;n=new ee(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+t]}return n},ee.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||ot(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r},ee.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||ot(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},ee.prototype.readUInt8=function(t,e){return e||ot(t,1,this.length),this[t]},ee.prototype.readUInt16LE=function(t,e){return e||ot(t,2,this.length),this[t]|this[t+1]<<8},ee.prototype.readUInt16BE=function(t,e){return e||ot(t,2,this.length),this[t]<<8|this[t+1]},ee.prototype.readUInt32LE=function(t,e){return e||ot(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},ee.prototype.readUInt32BE=function(t,e){return e||ot(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},ee.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||ot(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},ee.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||ot(t,e,this.length);for(var r=e,i=1,s=this[t+--r];r>0&&(i*=256);)s+=this[t+--r]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},ee.prototype.readInt8=function(t,e){return e||ot(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},ee.prototype.readInt16LE=function(t,e){e||ot(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},ee.prototype.readInt16BE=function(t,e){e||ot(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},ee.prototype.readInt32LE=function(t,e){return e||ot(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},ee.prototype.readInt32BE=function(t,e){return e||ot(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},ee.prototype.readFloatLE=function(t,e){return e||ot(t,4,this.length),Do(this,t,!0,23,4)},ee.prototype.readFloatBE=function(t,e){return e||ot(t,4,this.length),Do(this,t,!1,23,4)},ee.prototype.readDoubleLE=function(t,e){return e||ot(t,8,this.length),Do(this,t,!0,52,8)},ee.prototype.readDoubleBE=function(t,e){return e||ot(t,8,this.length),Do(this,t,!1,52,8)},ee.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||Mt(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,s=0;for(this[e]=255&t;++s<n&&(i*=256);)this[e+s]=t/i&255;return e+n},ee.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||Mt(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+n},ee.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,1,255,0),ee.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},ee.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,2,65535,0),ee.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Uo(this,t,e,!0),e+2},ee.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,2,65535,0),ee.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Uo(this,t,e,!1),e+2},ee.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,4,4294967295,0),ee.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Fo(this,t,e,!0),e+4},ee.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,4,4294967295,0),ee.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Fo(this,t,e,!1),e+4},ee.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);Mt(this,t,e,n,i-1,-i)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&a===0&&this[e+s-1]!==0&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},ee.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);Mt(this,t,e,n,i-1,-i)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&a===0&&this[e+s+1]!==0&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},ee.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,1,127,-128),ee.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},ee.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,2,32767,-32768),ee.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Uo(this,t,e,!0),e+2},ee.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,2,32767,-32768),ee.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Uo(this,t,e,!1),e+2},ee.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,4,2147483647,-2147483648),ee.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Fo(this,t,e,!0),e+4},ee.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),ee.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Fo(this,t,e,!1),e+4},ee.prototype.writeFloatLE=function(t,e,n){return Kh(this,t,e,!0,n)},ee.prototype.writeFloatBE=function(t,e,n){return Kh(this,t,e,!1,n)},ee.prototype.writeDoubleLE=function(t,e,n){return $h(this,t,e,!0,n)},ee.prototype.writeDoubleBE=function(t,e,n){return $h(this,t,e,!1,n)},ee.prototype.copy=function(t,e,n,r){if(n||(n=0),r||r===0||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,s=r-n;if(this===t&&n<e&&e<r)for(i=s-1;i>=0;--i)t[i+e]=this[i+n];else if(s<1e3||!ee.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},ee.prototype.fill=function(t,e,n,r){if(typeof t=="string"){if(typeof e=="string"?(r=e,e=0,n=this.length):typeof n=="string"&&(r=n,n=this.length),t.length===1){var i=t.charCodeAt(0);i<256&&(t=i)}if(r!==void 0&&typeof r!="string")throw new TypeError("encoding must be a string");if(typeof r=="string"&&!ee.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else typeof t=="number"&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=n===void 0?this.length:n>>>0,t||(t=0),typeof t=="number")for(s=e;s<n;++s)this[s]=t;else{var o=Tn(t)?t:Ua(new ee(t,r).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var K1=/[^+\/0-9A-Za-z-_]/g;function $1(t){return t<16?"0"+t.toString(16):t.toString(16)}function Ua(t,e){var n;e=e||1/0;for(var r=t.length,i=null,s=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function Dg(t){return function(e){var n,r,i,s,o,a;wd||Pg();var c=e.length;if(c%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o=e[c-2]==="="?2:e[c-1]==="="?1:0,a=new x1(3*c/4-o),i=o>0?c-4:c;var l=0;for(n=0,r=0;n<i;n+=4,r+=3)s=rn[e.charCodeAt(n)]<<18|rn[e.charCodeAt(n+1)]<<12|rn[e.charCodeAt(n+2)]<<6|rn[e.charCodeAt(n+3)],a[l++]=s>>16&255,a[l++]=s>>8&255,a[l++]=255&s;return o===2?(s=rn[e.charCodeAt(n)]<<2|rn[e.charCodeAt(n+1)]>>4,a[l++]=255&s):o===1&&(s=rn[e.charCodeAt(n)]<<10|rn[e.charCodeAt(n+1)]<<4|rn[e.charCodeAt(n+2)]>>2,a[l++]=s>>8&255,a[l++]=255&s),a}(function(e){if((e=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}(e).replace(K1,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(t))}function Ac(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function Ug(t){return t!=null&&(!!t._isBuffer||jh(t)||function(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&jh(e.slice(0,0))}(t))}function jh(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}var j1=Object.freeze({__proto__:null,Buffer:ee,INSPECT_MAX_BYTES:50,SlowBuffer:function(t){return+t!=t&&(t=0),ee.alloc(+t)},isBuffer:Ug,kMaxLength:T1}),ln=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function vo(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Mi={},Yt={},Et={};function Fa(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Fg(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Hg(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function bd(t,...e){if(!Hg(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Kg(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("hash must be wrapped by utils.wrapConstructor");Fa(t.outputLen),Fa(t.blockLen)}function $g(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function jg(t,e){bd(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Object.defineProperty(Et,"__esModule",{value:!0}),Et.isBytes=Hg,Et.number=Fa,Et.bool=Fg,Et.bytes=bd,Et.hash=Kg,Et.exists=$g,Et.output=jg;const z1={number:Fa,bool:Fg,bytes:bd,hash:Kg,exists:$g,output:jg};Et.default=z1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.wrapCipher=t.Hash=t.nextTick=t.isLE=t.createView=t.u32=t.u16=t.u8=void 0,t.bytesToHex=r,t.hexToBytes=o,t.hexToNumber=a,t.bytesToNumberBE=function(d){return a(r(d))},t.numberToBytesBE=function(d,h){return o(d.toString(16).padStart(2*h,"0"))},t.asyncLoop=async function(d,h,f){let g=Date.now();for(let p=0;p<d;p++){f(p);const y=Date.now()-g;y>=0&&y<h||(await(0,t.nextTick)(),g+=y)}},t.utf8ToBytes=c,t.bytesToUtf8=function(d){return new TextDecoder().decode(d)},t.toBytes=function(d){if(typeof d=="string")d=c(d);else{if(!(0,e.isBytes)(d))throw new Error("Uint8Array expected, got "+typeof d);d=u(d)}return d},t.concatBytes=function(...d){let h=0;for(let g=0;g<d.length;g++){const p=d[g];(0,e.bytes)(p),h+=p.length}const f=new Uint8Array(h);for(let g=0,p=0;g<d.length;g++){const y=d[g];f.set(y,p),p+=y.length}return f},t.checkOpts=function(d,h){if(h==null||typeof h!="object")throw new Error("options must be defined");return Object.assign(d,h)},t.equalBytes=function(d,h){if(d.length!==h.length)return!1;let f=0;for(let g=0;g<d.length;g++)f|=d[g]^h[g];return f===0},t.setBigUint64=l,t.u64Lengths=function(d,h){const f=new Uint8Array(16),g=(0,t.createView)(f);return l(g,0,BigInt(h?h.length:0),!0),l(g,8,BigInt(d.length),!0),f},t.isAligned32=function(d){return d.byteOffset%4==0},t.copyBytes=u,t.clean=function(...d){for(let h=0;h<d.length;h++)d[h].fill(0)};const e=Et;if(t.u8=d=>new Uint8Array(d.buffer,d.byteOffset,d.byteLength),t.u16=d=>new Uint16Array(d.buffer,d.byteOffset,Math.floor(d.byteLength/2)),t.u32=d=>new Uint32Array(d.buffer,d.byteOffset,Math.floor(d.byteLength/4)),t.createView=d=>new DataView(d.buffer,d.byteOffset,d.byteLength),t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!t.isLE)throw new Error("Non little-endian hardware is not supported");const n=Array.from({length:256},(d,h)=>h.toString(16).padStart(2,"0"));function r(d){(0,e.bytes)(d);let h="";for(let f=0;f<d.length;f++)h+=n[d[f]];return h}const i={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function s(d){return d>=i._0&&d<=i._9?d-i._0:d>=i._A&&d<=i._F?d-(i._A-10):d>=i._a&&d<=i._f?d-(i._a-10):void 0}function o(d){if(typeof d!="string")throw new Error("hex string expected, got "+typeof d);const h=d.length,f=h/2;if(h%2)throw new Error("padded hex string expected, got unpadded hex of length "+h);const g=new Uint8Array(f);for(let p=0,y=0;p<f;p++,y+=2){const m=s(d.charCodeAt(y)),C=s(d.charCodeAt(y+1));if(m===void 0||C===void 0){const v=d[y]+d[y+1];throw new Error('hex string expected, got non-hex character "'+v+'" at index '+y)}g[p]=16*m+C}return g}function a(d){if(typeof d!="string")throw new Error("hex string expected, got "+typeof d);return BigInt(d===""?"0":`0x${d}`)}function c(d){if(typeof d!="string")throw new Error("string expected, got "+typeof d);return new Uint8Array(new TextEncoder().encode(d))}t.nextTick=async()=>{},t.Hash=class{};function l(d,h,f,g){if(typeof d.setBigUint64=="function")return d.setBigUint64(h,f,g);const p=BigInt(32),y=BigInt(4294967295),m=Number(f>>p&y),C=Number(f&y),v=g?4:0,I=g?0:4;d.setUint32(h+v,m,g),d.setUint32(h+I,C,g)}function u(d){return Uint8Array.from(d)}t.wrapCipher=(d,h)=>(Object.assign(h,d),h)}(Yt);var Qs={},at={};Object.defineProperty(at,"__esModule",{value:!0}),at.AEAD_TAG_LENGTH=at.XCHACHA20_NONCE_LENGTH=at.CURVE25519_PUBLIC_KEY_SIZE=at.ETH_PUBLIC_KEY_SIZE=at.UNCOMPRESSED_PUBLIC_KEY_SIZE=at.COMPRESSED_PUBLIC_KEY_SIZE=at.SECRET_KEY_LENGTH=void 0,at.SECRET_KEY_LENGTH=32,at.COMPRESSED_PUBLIC_KEY_SIZE=33,at.UNCOMPRESSED_PUBLIC_KEY_SIZE=65,at.ETH_PUBLIC_KEY_SIZE=64,at.CURVE25519_PUBLIC_KEY_SIZE=32,at.XCHACHA20_NONCE_LENGTH=24,at.AEAD_TAG_LENGTH=16,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ephemeralKeySize=t.symmetricNonceLength=t.symmetricAlgorithm=t.isHkdfKeyCompressed=t.isEphemeralKeyCompressed=t.ellipticCurve=t.ECIES_CONFIG=void 0;var e=at,n=function(){this.ellipticCurve="secp256k1",this.isEphemeralKeyCompressed=!1,this.isHkdfKeyCompressed=!1,this.symmetricAlgorithm="aes-256-gcm",this.symmetricNonceLength=16};t.ECIES_CONFIG=new n,t.ellipticCurve=function(){return t.ECIES_CONFIG.ellipticCurve},t.isEphemeralKeyCompressed=function(){return t.ECIES_CONFIG.isEphemeralKeyCompressed},t.isHkdfKeyCompressed=function(){return t.ECIES_CONFIG.isHkdfKeyCompressed},t.symmetricAlgorithm=function(){return t.ECIES_CONFIG.symmetricAlgorithm},t.symmetricNonceLength=function(){return t.ECIES_CONFIG.symmetricNonceLength},t.ephemeralKeySize=function(){var r={secp256k1:t.ECIES_CONFIG.isEphemeralKeyCompressed?e.COMPRESSED_PUBLIC_KEY_SIZE:e.UNCOMPRESSED_PUBLIC_KEY_SIZE,x25519:e.CURVE25519_PUBLIC_KEY_SIZE,ed25519:e.CURVE25519_PUBLIC_KEY_SIZE};if(t.ECIES_CONFIG.ellipticCurve in r)return r[t.ECIES_CONFIG.ellipticCurve];throw new Error("Not implemented")}}(Qs);var sl={},Ha={},Cc={},zg={},Ed={},Ho={};Object.defineProperty(Ho,"__esModule",{value:!0}),Ho.crypto=void 0,Ho.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.gcm=t.ctr=t.cbc=t.utils=void 0,t.randomBytes=i,t.getWebcryptoSubtle=s,t.managedNonce=function(c){return(0,n.number)(c.nonceLength),(l,...u)=>({encrypt(d,...h){const{nonceLength:f}=c,g=i(f),p=c(l,g,...u).encrypt(d,...h),y=(0,r.concatBytes)(g,p);return p.fill(0),y},decrypt(d,...h){const{nonceLength:f}=c,g=d.subarray(0,f),p=d.subarray(f);return c(l,g,...u).decrypt(p,...h)}})};const e=Ho,n=Et,r=Yt;function i(c=32){if(e.crypto&&typeof e.crypto.getRandomValues=="function")return e.crypto.getRandomValues(new Uint8Array(c));if(e.crypto&&typeof e.crypto.randomBytes=="function")return e.crypto.randomBytes(c);throw new Error("crypto.getRandomValues must be defined")}function s(){if(e.crypto&&typeof e.crypto.subtle=="object"&&e.crypto.subtle!=null)return e.crypto.subtle;throw new Error("crypto.subtle must be defined")}t.utils={async encrypt(c,l,u,d){const h=s(),f=await h.importKey("raw",c,l,!0,["encrypt"]),g=await h.encrypt(u,f,d);return new Uint8Array(g)},async decrypt(c,l,u,d){const h=s(),f=await h.importKey("raw",c,l,!0,["decrypt"]),g=await h.decrypt(u,f,d);return new Uint8Array(g)}};const o={CBC:"AES-CBC",CTR:"AES-CTR",GCM:"AES-GCM"};function a(c){return(l,u,d)=>{(0,n.bytes)(l),(0,n.bytes)(u);const h={name:c,length:8*l.length},f=function(g,p,y){if(g===o.CBC)return{name:o.CBC,iv:p};if(g===o.CTR)return{name:o.CTR,counter:p,length:64};if(g===o.GCM)return y?{name:o.GCM,iv:p,additionalData:y}:{name:o.GCM,iv:p};throw new Error("unknown aes block mode")}(c,u,d);return{encrypt:g=>((0,n.bytes)(g),t.utils.encrypt(l,h,f,g)),decrypt:g=>((0,n.bytes)(g),t.utils.decrypt(l,h,f,g))}}}t.cbc=a(o.CBC),t.ctr=a(o.CTR),t.gcm=a(o.GCM)}(Ed);var Gg={},ct={},Xn={},Wt={};function Ka(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Vg(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function qg(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function Ad(t,...e){if(!qg(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Wg(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ka(t.outputLen),Ka(t.blockLen)}function Qg(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Jg(t,e){Ad(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.isBytes=qg,Wt.number=Ka,Wt.bool=Vg,Wt.bytes=Ad,Wt.hash=Wg,Wt.exists=Qg,Wt.output=Jg;const G1={number:Ka,bool:Vg,bytes:Ad,hash:Wg,exists:Qg,output:Jg};Wt.default=G1;var dr={},Ko={};Object.defineProperty(Ko,"__esModule",{value:!0}),Ko.crypto=void 0,Ko.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Hash=t.nextTick=t.byteSwapIfBE=t.byteSwap=t.isLE=t.rotl=t.rotr=t.createView=t.u32=t.u8=void 0,t.isBytes=function(l){return l instanceof Uint8Array||l!=null&&typeof l=="object"&&l.constructor.name==="Uint8Array"},t.byteSwap32=function(l){for(let u=0;u<l.length;u++)l[u]=(0,t.byteSwap)(l[u])},t.bytesToHex=function(l){(0,n.bytes)(l);let u="";for(let d=0;d<l.length;d++)u+=r[l[d]];return u},t.hexToBytes=function(l){if(typeof l!="string")throw new Error("hex string expected, got "+typeof l);const u=l.length,d=u/2;if(u%2)throw new Error("padded hex string expected, got unpadded hex of length "+u);const h=new Uint8Array(d);for(let f=0,g=0;f<d;f++,g+=2){const p=s(l.charCodeAt(g)),y=s(l.charCodeAt(g+1));if(p===void 0||y===void 0){const m=l[g]+l[g+1];throw new Error('hex string expected, got non-hex character "'+m+'" at index '+g)}h[f]=16*p+y}return h},t.asyncLoop=async function(l,u,d){let h=Date.now();for(let f=0;f<l;f++){d(f);const g=Date.now()-h;g>=0&&g<u||(await(0,t.nextTick)(),h+=g)}},t.utf8ToBytes=o,t.toBytes=a,t.concatBytes=function(...l){let u=0;for(let h=0;h<l.length;h++){const f=l[h];(0,n.bytes)(f),u+=f.length}const d=new Uint8Array(u);for(let h=0,f=0;h<l.length;h++){const g=l[h];d.set(g,f),f+=g.length}return d},t.checkOpts=function(l,u){if(u!==void 0&&c.call(u)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(l,u)},t.wrapConstructor=function(l){const u=h=>l().update(a(h)).digest(),d=l();return u.outputLen=d.outputLen,u.blockLen=d.blockLen,u.create=()=>l(),u},t.wrapConstructorWithOpts=function(l){const u=(h,f)=>l(f).update(a(h)).digest(),d=l({});return u.outputLen=d.outputLen,u.blockLen=d.blockLen,u.create=h=>l(h),u},t.wrapXOFConstructorWithOpts=function(l){const u=(h,f)=>l(f).update(a(h)).digest(),d=l({});return u.outputLen=d.outputLen,u.blockLen=d.blockLen,u.create=h=>l(h),u},t.randomBytes=function(l=32){if(e.crypto&&typeof e.crypto.getRandomValues=="function")return e.crypto.getRandomValues(new Uint8Array(l));if(e.crypto&&typeof e.crypto.randomBytes=="function")return e.crypto.randomBytes(l);throw new Error("crypto.getRandomValues must be defined")};const e=Ko,n=Wt;t.u8=l=>new Uint8Array(l.buffer,l.byteOffset,l.byteLength),t.u32=l=>new Uint32Array(l.buffer,l.byteOffset,Math.floor(l.byteLength/4)),t.createView=l=>new DataView(l.buffer,l.byteOffset,l.byteLength),t.rotr=(l,u)=>l<<32-u|l>>>u,t.rotl=(l,u)=>l<<u|l>>>32-u>>>0,t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,t.byteSwap=l=>l<<24&4278190080|l<<8&16711680|l>>>8&65280|l>>>24&255,t.byteSwapIfBE=t.isLE?l=>l:l=>(0,t.byteSwap)(l);const r=Array.from({length:256},(l,u)=>u.toString(16).padStart(2,"0")),i={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function s(l){return l>=i._0&&l<=i._9?l-i._0:l>=i._A&&l<=i._F?l-(i._A-10):l>=i._a&&l<=i._f?l-(i._a-10):void 0}function o(l){if(typeof l!="string")throw new Error("utf8ToBytes expected string, got "+typeof l);return new Uint8Array(new TextEncoder().encode(l))}function a(l){return typeof l=="string"&&(l=o(l)),(0,n.bytes)(l),l}t.nextTick=async()=>{},t.Hash=class{clone(){return this._cloneInto()}};const c={}.toString}(dr),Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.HashMD=Xn.Maj=Xn.Chi=void 0;const ol=Wt,Ss=dr;Xn.Chi=(t,e,n)=>t&e^~t&n;Xn.Maj=(t,e,n)=>t&e^t&n^e&n;Xn.HashMD=class extends Ss.Hash{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,Ss.createView)(this.buffer)}update(t){(0,ol.exists)(this);const{view:e,buffer:n,blockLen:r}=this,i=(t=(0,Ss.toBytes)(t)).length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);if(o!==r)n.set(t.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===r&&(this.process(e,0),this.pos=0);else{const a=(0,Ss.createView)(t);for(;r<=i-s;s+=r)this.process(a,s)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,ol.exists)(this),(0,ol.output)(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:i}=this;let{pos:s}=this;e[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>r-s&&(this.process(n,0),s=0);for(let u=s;u<r;u++)e[u]=0;(function(u,d,h,f){if(typeof u.setBigUint64=="function")return u.setBigUint64(d,h,f);const g=BigInt(32),p=BigInt(4294967295),y=Number(h>>g&p),m=Number(h&p),C=f?4:0,v=f?0:4;u.setUint32(d+C,y,f),u.setUint32(d+v,m,f)})(n,r-8,BigInt(8*this.length),i),this.process(n,0);const o=(0,Ss.createView)(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<c;u++)o.setUint32(4*u,l[u],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:i,destroyed:s,pos:o}=this;return t.length=r,t.pos=o,t.finished=i,t.destroyed=s,r%e&&t.buffer.set(n),t}};var be={};Object.defineProperty(be,"__esModule",{value:!0}),be.add5L=be.add5H=be.add4H=be.add4L=be.add3H=be.add3L=be.rotlBL=be.rotlBH=be.rotlSL=be.rotlSH=be.rotr32L=be.rotr32H=be.rotrBL=be.rotrBH=be.rotrSL=be.rotrSH=be.shrSL=be.shrSH=be.toBig=void 0,be.fromBig=Sd,be.split=Yg,be.add=dm;const $o=BigInt(2**32-1),mu=BigInt(32);function Sd(t,e=!1){return e?{h:Number(t&$o),l:Number(t>>mu&$o)}:{h:0|Number(t>>mu&$o),l:0|Number(t&$o)}}function Yg(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=Sd(t[i],e);[n[i],r[i]]=[s,o]}return[n,r]}const Zg=(t,e)=>BigInt(t>>>0)<<mu|BigInt(e>>>0);be.toBig=Zg;const Xg=(t,e,n)=>t>>>n;be.shrSH=Xg;const em=(t,e,n)=>t<<32-n|e>>>n;be.shrSL=em;const tm=(t,e,n)=>t>>>n|e<<32-n;be.rotrSH=tm;const nm=(t,e,n)=>t<<32-n|e>>>n;be.rotrSL=nm;const rm=(t,e,n)=>t<<64-n|e>>>n-32;be.rotrBH=rm;const im=(t,e,n)=>t>>>n-32|e<<64-n;be.rotrBL=im;const sm=(t,e)=>e;be.rotr32H=sm;const om=(t,e)=>t;be.rotr32L=om;const am=(t,e,n)=>t<<n|e>>>32-n;be.rotlSH=am;const cm=(t,e,n)=>e<<n|t>>>32-n;be.rotlSL=cm;const lm=(t,e,n)=>e<<n-32|t>>>64-n;be.rotlBH=lm;const um=(t,e,n)=>t<<n-32|e>>>64-n;function dm(t,e,n,r){const i=(e>>>0)+(r>>>0);return{h:t+n+(i/2**32|0)|0,l:0|i}}be.rotlBL=um;const hm=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0);be.add3L=hm;const fm=(t,e,n,r)=>e+n+r+(t/2**32|0)|0;be.add3H=fm;const pm=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0);be.add4L=pm;const gm=(t,e,n,r,i)=>e+n+r+i+(t/2**32|0)|0;be.add4H=gm;const mm=(t,e,n,r,i)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(i>>>0);be.add5L=mm;const ym=(t,e,n,r,i,s)=>e+n+r+i+s+(t/2**32|0)|0;be.add5H=ym;const V1={fromBig:Sd,split:Yg,toBig:Zg,shrSH:Xg,shrSL:em,rotrSH:tm,rotrSL:nm,rotrBH:rm,rotrBL:im,rotr32H:sm,rotr32L:om,rotlSH:am,rotlSL:cm,rotlBH:lm,rotlBL:um,add:dm,add3L:hm,add3H:fm,add4L:pm,add4H:gm,add5H:ym,add5L:mm};be.default=V1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.sha384=ct.sha512_256=ct.sha512_224=ct.sha512=ct.SHA384=ct.SHA512_256=ct.SHA512_224=ct.SHA512=void 0;const q1=Xn,Se=be,jo=dr,[W1,Q1]=Se.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),fr=new Uint32Array(80),pr=new Uint32Array(80);class bo extends q1.HashMD{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:g,Hh:p,Hl:y}=this;return[e,n,r,i,s,o,a,c,l,u,d,h,f,g,p,y]}set(e,n,r,i,s,o,a,c,l,u,d,h,f,g,p,y){this.Ah=0|e,this.Al=0|n,this.Bh=0|r,this.Bl=0|i,this.Ch=0|s,this.Cl=0|o,this.Dh=0|a,this.Dl=0|c,this.Eh=0|l,this.El=0|u,this.Fh=0|d,this.Fl=0|h,this.Gh=0|f,this.Gl=0|g,this.Hh=0|p,this.Hl=0|y}process(e,n){for(let v=0;v<16;v++,n+=4)fr[v]=e.getUint32(n),pr[v]=e.getUint32(n+=4);for(let v=16;v<80;v++){const I=0|fr[v-15],R=0|pr[v-15],L=Se.default.rotrSH(I,R,1)^Se.default.rotrSH(I,R,8)^Se.default.shrSH(I,R,7),z=Se.default.rotrSL(I,R,1)^Se.default.rotrSL(I,R,8)^Se.default.shrSL(I,R,7),j=0|fr[v-2],D=0|pr[v-2],B=Se.default.rotrSH(j,D,19)^Se.default.rotrBH(j,D,61)^Se.default.shrSH(j,D,6),$=Se.default.rotrSL(j,D,19)^Se.default.rotrBL(j,D,61)^Se.default.shrSL(j,D,6),U=Se.default.add4L(z,$,pr[v-7],pr[v-16]),M=Se.default.add4H(U,L,B,fr[v-7],fr[v-16]);fr[v]=0|M,pr[v]=0|U}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:g,Gh:p,Gl:y,Hh:m,Hl:C}=this;for(let v=0;v<80;v++){const I=Se.default.rotrSH(d,h,14)^Se.default.rotrSH(d,h,18)^Se.default.rotrBH(d,h,41),R=Se.default.rotrSL(d,h,14)^Se.default.rotrSL(d,h,18)^Se.default.rotrBL(d,h,41),L=d&f^~d&p,z=h&g^~h&y,j=Se.default.add5L(C,R,z,Q1[v],pr[v]),D=Se.default.add5H(j,m,I,L,W1[v],fr[v]),B=0|j,$=Se.default.rotrSH(r,i,28)^Se.default.rotrBH(r,i,34)^Se.default.rotrBH(r,i,39),U=Se.default.rotrSL(r,i,28)^Se.default.rotrBL(r,i,34)^Se.default.rotrBL(r,i,39),M=r&s^r&a^s&a,O=i&o^i&c^o&c;m=0|p,C=0|y,p=0|f,y=0|g,f=0|d,g=0|h,{h:d,l:h}=Se.default.add(0|l,0|u,0|D,0|B),l=0|a,u=0|c,a=0|s,c=0|o,s=0|r,o=0|i;const A=Se.default.add3L(B,U,O);r=Se.default.add3H(A,D,$,M),i=0|A}({h:r,l:i}=Se.default.add(0|this.Ah,0|this.Al,0|r,0|i)),{h:s,l:o}=Se.default.add(0|this.Bh,0|this.Bl,0|s,0|o),{h:a,l:c}=Se.default.add(0|this.Ch,0|this.Cl,0|a,0|c),{h:l,l:u}=Se.default.add(0|this.Dh,0|this.Dl,0|l,0|u),{h:d,l:h}=Se.default.add(0|this.Eh,0|this.El,0|d,0|h),{h:f,l:g}=Se.default.add(0|this.Fh,0|this.Fl,0|f,0|g),{h:p,l:y}=Se.default.add(0|this.Gh,0|this.Gl,0|p,0|y),{h:m,l:C}=Se.default.add(0|this.Hh,0|this.Hl,0|m,0|C),this.set(r,i,s,o,a,c,l,u,d,h,f,g,p,y,m,C)}roundClean(){fr.fill(0),pr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}ct.SHA512=bo;class wm extends bo{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}ct.SHA512_224=wm;class vm extends bo{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}ct.SHA512_256=vm;class zh extends bo{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}ct.SHA384=zh,ct.sha512=(0,jo.wrapConstructor)(()=>new bo),ct.sha512_224=(0,jo.wrapConstructor)(()=>new wm),ct.sha512_256=(0,jo.wrapConstructor)(()=>new vm),ct.sha384=(0,jo.wrapConstructor)(()=>new zh);var yu={},Ui={},Le={},xe={};Object.defineProperty(xe,"__esModule",{value:!0}),xe.notImplemented=xe.bitMask=void 0,xe.isBytes=$a,xe.abytes=ja,xe.abool=function(t,e){if(typeof e!="boolean")throw new Error(`${t} must be valid boolean, got "${e}".`)},xe.bytesToHex=al,xe.numberToHexUnpadded=Gh,xe.hexToNumber=cl,xe.hexToBytes=va,xe.bytesToNumberBE=function(t){return cl(al(t))},xe.bytesToNumberLE=function(t){return ja(t),cl(al(Uint8Array.from(t).reverse()))},xe.numberToBytesBE=qh,xe.numberToBytesLE=function(t,e){return qh(t,e).reverse()},xe.numberToVarBytesBE=function(t){return va(Gh(t))},xe.ensureBytes=function(t,e,n){let r;if(typeof e=="string")try{r=va(e)}catch(s){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${s}`)}else{if(!$a(e))throw new Error(`${t} must be hex string or Uint8Array`);r=Uint8Array.from(e)}const i=r.length;if(typeof n=="number"&&i!==n)throw new Error(`${t} expected ${n} bytes, got ${i}`);return r},xe.concatBytes=Wh,xe.equalBytes=function(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0},xe.utf8ToBytes=function(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))},xe.inRange=Qh,xe.aInRange=function(t,e,n,r){if(!Qh(e,n,r))throw new Error(`expected valid ${t}: ${n} <= n < ${r}, got ${typeof e} ${e}`)},xe.bitLen=function(t){let e;for(e=0;t>wu;t>>=wa,e+=1);return e},xe.bitGet=function(t,e){return t>>BigInt(e)&wa},xe.bitSet=function(t,e,n){return t|(n?wa:wu)<<BigInt(e)},xe.createHmacDrbg=function(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=ul(t),i=ul(t),s=0;const o=()=>{r.fill(1),i.fill(0),s=0},a=(...u)=>n(i,r,...u),c=(u=ul())=>{i=a(Jh([0]),u),r=a(),u.length!==0&&(i=a(Jh([1]),u),r=a())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const d=[];for(;u<e;){r=a();const h=r.slice();d.push(h),u+=r.length}return Wh(...d)};return(u,d)=>{let h;for(o(),c(u);!(h=d(l()));)c();return o(),h}},xe.validateObject=function(t,e,n={}){const r=(i,s,o)=>{const a=Z1[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);const c=t[i];if(!(o&&c===void 0||a(c,t)))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(const[i,s]of Object.entries(e))r(i,s,!1);for(const[i,s]of Object.entries(n))r(i,s,!0);return t},xe.memoized=function(t){const e=new WeakMap;return(n,...r)=>{const i=e.get(n);if(i!==void 0)return i;const s=t(n,...r);return e.set(n,s),s}};const wu=BigInt(0),wa=BigInt(1),J1=BigInt(2);function $a(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function ja(t){if(!$a(t))throw new Error("Uint8Array expected")}const Y1=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function al(t){ja(t);let e="";for(let n=0;n<t.length;n++)e+=Y1[t[n]];return e}function Gh(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}function cl(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}const $n={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Vh(t){return t>=$n._0&&t<=$n._9?t-$n._0:t>=$n._A&&t<=$n._F?t-($n._A-10):t>=$n._a&&t<=$n._f?t-($n._a-10):void 0}function va(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let i=0,s=0;i<n;i++,s+=2){const o=Vh(t.charCodeAt(s)),a=Vh(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}r[i]=16*o+a}return r}function qh(t,e){return va(t.toString(16).padStart(2*e,"0"))}function Wh(...t){let e=0;for(let r=0;r<t.length;r++){const i=t[r];ja(i),e+=i.length}const n=new Uint8Array(e);for(let r=0,i=0;r<t.length;r++){const s=t[r];n.set(s,i),i+=s.length}return n}const ll=t=>typeof t=="bigint"&&wu<=t;function Qh(t,e,n){return ll(t)&&ll(e)&&ll(n)&&e<=t&&t<n}xe.bitMask=t=>(J1<<BigInt(t-1))-wa;const ul=t=>new Uint8Array(t),Jh=t=>Uint8Array.from(t),Z1={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||$a(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};xe.notImplemented=()=>{throw new Error("not implemented")},Object.defineProperty(Le,"__esModule",{value:!0}),Le.isNegativeLE=void 0,Le.mod=zt,Le.pow=bm,Le.pow2=function(t,e,n){let r=t;for(;e-- >ut;)r*=r,r%=n;return r},Le.invert=zo,Le.tonelliShanks=Em,Le.FpSqrt=Xh,Le.validateField=function(t){const e=eE.reduce((n,r)=>(n[r]="function",n),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,$t.validateObject)(t,e)},Le.FpPow=ef,Le.FpInvertBatch=tf,Le.FpDiv=function(t,e,n){return t.mul(e,typeof n=="bigint"?zo(n,t.ORDER):t.inv(n))},Le.FpLegendre=nf,Le.FpIsSquare=function(t){const e=nf(t.ORDER);return n=>{const r=e(t,n);return t.eql(r,t.ZERO)||t.eql(r,t.ONE)}},Le.nLength=dl,Le.Field=function(t,e,n=!1,r={}){if(t<=ut)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:i,nByteLength:s}=dl(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=Xh(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:s,MASK:(0,$t.bitMask)(i),ZERO:ut,ONE:He,create:c=>zt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("Invalid field element: expected bigint, got "+typeof c);return ut<=c&&c<t},is0:c=>c===ut,isOdd:c=>(c&He)===He,neg:c=>zt(-c,t),eql:(c,l)=>c===l,sqr:c=>zt(c*c,t),add:(c,l)=>zt(c+l,t),sub:(c,l)=>zt(c-l,t),mul:(c,l)=>zt(c*l,t),pow:(c,l)=>ef(a,c,l),div:(c,l)=>zt(c*zo(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>zo(c,t),sqrt:r.sqrt||(c=>o(a,c)),invertBatch:c=>tf(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?(0,$t.numberToBytesLE)(c,s):(0,$t.numberToBytesBE)(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return n?(0,$t.bytesToNumberLE)(c):(0,$t.bytesToNumberBE)(c)}});return Object.freeze(a)},Le.FpSqrtOdd=function(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const n=t.sqrt(e);return t.isOdd(n)?n:t.neg(n)},Le.FpSqrtEven=function(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const n=t.sqrt(e);return t.isOdd(n)?t.neg(n):n},Le.hashToPrivateScalar=function(t,e,n=!1){t=(0,$t.ensureBytes)("privateHash",t);const r=t.length,i=dl(e).nByteLength+8;if(i<24||r<i||r>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${r}`);const s=n?(0,$t.bytesToNumberLE)(t):(0,$t.bytesToNumberBE)(t);return zt(s,e-He)+He},Le.getFieldBytesLength=bu,Le.getMinHashLength=rf,Le.mapHashToField=function(t,e,n=!1){const r=t.length,i=bu(e),s=rf(e);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);const o=zt(n?(0,$t.bytesToNumberBE)(t):(0,$t.bytesToNumberLE)(t),e-He)+He;return n?(0,$t.numberToBytesLE)(o,i):(0,$t.numberToBytesBE)(o,i)};const $t=xe,ut=BigInt(0),He=BigInt(1),Mr=BigInt(2),X1=BigInt(3),vu=BigInt(4),Yh=BigInt(5),Zh=BigInt(8);function zt(t,e){const n=t%e;return n>=ut?n:e+n}function bm(t,e,n){if(n<=ut||e<ut)throw new Error("Expected power/modulo > 0");if(n===He)return ut;let r=He;for(;e>ut;)e&He&&(r=r*t%n),t=t*t%n,e>>=He;return r}function zo(t,e){if(t===ut||e<=ut)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=zt(t,e),r=e,i=ut,s=He;for(;n!==ut;){const o=r%n,a=i-s*(r/n);r=n,n=o,i=s,s=a}if(r!==He)throw new Error("invert: does not exist");return zt(i,e)}function Em(t){const e=(t-He)/Mr;let n,r,i;for(n=t-He,r=0;n%Mr===ut;n/=Mr,r++);for(i=Mr;i<t&&bm(i,e,t)!==t-He;i++);if(r===1){const o=(t+He)/vu;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const s=(n+He)/Mr;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,l=o.pow(o.mul(o.ONE,i),n),u=o.pow(a,s),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let g=o.sqr(d);h<c&&!o.eql(g,o.ONE);h++)g=o.sqr(g);const f=o.pow(l,He<<BigInt(c-h-1));l=o.sqr(f),u=o.mul(u,f),d=o.mul(d,l),c=h}return u}}function Xh(t){if(t%vu===X1){const e=(t+He)/vu;return function(n,r){const i=n.pow(r,e);if(!n.eql(n.sqr(i),r))throw new Error("Cannot find square root");return i}}if(t%Zh===Yh){const e=(t-Yh)/Zh;return function(n,r){const i=n.mul(r,Mr),s=n.pow(i,e),o=n.mul(r,s),a=n.mul(n.mul(o,Mr),s),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return Em(t)}BigInt(9),BigInt(16);Le.isNegativeLE=(t,e)=>(zt(t,e)&He)===He;const eE=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ef(t,e,n){if(n<ut)throw new Error("Expected power > 0");if(n===ut)return t.ONE;if(n===He)return e;let r=t.ONE,i=e;for(;n>ut;)n&He&&(r=t.mul(r,i)),i=t.sqr(i),n>>=He;return r}function tf(t,e){const n=new Array(e.length),r=e.reduce((s,o,a)=>t.is0(o)?s:(n[a]=s,t.mul(s,o)),t.ONE),i=t.inv(r);return e.reduceRight((s,o,a)=>t.is0(o)?s:(n[a]=t.mul(s,n[a]),t.mul(s,o)),i),n}function nf(t){const e=(t-He)/Mr;return(n,r)=>n.pow(r,e)}function dl(t,e){const n=e!==void 0?e:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function bu(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function rf(t){const e=bu(t);return e+Math.ceil(e/2)}Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.wNAF=function(t,e){const n=(s,o)=>{const a=o.negate();return s?a:o},r=s=>{if(!Number.isSafeInteger(s)||s<=0||s>e)throw new Error(`Wrong window size=${s}, should be [1..${e}]`)},i=s=>(r(s),{windows:Math.ceil(e/s)+1,windowSize:2**(s-1)});return{constTimeNegate:n,unsafeLadder(s,o){let a=t.ZERO,c=s;for(;o>tE;)o&hl&&(a=a.add(c)),c=c.double(),o>>=hl;return a},precomputeWindow(s,o){const{windows:a,windowSize:c}=i(o),l=[];let u=s,d=u;for(let h=0;h<a;h++){d=u,l.push(d);for(let f=1;f<c;f++)d=d.add(u),l.push(d);u=d.double()}return l},wNAF(s,o,a){const{windows:c,windowSize:l}=i(s);let u=t.ZERO,d=t.BASE;const h=BigInt(2**s-1),f=2**s,g=BigInt(s);for(let p=0;p<c;p++){const y=p*l;let m=Number(a&h);a>>=g,m>l&&(m-=f,a+=hl);const C=y,v=y+Math.abs(m)-1,I=p%2!=0,R=m<0;m===0?d=d.add(n(I,o[C])):u=u.add(n(R,o[v]))}return{p:u,f:d}},wNAFCached(s,o,a){const c=af.get(s)||1;let l=fl.get(s);return l||(l=this.precomputeWindow(s,c),c!==1&&fl.set(s,a(l))),this.wNAF(c,l,o)},setWindowSize(s,o){r(o),af.set(s,o),fl.delete(s)}}},Ui.pippenger=function(t,e,n,r){if(!Array.isArray(n)||!Array.isArray(r)||r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");r.forEach((u,d)=>{if(!e.isValid(u))throw new Error(`wrong scalar at index ${d}`)}),n.forEach((u,d)=>{if(!(u instanceof t))throw new Error(`wrong point at index ${d}`)});const i=(0,of.bitLen)(BigInt(n.length)),s=i>12?i-3:i>4?i-2:i?2:1,o=(1<<s)-1,a=new Array(o+1).fill(t.ZERO),c=Math.floor((e.BITS-1)/s)*s;let l=t.ZERO;for(let u=c;u>=0;u-=s){a.fill(t.ZERO);for(let h=0;h<r.length;h++){const f=r[h],g=Number(f>>BigInt(u)&BigInt(o));a[g]=a[g].add(n[h])}let d=t.ZERO;for(let h=a.length-1,f=t.ZERO;h>0;h--)f=f.add(a[h]),d=d.add(f);if(l=l.add(d),u!==0)for(let h=0;h<s;h++)l=l.double()}return l},Ui.validateBasic=function(t){return(0,sf.validateField)(t.Fp),(0,of.validateObject)(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,sf.nLength)(t.n,t.nBitLength),...t,p:t.Fp.ORDER})};const sf=Le,of=xe,tE=BigInt(0),hl=BigInt(1),fl=new WeakMap,af=new WeakMap;Object.defineProperty(yu,"__esModule",{value:!0}),yu.twistedEdwards=function(t){const e=function(M){const O=(0,pl.validateBasic)(M);return Bt.validateObject(M,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...O})}(t),{Fp:n,n:r,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=e,l=Go<<BigInt(8*a)-Lt,u=n.create,d=(0,cf.Field)(e.n,e.nBitLength),h=e.uvRatio||((M,O)=>{try{return{isValid:!0,value:n.sqrt(M*n.inv(O))}}catch{return{isValid:!1,value:dn}}}),f=e.adjustScalarBytes||(M=>M),g=e.domain||((M,O,A)=>{if((0,jt.abool)("phflag",A),O.length||A)throw new Error("Contexts/pre-hash are not supported");return M});function p(M,O){Bt.aInRange("coordinate "+M,O,dn,l)}function y(M){if(!(M instanceof v))throw new Error("ExtendedPoint expected")}const m=(0,jt.memoized)((M,O)=>{const{ex:A,ey:T,ez:F}=M,w=M.is0();O==null&&(O=w?nE:n.inv(F));const S=u(A*O),_=u(T*O),k=u(F*O);if(w)return{x:dn,y:Lt};if(k!==Lt)throw new Error("invZ was invalid");return{x:S,y:_}}),C=(0,jt.memoized)(M=>{const{a:O,d:A}=e;if(M.is0())throw new Error("bad point: ZERO");const{ex:T,ey:F,ez:w,et:S}=M,_=u(T*T),k=u(F*F),E=u(w*w),b=u(E*E),x=u(_*O);if(u(E*u(x+k))!==u(b+u(A*u(_*k))))throw new Error("bad point: equation left != right (1)");if(u(T*F)!==u(w*S))throw new Error("bad point: equation left != right (2)");return!0});class v{constructor(O,A,T,F){this.ex=O,this.ey=A,this.ez=T,this.et=F,p("x",O),p("y",A),p("z",T),p("t",F),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(O){if(O instanceof v)throw new Error("extended point not allowed");const{x:A,y:T}=O||{};return p("x",A),p("y",T),new v(A,T,Lt,u(A*T))}static normalizeZ(O){const A=n.invertBatch(O.map(T=>T.ez));return O.map((T,F)=>T.toAffine(A[F])).map(v.fromAffine)}static msm(O,A){return(0,pl.pippenger)(v,d,O,A)}_setWindowSize(O){L.setWindowSize(this,O)}assertValidity(){C(this)}equals(O){y(O);const{ex:A,ey:T,ez:F}=this,{ex:w,ey:S,ez:_}=O,k=u(A*_),E=u(w*F),b=u(T*_),x=u(S*F);return k===E&&b===x}is0(){return this.equals(v.ZERO)}negate(){return new v(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:O}=e,{ex:A,ey:T,ez:F}=this,w=u(A*A),S=u(T*T),_=u(Go*u(F*F)),k=u(O*w),E=A+T,b=u(u(E*E)-w-S),x=k+S,P=x-_,N=k-S,H=u(b*P),K=u(x*N),V=u(b*N),q=u(P*x);return new v(H,K,q,V)}add(O){y(O);const{a:A,d:T}=e,{ex:F,ey:w,ez:S,et:_}=this,{ex:k,ey:E,ez:b,et:x}=O;if(A===BigInt(-1)){const ae=u((w-F)*(E+k)),fe=u((w+F)*(E-k)),le=u(fe-ae);if(le===dn)return this.double();const ye=u(S*Go*x),Ae=u(_*Go*b),ge=Ae+ye,we=fe+ae,Ee=Ae-ye,je=u(ge*le),st=u(we*Ee),Vc=u(ge*Ee),qc=u(le*we);return new v(je,st,qc,Vc)}const P=u(F*k),N=u(w*E),H=u(_*T*x),K=u(S*b),V=u((F+w)*(k+E)-P-N),q=K-H,Y=K+H,Z=u(N-A*P),ie=u(V*q),oe=u(Y*Z),pe=u(V*Z),se=u(q*Y);return new v(ie,oe,se,pe)}subtract(O){return this.add(O.negate())}wNAF(O){return L.wNAFCached(this,O,v.normalizeZ)}multiply(O){const A=O;Bt.aInRange("scalar",A,Lt,r);const{p:T,f:F}=this.wNAF(A);return v.normalizeZ([T,F])[0]}multiplyUnsafe(O){const A=O;return Bt.aInRange("scalar",A,dn,r),A===dn?R:this.equals(R)||A===Lt?this:this.equals(I)?this.wNAF(A).p:L.unsafeLadder(this,A)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return L.unsafeLadder(this,r).is0()}toAffine(O){return m(this,O)}clearCofactor(){const{h:O}=e;return O===Lt?this:this.multiplyUnsafe(O)}static fromHex(O,A=!1){const{d:T,a:F}=e,w=n.BYTES;O=(0,jt.ensureBytes)("pointHex",O,w),(0,jt.abool)("zip215",A);const S=O.slice(),_=O[w-1];S[w-1]=-129&_;const k=Bt.bytesToNumberLE(S),E=A?l:n.ORDER;Bt.aInRange("pointHex.y",k,dn,E);const b=u(k*k),x=u(b-Lt),P=u(T*b-F);let{isValid:N,value:H}=h(x,P);if(!N)throw new Error("Point.fromHex: invalid y coordinate");const K=(H&Lt)===Lt,V=(128&_)!=0;if(!A&&H===dn&&V)throw new Error("Point.fromHex: x=0 and x_0=1");return V!==K&&(H=u(-H)),v.fromAffine({x:H,y:k})}static fromPrivateKey(O){return D(O).point}toRawBytes(){const{x:O,y:A}=this.toAffine(),T=Bt.numberToBytesLE(A,n.BYTES);return T[T.length-1]|=O&Lt?128:0,T}toHex(){return Bt.bytesToHex(this.toRawBytes())}}v.BASE=new v(e.Gx,e.Gy,Lt,u(e.Gx*e.Gy)),v.ZERO=new v(dn,Lt,Lt,dn);const{BASE:I,ZERO:R}=v,L=(0,pl.wNAF)(v,8*a);function z(M){return(0,cf.mod)(M,r)}function j(M){return z(Bt.bytesToNumberLE(M))}function D(M){const O=a;M=(0,jt.ensureBytes)("private key",M,O);const A=(0,jt.ensureBytes)("hashed private key",s(M),2*O),T=f(A.slice(0,O)),F=A.slice(O,2*O),w=j(T),S=I.multiply(w),_=S.toRawBytes();return{head:T,prefix:F,scalar:w,point:S,pointBytes:_}}function B(M=new Uint8Array,...O){const A=Bt.concatBytes(...O);return j(s(g(A,(0,jt.ensureBytes)("context",M),!!i)))}const $=rE;return I._setWindowSize(8),{CURVE:e,getPublicKey:function(M){return D(M).pointBytes},sign:function(M,O,A={}){M=(0,jt.ensureBytes)("message",M),i&&(M=i(M));const{prefix:T,scalar:F,pointBytes:w}=D(O),S=B(A.context,T,M),_=I.multiply(S).toRawBytes(),k=z(S+B(A.context,_,w,M)*F);Bt.aInRange("signature.s",k,dn,r);const E=Bt.concatBytes(_,Bt.numberToBytesLE(k,n.BYTES));return(0,jt.ensureBytes)("result",E,2*a)},verify:function(M,O,A,T=$){const{context:F,zip215:w}=T,S=n.BYTES;M=(0,jt.ensureBytes)("signature",M,2*S),O=(0,jt.ensureBytes)("message",O),w!==void 0&&(0,jt.abool)("zip215",w),i&&(O=i(O));const _=Bt.bytesToNumberLE(M.slice(S,2*S));let k,E,b;try{k=v.fromHex(A,w),E=v.fromHex(M.slice(0,S),w),b=I.multiplyUnsafe(_)}catch{return!1}if(!w&&k.isSmallOrder())return!1;const x=B(F,E.toRawBytes(),k.toRawBytes(),O);return E.add(k.multiplyUnsafe(x)).subtract(b).clearCofactor().equals(v.ZERO)},ExtendedPoint:v,utils:{getExtendedPublicKey:D,randomPrivateKey:()=>o(n.BYTES),precompute:(M=8,O=v.BASE)=>(O._setWindowSize(M),O.multiply(BigInt(3)),O)}}};const pl=Ui,cf=Le,Bt=xe,jt=xe,dn=BigInt(0),Lt=BigInt(1),Go=BigInt(2),nE=BigInt(8),rE={zip215:!0};var kr={};Object.defineProperty(kr,"__esModule",{value:!0}),kr.expand_message_xmd=Am,kr.expand_message_xof=Sm,kr.hash_to_field=gl,kr.isogenyMap=function(t,e){const n=e.map(r=>Array.from(r).reverse());return(r,i)=>{const[s,o,a,c]=n.map(l=>l.reduce((u,d)=>t.add(t.mul(u,r),d)));return r=t.div(s,o),i=t.mul(i,t.div(a,c)),{x:r,y:i}}},kr.createHasher=function(t,e,n){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(r,i){const s=gl(r,2,{...n,DST:n.DST,...i}),o=t.fromAffine(e(s[0])),a=t.fromAffine(e(s[1])),c=o.add(a).clearCofactor();return c.assertValidity(),c},encodeToCurve(r,i){const s=gl(r,1,{...n,DST:n.encodeDST,...i}),o=t.fromAffine(e(s[0])).clearCofactor();return o.assertValidity(),o},mapToCurve(r){if(!Array.isArray(r))throw new Error("mapToCurve: expected array of bigints");for(const s of r)if(typeof s!="bigint")throw new Error(`mapToCurve: expected array of bigints, got ${s} in array`);const i=t.fromAffine(e(r)).clearCofactor();return i.assertValidity(),i}}};const iE=Le,bt=xe,sE=bt.bytesToNumberBE;function Pr(t,e){if(Js(t),Js(e),t<0||t>=1<<8*e)throw new Error(`bad I2OSP call: value=${t} length=${e}`);const n=Array.from({length:e}).fill(0);for(let r=e-1;r>=0;r--)n[r]=255&t,t>>>=8;return new Uint8Array(n)}function oE(t,e){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]^e[r];return n}function Js(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Am(t,e,n,r){(0,bt.abytes)(t),(0,bt.abytes)(e),Js(n),e.length>255&&(e=r((0,bt.concatBytes)((0,bt.utf8ToBytes)("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:s}=r,o=Math.ceil(n/i);if(n>65535||o>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=(0,bt.concatBytes)(e,Pr(e.length,1)),c=Pr(0,s),l=Pr(n,2),u=new Array(o),d=r((0,bt.concatBytes)(c,t,l,Pr(0,1),a));u[0]=r((0,bt.concatBytes)(d,Pr(1,1),a));for(let h=1;h<=o;h++){const f=[oE(d,u[h-1]),Pr(h+1,1),a];u[h]=r((0,bt.concatBytes)(...f))}return(0,bt.concatBytes)(...u).slice(0,n)}function Sm(t,e,n,r,i){if((0,bt.abytes)(t),(0,bt.abytes)(e),Js(n),e.length>255){const s=Math.ceil(2*r/8);e=i.create({dkLen:s}).update((0,bt.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(e).digest()}if(n>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:n}).update(t).update(Pr(n,2)).update(e).update(Pr(e.length,1)).digest()}function gl(t,e,n){(0,bt.validateObject)(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:r,k:i,m:s,hash:o,expand:a,DST:c}=n;(0,bt.abytes)(t),Js(e);const l=typeof c=="string"?(0,bt.utf8ToBytes)(c):c,u=r.toString(2).length,d=Math.ceil((u+i)/8),h=e*s*d;let f;if(a==="xmd")f=Am(t,l,h,o);else if(a==="xof")f=Sm(t,l,h,i,o);else{if(a!=="_internal_pass")throw new Error('expand must be "xmd" or "xof"');f=t}const g=new Array(e);for(let p=0;p<e;p++){const y=new Array(s);for(let m=0;m<s;m++){const C=d*(m+p*s),v=f.subarray(C,C+d);y[m]=(0,iE.mod)(sE(v),r)}g[p]=y}return g}var Eu={};Object.defineProperty(Eu,"__esModule",{value:!0}),Eu.montgomery=function(t){const e=function(p){return(0,gr.validateObject)(p,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...p})}(t),{P:n}=e,r=p=>(0,lf.mod)(p,n),i=e.montgomeryBits,s=Math.ceil(i/8),o=e.nByteLength,a=e.adjustScalarBytes||(p=>p),c=e.powPminus2||(p=>(0,lf.pow)(p,n-BigInt(2),n));function l(p,y,m){const C=r(p*(y-m));return[y=r(y-C),m=r(m+C)]}const u=(e.a-BigInt(2))/BigInt(4);function d(p){return(0,gr.numberToBytesLE)(r(p),s)}function h(p,y){const m=function(I){const R=(0,gr.ensureBytes)("u coordinate",I,s);return o===32&&(R[31]&=127),(0,gr.bytesToNumberLE)(R)}(y),C=function(I){const R=(0,gr.ensureBytes)("scalar",I),L=R.length;if(L!==s&&L!==o)throw new Error(`Expected ${s} or ${o} bytes, got ${L}`);return(0,gr.bytesToNumberLE)(a(R))}(p),v=function(I,R){(0,gr.aInRange)("u",I,ki,n),(0,gr.aInRange)("scalar",R,ki,n);const L=R,z=I;let j,D=ml,B=ki,$=I,U=ml,M=ki;for(let A=BigInt(i-1);A>=ki;A--){const T=L>>A&ml;M^=T,j=l(M,D,$),D=j[0],$=j[1],j=l(M,B,U),B=j[0],U=j[1],M=T;const F=D+B,w=r(F*F),S=D-B,_=r(S*S),k=w-_,E=$+U,b=r(($-U)*F),x=r(E*S),P=b+x,N=b-x;$=r(P*P),U=r(z*r(N*N)),D=r(w*_),B=r(k*(w+r(u*k)))}j=l(M,D,$),D=j[0],$=j[1],j=l(M,B,U),B=j[0],U=j[1];const O=c(B);return r(D*O)}(m,C);if(v===ki)throw new Error("Invalid private or public key received");return d(v)}const f=d(e.Gu);function g(p){return h(p,f)}return{scalarMult:h,scalarMultBase:g,getSharedSecret:(p,y)=>h(p,y),getPublicKey:p=>g(p),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:f}};const lf=Le,gr=xe,ki=BigInt(0),ml=BigInt(1);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.hash_to_ristretto255=t.hashToRistretto255=t.RistrettoPoint=t.encodeToCurve=t.hashToCurve=t.edwardsToMontgomery=t.x25519=t.ed25519ph=t.ed25519ctx=t.ed25519=t.ED25519_TORSION_SUBGROUP=void 0,t.edwardsToMontgomeryPub=L,t.edwardsToMontgomeryPriv=function(x){const P=I.hash(x.subarray(0,32));return I.adjustScalarBytes(P).subarray(0,32)};const e=ct,n=dr,r=yu,i=kr,s=Le,o=Eu,a=xe,c=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),u=BigInt(0),d=BigInt(1),h=BigInt(2),f=BigInt(3),g=BigInt(5),p=BigInt(8);function y(x){const P=BigInt(10),N=BigInt(20),H=BigInt(40),K=BigInt(80),V=c,q=x*x%V*x%V,Y=(0,s.pow2)(q,h,V)*q%V,Z=(0,s.pow2)(Y,d,V)*x%V,ie=(0,s.pow2)(Z,g,V)*Z%V,oe=(0,s.pow2)(ie,P,V)*ie%V,pe=(0,s.pow2)(oe,N,V)*oe%V,se=(0,s.pow2)(pe,H,V)*pe%V,ae=(0,s.pow2)(se,K,V)*se%V,fe=(0,s.pow2)(ae,K,V)*se%V,le=(0,s.pow2)(fe,P,V)*ie%V;return{pow_p_5_8:(0,s.pow2)(le,h,V)*x%V,b2:q}}function m(x){return x[0]&=248,x[31]&=127,x[31]|=64,x}function C(x,P){const N=c,H=(0,s.mod)(P*P*P,N),K=y(x*(0,s.mod)(H*H*P,N)).pow_p_5_8;let V=(0,s.mod)(x*H*K,N);const q=(0,s.mod)(P*V*V,N),Y=V,Z=(0,s.mod)(V*l,N),ie=q===x,oe=q===(0,s.mod)(-x,N),pe=q===(0,s.mod)(-x*l,N);return ie&&(V=Y),(oe||pe)&&(V=Z),(0,s.isNegativeLE)(V,N)&&(V=(0,s.mod)(-V,N)),{isValid:ie||oe,value:V}}t.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];const v=(0,s.Field)(c,void 0,!0),I={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:v,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:p,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:e.sha512,randomBytes:n.randomBytes,adjustScalarBytes:m,uvRatio:C};function R(x,P,N){if(P.length>255)throw new Error("Context is too big");return(0,n.concatBytes)((0,n.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([N?1:0,P.length]),P,x)}function L(x){const{y:P}=t.ed25519.ExtendedPoint.fromHex(x),N=BigInt(1);return v.toBytes(v.create((N+P)*v.inv(N-P)))}t.ed25519=(0,r.twistedEdwards)(I),t.ed25519ctx=(0,r.twistedEdwards)({...I,domain:R}),t.ed25519ph=(0,r.twistedEdwards)(Object.assign({},I,{domain:R,prehash:e.sha512})),t.x25519=(0,o.montgomery)({P:c,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:x=>{const P=c,{pow_p_5_8:N,b2:H}=y(x);return(0,s.mod)((0,s.pow2)(N,f,P)*H,P)},adjustScalarBytes:m,randomBytes:n.randomBytes}),t.edwardsToMontgomery=L;const z=(v.ORDER+f)/p,j=v.pow(h,z),D=v.sqrt(v.neg(v.ONE)),B=(0,s.FpSqrtEven)(v,v.neg(BigInt(486664)));function $(x){const{xMn:P,xMd:N,yMn:H,yMd:K}=function(se){const ae=(v.ORDER-g)/p,fe=BigInt(486662);let le=v.sqr(se);le=v.mul(le,h);let ye=v.add(le,v.ONE),Ae=v.neg(fe),ge=v.sqr(ye),we=v.mul(ge,ye),Ee=v.mul(le,fe);Ee=v.mul(Ee,Ae),Ee=v.add(Ee,ge),Ee=v.mul(Ee,Ae);let je=v.sqr(we);ge=v.sqr(je),je=v.mul(je,we),je=v.mul(je,Ee),ge=v.mul(ge,je);let st=v.pow(ge,ae);st=v.mul(st,je);let Vc=v.mul(st,D);ge=v.sqr(st),ge=v.mul(ge,we);let qc=v.eql(ge,Ee),Sh=v.cmov(Vc,st,qc),lb=v.mul(Ae,le),bs=v.mul(st,se);bs=v.mul(bs,j);let ub=v.mul(bs,D),db=v.mul(Ee,le);ge=v.sqr(bs),ge=v.mul(ge,we);let hb=v.eql(ge,db),fb=v.cmov(ub,bs,hb);ge=v.sqr(Sh),ge=v.mul(ge,we);let Wc=v.eql(ge,Ee),pb=v.cmov(lb,Ae,Wc),Es=v.cmov(fb,Sh,Wc),gb=v.isOdd(Es);return Es=v.cmov(Es,v.neg(Es),Wc!==gb),{xMn:pb,xMd:ye,yMn:Es,yMd:d}}(x);let V=v.mul(P,K);V=v.mul(V,B);let q=v.mul(N,H),Y=v.sub(P,N),Z=v.add(P,N),ie=v.mul(q,Z),oe=v.eql(ie,v.ZERO);V=v.cmov(V,v.ZERO,oe),q=v.cmov(q,v.ONE,oe),Y=v.cmov(Y,v.ONE,oe),Z=v.cmov(Z,v.ONE,oe);const pe=v.invertBatch([q,Z]);return{x:v.mul(V,pe[0]),y:v.mul(Y,pe[1])}}const U=(0,i.createHasher)(t.ed25519.ExtendedPoint,x=>$(x[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:v.ORDER,m:1,k:128,expand:"xmd",hash:e.sha512});function M(x){if(!(x instanceof b))throw new Error("RistrettoPoint expected")}t.hashToCurve=U.hashToCurve,t.encodeToCurve=U.encodeToCurve;const O=l,A=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),T=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),F=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),w=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),S=x=>C(d,x),_=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),k=x=>t.ed25519.CURVE.Fp.create((0,a.bytesToNumberLE)(x)&_);function E(x){const{d:P}=t.ed25519.CURVE,N=t.ed25519.CURVE.Fp.ORDER,H=t.ed25519.CURVE.Fp.create,K=H(O*x*x),V=H((K+d)*F);let q=BigInt(-1);const Y=H((q-P*K)*H(K+P));let{isValid:Z,value:ie}=C(V,Y),oe=H(ie*x);(0,s.isNegativeLE)(oe,N)||(oe=H(-oe)),Z||(ie=oe),Z||(q=K);const pe=H(q*(K-d)*w-Y),se=ie*ie,ae=H((ie+ie)*Y),fe=H(pe*A),le=H(d-se),ye=H(d+se);return new t.ed25519.ExtendedPoint(H(ae*ye),H(le*fe),H(fe*ye),H(ae*le))}class b{constructor(P){this.ep=P}static fromAffine(P){return new b(t.ed25519.ExtendedPoint.fromAffine(P))}static hashToCurve(P){P=(0,a.ensureBytes)("ristrettoHash",P,64);const N=E(k(P.slice(0,32))),H=E(k(P.slice(32,64)));return new b(N.add(H))}static fromHex(P){P=(0,a.ensureBytes)("ristrettoHex",P,32);const{a:N,d:H}=t.ed25519.CURVE,K=t.ed25519.CURVE.Fp.ORDER,V=t.ed25519.CURVE.Fp.create,q="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",Y=k(P);if(!(0,a.equalBytes)((0,a.numberToBytesLE)(Y,32),P)||(0,s.isNegativeLE)(Y,K))throw new Error(q);const Z=V(Y*Y),ie=V(d+N*Z),oe=V(d-N*Z),pe=V(ie*ie),se=V(oe*oe),ae=V(N*H*pe-se),{isValid:fe,value:le}=S(V(ae*se)),ye=V(le*oe),Ae=V(le*ye*ae);let ge=V((Y+Y)*ye);(0,s.isNegativeLE)(ge,K)&&(ge=V(-ge));const we=V(ie*Ae),Ee=V(ge*we);if(!fe||(0,s.isNegativeLE)(Ee,K)||we===u)throw new Error(q);return new b(new t.ed25519.ExtendedPoint(ge,we,d,Ee))}toRawBytes(){let{ex:P,ey:N,ez:H,et:K}=this.ep;const V=t.ed25519.CURVE.Fp.ORDER,q=t.ed25519.CURVE.Fp.create,Y=q(q(H+N)*q(H-N)),Z=q(P*N),ie=q(Z*Z),{value:oe}=S(q(Y*ie)),pe=q(oe*Y),se=q(oe*Z),ae=q(pe*se*K);let fe;if((0,s.isNegativeLE)(K*ae,V)){let ye=q(N*O),Ae=q(P*O);P=ye,N=Ae,fe=q(pe*T)}else fe=se;(0,s.isNegativeLE)(P*ae,V)&&(N=q(-N));let le=q((H-N)*fe);return(0,s.isNegativeLE)(le,V)&&(le=q(-le)),(0,a.numberToBytesLE)(le,32)}toHex(){return(0,a.bytesToHex)(this.toRawBytes())}toString(){return this.toHex()}equals(P){M(P);const{ex:N,ey:H}=this.ep,{ex:K,ey:V}=P.ep,q=t.ed25519.CURVE.Fp.create,Y=q(N*V)===q(H*K),Z=q(H*V)===q(N*K);return Y||Z}add(P){return M(P),new b(this.ep.add(P.ep))}subtract(P){return M(P),new b(this.ep.subtract(P.ep))}multiply(P){return new b(this.ep.multiply(P))}multiplyUnsafe(P){return new b(this.ep.multiplyUnsafe(P))}double(){return new b(this.ep.double())}negate(){return new b(this.ep.negate())}}t.RistrettoPoint=(b.BASE||(b.BASE=new b(t.ed25519.ExtendedPoint.BASE)),b.ZERO||(b.ZERO=new b(t.ed25519.ExtendedPoint.ZERO)),b),t.hashToRistretto255=(x,P)=>{const N=P.DST,H=typeof N=="string"?(0,n.utf8ToBytes)(N):N,K=(0,i.expand_message_xmd)(x,H,64,e.sha512);return b.hashToCurve(K)},t.hash_to_ristretto255=t.hashToRistretto255})(Gg);var Cm={},er={};Object.defineProperty(er,"__esModule",{value:!0}),er.sha224=er.sha256=er.SHA256=void 0;const yl=Xn,tn=dr,aE=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),mr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),yr=new Uint32Array(64);class Cd extends yl.HashMD{constructor(){super(64,32,8,!1),this.A=0|mr[0],this.B=0|mr[1],this.C=0|mr[2],this.D=0|mr[3],this.E=0|mr[4],this.F=0|mr[5],this.G=0|mr[6],this.H=0|mr[7]}get(){const{A:e,B:n,C:r,D:i,E:s,F:o,G:a,H:c}=this;return[e,n,r,i,s,o,a,c]}set(e,n,r,i,s,o,a,c){this.A=0|e,this.B=0|n,this.C=0|r,this.D=0|i,this.E=0|s,this.F=0|o,this.G=0|a,this.H=0|c}process(e,n){for(let d=0;d<16;d++,n+=4)yr[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=yr[d-15],f=yr[d-2],g=(0,tn.rotr)(h,7)^(0,tn.rotr)(h,18)^h>>>3,p=(0,tn.rotr)(f,17)^(0,tn.rotr)(f,19)^f>>>10;yr[d]=p+yr[d-7]+g+yr[d-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=u+((0,tn.rotr)(a,6)^(0,tn.rotr)(a,11)^(0,tn.rotr)(a,25))+(0,yl.Chi)(a,c,l)+aE[d]+yr[d]|0,f=((0,tn.rotr)(r,2)^(0,tn.rotr)(r,13)^(0,tn.rotr)(r,22))+(0,yl.Maj)(r,i,s)|0;u=l,l=c,c=a,a=o+h|0,o=s,s=i,i=r,r=h+f|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,i,s,o,a,c,l,u)}roundClean(){yr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}er.SHA256=Cd;class cE extends Cd{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}er.sha256=(0,tn.wrapConstructor)(()=>new Cd),er.sha224=(0,tn.wrapConstructor)(()=>new cE);var ba={},_d={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.hmac=t.HMAC=void 0;const e=Wt,n=dr;class r extends n.Hash{constructor(s,o){super(),this.finished=!1,this.destroyed=!1,(0,e.hash)(s);const a=(0,n.toBytes)(o);if(this.iHash=s.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const c=this.blockLen,l=new Uint8Array(c);l.set(a.length>c?s.create().update(a).digest():a);for(let u=0;u<l.length;u++)l[u]^=54;this.iHash.update(l),this.oHash=s.create();for(let u=0;u<l.length;u++)l[u]^=106;this.oHash.update(l),l.fill(0)}update(s){return(0,e.exists)(this),this.iHash.update(s),this}digestInto(s){(0,e.exists)(this),(0,e.bytes)(s,this.outputLen),this.finished=!0,this.iHash.digestInto(s),this.oHash.update(s),this.oHash.digestInto(s),this.destroy()}digest(){const s=new Uint8Array(this.oHash.outputLen);return this.digestInto(s),s}_cloneInto(s){s||(s=Object.create(Object.getPrototypeOf(this),{}));const{oHash:o,iHash:a,finished:c,destroyed:l,blockLen:u,outputLen:d}=this;return s.finished=c,s.destroyed=l,s.blockLen=u,s.outputLen=d,s.oHash=o._cloneInto(s.oHash),s.iHash=a._cloneInto(s.iHash),s}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}t.HMAC=r,t.hmac=(i,s,o)=>new r(i,s).update(o).digest(),t.hmac.create=(i,s)=>new r(i,s)})(_d);var xd={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DER=void 0,t.weierstrassPoints=f,t.weierstrass=function(p){const y=function(x){const P=(0,e.validateBasic)(x);return r.validateObject(P,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...P})}(p),{Fp:m,n:C}=y,v=m.BYTES+1,I=2*m.BYTES+1;function R(x){return n.mod(x,C)}function L(x){return n.invert(x,C)}const{ProjectivePoint:z,normPrivateKeyToScalar:j,weierstrassEquation:D,isWithinCurveOrder:B}=f({...y,toBytes(x,P,N){const H=P.toAffine(),K=m.toBytes(H.x),V=r.concatBytes;return(0,i.abool)("isCompressed",N),N?V(Uint8Array.from([P.hasEvenY()?2:3]),K):V(Uint8Array.from([4]),K,m.toBytes(H.y))},fromBytes(x){const P=x.length,N=x[0],H=x.subarray(1);if(P!==v||N!==2&&N!==3){if(P===I&&N===4)return{x:m.fromBytes(H.subarray(0,m.BYTES)),y:m.fromBytes(H.subarray(m.BYTES,2*m.BYTES))};throw new Error(`Point of length ${P} was invalid. Expected ${v} compressed bytes or ${I} uncompressed bytes`)}{const K=r.bytesToNumberBE(H);if(!r.inRange(K,l,m.ORDER))throw new Error("Point is not on curve");const V=D(K);let q;try{q=m.sqrt(V)}catch(Y){const Z=Y instanceof Error?": "+Y.message:"";throw new Error("Point is not on curve"+Z)}return(1&N)==1!=((q&l)===l)&&(q=m.neg(q)),{x:K,y:q}}}}),$=x=>r.bytesToHex(r.numberToBytesBE(x,y.nByteLength));function U(x){return x>C>>l}const M=(x,P,N)=>r.bytesToNumberBE(x.slice(P,N));class O{constructor(P,N,H){this.r=P,this.s=N,this.recovery=H,this.assertValidity()}static fromCompact(P){const N=y.nByteLength;return P=(0,i.ensureBytes)("compactSignature",P,2*N),new O(M(P,0,N),M(P,N,2*N))}static fromDER(P){const{r:N,s:H}=t.DER.toSig((0,i.ensureBytes)("DER",P));return new O(N,H)}assertValidity(){r.aInRange("r",this.r,l,C),r.aInRange("s",this.s,l,C)}addRecoveryBit(P){return new O(this.r,this.s,P)}recoverPublicKey(P){const{r:N,s:H,recovery:K}=this,V=w((0,i.ensureBytes)("msgHash",P));if(K==null||![0,1,2,3].includes(K))throw new Error("recovery id invalid");const q=K===2||K===3?N+y.n:N;if(q>=m.ORDER)throw new Error("recovery id 2 or 3 invalid");const Y=(1&K)==0?"02":"03",Z=z.fromHex(Y+$(q)),ie=L(q),oe=R(-V*ie),pe=R(H*ie),se=z.BASE.multiplyAndAddUnsafe(Z,oe,pe);if(!se)throw new Error("point at infinify");return se.assertValidity(),se}hasHighS(){return U(this.s)}normalizeS(){return this.hasHighS()?new O(this.r,R(-this.s),this.recovery):this}toDERRawBytes(){return r.hexToBytes(this.toDERHex())}toDERHex(){return t.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return r.hexToBytes(this.toCompactHex())}toCompactHex(){return $(this.r)+$(this.s)}}const A={isValidPrivateKey(x){try{return j(x),!0}catch{return!1}},normPrivateKeyToScalar:j,randomPrivateKey:()=>{const x=n.getMinHashLength(y.n);return n.mapHashToField(y.randomBytes(x),y.n)},precompute:(x=8,P=z.BASE)=>(P._setWindowSize(x),P.multiply(BigInt(3)),P)};function T(x){const P=r.isBytes(x),N=typeof x=="string",H=(P||N)&&x.length;return P?H===v||H===I:N?H===2*v||H===2*I:x instanceof z}const F=y.bits2int||function(x){const P=r.bytesToNumberBE(x),N=8*x.length-y.nBitLength;return N>0?P>>BigInt(N):P},w=y.bits2int_modN||function(x){return R(F(x))},S=r.bitMask(y.nBitLength);function _(x){return r.aInRange(`num < 2^${y.nBitLength}`,x,c,S),r.numberToBytesBE(x,y.nByteLength)}function k(x,P,N=E){if(["recovered","canonical"].some(ae=>ae in N))throw new Error("sign() legacy options not supported");const{hash:H,randomBytes:K}=y;let{lowS:V,prehash:q,extraEntropy:Y}=N;V==null&&(V=!0),x=(0,i.ensureBytes)("msgHash",x),s(N),q&&(x=(0,i.ensureBytes)("prehashed msgHash",H(x)));const Z=w(x),ie=j(P),oe=[_(ie),_(Z)];if(Y!=null&&Y!==!1){const ae=Y===!0?K(m.BYTES):Y;oe.push((0,i.ensureBytes)("extraEntropy",ae))}const pe=r.concatBytes(...oe),se=Z;return{seed:pe,k2sig:function(ae){const fe=F(ae);if(!B(fe))return;const le=L(fe),ye=z.BASE.multiply(fe).toAffine(),Ae=R(ye.x);if(Ae===c)return;const ge=R(le*R(se+Ae*ie));if(ge===c)return;let we=(ye.x===Ae?0:2)|Number(ye.y&l),Ee=ge;return V&&U(ge)&&(Ee=function(je){return U(je)?R(-je):je}(ge),we^=1),new O(Ae,Ee,we)}}}const E={lowS:y.lowS,prehash:!1},b={lowS:y.lowS,prehash:!1};return z.BASE._setWindowSize(8),{CURVE:y,getPublicKey:function(x,P=!0){return z.fromPrivateKey(x).toRawBytes(P)},getSharedSecret:function(x,P,N=!0){if(T(x))throw new Error("first arg must be private key");if(!T(P))throw new Error("second arg must be public key");return z.fromHex(P).multiply(j(x)).toRawBytes(N)},sign:function(x,P,N=E){const{seed:H,k2sig:K}=k(x,P,N),V=y;return r.createHmacDrbg(V.hash.outputLen,V.nByteLength,V.hmac)(H,K)},verify:function(x,P,N,H=b){const K=x;if(P=(0,i.ensureBytes)("msgHash",P),N=(0,i.ensureBytes)("publicKey",N),"strict"in H)throw new Error("options.strict was renamed to lowS");s(H);const{lowS:V,prehash:q}=H;let Y,Z;try{if(typeof K=="string"||r.isBytes(K))try{Y=O.fromDER(K)}catch(Ae){if(!(Ae instanceof t.DER.Err))throw Ae;Y=O.fromCompact(K)}else{if(typeof K!="object"||typeof K.r!="bigint"||typeof K.s!="bigint")throw new Error("PARSE");{const{r:Ae,s:ge}=K;Y=new O(Ae,ge)}}Z=z.fromHex(N)}catch(Ae){if(Ae.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(V&&Y.hasHighS())return!1;q&&(P=y.hash(P));const{r:ie,s:oe}=Y,pe=w(P),se=L(oe),ae=R(pe*se),fe=R(ie*se),le=z.BASE.multiplyAndAddUnsafe(Z,ae,fe)?.toAffine();return le?R(le.x)===ie:!1},ProjectivePoint:z,Signature:O,utils:A}},t.SWUFpSqrtRatio=g,t.mapToCurveSimpleSWU=function(p,y){if(n.validateField(p),!p.isValid(y.A)||!p.isValid(y.B)||!p.isValid(y.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const m=g(p,y.Z);if(!p.isOdd)throw new Error("Fp.isOdd is not implemented!");return C=>{let v,I,R,L,z,j,D,B;v=p.sqr(C),v=p.mul(v,y.Z),I=p.sqr(v),I=p.add(I,v),R=p.add(I,p.ONE),R=p.mul(R,y.B),L=p.cmov(y.Z,p.neg(I),!p.eql(I,p.ZERO)),L=p.mul(L,y.A),I=p.sqr(R),j=p.sqr(L),z=p.mul(j,y.A),I=p.add(I,z),I=p.mul(I,R),j=p.mul(j,L),z=p.mul(j,y.B),I=p.add(I,z),D=p.mul(v,R);const{isValid:$,value:U}=m(I,j);B=p.mul(v,C),B=p.mul(B,U),D=p.cmov(D,R,$),B=p.cmov(B,U,$);const M=p.isOdd(C)===p.isOdd(B);return B=p.cmov(p.neg(B),B,M),D=p.div(D,L),{x:D,y:B}}};const e=Ui,n=Le,r=xe,i=xe;function s(p){p.lowS!==void 0&&(0,i.abool)("lowS",p.lowS),p.prehash!==void 0&&(0,i.abool)("prehash",p.prehash)}const{bytesToNumberBE:o,hexToBytes:a}=r;t.DER={Err:class extends Error{constructor(p=""){super(p)}},_tlv:{encode:(p,y)=>{const{Err:m}=t.DER;if(p<0||p>256)throw new m("tlv.encode: wrong tag");if(1&y.length)throw new m("tlv.encode: unpadded data");const C=y.length/2,v=r.numberToHexUnpadded(C);if(v.length/2&128)throw new m("tlv.encode: long form length too big");const I=C>127?r.numberToHexUnpadded(v.length/2|128):"";return`${r.numberToHexUnpadded(p)}${I}${v}${y}`},decode(p,y){const{Err:m}=t.DER;let C=0;if(p<0||p>256)throw new m("tlv.encode: wrong tag");if(y.length<2||y[C++]!==p)throw new m("tlv.decode: wrong tlv");const v=y[C++];let I=0;if(128&v){const L=127&v;if(!L)throw new m("tlv.decode(long): indefinite length not supported");if(L>4)throw new m("tlv.decode(long): byte length is too big");const z=y.subarray(C,C+L);if(z.length!==L)throw new m("tlv.decode: length bytes not complete");if(z[0]===0)throw new m("tlv.decode(long): zero leftmost byte");for(const j of z)I=I<<8|j;if(C+=L,I<128)throw new m("tlv.decode(long): not minimal encoding")}else I=v;const R=y.subarray(C,C+I);if(R.length!==I)throw new m("tlv.decode: wrong value length");return{v:R,l:y.subarray(C+I)}}},_int:{encode(p){const{Err:y}=t.DER;if(p<c)throw new y("integer: negative integers are not allowed");let m=r.numberToHexUnpadded(p);if(8&Number.parseInt(m[0],16)&&(m="00"+m),1&m.length)throw new y("unexpected assertion");return m},decode(p){const{Err:y}=t.DER;if(128&p[0])throw new y("Invalid signature integer: negative");if(p[0]===0&&!(128&p[1]))throw new y("Invalid signature integer: unnecessary leading zero");return o(p)}},toSig(p){const{Err:y,_int:m,_tlv:C}=t.DER,v=typeof p=="string"?a(p):p;r.abytes(v);const{v:I,l:R}=C.decode(48,v);if(R.length)throw new y("Invalid signature: left bytes after parsing");const{v:L,l:z}=C.decode(2,I),{v:j,l:D}=C.decode(2,z);if(D.length)throw new y("Invalid signature: left bytes after parsing");return{r:m.decode(L),s:m.decode(j)}},hexFromSig(p){const{_tlv:y,_int:m}=t.DER,C=`${y.encode(2,m.encode(p.r))}${y.encode(2,m.encode(p.s))}`;return y.encode(48,C)}};const c=BigInt(0),l=BigInt(1),u=BigInt(2),d=BigInt(3),h=BigInt(4);function f(p){const y=function(M){const O=(0,e.validateBasic)(M);r.validateObject(O,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:A,Fp:T,a:F}=O;if(A){if(!T.eql(F,T.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof A!="object"||typeof A.beta!="bigint"||typeof A.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...O})}(p),{Fp:m}=y,C=n.Field(y.n,y.nBitLength),v=y.toBytes||((M,O,A)=>{const T=O.toAffine();return r.concatBytes(Uint8Array.from([4]),m.toBytes(T.x),m.toBytes(T.y))}),I=y.fromBytes||(M=>{const O=M.subarray(1);return{x:m.fromBytes(O.subarray(0,m.BYTES)),y:m.fromBytes(O.subarray(m.BYTES,2*m.BYTES))}});function R(M){const{a:O,b:A}=y,T=m.sqr(M),F=m.mul(T,M);return m.add(m.add(F,m.mul(M,O)),A)}if(!m.eql(m.sqr(y.Gy),R(y.Gx)))throw new Error("bad generator point: equation left != right");function L(M){const{allowedPrivateKeyLengths:O,nByteLength:A,wrapPrivateKey:T,n:F}=y;if(O&&typeof M!="bigint"){if(r.isBytes(M)&&(M=r.bytesToHex(M)),typeof M!="string"||!O.includes(M.length))throw new Error("Invalid key");M=M.padStart(2*A,"0")}let w;try{w=typeof M=="bigint"?M:r.bytesToNumberBE((0,i.ensureBytes)("private key",M,A))}catch{throw new Error(`private key must be ${A} bytes, hex or bigint, not ${typeof M}`)}return T&&(w=n.mod(w,F)),r.aInRange("private key",w,l,F),w}function z(M){if(!(M instanceof B))throw new Error("ProjectivePoint expected")}const j=(0,i.memoized)((M,O)=>{const{px:A,py:T,pz:F}=M;if(m.eql(F,m.ONE))return{x:A,y:T};const w=M.is0();O==null&&(O=w?m.ONE:m.inv(F));const S=m.mul(A,O),_=m.mul(T,O),k=m.mul(F,O);if(w)return{x:m.ZERO,y:m.ZERO};if(!m.eql(k,m.ONE))throw new Error("invZ was invalid");return{x:S,y:_}}),D=(0,i.memoized)(M=>{if(M.is0()){if(y.allowInfinityPoint&&!m.is0(M.py))return;throw new Error("bad point: ZERO")}const{x:O,y:A}=M.toAffine();if(!m.isValid(O)||!m.isValid(A))throw new Error("bad point: x or y not FE");const T=m.sqr(A),F=R(O);if(!m.eql(T,F))throw new Error("bad point: equation left != right");if(!M.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class B{constructor(O,A,T){if(this.px=O,this.py=A,this.pz=T,O==null||!m.isValid(O))throw new Error("x required");if(A==null||!m.isValid(A))throw new Error("y required");if(T==null||!m.isValid(T))throw new Error("z required");Object.freeze(this)}static fromAffine(O){const{x:A,y:T}=O||{};if(!O||!m.isValid(A)||!m.isValid(T))throw new Error("invalid affine point");if(O instanceof B)throw new Error("projective point not allowed");const F=w=>m.eql(w,m.ZERO);return F(A)&&F(T)?B.ZERO:new B(A,T,m.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(O){const A=m.invertBatch(O.map(T=>T.pz));return O.map((T,F)=>T.toAffine(A[F])).map(B.fromAffine)}static fromHex(O){const A=B.fromAffine(I((0,i.ensureBytes)("pointHex",O)));return A.assertValidity(),A}static fromPrivateKey(O){return B.BASE.multiply(L(O))}static msm(O,A){return(0,e.pippenger)(B,C,O,A)}_setWindowSize(O){U.setWindowSize(this,O)}assertValidity(){D(this)}hasEvenY(){const{y:O}=this.toAffine();if(m.isOdd)return!m.isOdd(O);throw new Error("Field doesn't support isOdd")}equals(O){z(O);const{px:A,py:T,pz:F}=this,{px:w,py:S,pz:_}=O,k=m.eql(m.mul(A,_),m.mul(w,F)),E=m.eql(m.mul(T,_),m.mul(S,F));return k&&E}negate(){return new B(this.px,m.neg(this.py),this.pz)}double(){const{a:O,b:A}=y,T=m.mul(A,d),{px:F,py:w,pz:S}=this;let _=m.ZERO,k=m.ZERO,E=m.ZERO,b=m.mul(F,F),x=m.mul(w,w),P=m.mul(S,S),N=m.mul(F,w);return N=m.add(N,N),E=m.mul(F,S),E=m.add(E,E),_=m.mul(O,E),k=m.mul(T,P),k=m.add(_,k),_=m.sub(x,k),k=m.add(x,k),k=m.mul(_,k),_=m.mul(N,_),E=m.mul(T,E),P=m.mul(O,P),N=m.sub(b,P),N=m.mul(O,N),N=m.add(N,E),E=m.add(b,b),b=m.add(E,b),b=m.add(b,P),b=m.mul(b,N),k=m.add(k,b),P=m.mul(w,S),P=m.add(P,P),b=m.mul(P,N),_=m.sub(_,b),E=m.mul(P,x),E=m.add(E,E),E=m.add(E,E),new B(_,k,E)}add(O){z(O);const{px:A,py:T,pz:F}=this,{px:w,py:S,pz:_}=O;let k=m.ZERO,E=m.ZERO,b=m.ZERO;const x=y.a,P=m.mul(y.b,d);let N=m.mul(A,w),H=m.mul(T,S),K=m.mul(F,_),V=m.add(A,T),q=m.add(w,S);V=m.mul(V,q),q=m.add(N,H),V=m.sub(V,q),q=m.add(A,F);let Y=m.add(w,_);return q=m.mul(q,Y),Y=m.add(N,K),q=m.sub(q,Y),Y=m.add(T,F),k=m.add(S,_),Y=m.mul(Y,k),k=m.add(H,K),Y=m.sub(Y,k),b=m.mul(x,q),k=m.mul(P,K),b=m.add(k,b),k=m.sub(H,b),b=m.add(H,b),E=m.mul(k,b),H=m.add(N,N),H=m.add(H,N),K=m.mul(x,K),q=m.mul(P,q),H=m.add(H,K),K=m.sub(N,K),K=m.mul(x,K),q=m.add(q,K),N=m.mul(H,q),E=m.add(E,N),N=m.mul(Y,q),k=m.mul(V,k),k=m.sub(k,N),N=m.mul(V,H),b=m.mul(Y,b),b=m.add(b,N),new B(k,E,b)}subtract(O){return this.add(O.negate())}is0(){return this.equals(B.ZERO)}wNAF(O){return U.wNAFCached(this,O,B.normalizeZ)}multiplyUnsafe(O){r.aInRange("scalar",O,c,y.n);const A=B.ZERO;if(O===c)return A;if(O===l)return this;const{endo:T}=y;if(!T)return U.unsafeLadder(this,O);let{k1neg:F,k1:w,k2neg:S,k2:_}=T.splitScalar(O),k=A,E=A,b=this;for(;w>c||_>c;)w&l&&(k=k.add(b)),_&l&&(E=E.add(b)),b=b.double(),w>>=l,_>>=l;return F&&(k=k.negate()),S&&(E=E.negate()),E=new B(m.mul(E.px,T.beta),E.py,E.pz),k.add(E)}multiply(O){const{endo:A,n:T}=y;let F,w;if(r.aInRange("scalar",O,l,T),A){const{k1neg:S,k1:_,k2neg:k,k2:E}=A.splitScalar(O);let{p:b,f:x}=this.wNAF(_),{p:P,f:N}=this.wNAF(E);b=U.constTimeNegate(S,b),P=U.constTimeNegate(k,P),P=new B(m.mul(P.px,A.beta),P.py,P.pz),F=b.add(P),w=x.add(N)}else{const{p:S,f:_}=this.wNAF(O);F=S,w=_}return B.normalizeZ([F,w])[0]}multiplyAndAddUnsafe(O,A,T){const F=B.BASE,w=(_,k)=>k!==c&&k!==l&&_.equals(F)?_.multiply(k):_.multiplyUnsafe(k),S=w(this,A).add(w(O,T));return S.is0()?void 0:S}toAffine(O){return j(this,O)}isTorsionFree(){const{h:O,isTorsionFree:A}=y;if(O===l)return!0;if(A)return A(B,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:O,clearCofactor:A}=y;return O===l?this:A?A(B,this):this.multiplyUnsafe(y.h)}toRawBytes(O=!0){return(0,i.abool)("isCompressed",O),this.assertValidity(),v(B,this,O)}toHex(O=!0){return(0,i.abool)("isCompressed",O),r.bytesToHex(this.toRawBytes(O))}}B.BASE=new B(y.Gx,y.Gy,m.ONE),B.ZERO=new B(m.ZERO,m.ONE,m.ZERO);const $=y.nBitLength,U=(0,e.wNAF)(B,y.endo?Math.ceil($/2):$);return{CURVE:y,ProjectivePoint:B,normPrivateKeyToScalar:L,weierstrassEquation:R,isWithinCurveOrder:function(M){return r.inRange(M,l,y.n)}}}function g(p,y){const m=p.ORDER;let C=c;for(let M=m-l;M%u===c;M/=u)C+=l;const v=C,I=u<<v-l-l,R=I*u,L=(m-l)/R,z=(L-l)/u,j=R-l,D=I,B=p.pow(y,L),$=p.pow(y,(L+l)/u);let U=(M,O)=>{let A=B,T=p.pow(O,j),F=p.sqr(T);F=p.mul(F,O);let w=p.mul(M,F);w=p.pow(w,z),w=p.mul(w,T),T=p.mul(w,O),F=p.mul(w,M);let S=p.mul(F,T);w=p.pow(S,D);let _=p.eql(w,p.ONE);T=p.mul(F,$),w=p.mul(S,A),F=p.cmov(T,F,_),S=p.cmov(w,S,_);for(let k=v;k>l;k--){let E=k-u;E=u<<E-l;let b=p.pow(S,E);const x=p.eql(b,p.ONE);T=p.mul(F,A),A=p.mul(A,A),b=p.mul(S,A),F=p.cmov(T,F,x),S=p.cmov(b,S,x)}return{isValid:_,value:F}};if(p.ORDER%h===d){const M=(p.ORDER-d)/h,O=p.sqrt(p.neg(y));U=(A,T)=>{let F=p.sqr(T);const w=p.mul(A,T);F=p.mul(F,w);let S=p.pow(F,M);S=p.mul(S,w);const _=p.mul(S,O),k=p.mul(p.sqr(S),T),E=p.eql(k,A);return{isValid:E,value:p.cmov(_,S,E)}}}return U}})(xd),Object.defineProperty(ba,"__esModule",{value:!0}),ba.getHash=df,ba.createCurve=function(t,e){const n=r=>(0,uE.weierstrass)({...t,...df(r)});return Object.freeze({...n(e),create:n})};const lE=_d,uf=dr,uE=xd;function df(t){return{hash:t,hmac:(e,...n)=>(0,lE.hmac)(t,e,(0,uf.concatBytes)(...n)),randomBytes:uf.randomBytes}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.encodeToCurve=t.hashToCurve=t.schnorr=t.secp256k1=void 0;const e=er,n=dr,r=ba,i=kr,s=Le,o=xe,a=xd,c=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),l=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),u=BigInt(1),d=BigInt(2),h=(w,S)=>(w+S/d)/S;function f(w){const S=c,_=BigInt(3),k=BigInt(6),E=BigInt(11),b=BigInt(22),x=BigInt(23),P=BigInt(44),N=BigInt(88),H=w*w*w%S,K=H*H*w%S,V=(0,s.pow2)(K,_,S)*K%S,q=(0,s.pow2)(V,_,S)*K%S,Y=(0,s.pow2)(q,d,S)*H%S,Z=(0,s.pow2)(Y,E,S)*Y%S,ie=(0,s.pow2)(Z,b,S)*Z%S,oe=(0,s.pow2)(ie,P,S)*ie%S,pe=(0,s.pow2)(oe,N,S)*oe%S,se=(0,s.pow2)(pe,P,S)*ie%S,ae=(0,s.pow2)(se,_,S)*K%S,fe=(0,s.pow2)(ae,x,S)*Z%S,le=(0,s.pow2)(fe,k,S)*H%S,ye=(0,s.pow2)(le,d,S);if(!g.eql(g.sqr(ye),w))throw new Error("Cannot find square root");return ye}const g=(0,s.Field)(c,void 0,void 0,{sqrt:f});t.secp256k1=(0,r.createCurve)({a:BigInt(0),b:BigInt(7),Fp:g,n:l,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:w=>{const S=l,_=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),k=-u*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),E=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),b=_,x=BigInt("0x100000000000000000000000000000000"),P=h(b*w,S),N=h(-k*w,S);let H=(0,s.mod)(w-P*_-N*E,S),K=(0,s.mod)(-P*k-N*b,S);const V=H>x,q=K>x;if(V&&(H=S-H),q&&(K=S-K),H>x||K>x)throw new Error("splitScalar: Endomorphism failed, k="+w);return{k1neg:V,k1:H,k2neg:q,k2:K}}}},e.sha256);const p=BigInt(0),y={};function m(w,...S){let _=y[w];if(_===void 0){const k=(0,e.sha256)(Uint8Array.from(w,E=>E.charCodeAt(0)));_=(0,o.concatBytes)(k,k),y[w]=_}return(0,e.sha256)((0,o.concatBytes)(_,...S))}const C=w=>w.toRawBytes(!0).slice(1),v=w=>(0,o.numberToBytesBE)(w,32),I=w=>(0,s.mod)(w,c),R=w=>(0,s.mod)(w,l),L=t.secp256k1.ProjectivePoint,z=(w,S,_)=>L.BASE.multiplyAndAddUnsafe(w,S,_);function j(w){let S=t.secp256k1.utils.normPrivateKeyToScalar(w),_=L.fromPrivateKey(S);return{scalar:_.hasEvenY()?S:R(-S),bytes:C(_)}}function D(w){(0,o.aInRange)("x",w,u,c);const S=I(w*w);let _=f(I(S*w+BigInt(7)));_%d!==p&&(_=I(-_));const k=new L(w,_,u);return k.assertValidity(),k}const B=o.bytesToNumberBE;function $(...w){return R(B(m("BIP0340/challenge",...w)))}function U(w){return j(w).bytes}function M(w,S,_=(0,n.randomBytes)(32)){const k=(0,o.ensureBytes)("message",w),{bytes:E,scalar:b}=j(S),x=(0,o.ensureBytes)("auxRand",_,32),P=v(b^B(m("BIP0340/aux",x))),N=m("BIP0340/nonce",P,E,k),H=R(B(N));if(H===p)throw new Error("sign failed: k is zero");const{bytes:K,scalar:V}=j(H),q=$(K,E,k),Y=new Uint8Array(64);if(Y.set(K,0),Y.set(v(R(V+q*b)),32),!O(Y,k,E))throw new Error("sign: Invalid signature produced");return Y}function O(w,S,_){const k=(0,o.ensureBytes)("signature",w,64),E=(0,o.ensureBytes)("message",S),b=(0,o.ensureBytes)("publicKey",_,32);try{const x=D(B(b)),P=B(k.subarray(0,32));if(!(0,o.inRange)(P,u,c))return!1;const N=B(k.subarray(32,64));if(!(0,o.inRange)(N,u,l))return!1;const H=$(v(P),C(x),E),K=z(x,N,R(-H));return!(!K||!K.hasEvenY()||K.toAffine().x!==P)}catch{return!1}}t.schnorr={getPublicKey:U,sign:M,verify:O,utils:{randomPrivateKey:t.secp256k1.utils.randomPrivateKey,lift_x:D,pointToBytes:C,numberToBytesBE:o.numberToBytesBE,bytesToNumberBE:o.bytesToNumberBE,taggedHash:m,mod:s.mod}};const A=(0,i.isogenyMap)(g,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(w=>w.map(S=>BigInt(S)))),T=(0,a.mapToCurveSimpleSWU)(g,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:g.create(BigInt("-11"))}),F=(0,i.createHasher)(t.secp256k1.ProjectivePoint,w=>{const{x:S,y:_}=T(g.create(w[0]));return A(S,_)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:g.ORDER,m:1,k:128,expand:"xmd",hash:e.sha256});t.hashToCurve=F.hashToCurve,t.encodeToCurve=F.encodeToCurve})(Cm);var Au={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.decodeHex=t.remove0x=void 0;var e=Yt;t.remove0x=function(n){return n.startsWith("0x")||n.startsWith("0X")?n.slice(2):n},t.decodeHex=function(n){return(0,e.hexToBytes)((0,t.remove0x)(n))}})(Au),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.hexToPublicKey=t.convertPublicKeyFormat=t.getSharedPoint=t.getPublicKey=t.isValidPrivateKey=t.getValidSecret=void 0;var e=Ed,n=Gg,r=Cm,i=Qs,s=at,o=Au;t.getValidSecret=function(){var u;do u=(0,e.randomBytes)(s.SECRET_KEY_LENGTH);while(!(0,t.isValidPrivateKey)(u));return u},t.isValidPrivateKey=function(u){return a((0,i.ellipticCurve)(),function(d){return d.utils.isValidPrivateKey(u)},function(){return!0},function(){return!0})},t.getPublicKey=function(u){return a((0,i.ellipticCurve)(),function(d){return d.getPublicKey(u)},function(d){return d.getPublicKey(u)},function(d){return d.getPublicKey(u)})},t.getSharedPoint=function(u,d,h){return a((0,i.ellipticCurve)(),function(f){return f.getSharedSecret(u,d,h)},function(f){return f.getSharedSecret(u,d)},function(f){return l(f,u,d)})},t.convertPublicKeyFormat=function(u,d){return a((0,i.ellipticCurve)(),function(h){return h.getSharedSecret(BigInt(1),u,d)},function(){return u},function(){return u})};function a(u,d,h,f){if(u==="secp256k1")return d(r.secp256k1);if(u==="x25519")return h(n.x25519);if(u==="ed25519")return f(n.ed25519);throw new Error("Not implemented")}t.hexToPublicKey=function(u){var d=(0,o.decodeHex)(u);return a((0,i.ellipticCurve)(),function(){return c(d)},function(){return d},function(){return d})};var c=function(u){if(u.length===s.ETH_PUBLIC_KEY_SIZE){var d=new Uint8Array(1+u.length);return d.set([4]),d.set(u,1),d}return u},l=function(u,d,h){var f=u.utils.getExtendedPublicKey(d).scalar;return u.ExtendedPoint.fromHex(h).multiply(f).toRawBytes()}}(zg);var _m={},Fi={};Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.hkdf=void 0,Fi.extract=km,Fi.expand=Pm;const Su=Wt,hf=dr,xm=_d;function km(t,e,n){return(0,Su.hash)(t),n===void 0&&(n=new Uint8Array(t.outputLen)),(0,xm.hmac)(t,(0,hf.toBytes)(n),(0,hf.toBytes)(e))}const wl=new Uint8Array([0]),ff=new Uint8Array;function Pm(t,e,n,r=32){if((0,Su.hash)(t),(0,Su.number)(r),r>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/t.outputLen);n===void 0&&(n=ff);const s=new Uint8Array(i*t.outputLen),o=xm.hmac.create(t,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let l=0;l<i;l++)wl[0]=l+1,a.update(l===0?ff:c).update(n).update(wl).digestInto(c),s.set(c,t.outputLen*l),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),wl.fill(0),s.slice(0,r)}Fi.hkdf=(t,e,n,r,i)=>Pm(t,km(t,e,n),r,i),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getSharedKey=t.deriveKey=void 0;var e=Yt,n=Fi,r=er;t.deriveKey=function(i,s,o){return(0,n.hkdf)(r.sha256,i,s,o,32)},t.getSharedKey=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return(0,t.deriveKey)(e.concatBytes.apply(void 0,i))}}(_m);var pf={},Wi={},Ve={},ii={};Object.defineProperty(ii,"__esModule",{value:!0}),ii.polyval=ii.ghash=void 0,ii._toGHASHKey=Tm;const si=Et,xt=Yt,Gn=16,kd=new Uint8Array(16),In=(0,xt.u32)(kd),sn=t=>(t>>>0&255)<<24|(t>>>8&255)<<16|(t>>>16&255)<<8|t>>>24&255|0;function Tm(t){t.reverse();const e=1&t[15];let n=0;for(let r=0;r<t.length;r++){const i=t[r];t[r]=i>>>1|n,n=(1&i)<<7}return t[0]^=225&-e,t}class Im{constructor(e,n){this.blockLen=Gn,this.outputLen=Gn,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,e=(0,xt.toBytes)(e),(0,si.bytes)(e,16);const r=(0,xt.createView)(e);let i=r.getUint32(0,!1),s=r.getUint32(4,!1),o=r.getUint32(8,!1),a=r.getUint32(12,!1);const c=[];for(let m=0;m<128;m++)c.push({s0:sn(i),s1:sn(s),s2:sn(o),s3:sn(a)}),{s0:i,s1:s,s2:o,s3:a}={s3:(d=o)<<31|(h=a)>>>1,s2:(u=s)<<31|d>>>1,s1:(l=i)<<31|u>>>1,s0:l>>>1^225<<24&-(1&h)};var l,u,d,h;const f=(m=>m>65536?8:m>1024?4:2)(n||1024);if(![1,2,4,8].includes(f))throw new Error(`ghash: wrong window size=${f}, should be 2, 4 or 8`);this.W=f;const g=128/f,p=this.windowSize=2**f,y=[];for(let m=0;m<g;m++)for(let C=0;C<p;C++){let v=0,I=0,R=0,L=0;for(let z=0;z<f;z++){if(!(C>>>f-z-1&1))continue;const{s0:j,s1:D,s2:B,s3:$}=c[f*m+z];v^=j,I^=D,R^=B,L^=$}y.push({s0:v,s1:I,s2:R,s3:L})}this.t=y}_updateBlock(e,n,r,i){e^=this.s0,n^=this.s1,r^=this.s2,i^=this.s3;const{W:s,t:o,windowSize:a}=this;let c=0,l=0,u=0,d=0;const h=(1<<s)-1;let f=0;for(const g of[e,n,r,i])for(let p=0;p<4;p++){const y=g>>>8*p&255;for(let m=8/s-1;m>=0;m--){const C=y>>>s*m&h,{s0:v,s1:I,s2:R,s3:L}=o[f*a+C];c^=v,l^=I,u^=R,d^=L,f+=1}}this.s0=c,this.s1=l,this.s2=u,this.s3=d}update(e){e=(0,xt.toBytes)(e),(0,si.exists)(this);const n=(0,xt.u32)(e),r=Math.floor(e.length/Gn),i=e.length%Gn;for(let s=0;s<r;s++)this._updateBlock(n[4*s+0],n[4*s+1],n[4*s+2],n[4*s+3]);return i&&(kd.set(e.subarray(r*Gn)),this._updateBlock(In[0],In[1],In[2],In[3]),(0,xt.clean)(In)),this}destroy(){const{t:e}=this;for(const n of e)n.s0=0,n.s1=0,n.s2=0,n.s3=0}digestInto(e){(0,si.exists)(this),(0,si.output)(e,this),this.finished=!0;const{s0:n,s1:r,s2:i,s3:s}=this,o=(0,xt.u32)(e);return o[0]=n,o[1]=r,o[2]=i,o[3]=s,e}digest(){const e=new Uint8Array(Gn);return this.digestInto(e),this.destroy(),e}}class dE extends Im{constructor(e,n){e=(0,xt.toBytes)(e);const r=Tm((0,xt.copyBytes)(e));super(r,n),(0,xt.clean)(r)}update(e){e=(0,xt.toBytes)(e),(0,si.exists)(this);const n=(0,xt.u32)(e),r=e.length%Gn,i=Math.floor(e.length/Gn);for(let s=0;s<i;s++)this._updateBlock(sn(n[4*s+3]),sn(n[4*s+2]),sn(n[4*s+1]),sn(n[4*s+0]));return r&&(kd.set(e.subarray(i*Gn)),this._updateBlock(sn(In[3]),sn(In[2]),sn(In[1]),sn(In[0])),(0,xt.clean)(In)),this}digestInto(e){(0,si.exists)(this),(0,si.output)(e,this),this.finished=!0;const{s0:n,s1:r,s2:i,s3:s}=this,o=(0,xt.u32)(e);return o[0]=n,o[1]=r,o[2]=i,o[3]=s,e.reverse()}}function gf(t){const e=(r,i)=>t(i,r.length).update((0,xt.toBytes)(r)).digest(),n=t(new Uint8Array(16),0);return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=(r,i)=>t(r,i),e}ii.ghash=gf((t,e)=>new Im(t,e)),ii.polyval=gf((t,e)=>new dE(t,e)),Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.unsafe=Ve.aeskwp=Ve.aeskw=Ve.siv=Ve.gcm=Ve.cfb=Ve.cbc=Ve.ecb=Ve.ctr=void 0,Ve.expandKeyLE=vn,Ve.expandKeyDecLE=Ys;const Oe=Et,Cu=ii,ne=Yt,Ht=16,Vo=new Uint8Array(Ht),hE=283;function Pd(t){return t<<1^hE&-(t>>7)}function Hi(t,e){let n=0;for(;e>0;e>>=1)n^=t&-(1&e),t=Pd(t);return n}const _u=(()=>{const t=new Uint8Array(256);for(let n=0,r=1;n<256;n++,r^=Pd(r))t[n]=r;const e=new Uint8Array(256);e[0]=99;for(let n=0;n<255;n++){let r=t[255-n];r|=r<<8,e[t[n]]=255&(r^r>>4^r>>5^r>>6^r>>7^99)}return(0,ne.clean)(t),e})(),fE=_u.map((t,e)=>_u.indexOf(e)),pE=t=>t<<24|t>>>8,vl=t=>t<<8|t>>>24,za=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;function Om(t,e){if(t.length!==256)throw new Error("Wrong sbox length");const n=new Uint32Array(256).map((l,u)=>e(t[u])),r=n.map(vl),i=r.map(vl),s=i.map(vl),o=new Uint32Array(65536),a=new Uint32Array(65536),c=new Uint16Array(65536);for(let l=0;l<256;l++)for(let u=0;u<256;u++){const d=256*l+u;o[d]=n[l]^r[u],a[d]=i[l]^s[u],c[d]=t[l]<<8|t[u]}return{sbox:t,sbox2:c,T0:n,T1:r,T2:i,T3:s,T01:o,T23:a}}const Td=Om(_u,t=>Hi(t,3)<<24|t<<16|t<<8|Hi(t,2)),Rm=Om(fE,t=>Hi(t,11)<<24|Hi(t,13)<<16|Hi(t,9)<<8|Hi(t,14)),gE=(()=>{const t=new Uint8Array(16);for(let e=0,n=1;e<16;e++,n=Pd(n))t[e]=n;return t})();function vn(t){(0,Oe.bytes)(t);const e=t.length;if(![16,24,32].includes(e))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${e}`);const{sbox2:n}=Td,r=[];(0,ne.isAligned32)(t)||r.push(t=(0,ne.copyBytes)(t));const i=(0,ne.u32)(t),s=i.length,o=c=>Mn(n,c,c,c,c),a=new Uint32Array(e+28);a.set(i);for(let c=s;c<a.length;c++){let l=a[c-1];c%s==0?l=o(pE(l))^gE[c/s-1]:s>6&&c%s==4&&(l=o(l)),a[c]=a[c-s]^l}return(0,ne.clean)(...r),a}function Ys(t){const e=vn(t),n=e.slice(),r=e.length,{sbox2:i}=Td,{T0:s,T1:o,T2:a,T3:c}=Rm;for(let l=0;l<r;l+=4)for(let u=0;u<4;u++)n[l+u]=e[r-l-4+u];(0,ne.clean)(e);for(let l=4;l<r-4;l++){const u=n[l],d=Mn(i,u,u,u,u);n[l]=s[255&d]^o[d>>>8&255]^a[d>>>16&255]^c[d>>>24]}return n}function Lr(t,e,n,r,i,s){return t[n<<8&65280|r>>>8&255]^e[i>>>8&65280|s>>>24&255]}function Mn(t,e,n,r,i){return t[255&e|65280&n]|t[r>>>16&255|i>>>16&65280]<<16}function kt(t,e,n,r,i){const{sbox2:s,T01:o,T23:a}=Td;let c=0;e^=t[c++],n^=t[c++],r^=t[c++],i^=t[c++];const l=t.length/4-2;for(let u=0;u<l;u++){const d=t[c++]^Lr(o,a,e,n,r,i),h=t[c++]^Lr(o,a,n,r,i,e),f=t[c++]^Lr(o,a,r,i,e,n),g=t[c++]^Lr(o,a,i,e,n,r);e=d,n=h,r=f,i=g}return{s0:t[c++]^Mn(s,e,n,r,i),s1:t[c++]^Mn(s,n,r,i,e),s2:t[c++]^Mn(s,r,i,e,n),s3:t[c++]^Mn(s,i,e,n,r)}}function Zs(t,e,n,r,i){const{sbox2:s,T01:o,T23:a}=Rm;let c=0;e^=t[c++],n^=t[c++],r^=t[c++],i^=t[c++];const l=t.length/4-2;for(let u=0;u<l;u++){const d=t[c++]^Lr(o,a,e,i,r,n),h=t[c++]^Lr(o,a,n,e,i,r),f=t[c++]^Lr(o,a,r,n,e,i),g=t[c++]^Lr(o,a,i,r,n,e);e=d,n=h,r=f,i=g}return{s0:t[c++]^Mn(s,e,i,r,n),s1:t[c++]^Mn(s,n,e,i,r),s2:t[c++]^Mn(s,r,n,e,i),s3:t[c++]^Mn(s,i,r,n,e)}}function Qi(t,e){if(e===void 0)return new Uint8Array(t);if((0,Oe.bytes)(e),e.length<t)throw new Error(`aes: wrong destination length, expected at least ${t}, got: ${e.length}`);if(!(0,ne.isAligned32)(e))throw new Error("unaligned dst");return e}function Nm(t,e,n,r){(0,Oe.bytes)(e,Ht),(0,Oe.bytes)(n);const i=n.length;r=Qi(i,r);const s=e,o=(0,ne.u32)(s);let{s0:a,s1:c,s2:l,s3:u}=kt(t,o[0],o[1],o[2],o[3]);const d=(0,ne.u32)(n),h=(0,ne.u32)(r);for(let g=0;g+4<=d.length;g+=4){h[g+0]=d[g+0]^a,h[g+1]=d[g+1]^c,h[g+2]=d[g+2]^l,h[g+3]=d[g+3]^u;let p=1;for(let y=s.length-1;y>=0;y--)p=p+(255&s[y])|0,s[y]=255&p,p>>>=8;({s0:a,s1:c,s2:l,s3:u}=kt(t,o[0],o[1],o[2],o[3]))}const f=Ht*Math.floor(d.length/4);if(f<i){const g=new Uint32Array([a,c,l,u]),p=(0,ne.u8)(g);for(let y=f,m=0;y<i;y++,m++)r[y]=n[y]^p[m];(0,ne.clean)(g)}return r}function Ki(t,e,n,r,i){(0,Oe.bytes)(n,Ht),(0,Oe.bytes)(r),i=Qi(r.length,i);const s=n,o=(0,ne.u32)(s),a=(0,ne.createView)(s),c=(0,ne.u32)(r),l=(0,ne.u32)(i),u=e?0:12,d=r.length;let h=a.getUint32(u,e),{s0:f,s1:g,s2:p,s3:y}=kt(t,o[0],o[1],o[2],o[3]);for(let C=0;C+4<=c.length;C+=4)l[C+0]=c[C+0]^f,l[C+1]=c[C+1]^g,l[C+2]=c[C+2]^p,l[C+3]=c[C+3]^y,h=h+1>>>0,a.setUint32(u,h,e),{s0:f,s1:g,s2:p,s3:y}=kt(t,o[0],o[1],o[2],o[3]);const m=Ht*Math.floor(c.length/4);if(m<d){const C=new Uint32Array([f,g,p,y]),v=(0,ne.u8)(C);for(let I=m,R=0;I<d;I++,R++)i[I]=r[I]^v[R];(0,ne.clean)(C)}return i}function mf(t){if((0,Oe.bytes)(t),t.length%Ht!=0)throw new Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")}function yf(t,e,n){(0,Oe.bytes)(t);let r=t.length;const i=r%Ht;if(!e&&i!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");(0,ne.isAligned32)(t)||(t=(0,ne.copyBytes)(t));const s=(0,ne.u32)(t);if(e){let a=Ht-i;a||(a=Ht),r+=a}const o=Qi(r,n);return{b:s,o:(0,ne.u32)(o),out:o}}function wf(t,e){if(!e)return t;const n=t.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");const r=t[n-1];if(r<=0||r>16)throw new Error("aes/pcks5: wrong padding");const i=t.subarray(0,-r);for(let s=0;s<r;s++)if(t[n-s-1]!==r)throw new Error("aes/pcks5: wrong padding");return i}function vf(t){const e=new Uint8Array(16),n=(0,ne.u32)(e);e.set(t);const r=Ht-t.length;for(let i=Ht-r;i<Ht;i++)e[i]=r;return n}function Mm(t,e,n,r,i){const s=i==null?0:i.length,o=t.create(n,r.length+s);i&&o.update(i),o.update(r);const a=new Uint8Array(16),c=(0,ne.createView)(a);i&&(0,ne.setBigUint64)(c,0,BigInt(8*s),e),(0,ne.setBigUint64)(c,8,BigInt(8*r.length),e),o.update(a);const l=o.digest();return(0,ne.clean)(a),l}Ve.ctr=(0,ne.wrapCipher)({blockSize:16,nonceLength:16},function(t,e){function n(r,i){if((0,Oe.bytes)(r),i!==void 0&&((0,Oe.bytes)(i),!(0,ne.isAligned32)(i)))throw new Error("unaligned destination");const s=vn(t),o=(0,ne.copyBytes)(e),a=[s,o];(0,ne.isAligned32)(r)||a.push(r=(0,ne.copyBytes)(r));const c=Nm(s,o,r,i);return(0,ne.clean)(...a),c}return(0,Oe.bytes)(t),(0,Oe.bytes)(e,Ht),{encrypt:(r,i)=>n(r,i),decrypt:(r,i)=>n(r,i)}}),Ve.ecb=(0,ne.wrapCipher)({blockSize:16},function(t,e={}){(0,Oe.bytes)(t);const n=!e.disablePadding;return{encrypt(r,i){const{b:s,o,out:a}=yf(r,n,i),c=vn(t);let l=0;for(;l+4<=s.length;){const{s0:u,s1:d,s2:h,s3:f}=kt(c,s[l+0],s[l+1],s[l+2],s[l+3]);o[l++]=u,o[l++]=d,o[l++]=h,o[l++]=f}if(n){const u=vf(r.subarray(4*l)),{s0:d,s1:h,s2:f,s3:g}=kt(c,u[0],u[1],u[2],u[3]);o[l++]=d,o[l++]=h,o[l++]=f,o[l++]=g}return(0,ne.clean)(c),a},decrypt(r,i){mf(r);const s=Ys(t),o=Qi(r.length,i),a=[s];(0,ne.isAligned32)(r)||a.push(r=(0,ne.copyBytes)(r));const c=(0,ne.u32)(r),l=(0,ne.u32)(o);for(let u=0;u+4<=c.length;){const{s0:d,s1:h,s2:f,s3:g}=Zs(s,c[u+0],c[u+1],c[u+2],c[u+3]);l[u++]=d,l[u++]=h,l[u++]=f,l[u++]=g}return(0,ne.clean)(...a),wf(o,n)}}}),Ve.cbc=(0,ne.wrapCipher)({blockSize:16,nonceLength:16},function(t,e,n={}){(0,Oe.bytes)(t),(0,Oe.bytes)(e,16);const r=!n.disablePadding;return{encrypt(i,s){const o=vn(t),{b:a,o:c,out:l}=yf(i,r,s);let u=e;const d=[o];(0,ne.isAligned32)(u)||d.push(u=(0,ne.copyBytes)(u));const h=(0,ne.u32)(u);let f=h[0],g=h[1],p=h[2],y=h[3],m=0;for(;m+4<=a.length;)f^=a[m+0],g^=a[m+1],p^=a[m+2],y^=a[m+3],{s0:f,s1:g,s2:p,s3:y}=kt(o,f,g,p,y),c[m++]=f,c[m++]=g,c[m++]=p,c[m++]=y;if(r){const C=vf(i.subarray(4*m));f^=C[0],g^=C[1],p^=C[2],y^=C[3],{s0:f,s1:g,s2:p,s3:y}=kt(o,f,g,p,y),c[m++]=f,c[m++]=g,c[m++]=p,c[m++]=y}return(0,ne.clean)(...d),l},decrypt(i,s){mf(i);const o=Ys(t);let a=e;const c=[o];(0,ne.isAligned32)(a)||c.push(a=(0,ne.copyBytes)(a));const l=(0,ne.u32)(a),u=Qi(i.length,s);(0,ne.isAligned32)(i)||c.push(i=(0,ne.copyBytes)(i));const d=(0,ne.u32)(i),h=(0,ne.u32)(u);let f=l[0],g=l[1],p=l[2],y=l[3];for(let m=0;m+4<=d.length;){const C=f,v=g,I=p,R=y;f=d[m+0],g=d[m+1],p=d[m+2],y=d[m+3];const{s0:L,s1:z,s2:j,s3:D}=Zs(o,f,g,p,y);h[m++]=L^C,h[m++]=z^v,h[m++]=j^I,h[m++]=D^R}return(0,ne.clean)(...c),wf(u,r)}}}),Ve.cfb=(0,ne.wrapCipher)({blockSize:16,nonceLength:16},function(t,e){function n(r,i,s){(0,Oe.bytes)(r);const o=r.length;s=Qi(o,s);const a=vn(t);let c=e;const l=[a];(0,ne.isAligned32)(c)||l.push(c=(0,ne.copyBytes)(c)),(0,ne.isAligned32)(r)||l.push(r=(0,ne.copyBytes)(r));const u=(0,ne.u32)(r),d=(0,ne.u32)(s),h=i?d:u,f=(0,ne.u32)(c);let g=f[0],p=f[1],y=f[2],m=f[3];for(let v=0;v+4<=u.length;){const{s0:I,s1:R,s2:L,s3:z}=kt(a,g,p,y,m);d[v+0]=u[v+0]^I,d[v+1]=u[v+1]^R,d[v+2]=u[v+2]^L,d[v+3]=u[v+3]^z,g=h[v++],p=h[v++],y=h[v++],m=h[v++]}const C=Ht*Math.floor(u.length/4);if(C<o){({s0:g,s1:p,s2:y,s3:m}=kt(a,g,p,y,m));const v=(0,ne.u8)(new Uint32Array([g,p,y,m]));for(let I=C,R=0;I<o;I++,R++)s[I]=r[I]^v[R];(0,ne.clean)(v)}return(0,ne.clean)(...l),s}return(0,Oe.bytes)(t),(0,Oe.bytes)(e,16),{encrypt:(r,i)=>n(r,!0,i),decrypt:(r,i)=>n(r,!1,i)}}),Ve.gcm=(0,ne.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16},function(t,e,n){if((0,Oe.bytes)(t),(0,Oe.bytes)(e),n!==void 0&&(0,Oe.bytes)(n),e.length<8)throw new Error("aes/gcm: invalid nonce length");const r=16;function i(o,a,c){const l=Mm(Cu.ghash,!1,o,c,n);for(let u=0;u<a.length;u++)l[u]^=a[u];return l}function s(){const o=vn(t),a=Vo.slice(),c=Vo.slice();if(Ki(o,!1,c,c,a),e.length===12)c.set(e);else{const l=Vo.slice(),u=(0,ne.createView)(l);(0,ne.setBigUint64)(u,8,BigInt(8*e.length),!1);const d=Cu.ghash.create(a).update(e).update(l);d.digestInto(c),d.destroy()}return{xk:o,authKey:a,counter:c,tagMask:Ki(o,!1,c,Vo)}}return{encrypt(o){(0,Oe.bytes)(o);const{xk:a,authKey:c,counter:l,tagMask:u}=s(),d=new Uint8Array(o.length+r),h=[a,c,l,u];(0,ne.isAligned32)(o)||h.push(o=(0,ne.copyBytes)(o)),Ki(a,!1,l,o,d);const f=i(c,u,d.subarray(0,d.length-r));return h.push(f),d.set(f,o.length),(0,ne.clean)(...h),d},decrypt(o){if((0,Oe.bytes)(o),o.length<r)throw new Error("aes/gcm: ciphertext less than tagLen (16)");const{xk:a,authKey:c,counter:l,tagMask:u}=s(),d=[a,c,u,l];(0,ne.isAligned32)(o)||d.push(o=(0,ne.copyBytes)(o));const h=o.subarray(0,-16),f=o.subarray(-16),g=i(c,u,h);if(d.push(g),!(0,ne.equalBytes)(g,f))throw new Error("aes/gcm: invalid ghash tag");const p=Ki(a,!1,l,h);return(0,ne.clean)(...d),p}}});const qo=(t,e,n)=>r=>{if(!Number.isSafeInteger(r)||e>r||r>n)throw new Error(`${t}: invalid value=${r}, must be [${e}..${n}]`)};function Bm(t){return t!=null&&typeof t=="object"&&(t instanceof Uint32Array||t.constructor.name==="Uint32Array")}function Lm(t,e){if((0,Oe.bytes)(e,16),!Bm(t))throw new Error("_encryptBlock accepts result of expandKeyLE");const n=(0,ne.u32)(e);let{s0:r,s1:i,s2:s,s3:o}=kt(t,n[0],n[1],n[2],n[3]);return n[0]=r,n[1]=i,n[2]=s,n[3]=o,e}function Dm(t,e){if((0,Oe.bytes)(e,16),!Bm(t))throw new Error("_decryptBlock accepts result of expandKeyLE");const n=(0,ne.u32)(e);let{s0:r,s1:i,s2:s,s3:o}=Zs(t,n[0],n[1],n[2],n[3]);return n[0]=r,n[1]=i,n[2]=s,n[3]=o,e}Ve.siv=(0,ne.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16},function(t,e,n){const r=qo("AAD",0,68719476736),i=qo("plaintext",0,2**36),s=qo("nonce",12,12),o=qo("ciphertext",16,2**36+16);function a(){const u=vn(t),d=new Uint8Array(t.length),h=new Uint8Array(16),f=[u,d];let g=e;(0,ne.isAligned32)(g)||f.push(g=(0,ne.copyBytes)(g));const p=(0,ne.u32)(g);let y=0,m=p[0],C=p[1],v=p[2],I=0;for(const L of[h,d].map(ne.u32)){const z=(0,ne.u32)(L);for(let j=0;j<z.length;j+=2){const{s0:D,s1:B}=kt(u,y,m,C,v);z[j+0]=D,z[j+1]=B,y=++I}}const R={authKey:h,encKey:vn(d)};return(0,ne.clean)(...f),R}function c(u,d,h){const f=Mm(Cu.polyval,!0,d,h,n);for(let v=0;v<12;v++)f[v]^=e[v];f[15]&=127;const g=(0,ne.u32)(f);let p=g[0],y=g[1],m=g[2],C=g[3];return{s0:p,s1:y,s2:m,s3:C}=kt(u,p,y,m,C),g[0]=p,g[1]=y,g[2]=m,g[3]=C,f}function l(u,d,h){let f=(0,ne.copyBytes)(d);f[15]|=128;const g=Ki(u,!0,f,h);return(0,ne.clean)(f),g}return(0,Oe.bytes)(t,16,24,32),(0,Oe.bytes)(e),s(e.length),n!==void 0&&((0,Oe.bytes)(n),r(n.length)),{encrypt(u){(0,Oe.bytes)(u),i(u.length);const{encKey:d,authKey:h}=a(),f=c(d,h,u),g=[d,h,f];(0,ne.isAligned32)(u)||g.push(u=(0,ne.copyBytes)(u));const p=new Uint8Array(u.length+16);return p.set(f,u.length),p.set(l(d,f,u)),(0,ne.clean)(...g),p},decrypt(u){(0,Oe.bytes)(u),o(u.length);const d=u.subarray(-16),{encKey:h,authKey:f}=a(),g=[h,f];(0,ne.isAligned32)(u)||g.push(u=(0,ne.copyBytes)(u));const p=l(h,d,u.subarray(0,-16)),y=c(h,f,p);if(g.push(y),!(0,ne.equalBytes)(d,y))throw(0,ne.clean)(...g),new Error("invalid polyval tag");return(0,ne.clean)(...g),p}}});const Ga={encrypt(t,e){if(e.length>=2**32)throw new Error("plaintext should be less than 4gb");const n=vn(t);if(e.length===16)Lm(n,e);else{const r=(0,ne.u32)(e);let i=r[0],s=r[1];for(let o=0,a=1;o<6;o++)for(let c=2;c<r.length;c+=2,a++){const{s0:l,s1:u,s2:d,s3:h}=kt(n,i,s,r[c],r[c+1]);i=l,s=u^za(a),r[c]=d,r[c+1]=h}r[0]=i,r[1]=s}n.fill(0)},decrypt(t,e){if(e.length-8>=2**32)throw new Error("ciphertext should be less than 4gb");const n=Ys(t),r=e.length/8-1;if(r===1)Dm(n,e);else{const i=(0,ne.u32)(e);let s=i[0],o=i[1];for(let a=0,c=6*r;a<6;a++)for(let l=2*r;l>=1;l-=2,c--){o^=za(c);const{s0:u,s1:d,s2:h,s3:f}=Zs(n,s,o,i[l],i[l+1]);s=u,o=d,i[l]=h,i[l+1]=f}i[0]=s,i[1]=o}n.fill(0)}},bf=new Uint8Array(8).fill(166);Ve.aeskw=(0,ne.wrapCipher)({blockSize:8},t=>({encrypt(e){if((0,Oe.bytes)(e),!e.length||e.length%8!=0)throw new Error("invalid plaintext length");if(e.length===8)throw new Error("8-byte keys not allowed in AESKW, use AESKWP instead");const n=(0,ne.concatBytes)(bf,e);return Ga.encrypt(t,n),n},decrypt(e){if((0,Oe.bytes)(e),e.length%8!=0||e.length<24)throw new Error("invalid ciphertext length");const n=(0,ne.copyBytes)(e);if(Ga.decrypt(t,n),!(0,ne.equalBytes)(n.subarray(0,8),bf))throw new Error("integrity check failed");return n.subarray(0,8).fill(0),n.subarray(8)}}));const Ef=2790873510;Ve.aeskwp=(0,ne.wrapCipher)({blockSize:8},t=>({encrypt(e){if((0,Oe.bytes)(e),!e.length)throw new Error("invalid plaintext length");const n=8*Math.ceil(e.length/8),r=new Uint8Array(8+n);r.set(e,8);const i=(0,ne.u32)(r);return i[0]=Ef,i[1]=za(e.length),Ga.encrypt(t,r),r},decrypt(e){if((0,Oe.bytes)(e),e.length<16)throw new Error("invalid ciphertext length");const n=(0,ne.copyBytes)(e),r=(0,ne.u32)(n);Ga.decrypt(t,n);const i=za(r[1])>>>0,s=8*Math.ceil(i/8);if(r[0]!==Ef||n.length-8!==s)throw new Error("integrity check failed");for(let o=i;o<s;o++)if(n[8+o]!==0)throw new Error("integrity check failed");return n.subarray(0,8).fill(0),n.subarray(8,8+i)}})),Ve.unsafe={expandKeyLE:vn,expandKeyDecLE:Ys,encrypt:kt,decrypt:Zs,encryptBlock:Lm,decryptBlock:Dm,ctrCounter:Nm,ctr32:Ki},Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.aes256cbc=Wi.aes256gcm=void 0;var Um=Ve;Wi.aes256gcm=function(t,e,n){return(0,Um.gcm)(t,e,n)};Wi.aes256cbc=function(t,e,n){return(0,Um.cbc)(t,e)};var Va={},Fm={},$i={};Object.defineProperty($i,"__esModule",{value:!0}),$i.sigma=void 0,$i.rotl=function(t,e){return t<<e|t>>>32-e},$i.createCipher=function(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:i,counterRight:s,rounds:o}=(0,nn.checkOpts)({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return(0,jn.number)(i),(0,jn.number)(o),(0,jn.bool)(s),(0,jn.bool)(n),(a,c,l,u,d=0)=>{(0,jn.bytes)(a),(0,jn.bytes)(c),(0,jn.bytes)(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),(0,jn.bytes)(u),(0,jn.number)(d),d<0||d>=Af)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const f=[];let g,p,y=a.length;if(y===32)f.push(g=(0,nn.copyBytes)(a)),p=Km;else{if(y!==16||!n)throw new Error(`arx: invalid 32-byte key, got length=${y}`);g=new Uint8Array(32),g.set(a),g.set(a,16),p=wE,f.push(g)}bl(c)||f.push(c=(0,nn.copyBytes)(c));const m=(0,nn.u32)(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(p,m,(0,nn.u32)(c.subarray(0,16)),m),c=c.subarray(16)}const C=16-i;if(C!==c.length)throw new Error(`arx: nonce must be ${C} or 16 bytes`);if(C!==12){const I=new Uint8Array(12);I.set(c,s?0:12-c.length),c=I,f.push(c)}const v=(0,nn.u32)(c);return function(I,R,L,z,j,D,B,$){const U=j.length,M=new Uint8Array(Wo),O=(0,nn.u32)(M),A=bl(j)&&bl(D),T=A?(0,nn.u32)(j):Sf,F=A?(0,nn.u32)(D):Sf;for(let w=0;w<U;B++){if(I(R,L,z,O,B,$),B>=Af)throw new Error("arx: counter overflow");const S=Math.min(Wo,U-w);if(A&&S===Wo){const _=w/4;if(w%4!=0)throw new Error("arx: invalid block position");for(let k,E=0;E<vE;E++)k=_+E,F[k]=T[k]^O[E];w+=Wo}else{for(let _,k=0;k<S;k++)_=w+k,D[_]=j[_]^M[k];w+=S}}}(t,p,m,v,l,u,d,o),(0,nn.clean)(...f),u}};const jn=Et,nn=Yt,Hm=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),mE=Hm("expand 16-byte k"),yE=Hm("expand 32-byte k"),wE=(0,nn.u32)(mE),Km=(0,nn.u32)(yE);function bl(t){return t.byteOffset%4==0}$i.sigma=Km.slice();const Wo=64,vE=16,Af=2**32-1,Sf=new Uint32Array;var Us={};Object.defineProperty(Us,"__esModule",{value:!0}),Us.poly1305=void 0,Us.wrapConstructorWithKey=$m;const Qo=Et,Rs=Yt,ht=(t,e)=>255&t[e++]|(255&t[e++])<<8;class bE{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=(0,Rs.toBytes)(e),(0,Qo.bytes)(e,32);const n=ht(e,0),r=ht(e,2),i=ht(e,4),s=ht(e,6),o=ht(e,8),a=ht(e,10),c=ht(e,12),l=ht(e,14);this.r[0]=8191&n,this.r[1]=8191&(n>>>13|r<<3),this.r[2]=7939&(r>>>10|i<<6),this.r[3]=8191&(i>>>7|s<<9),this.r[4]=255&(s>>>4|o<<12),this.r[5]=o>>>1&8190,this.r[6]=8191&(o>>>14|a<<2),this.r[7]=8065&(a>>>11|c<<5),this.r[8]=8191&(c>>>8|l<<8),this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=ht(e,16+2*u)}process(e,n,r=!1){const i=r?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],f=o[6],g=o[7],p=o[8],y=o[9],m=ht(e,n+0),C=ht(e,n+2),v=ht(e,n+4),I=ht(e,n+6),R=ht(e,n+8),L=ht(e,n+10),z=ht(e,n+12),j=ht(e,n+14);let D=s[0]+(8191&m),B=s[1]+(8191&(m>>>13|C<<3)),$=s[2]+(8191&(C>>>10|v<<6)),U=s[3]+(8191&(v>>>7|I<<9)),M=s[4]+(8191&(I>>>4|R<<12)),O=s[5]+(R>>>1&8191),A=s[6]+(8191&(R>>>14|L<<2)),T=s[7]+(8191&(L>>>11|z<<5)),F=s[8]+(8191&(z>>>8|j<<8)),w=s[9]+(j>>>5|i),S=0,_=S+D*a+B*(5*y)+$*(5*p)+U*(5*g)+M*(5*f);S=_>>>13,_&=8191,_+=O*(5*h)+A*(5*d)+T*(5*u)+F*(5*l)+w*(5*c),S+=_>>>13,_&=8191;let k=S+D*c+B*a+$*(5*y)+U*(5*p)+M*(5*g);S=k>>>13,k&=8191,k+=O*(5*f)+A*(5*h)+T*(5*d)+F*(5*u)+w*(5*l),S+=k>>>13,k&=8191;let E=S+D*l+B*c+$*a+U*(5*y)+M*(5*p);S=E>>>13,E&=8191,E+=O*(5*g)+A*(5*f)+T*(5*h)+F*(5*d)+w*(5*u),S+=E>>>13,E&=8191;let b=S+D*u+B*l+$*c+U*a+M*(5*y);S=b>>>13,b&=8191,b+=O*(5*p)+A*(5*g)+T*(5*f)+F*(5*h)+w*(5*d),S+=b>>>13,b&=8191;let x=S+D*d+B*u+$*l+U*c+M*a;S=x>>>13,x&=8191,x+=O*(5*y)+A*(5*p)+T*(5*g)+F*(5*f)+w*(5*h),S+=x>>>13,x&=8191;let P=S+D*h+B*d+$*u+U*l+M*c;S=P>>>13,P&=8191,P+=O*a+A*(5*y)+T*(5*p)+F*(5*g)+w*(5*f),S+=P>>>13,P&=8191;let N=S+D*f+B*h+$*d+U*u+M*l;S=N>>>13,N&=8191,N+=O*c+A*a+T*(5*y)+F*(5*p)+w*(5*g),S+=N>>>13,N&=8191;let H=S+D*g+B*f+$*h+U*d+M*u;S=H>>>13,H&=8191,H+=O*l+A*c+T*a+F*(5*y)+w*(5*p),S+=H>>>13,H&=8191;let K=S+D*p+B*g+$*f+U*h+M*d;S=K>>>13,K&=8191,K+=O*u+A*l+T*c+F*a+w*(5*y),S+=K>>>13,K&=8191;let V=S+D*y+B*p+$*g+U*f+M*h;S=V>>>13,V&=8191,V+=O*d+A*u+T*l+F*c+w*a,S+=V>>>13,V&=8191,S=(S<<2)+S|0,S=S+_|0,_=8191&S,S>>>=13,k+=S,s[0]=_,s[1]=k,s[2]=E,s[3]=b,s[4]=x,s[5]=P,s[6]=N,s[7]=H,s[8]=K,s[9]=V}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=5*i,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+i,i=r[a]>>>13,r[a]&=8191;r[9]-=8192;let s=(1^i)-1;for(let a=0;a<10;a++)r[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|r[a];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);let o=e[0]+n[0];e[0]=65535&o;for(let a=1;a<8;a++)o=(e[a]+n[a]|0)+(o>>>16)|0,e[a]=65535&o;(0,Rs.clean)(r)}update(e){(0,Qo.exists)(this);const{buffer:n,blockLen:r}=this,i=(e=(0,Rs.toBytes)(e)).length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);if(o!==r)n.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0);else for(;r<=i-s;s+=r)this.process(e,s)}return this}destroy(){(0,Rs.clean)(this.h,this.r,this.buffer,this.pad)}digestInto(e){(0,Qo.exists)(this),(0,Qo.output)(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:i}=this;if(i){for(n[i++]=1;i<16;i++)n[i]=0;this.process(n,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=r[o]>>>0,e[s++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function $m(t){const e=(r,i)=>t(i).update((0,Rs.toBytes)(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}Us.poly1305=$m(t=>new bE(t)),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.xchacha20poly1305=t.chacha20poly1305=t._poly1305_aead=t.chacha12=t.chacha8=t.xchacha20=t.chacha20=t.chacha20orig=void 0,t.hchacha=o;const e=$i,n=Et,r=Us,i=Yt;function s(d,h,f,g,p,y=20){let m=d[0],C=d[1],v=d[2],I=d[3],R=h[0],L=h[1],z=h[2],j=h[3],D=h[4],B=h[5],$=h[6],U=h[7],M=p,O=f[0],A=f[1],T=f[2],F=m,w=C,S=v,_=I,k=R,E=L,b=z,x=j,P=D,N=B,H=$,K=U,V=M,q=O,Y=A,Z=T;for(let oe=0;oe<y;oe+=2)F=F+k|0,V=(0,e.rotl)(V^F,16),P=P+V|0,k=(0,e.rotl)(k^P,12),F=F+k|0,V=(0,e.rotl)(V^F,8),P=P+V|0,k=(0,e.rotl)(k^P,7),w=w+E|0,q=(0,e.rotl)(q^w,16),N=N+q|0,E=(0,e.rotl)(E^N,12),w=w+E|0,q=(0,e.rotl)(q^w,8),N=N+q|0,E=(0,e.rotl)(E^N,7),S=S+b|0,Y=(0,e.rotl)(Y^S,16),H=H+Y|0,b=(0,e.rotl)(b^H,12),S=S+b|0,Y=(0,e.rotl)(Y^S,8),H=H+Y|0,b=(0,e.rotl)(b^H,7),_=_+x|0,Z=(0,e.rotl)(Z^_,16),K=K+Z|0,x=(0,e.rotl)(x^K,12),_=_+x|0,Z=(0,e.rotl)(Z^_,8),K=K+Z|0,x=(0,e.rotl)(x^K,7),F=F+E|0,Z=(0,e.rotl)(Z^F,16),H=H+Z|0,E=(0,e.rotl)(E^H,12),F=F+E|0,Z=(0,e.rotl)(Z^F,8),H=H+Z|0,E=(0,e.rotl)(E^H,7),w=w+b|0,V=(0,e.rotl)(V^w,16),K=K+V|0,b=(0,e.rotl)(b^K,12),w=w+b|0,V=(0,e.rotl)(V^w,8),K=K+V|0,b=(0,e.rotl)(b^K,7),S=S+x|0,q=(0,e.rotl)(q^S,16),P=P+q|0,x=(0,e.rotl)(x^P,12),S=S+x|0,q=(0,e.rotl)(q^S,8),P=P+q|0,x=(0,e.rotl)(x^P,7),_=_+k|0,Y=(0,e.rotl)(Y^_,16),N=N+Y|0,k=(0,e.rotl)(k^N,12),_=_+k|0,Y=(0,e.rotl)(Y^_,8),N=N+Y|0,k=(0,e.rotl)(k^N,7);let ie=0;g[ie++]=m+F|0,g[ie++]=C+w|0,g[ie++]=v+S|0,g[ie++]=I+_|0,g[ie++]=R+k|0,g[ie++]=L+E|0,g[ie++]=z+b|0,g[ie++]=j+x|0,g[ie++]=D+P|0,g[ie++]=B+N|0,g[ie++]=$+H|0,g[ie++]=U+K|0,g[ie++]=M+V|0,g[ie++]=O+q|0,g[ie++]=A+Y|0,g[ie++]=T+Z|0}function o(d,h,f,g){let p=d[0],y=d[1],m=d[2],C=d[3],v=h[0],I=h[1],R=h[2],L=h[3],z=h[4],j=h[5],D=h[6],B=h[7],$=f[0],U=f[1],M=f[2],O=f[3];for(let T=0;T<20;T+=2)p=p+v|0,$=(0,e.rotl)($^p,16),z=z+$|0,v=(0,e.rotl)(v^z,12),p=p+v|0,$=(0,e.rotl)($^p,8),z=z+$|0,v=(0,e.rotl)(v^z,7),y=y+I|0,U=(0,e.rotl)(U^y,16),j=j+U|0,I=(0,e.rotl)(I^j,12),y=y+I|0,U=(0,e.rotl)(U^y,8),j=j+U|0,I=(0,e.rotl)(I^j,7),m=m+R|0,M=(0,e.rotl)(M^m,16),D=D+M|0,R=(0,e.rotl)(R^D,12),m=m+R|0,M=(0,e.rotl)(M^m,8),D=D+M|0,R=(0,e.rotl)(R^D,7),C=C+L|0,O=(0,e.rotl)(O^C,16),B=B+O|0,L=(0,e.rotl)(L^B,12),C=C+L|0,O=(0,e.rotl)(O^C,8),B=B+O|0,L=(0,e.rotl)(L^B,7),p=p+I|0,O=(0,e.rotl)(O^p,16),D=D+O|0,I=(0,e.rotl)(I^D,12),p=p+I|0,O=(0,e.rotl)(O^p,8),D=D+O|0,I=(0,e.rotl)(I^D,7),y=y+R|0,$=(0,e.rotl)($^y,16),B=B+$|0,R=(0,e.rotl)(R^B,12),y=y+R|0,$=(0,e.rotl)($^y,8),B=B+$|0,R=(0,e.rotl)(R^B,7),m=m+L|0,U=(0,e.rotl)(U^m,16),z=z+U|0,L=(0,e.rotl)(L^z,12),m=m+L|0,U=(0,e.rotl)(U^m,8),z=z+U|0,L=(0,e.rotl)(L^z,7),C=C+v|0,M=(0,e.rotl)(M^C,16),j=j+M|0,v=(0,e.rotl)(v^j,12),C=C+v|0,M=(0,e.rotl)(M^C,8),j=j+M|0,v=(0,e.rotl)(v^j,7);let A=0;g[A++]=p,g[A++]=y,g[A++]=m,g[A++]=C,g[A++]=$,g[A++]=U,g[A++]=M,g[A++]=O}t.chacha20orig=(0,e.createCipher)(s,{counterRight:!1,counterLength:8,allowShortKeys:!0}),t.chacha20=(0,e.createCipher)(s,{counterRight:!1,counterLength:4,allowShortKeys:!1}),t.xchacha20=(0,e.createCipher)(s,{counterRight:!1,counterLength:8,extendNonceFn:o,allowShortKeys:!1}),t.chacha8=(0,e.createCipher)(s,{counterRight:!1,counterLength:4,rounds:8}),t.chacha12=(0,e.createCipher)(s,{counterRight:!1,counterLength:4,rounds:12});const a=new Uint8Array(16),c=(d,h)=>{d.update(h);const f=h.length%16;f&&d.update(a.subarray(f))},l=new Uint8Array(32);function u(d,h,f,g,p){const y=d(h,f,l),m=r.poly1305.create(y);p&&c(m,p),c(m,g);const C=new Uint8Array(16),v=(0,i.createView)(C);(0,i.setBigUint64)(v,0,BigInt(p?p.length:0),!0),(0,i.setBigUint64)(v,8,BigInt(g.length),!0),m.update(C);const I=m.digest();return(0,i.clean)(y,C),I}t._poly1305_aead=d=>(h,f,g)=>((0,n.bytes)(h,32),(0,n.bytes)(f),{encrypt(y,m){const C=y.length,v=C+16;m?(0,n.bytes)(m,v):m=new Uint8Array(v),d(h,f,y,m,1);const I=u(d,h,f,m.subarray(0,-16),g);return m.set(I,C),(0,i.clean)(I),m},decrypt(y,m){const C=y.length,v=C-16;if(C<16)throw new Error("encrypted data must be at least 16 bytes");m?(0,n.bytes)(m,v):m=new Uint8Array(v);const I=y.subarray(0,-16),R=y.subarray(-16),L=u(d,h,f,I,g);if(!(0,i.equalBytes)(R,L))throw new Error("invalid tag");return d(h,f,I,m,1),(0,i.clean)(L),m}}),t.chacha20poly1305=(0,i.wrapCipher)({blockSize:64,nonceLength:12,tagLength:16},(0,t._poly1305_aead)(t.chacha20)),t.xchacha20poly1305=(0,i.wrapCipher)({blockSize:64,nonceLength:24,tagLength:16},(0,t._poly1305_aead)(t.xchacha20))}(Fm),Object.defineProperty(Va,"__esModule",{value:!0}),Va.xchacha20=void 0;var Pi,Cf,Cs,EE=Fm;Va.xchacha20=function(t,e,n){return(0,EE.xchacha20poly1305)(t,e,n)},function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.aesDecrypt=t.aesEncrypt=t.symDecrypt=t.symEncrypt=void 0;var e=Yt,n=Ed,r=Wi,i=Va,s=Qs,o=at;t.symEncrypt=function(u,d,h){return a(c,u,d,h)};function a(u,d,h,f){var g=(0,s.symmetricAlgorithm)();if(g==="aes-256-gcm")return u(r.aes256gcm,d,h,(0,s.symmetricNonceLength)(),o.AEAD_TAG_LENGTH,f);if(g==="xchacha20")return u(i.xchacha20,d,h,o.XCHACHA20_NONCE_LENGTH,o.AEAD_TAG_LENGTH,f);if(g==="aes-256-cbc")return u(r.aes256cbc,d,h,16,0);throw new Error("Not implemented")}function c(u,d,h,f,g,p){var y=(0,n.randomBytes)(f),m=u(d,y,p).encrypt(h);if(g===0)return(0,e.concatBytes)(y,m);var C=m.length-g,v=m.subarray(0,C),I=m.subarray(C);return(0,e.concatBytes)(y,I,v)}function l(u,d,h,f,g,p){var y=h.subarray(0,f),m=u(d,Uint8Array.from(y),p),C=h.subarray(f);if(g===0)return m.decrypt(C);var v=C.subarray(0,g),I=C.subarray(g);return m.decrypt((0,e.concatBytes)(I,v))}t.symDecrypt=function(u,d,h){return a(l,u,d,h)},t.aesEncrypt=t.symEncrypt,t.aesDecrypt=t.symDecrypt}(pf),Pi=Cc,Cf=ln&&ln.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),Cs=ln&&ln.__exportStar||function(t,e){for(var n in t)n==="default"||Object.prototype.hasOwnProperty.call(e,n)||Cf(e,t,n)},Object.defineProperty(Pi,"__esModule",{value:!0}),Cs(zg,Pi),Cs(_m,Pi),Cs(Au,Pi),Cs(pf,Pi);var Xs={};Object.defineProperty(Xs,"__esModule",{value:!0}),Xs.PublicKey=void 0;var _f=Yt,Jo=Cc,AE=function(){function t(e){this.data=(0,Jo.convertPublicKeyFormat)(e,!0)}return t.fromHex=function(e){return new t((0,Jo.hexToPublicKey)(e))},Object.defineProperty(t.prototype,"uncompressed",{get:function(){return ee.from((0,Jo.convertPublicKeyFormat)(this.data,!1))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"compressed",{get:function(){return ee.from(this.data)},enumerable:!1,configurable:!0}),t.prototype.toHex=function(e){return e===void 0&&(e=!0),(0,_f.bytesToHex)(e?this.data:this.uncompressed)},t.prototype.decapsulate=function(e,n){n===void 0&&(n=!1);var r=n?this.data:this.uncompressed,i=e.multiply(this,n);return(0,Jo.getSharedKey)(r,i)},t.prototype.equals=function(e){return(0,_f.equalBytes)(this.data,e.data)},t}();Xs.PublicKey=AE,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.PrivateKey=void 0;var xf=Yt,Ti=Cc,SE=Xs,CE=function(){function t(e){if(e===void 0)this.data=(0,Ti.getValidSecret)();else{if(!(0,Ti.isValidPrivateKey)(e))throw new Error("Invalid private key");this.data=e}this.publicKey=new SE.PublicKey((0,Ti.getPublicKey)(this.data))}return t.fromHex=function(e){return new t((0,Ti.decodeHex)(e))},Object.defineProperty(t.prototype,"secret",{get:function(){return ee.from(this.data)},enumerable:!1,configurable:!0}),t.prototype.toHex=function(){return(0,xf.bytesToHex)(this.data)},t.prototype.encapsulate=function(e,n){n===void 0&&(n=!1);var r=n?this.publicKey.compressed:this.publicKey.uncompressed,i=this.multiply(e,n);return(0,Ti.getSharedKey)(r,i)},t.prototype.multiply=function(e,n){return n===void 0&&(n=!1),(0,Ti.getSharedPoint)(this.data,e.compressed,n)},t.prototype.equals=function(e){return(0,xf.equalBytes)(this.data,e.data)},t}();Ha.PrivateKey=CE,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.PublicKey=t.PrivateKey=void 0;var e=Ha;Object.defineProperty(t,"PrivateKey",{enumerable:!0,get:function(){return e.PrivateKey}});var n=Xs;Object.defineProperty(t,"PublicKey",{enumerable:!0,get:function(){return n.PublicKey}})}(sl),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.utils=t.PublicKey=t.PrivateKey=t.ECIES_CONFIG=void 0,t.encrypt=function(a,c){var l=new r.PrivateKey,u=a instanceof Uint8Array?new r.PublicKey(a):r.PublicKey.fromHex(a),d=l.encapsulate(u,(0,n.isHkdfKeyCompressed)()),h=(0,n.isEphemeralKeyCompressed)()?l.publicKey.compressed:l.publicKey.uncompressed,f=(0,i.symEncrypt)(d,c);return ee.from((0,e.concatBytes)(h,f))},t.decrypt=function(a,c){var l=a instanceof Uint8Array?new r.PrivateKey(a):r.PrivateKey.fromHex(a),u=(0,n.ephemeralKeySize)(),d=new r.PublicKey(c.subarray(0,u)),h=c.subarray(u),f=d.decapsulate(l,(0,n.isHkdfKeyCompressed)());return ee.from((0,i.symDecrypt)(f,h))};var e=Yt,n=Qs,r=sl,i=Cc,s=Qs;Object.defineProperty(t,"ECIES_CONFIG",{enumerable:!0,get:function(){return s.ECIES_CONFIG}});var o=sl;Object.defineProperty(t,"PrivateKey",{enumerable:!0,get:function(){return o.PrivateKey}}),Object.defineProperty(t,"PublicKey",{enumerable:!0,get:function(){return o.PublicKey}}),t.utils={aesEncrypt:i.aesEncrypt,aesDecrypt:i.aesDecrypt,symEncrypt:i.symEncrypt,symDecrypt:i.symDecrypt,decodeHex:i.decodeHex,getValidSecret:i.getValidSecret,remove0x:i.remove0x}}(Mi);const jm=Tt("KeyExchange:Layer"),zm=Tt("SocketService:Layer"),Gm=Tt("Ecies:Layer"),Vm=Tt("RemoteCommunication:Layer");jm.color="##95c44e",zm.color="#f638d7",Gm.color="#465b9c",Vm.color="#47a2be";const W={KeyExchange:jm,SocketService:zm,Ecies:Gm,RemoteCommunication:Vm};let _s,Yo=[],El=[];const ar=(t,e)=>X(void 0,void 0,void 0,function*(){_s=e,El.push(t),function(n){return X(this,void 0,void 0,function*(){if(!_s||!n)return;(function(){const o=El;El=Yo,Yo=o})();const r=_s.endsWith("/")?`${_s}evt`:`${_s}/evt`,i=Object.assign({},n);if(delete i.params,n.params)for(const[o,a]of Object.entries(n.params))i[o]=a;const s=JSON.stringify(i);W.RemoteCommunication(`[sendBufferedEvents] Sending ${Yo.length} analytics events to ${r}`);try{const o=yield pg(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:s}),a=yield o.text();W.RemoteCommunication(`[sendBufferedEvents] Response: ${a}`),Yo.length=0}catch{}})}(t).catch(()=>{})});class Al{constructor(e){this.enabled=!0,e?.debug&&Tt.enable("Ecies:Layer"),this.ecies=e?.privateKey?Mi.PrivateKey.fromHex(e.privateKey):new Mi.PrivateKey,W.Ecies("[ECIES constructor()] initialized secret: ",this.ecies.toHex()),W.Ecies("[ECIES constructor()] initialized public: ",this.ecies.publicKey.toHex()),W.Ecies("[ECIES constructor()] init with",this)}generateECIES(){this.ecies=new Mi.PrivateKey}getPublicKey(){return this.ecies.publicKey.toHex()}encrypt(e,n){let r=e;if(this.enabled)try{W.Ecies("[ECIES: encrypt()] using otherPublicKey",n);const i=ee.from(e),s=Mi.encrypt(n,i);r=ee.from(s).toString("base64")}catch(i){throw W.Ecies("[ECIES: encrypt()] error encrypt:",i),W.Ecies("[ECIES: encrypt()] private: ",this.ecies.toHex()),W.Ecies("[ECIES: encrypt()] data: ",e),W.Ecies("[ECIES: encrypt()] otherkey: ",n),i}return r}decrypt(e){let n=e;if(this.enabled)try{W.Ecies("[ECIES: decrypt()] using privateKey",this.ecies.toHex());const r=ee.from(e.toString(),"base64");n=Mi.decrypt(this.ecies.toHex(),r).toString()}catch(r){throw W.Ecies("[ECIES: decrypt()] error decrypt",r),W.Ecies("[ECIES: decrypt()] private: ",this.ecies.toHex()),W.Ecies("[ECIES: decrypt()] encryptedData: ",e),r}return n}getKeyInfo(){return{private:this.ecies.toHex(),public:this.ecies.publicKey.toHex()}}toString(){W.Ecies("[ECIES: toString()]",this.getKeyInfo())}}var $r={version:"0.33.0"};const is="https://metamask-sdk.api.cx.metamask.io/",_E=["websocket"],ss=6048e5,xE=3e3,vt={METAMASK_CONNECTSIGN:"metamask_connectSign",METAMASK_CONNECTWITH:"metamask_connectWith",METAMASK_OPEN:"metamask_open",METAMASK_BATCH:"metamask_batch",PERSONAL_SIGN:"personal_sign",WALLET_REQUESTPERMISSIONS:"wallet_requestPermissions",WALLET_REVOKEPERMISSIONS:"wallet_revokePermissions",WALLET_WATCHASSET:"wallet_watchAsset",ETH_REQUESTACCOUNTS:"eth_requestAccounts",ETH_SENDTRANSACTION:"eth_sendTransaction",ETH_SIGNTYPEDDATA:"eth_signTypedData",ETH_SIGNTYPEDDATA_V3:"eth_signTypedData_v3",ETH_SIGNTYPEDDATA_V4:"eth_signTypedData_v4",ETH_SIGNTRANSACTION:"eth_signTransaction",ETH_SIGN:"eth_sign",PERSONAL_EC_RECOVER:"personal_ecRecover"},kE=[vt.METAMASK_CONNECTSIGN,vt.METAMASK_CONNECTWITH,vt.METAMASK_OPEN,vt.METAMASK_BATCH,vt.PERSONAL_SIGN,vt.WALLET_REQUESTPERMISSIONS,vt.WALLET_REVOKEPERMISSIONS,vt.WALLET_WATCHASSET,vt.ETH_SENDTRANSACTION,vt.ETH_SIGNTYPEDDATA,vt.ETH_SIGNTYPEDDATA_V3,vt.ETH_SIGNTYPEDDATA_V4,vt.ETH_SIGNTRANSACTION,vt.ETH_SIGN,vt.PERSONAL_EC_RECOVER];function Eo(t){return kE.includes(t)}function qm(t){const{context:e}=t;W.RemoteCommunication(`[RemoteCommunication: clean()] context=${e}`),t.channelConfig=void 0,t.ready=!1,t.originatorConnectStarted=!1}var mt,re,qa,Be,ze,tt,Ii;(Ii=mt||(mt={})).DISCONNECTED="disconnected",Ii.WAITING="waiting",Ii.TIMEOUT="timeout",Ii.LINKED="linked",Ii.PAUSED="paused",Ii.TERMINATED="terminated",function(t){t.KEY_INFO="key_info",t.SERVICE_STATUS="service_status",t.PROVIDER_UPDATE="provider_update",t.RPC_UPDATE="rpc_update",t.KEYS_EXCHANGED="keys_exchanged",t.JOIN_CHANNEL="join_channel",t.PUBLIC_KEY="public_key",t.CHANNEL_CREATED="channel_created",t.CLIENTS_CONNECTED="clients_connected",t.CLIENTS_DISCONNECTED="clients_disconnected",t.CLIENTS_WAITING="clients_waiting",t.CLIENTS_READY="clients_ready",t.REJECTED="rejected",t.WALLET_INIT="wallet_init",t.CHANNEL_PERSISTENCE="channel_persistence",t.CONFIG="config",t.MESSAGE_ACK="ack",t.SOCKET_DISCONNECTED="socket_disconnected",t.SOCKET_RECONNECT="socket_reconnect",t.OTP="otp",t.SDK_RPC_CALL="sdk_rpc_call",t.AUTHORIZED="authorized",t.CONNECTION_STATUS="connection_status",t.MESSAGE="message",t.TERMINATE="terminate"}(re||(re={})),(qa||(qa={})).KEY_EXCHANGE="key_exchange",function(t){t.KEY_HANDSHAKE_START="key_handshake_start",t.KEY_HANDSHAKE_CHECK="key_handshake_check",t.KEY_HANDSHAKE_SYN="key_handshake_SYN",t.KEY_HANDSHAKE_SYNACK="key_handshake_SYNACK",t.KEY_HANDSHAKE_ACK="key_handshake_ACK",t.KEY_HANDSHAKE_WALLET="key_handshake_wallet",t.KEY_HANDSHAKE_NONE="none"}(Be||(Be={}));class PE extends vc.EventEmitter2{constructor({communicationLayer:e,otherPublicKey:n,context:r,ecies:i,logging:s}){super(),this.keysExchanged=!1,this.step=Be.KEY_HANDSHAKE_NONE,this.debug=!1,this.context=r,this.communicationLayer=e,i?.privateKey&&n&&(W.KeyExchange(`[KeyExchange: constructor()] otherPubKey=${n} set keysExchanged to true!`,i),this.keysExchanged=!0),this.myECIES=new Al(Object.assign(Object.assign({},i),{debug:s?.eciesLayer})),this.communicationLayer.state.eciesInstance=this.myECIES,this.myPublicKey=this.myECIES.getPublicKey(),this.debug=s?.keyExchangeLayer===!0,n&&this.setOtherPublicKey(n),this.communicationLayer.on(qa.KEY_EXCHANGE,this.onKeyExchangeMessage.bind(this))}onKeyExchangeMessage(e){const{relayPersistence:n}=this.communicationLayer.remote.state;if(W.KeyExchange(`[KeyExchange: onKeyExchangeMessage()] context=${this.context} keysExchanged=${this.keysExchanged} relayPersistence=${n}`,e),n)return void W.KeyExchange("[KeyExchange: onKeyExchangeMessage()] Ignoring key exchange message because relay persistence is activated");const{message:r}=e;this.keysExchanged&&W.KeyExchange(`[KeyExchange: onKeyExchangeMessage()] context=${this.context} received handshake while already exchanged. step=${this.step} otherPubKey=${this.otherPublicKey}`),this.emit(re.KEY_INFO,r.type),r.type===Be.KEY_HANDSHAKE_SYN?(this.checkStep([Be.KEY_HANDSHAKE_NONE,Be.KEY_HANDSHAKE_ACK]),W.KeyExchange("[KeyExchange: onKeyExchangeMessage()] KEY_HANDSHAKE_SYN",r),r.pubkey&&this.setOtherPublicKey(r.pubkey),this.communicationLayer.sendMessage({type:Be.KEY_HANDSHAKE_SYNACK,pubkey:this.myPublicKey}).catch(i=>{W.KeyExchange("[KeyExchange: onKeyExchangeMessage()] Error sending KEY_HANDSHAKE_SYNACK",i)}),this.setStep(Be.KEY_HANDSHAKE_ACK)):r.type===Be.KEY_HANDSHAKE_SYNACK?(this.checkStep([Be.KEY_HANDSHAKE_SYNACK,Be.KEY_HANDSHAKE_ACK,Be.KEY_HANDSHAKE_NONE]),W.KeyExchange("[KeyExchange: onKeyExchangeMessage()] KEY_HANDSHAKE_SYNACK"),r.pubkey&&this.setOtherPublicKey(r.pubkey),this.communicationLayer.sendMessage({type:Be.KEY_HANDSHAKE_ACK}).catch(i=>{W.KeyExchange("[KeyExchange: onKeyExchangeMessage()] Error sending KEY_HANDSHAKE_ACK",i)}),this.keysExchanged=!0,this.setStep(Be.KEY_HANDSHAKE_ACK),this.emit(re.KEYS_EXCHANGED)):r.type===Be.KEY_HANDSHAKE_ACK&&(W.KeyExchange("[KeyExchange: onKeyExchangeMessage()] KEY_HANDSHAKE_ACK set keysExchanged to true!"),this.checkStep([Be.KEY_HANDSHAKE_ACK,Be.KEY_HANDSHAKE_NONE]),this.keysExchanged=!0,this.setStep(Be.KEY_HANDSHAKE_ACK),this.emit(re.KEYS_EXCHANGED))}resetKeys(e){this.clean(),this.myECIES=new Al(e)}clean(){W.KeyExchange(`[KeyExchange: clean()] context=${this.context} reset handshake state`),this.setStep(Be.KEY_HANDSHAKE_NONE),this.emit(re.KEY_INFO,this.step),this.keysExchanged=!1}start({isOriginator:e,force:n}){const{relayPersistence:r,protocolVersion:i}=this.communicationLayer.remote.state,s=i>=2;r?W.KeyExchange("[KeyExchange: start()] Ignoring key exchange message because relay persistence is activated"):(W.KeyExchange(`[KeyExchange: start()] context=${this.context} protocolVersion=${i} isOriginator=${e} step=${this.step} force=${n} relayPersistence=${r} keysExchanged=${this.keysExchanged}`),e?!(this.keysExchanged||this.step!==Be.KEY_HANDSHAKE_NONE&&this.step!==Be.KEY_HANDSHAKE_SYNACK)||n?(W.KeyExchange(`[KeyExchange: start()] context=${this.context} -- start key exchange (force=${n}) -- step=${this.step}`,this.step),this.clean(),this.setStep(Be.KEY_HANDSHAKE_SYNACK),this.communicationLayer.sendMessage({type:Be.KEY_HANDSHAKE_SYN,pubkey:this.myPublicKey,v:2}).catch(o=>{W.KeyExchange("[KeyExchange: start()] Error sending KEY_HANDSHAKE_SYN",o)})):W.KeyExchange(`[KeyExchange: start()] context=${this.context} -- key exchange already ${this.keysExchanged?"done":"in progress"} -- aborted.`,this.step):this.keysExchanged&&n!==!0?W.KeyExchange("[KeyExchange: start()] don't send KEY_HANDSHAKE_START -- exchange already done."):s?this.communicationLayer.sendMessage({type:Be.KEY_HANDSHAKE_SYNACK,pubkey:this.myPublicKey,v:2}).catch(o=>{W.KeyExchange("[KeyExchange: start()] Error sending KEY_HANDSHAKE_SYNACK",o)}):(this.communicationLayer.sendMessage({type:Be.KEY_HANDSHAKE_START}).catch(o=>{W.KeyExchange("[KeyExchange: start()] Error sending KEY_HANDSHAKE_START",o)}),this.clean()))}setStep(e){this.step=e,this.emit(re.KEY_INFO,e)}checkStep(e){e.length>0&&e.indexOf(this.step.toString())}setRelayPersistence({localKey:e,otherKey:n}){this.otherPublicKey=n,this.myECIES=new Al({privateKey:e,debug:this.debug}),this.keysExchanged=!0}setKeysExchanged(e){this.keysExchanged=e}areKeysExchanged(){return this.keysExchanged}getMyPublicKey(){return this.myPublicKey}getOtherPublicKey(){return this.otherPublicKey}setOtherPublicKey(e){W.KeyExchange("[KeyExchange: setOtherPubKey()]",e),this.otherPublicKey=e}encryptMessage(e){if(!this.otherPublicKey)throw new Error("encryptMessage: Keys not exchanged - missing otherPubKey");return this.myECIES.encrypt(e,this.otherPublicKey)}decryptMessage(e){if(!this.otherPublicKey)throw new Error("decryptMessage: Keys not exchanged - missing otherPubKey");return this.myECIES.decrypt(e)}getKeyInfo(){return{ecies:Object.assign(Object.assign({},this.myECIES.getKeyInfo()),{otherPubKey:this.otherPublicKey}),step:this.step,keysExchanged:this.areKeysExchanged()}}toString(){const e={keyInfo:this.getKeyInfo(),keysExchanged:this.keysExchanged,step:this.step};return JSON.stringify(e)}}(function(t){t.TERMINATE="terminate",t.ANSWER="answer",t.OFFER="offer",t.CANDIDATE="candidate",t.JSONRPC="jsonrpc",t.WALLET_INFO="wallet_info",t.WALLET_INIT="wallet_init",t.ORIGINATOR_INFO="originator_info",t.PAUSE="pause",t.OTP="otp",t.AUTHORIZED="authorized",t.PING="ping",t.READY="ready"})(ze||(ze={})),function(t){t.REQUEST="sdk_connect_request_started",t.REQUEST_MOBILE="sdk_connect_request_started_mobile",t.RECONNECT="sdk_reconnect_request_started",t.CONNECTED="sdk_connection_established",t.CONNECTED_MOBILE="sdk_connection_established_mobile",t.AUTHORIZED="sdk_connection_authorized",t.REJECTED="sdk_connection_rejected",t.TERMINATED="sdk_connection_terminated",t.DISCONNECTED="sdk_disconnected",t.SDK_USE_EXTENSION="sdk_use_extension",t.SDK_RPC_REQUEST="sdk_rpc_request",t.SDK_RPC_REQUEST_RECEIVED="sdk_rpc_request_received",t.SDK_RPC_REQUEST_DONE="sdk_rpc_request_done",t.SDK_EXTENSION_UTILIZED="sdk_extension_utilized",t.SDK_USE_INAPP_BROWSER="sdk_use_inapp_browser"}(tt||(tt={}));const Ea=(t,e,n)=>X(void 0,void 0,void 0,function*(){var r,i,s,o,a,c;const{remote:l,state:u}=t,{channelId:d,isOriginator:h}=u;if(e==="error_terminated")return W.SocketService(`handleJoinChannelResults: Channel ${d} terminated`),void t.emit(re.TERMINATE);if(!n)return void W.SocketService(`handleJoinChannelResults: No result for channel ${d}`);const{persistence:f,walletKey:g,rejected:p}=n;if(W.SocketService(`handleJoinChannelResults: Channel ${d} persistence=${f} walletKey=${g} rejected=${p}`),p)return W.SocketService(`handleJoinChannelResults: Channel ${d} rejected`),yield t.remote.disconnect({terminate:!0}),t.remote.emit(re.REJECTED,{channelId:d}),void t.remote.emitServiceStatusEvent();if(g&&!(!((r=l.state.channelConfig)===null||r===void 0)&&r.otherKey)){t.getKeyExchange().setOtherPublicKey(g),(i=t.state.keyExchange)===null||i===void 0||i.setKeysExchanged(!0),l.state.ready=!0,l.state.authorized=!0,l.emit(re.AUTHORIZED);const{communicationLayer:y,storageManager:m}=l.state,C=Object.assign(Object.assign({},l.state.channelConfig),{channelId:(s=l.state.channelId)!==null&&s!==void 0?s:"",validUntil:Date.now()+ss,localKey:y?.getKeyInfo().ecies.private,otherKey:g});t.sendMessage({type:Be.KEY_HANDSHAKE_ACK}).catch(v=>{}),(o=t.state.socket)===null||o===void 0||o.emit(ze.PING,{id:d,clientType:h?"dapp":"wallet",context:"on_channel_reconnect",message:""}),yield m?.persistChannelConfig(C),l.emitServiceStatusEvent(),l.setConnectionStatus(mt.LINKED)}f&&(t.emit(re.CHANNEL_PERSISTENCE),(a=t.state.keyExchange)===null||a===void 0||a.setKeysExchanged(!0),l.state.ready=!0,l.state.authorized=!0,l.emit(re.AUTHORIZED),ar(Object.assign(Object.assign({id:d??"",event:h?tt.CONNECTED:tt.CONNECTED_MOBILE},t.remote.state.originatorInfo),{sdkVersion:t.remote.state.sdkVersion,commLayer:t.state.communicationLayerPreference,commLayerVersion:$r.version,walletVersion:(c=t.remote.state.walletInfo)===null||c===void 0?void 0:c.version}),u.communicationServerUrl).catch(y=>{}))}),Ji=t=>new Promise(e=>{setTimeout(e,t)}),kf=(t,e,...n)=>X(void 0,[t,e,...n],void 0,function*(r,i,s=200){let o;const a=Date.now();let c=!1;for(;!c;){if(c=Date.now()-a>3e5,o=i[r],o.elapsedTime!==void 0)return o;yield Ji(s)}throw new Error(`RPC ${r} timed out`)}),xu=t=>X(void 0,void 0,void 0,function*(){const{state:e}=t,{socket:n,channelId:r,context:i,isOriginator:s,isReconnecting:o}=e;if(o)return W.SocketService("[SocketService: reconnectSocket()] Reconnection already in progress, skipping",t),!1;if(!n)return W.SocketService("[SocketService: reconnectSocket()] socket is not defined",t),!1;if(!r)return!1;const{connected:a}=n;e.isReconnecting=!0,e.reconnectionAttempts=0,W.SocketService(`[SocketService: reconnectSocket()] connected=${a} trying to reconnect after socketio disconnection`,t);try{for(;3>e.reconnectionAttempts;){if(W.SocketService(`[SocketService: reconnectSocket()] Attempt ${e.reconnectionAttempts+1} of 3`,t),yield Ji(200),n.connected)return W.SocketService("Socket already connected --- ping to retrieve messages"),n.emit(ze.PING,{id:r,clientType:s?"dapp":"wallet",context:"on_channel_config",message:""}),!0;e.resumed=!0,n.connect(),t.emit(re.SOCKET_RECONNECT);try{if(yield new Promise((c,l)=>{n.emit(re.JOIN_CHANNEL,{channelId:r,context:`${i}connect_again`,clientType:s?"dapp":"wallet"},(u,d)=>X(void 0,void 0,void 0,function*(){try{yield Ea(t,u,d),c()}catch(h){l(h)}}))}),yield Ji(100),n.connected)return W.SocketService(`Reconnection successful on attempt ${e.reconnectionAttempts+1}`),!0}catch(c){W.SocketService(`Error during reconnection attempt ${e.reconnectionAttempts+1}:`,c)}e.reconnectionAttempts+=1,3>e.reconnectionAttempts&&(yield Ji(200))}return W.SocketService("Failed to reconnect after 3 attempts"),!1}finally{e.isReconnecting=!1,e.reconnectionAttempts=0}});function Wm(t,e){return X(this,void 0,void 0,function*(){var n;const r=(n=t.state.keyExchange)===null||n===void 0?void 0:n.encryptMessage(JSON.stringify(e)),i={id:t.state.channelId,context:t.state.context,clientType:t.state.isOriginator?"dapp":"wallet",message:r,plaintext:t.state.hasPlaintext?JSON.stringify(e):void 0};return W.SocketService(`[SocketService: encryptAndSendMessage()] context=${t.state.context}`,i),e.type===ze.TERMINATE&&(t.state.manualDisconnect=!0),new Promise((s,o)=>{var a;(a=t.state.socket)===null||a===void 0||a.emit(re.MESSAGE,i,(c,l)=>{var u;c&&(W.SocketService(`[SocketService: encryptAndSendMessage()] error=${c}`),o(c)),W.SocketService("[encryptAndSendMessage] response",l),s((u=l?.success)!==null&&u!==void 0&&u)})})})}var ji;(function(t){t.RPC_CHECK="rpcCheck",t.SKIPPED_RPC="skippedRpc"})(ji||(ji={}));const Qm=["eth_sendTransaction","eth_signTypedData","eth_signTransaction","personal_sign","wallet_requestPermissions","wallet_switchEthereumChain","eth_signTypedData_v3","eth_signTypedData_v4","metamask_connectSign","metamask_connectWith","metamask_batch"].map(t=>t.toLowerCase()),TE=[{event:re.CLIENTS_CONNECTED,handler:function(t,e){return n=>X(this,void 0,void 0,function*(){var r,i,s,o,a,c,l,u,d,h,f;const g=(i=(r=t.remote.state.channelConfig)===null||r===void 0?void 0:r.relayPersistence)!==null&&i!==void 0&&i;if(W.SocketService(`[SocketService: handleClientsConnected()] context=${t.state.context} on 'clients_connected-${e}' relayPersistence=${g} resumed=${t.state.resumed}  clientsPaused=${t.state.clientsPaused} keysExchanged=${(s=t.state.keyExchange)===null||s===void 0?void 0:s.areKeysExchanged()} isOriginator=${t.state.isOriginator}`),t.emit(re.CLIENTS_CONNECTED,{isOriginator:t.state.isOriginator,keysExchanged:(o=t.state.keyExchange)===null||o===void 0?void 0:o.areKeysExchanged(),context:t.state.context}),t.state.resumed)t.state.isOriginator||(W.SocketService(`[SocketService: handleClientsConnected()] context=${t.state.context} 'clients_connected' / keysExchanged=${(a=t.state.keyExchange)===null||a===void 0?void 0:a.areKeysExchanged()} -- backward compatibility`),(c=t.state.keyExchange)===null||c===void 0||c.start({isOriginator:(l=t.state.isOriginator)!==null&&l!==void 0&&l})),t.state.resumed=!1;else if(t.state.clientsPaused)W.SocketService("[SocketService: handleClientsConnected()] 'clients_connected' skip sending originatorInfo on pause");else if(!t.state.isOriginator){const p=!g;W.SocketService(`[SocketService: handleClientsConnected()] context=${t.state.context} on 'clients_connected' / keysExchanged=${(u=t.state.keyExchange)===null||u===void 0?void 0:u.areKeysExchanged()} -- force=${p} -- backward compatibility`),W.SocketService(`[SocketService: handleClientsConnected()] context=${t.state.context} on 'clients_connected' / keysExchanged=${(d=t.state.keyExchange)===null||d===void 0?void 0:d.areKeysExchanged()} -- force=${p} -- backward compatibility`),(h=t.state.keyExchange)===null||h===void 0||h.start({isOriginator:(f=t.state.isOriginator)!==null&&f!==void 0&&f,force:p})}t.state.clientsConnected=!0,t.state.clientsPaused=!1})}},{event:re.CHANNEL_CREATED,handler:function(t,e){return n=>{W.SocketService(`[SocketService: handleChannelCreated()] context=${t.state.context} on 'channel_created-${e}'`,n),t.emit(re.CHANNEL_CREATED,n)}}},{event:re.CLIENTS_DISCONNECTED,handler:function(t,e){return()=>{var n;t.state.clientsConnected=!1,W.SocketService(`[SocketService: handlesClientsDisconnected()] context=${t.state.context} on 'clients_disconnected-${e}'`),t.remote.state.relayPersistence?W.SocketService(`[SocketService: handlesClientsDisconnected()] context=${t.state.context} on 'clients_disconnected-${e}' - relayPersistence enabled, skipping key exchange cleanup.`):(t.state.isOriginator&&!t.state.clientsPaused&&((n=t.state.keyExchange)===null||n===void 0||n.clean()),t.emit(re.CLIENTS_DISCONNECTED,e))}}},{event:re.CONFIG,handler:function(t,e){return n=>X(this,void 0,void 0,function*(){var r,i,s;W.SocketService(`[SocketService: handleChannelConfig()] update relayPersistence on 'config-${e}'`,n);const{persistence:o,walletKey:a}=n;t.state.isOriginator&&t.remote.state.channelConfig?(n.walletKey&&!t.remote.state.channelConfig.otherKey&&(W.SocketService(`Setting wallet key ${a}`),t.remote.state.channelConfig.otherKey=a,t.getKeyExchange().setOtherPublicKey(n.walletKey),(r=t.state.keyExchange)===null||r===void 0||r.setKeysExchanged(!0),yield t.remote.sendMessage({type:Be.KEY_HANDSHAKE_ACK}),yield t.remote.sendMessage({type:ze.PING}),yield(i=t.remote.state.storageManager)===null||i===void 0?void 0:i.persistChannelConfig(t.remote.state.channelConfig)),o!==!0||t.remote.state.channelConfig.relayPersistence||(W.SocketService(`Setting relay persistence ${o}`),t.remote.state.channelConfig.relayPersistence=o,t.remote.state.relayPersistence=!0,t.remote.emit(re.CHANNEL_PERSISTENCE),t.remote.state.authorized=!0,t.remote.state.ready=!0,t.remote.emit(re.AUTHORIZED),yield(s=t.remote.state.storageManager)===null||s===void 0?void 0:s.persistChannelConfig(t.remote.state.channelConfig))):t.state.isOriginator||n.persistence&&(t.remote.state.relayPersistence=!0,t.remote.emit(re.CHANNEL_PERSISTENCE))})}},{event:re.MESSAGE,handler:function(t,e){return n=>{var r,i,s,o,a,c,l,u,d,h,f,g,p,y,m,C,v,I;const{ackId:R,message:L,error:z}=n,j=(r=t.remote.state.relayPersistence)!==null&&r!==void 0&&r;if(W.SocketService(`[SocketService handleMessage()]  relayPersistence=${j}  context=${t.state.context} on 'message' ${e} keysExchanged=${(i=t.state.keyExchange)===null||i===void 0?void 0:i.areKeysExchanged()}`,n),z)throw W.SocketService(`
      [SocketService handleMessage()] context=${t.state.context}::on 'message' error=${z}`),new Error(z);const D=typeof L=="string";if(!D&&L?.type===Be.KEY_HANDSHAKE_START)return j?void 0:(W.SocketService(`[SocketService handleMessage()] context=${t.state.context}::on 'message' received HANDSHAKE_START isOriginator=${t.state.isOriginator}`,L),void((s=t.state.keyExchange)===null||s===void 0||s.start({isOriginator:(o=t.state.isOriginator)!==null&&o!==void 0&&o,force:!0})));if(!D&&(!((a=L?.type)===null||a===void 0)&&a.startsWith("key_handshake")))return j?void 0:(W.SocketService(`[SocketService handleMessage()] context=${t.state.context}::on 'message' emit KEY_EXCHANGE`,L),void t.emit(qa.KEY_EXCHANGE,{message:L,context:t.state.context}));if(D&&!(!((c=t.state.keyExchange)===null||c===void 0)&&c.areKeysExchanged())){let U=!1;try{W.SocketService(`[SocketService handleMessage()] context=${t.state.context}::on 'message' trying to decrypt message`),(l=t.state.keyExchange)===null||l===void 0||l.decryptMessage(L),U=!0}catch(M){W.SocketService(`[SocketService handleMessage()] context=${t.state.context}::on 'message' error`,M)}if(!U)return t.state.isOriginator?(d=t.state.keyExchange)===null||d===void 0||d.start({isOriginator:(h=t.state.isOriginator)!==null&&h!==void 0&&h}):t.sendMessage({type:Be.KEY_HANDSHAKE_START}).catch(M=>{}),void W.SocketService(`Message ignored because invalid key exchange status. step=${(f=t.state.keyExchange)===null||f===void 0?void 0:f.getKeyInfo().step}`,(g=t.state.keyExchange)===null||g===void 0?void 0:g.getKeyInfo(),L);W.SocketService("Invalid key exchange status detected --- updating it."),(u=t.state.keyExchange)===null||u===void 0||u.setKeysExchanged(!0)}else if(!D&&L?.type)return void t.emit(re.MESSAGE,L);if(!D)return void t.emit(re.MESSAGE,L);const B=(p=t.state.keyExchange)===null||p===void 0?void 0:p.decryptMessage(L),$=JSON.parse(B??"{}");if(R&&R?.length>0&&(W.SocketService(`[SocketService handleMessage()] context=${t.state.context}::on 'message' ackid=${R} channelId=${e}`),(y=t.state.socket)===null||y===void 0||y.emit(re.MESSAGE_ACK,{ackId:R,channelId:e,clientType:t.state.isOriginator?"dapp":"wallet"})),t.state.clientsPaused=$?.type===ze.PAUSE,t.state.isOriginator&&$.data){const U=$.data,M=t.state.rpcMethodTracker[U.id];if(M){const O=Date.now()-M.timestamp;W.SocketService(`[SocketService handleMessage()] context=${t.state.context}::on 'message' received answer for id=${U.id} method=${M.method} responseTime=${O}`,$),t.remote.state.analytics&&Qm.includes(M.method.toLowerCase())&&ar(Object.assign(Object.assign({id:(m=t.remote.state.channelId)!==null&&m!==void 0?m:"",event:tt.SDK_RPC_REQUEST_DONE,sdkVersion:t.remote.state.sdkVersion,commLayerVersion:$r.version},t.remote.state.originatorInfo),{walletVersion:(C=t.remote.state.walletInfo)===null||C===void 0?void 0:C.version,params:{method:M.method,from:"mobile"}}),t.remote.state.communicationServerUrl).catch(T=>{}),Eo(M.method)&&Ze.analytics.track(U.error?U.error.code===4001?"sdk_action_rejected":"sdk_action_failed":"sdk_action_succeeded",{action:M.method});const A=Object.assign(Object.assign({},M),{result:U.result,error:U.error?{code:(v=U.error)===null||v===void 0?void 0:v.code,message:(I=U.error)===null||I===void 0?void 0:I.message}:void 0,elapsedTime:O});t.state.rpcMethodTracker[U.id]=A,t.emit(re.RPC_UPDATE,A)}}t.emit(re.MESSAGE,{message:$})}}},{event:re.REJECTED,handler:function(t,e){return n=>X(this,void 0,void 0,function*(){var r;t.state.isOriginator&&!t.remote.state.ready?(W.SocketService(`[SocketService: handleChannelRejected()] context=${t.state.context} channelId=${e} isOriginator=${t.state.isOriginator} ready=${t.remote.state.ready}`,t.remote.state.originatorInfo),ar(Object.assign(Object.assign({id:e,event:tt.REJECTED},t.remote.state.originatorInfo),{sdkVersion:t.remote.state.sdkVersion,commLayer:t.state.communicationLayerPreference,commLayerVersion:$r.version,walletVersion:(r=t.remote.state.walletInfo)===null||r===void 0?void 0:r.version}),t.remote.state.communicationServerUrl).catch(i=>{}),Ze.analytics.track("sdk_connection_rejected",{transport_type:"websocket"}),yield t.remote.disconnect({terminate:!0}),t.remote.emit(re.REJECTED,{channelId:e}),t.remote.setConnectionStatus(mt.DISCONNECTED)):W.SocketService(`[SocketService: handleChannelRejected()] SKIP -- channelId=${e} isOriginator=${t.state.isOriginator} ready=${t.remote.state.ready}`)})}},{event:"clients_waiting_to_join",handler:function(t,e){return n=>{W.SocketService(`[SocketService: handleClientsWaitingToJoin()] context=${t.state.context} on 'clients_waiting_to_join-${e}'`,n),t.emit(re.CLIENTS_WAITING,n)}}}],IE=[{event:re.KEY_INFO,handler:function(t){return e=>{W.SocketService("[SocketService: handleKeyInfo()] on 'KEY_INFO'",e),t.emit(re.KEY_INFO,e)}}},{event:re.KEYS_EXCHANGED,handler:function(t){return()=>{var e,n,r;W.SocketService(`[SocketService: handleKeysExchanged()] on 'keys_exchanged' keyschanged=${(e=t.state.keyExchange)===null||e===void 0?void 0:e.areKeysExchanged()}`);const{channelConfig:i}=t.remote.state;if(i){const o=t.getKeyExchange().getKeyInfo().ecies;i.localKey=o.private,i.otherKey=o.otherPubKey,t.remote.state.channelConfig=i,(n=t.remote.state.storageManager)===null||n===void 0||n.persistChannelConfig(i).catch(a=>{})}t.emit(re.KEYS_EXCHANGED,{keysExchanged:(r=t.state.keyExchange)===null||r===void 0?void 0:r.areKeysExchanged(),isOriginator:t.state.isOriginator});const s={keyInfo:t.getKeyInfo()};t.emit(re.SERVICE_STATUS,s)}}}];function Pf(t,e){W.SocketService(`[SocketService: setupChannelListener()] context=${t.state.context} setting socket listeners for channel ${e}...`);const{socket:n}=t.state,{keyExchange:r}=t.state;n&&t.state.isOriginator&&(t.state.debug&&(n?.io.on("error",i=>{W.SocketService(`[SocketService: setupChannelListener()] context=${t.state.context} socket event=error`,i)}),n?.io.on("reconnect",i=>{W.SocketService(`[SocketService: setupChannelListener()] context=${t.state.context} socket event=reconnect`,i),xu(t).catch(s=>{})}),n?.io.on("reconnect_error",i=>{W.SocketService(`[SocketService: setupChannelListener()] context=${t.state.context} socket event=reconnect_error`,i)}),n?.io.on("reconnect_failed",()=>{W.SocketService(`[SocketService: setupChannelListener()] context=${t.state.context} socket event=reconnect_failed`)})),n?.on("disconnect",i=>(W.SocketService(`[SocketService: setupChannelListener()] on 'disconnect' -- MetaMaskSDK socket disconnected '${i}' begin recovery...`),function(s){return o=>{W.SocketService(`[SocketService: handleDisconnect()] on 'disconnect' manualDisconnect=${s.state.manualDisconnect}`,o),s.state.manualDisconnect||(s.emit(re.SOCKET_DISCONNECTED),xu(s).catch(a=>{}))}}(t)(i)))),TE.forEach(({event:i,handler:s})=>{n?.on(`${i}-${e}`,s(t,e))}),IE.forEach(({event:i,handler:s})=>{r?.on(i,s(t))}),t.state.setupChannelListeners=!0}class OE extends vc.EventEmitter2{constructor(e){super(),this.state={clientsConnected:!1,clientsPaused:!1,manualDisconnect:!1,lastRpcId:void 0,rpcMethodTracker:{},hasPlaintext:!1,communicationServerUrl:"",focusListenerAdded:!1,removeFocusListener:void 0,isReconnecting:!1,reconnectionAttempts:0},this.options=e;const{reconnect:n,communicationLayerPreference:r,communicationServerUrl:i,context:s,remote:o,logging:a}=e;this.state.resumed=n,this.state.context=s,this.state.isOriginator=o.state.isOriginator,this.state.communicationLayerPreference=r,this.state.debug=a?.serviceLayer===!0,this.remote=o,a?.serviceLayer===!0&&Tt.enable("SocketService:Layer"),this.state.communicationServerUrl=i,this.state.hasPlaintext=this.state.communicationServerUrl!==is&&a?.plaintext===!0,W.SocketService(`[SocketService: constructor()] Socket IO url: ${this.state.communicationServerUrl}`),this.initSocket()}initSocket(){var e;const{otherPublicKey:n,ecies:r,logging:i}=this.options,s={autoConnect:!1,transports:_E,withCredentials:!0},o=this.state.communicationServerUrl;W.SocketService(`[SocketService: initSocket()] Socket IO url: ${o}`),this.state.socket=ya(o,s),function(c){if(typeof window<"u"&&typeof document<"u"&&(W.SocketService(`[SocketService: setupSocketFocusListener()] hasFocus=${document.hasFocus()}`,c),!c.state.focusListenerAdded)){const l=()=>{W.SocketService("Document has focus --- reconnecting socket"),xu(c).catch(u=>{})};window.addEventListener("focus",l),c.state.focusListenerAdded=!0,c.state.removeFocusListener=()=>{window.removeEventListener("focus",l),c.state.focusListenerAdded=!1}}}(this);const a={communicationLayer:this,otherPublicKey:n,sendPublicKey:!1,context:(e=this.state.context)!==null&&e!==void 0?e:"",ecies:r,logging:i};this.state.keyExchange=new PE(a)}resetKeys(){return W.SocketService("[SocketService: resetKeys()] Resetting keys."),void((e=this.state.keyExchange)===null||e===void 0||e.resetKeys());var e}createChannel(){return X(this,void 0,void 0,function*(){return function(e){return X(this,void 0,void 0,function*(){var n,r,i;if(W.SocketService(`[SocketService: createChannel()] context=${e.state.context}`),e.state.socket||e.initSocket(),(n=e.state.socket)===null||n===void 0?void 0:n.connected)throw new Error("socket already connected");(r=e.state.socket)===null||r===void 0||r.connect(),e.state.manualDisconnect=!1,e.state.isOriginator=!0;const s=Nr();e.state.channelId=s,Pf(e,s),yield new Promise((a,c)=>{var l;(l=e.state.socket)===null||l===void 0||l.emit(re.JOIN_CHANNEL,{channelId:s,context:`${e.state.context}createChannel`,clientType:"dapp"},(u,d)=>X(this,void 0,void 0,function*(){try{yield Ea(e,u,d),a()}catch(h){c(h)}}))});const o=(i=e.state.keyExchange)===null||i===void 0?void 0:i.getKeyInfo();return{channelId:s,pubKey:o?.ecies.public||"",privKey:o?.ecies.private||""}})}(this)})}connectToChannel({channelId:e,withKeyExchange:n=!1,authorized:r}){return function(i){return X(this,arguments,void 0,function*({options:s,instance:o}){const{channelId:a,authorized:c,withKeyExchange:l}=s,{state:u,remote:d}=o,{isOriginator:h=!1,socket:f,keyExchange:g}=u,{channelConfig:p}=d.state;if(f?.connected)throw new Error("socket already connected");if(h&&p?.relayPersistence){const{localKey:y,otherKey:m}=p;y&&m&&g?.setRelayPersistence({localKey:y,otherKey:m})}return Object.assign(u,{manualDisconnect:!1,withKeyExchange:l,isOriginator:h,channelId:a}),f?.connect(),Pf(o,a),!h&&c&&(g?.setKeysExchanged(!0),Object.assign(d.state,{ready:!0,authorized:!0})),new Promise(y=>{var m;const C=(m=g?.getKeyInfo())===null||m===void 0?void 0:m.ecies.public;f?.emit(re.JOIN_CHANNEL,{channelId:a,context:`${u.context}_connectToChannel`,clientType:h?"dapp":"wallet",publicKey:c&&!h?C:void 0},(v,I)=>X(this,void 0,void 0,function*(){yield Ea(o,v,I),y()}))})})}({options:{channelId:e,withKeyExchange:n,authorized:r},instance:this})}getKeyInfo(){return this.state.keyExchange.getKeyInfo()}keyCheck(){var e,n;(n=(e=this).state.socket)===null||n===void 0||n.emit(re.MESSAGE,{id:e.state.channelId,context:e.state.context,message:{type:Be.KEY_HANDSHAKE_CHECK,pubkey:e.getKeyInfo().ecies.otherPubKey}})}getKeyExchange(){return this.state.keyExchange}sendMessage(e){return X(this,void 0,void 0,function*(){return function(n,r){return X(this,void 0,void 0,function*(){var i,s,o;if(!n.state.channelId)throw W.SocketService("handleSendMessage: no channelId - Create a channel first"),new Error("Create a channel first");if(W.SocketService(`[SocketService: handleSendMessage()] context=${n.state.context} areKeysExchanged=${(i=n.state.keyExchange)===null||i===void 0?void 0:i.areKeysExchanged()}`,r),(s=r?.type)===null||s===void 0?void 0:s.startsWith("key_handshake"))return function(c,l){var u;W.SocketService(`[SocketService: handleKeyHandshake()] context=${c.state.context}`,l),(u=c.state.socket)===null||u===void 0||u.emit(re.MESSAGE,{id:c.state.channelId,context:c.state.context,clientType:c.state.isOriginator?"dapp":"wallet",message:l})}(n,r),!0;(function(c,l){var u;if(!(!((u=c.state.keyExchange)===null||u===void 0)&&u.areKeysExchanged())&&!c.remote.state.relayPersistence)throw W.SocketService(`[SocketService: validateKeyExchange()] context=${c.state.context} ERROR keys not exchanged`,l),new Error("Keys not exchanged BBB")})(n,r),function(c,l){var u;const d=(u=l?.method)!==null&&u!==void 0?u:"",h=l?.id;c.state.isOriginator&&h&&(c.state.rpcMethodTracker[h]={id:h,timestamp:Date.now(),method:d},c.emit(re.RPC_UPDATE,c.state.rpcMethodTracker[h]))}(n,r);const a=yield Wm(n,r);return n.remote.state.analytics&&n.remote.state.isOriginator&&r.method&&Qm.includes(r.method.toLowerCase())&&ar({id:(o=n.remote.state.channelId)!==null&&o!==void 0?o:"",event:tt.SDK_RPC_REQUEST,params:{method:r.method,from:"mobile"}},n.remote.state.communicationServerUrl).catch(c=>{}),n.remote.state.isOriginator&&r.method&&Eo(r.method)&&Ze.analytics.track("sdk_action_requested",{action:r.method}),function(c,l){return X(this,void 0,void 0,function*(){var u;const d=l?.id,h=(u=l?.method)!==null&&u!==void 0?u:"";if(c.state.isOriginator&&d)try{const f=kf(d,c.state.rpcMethodTracker,200).then(y=>({type:ji.RPC_CHECK,result:y})),g=X(this,void 0,void 0,function*(){const y=yield(C=>X(void 0,[C],void 0,function*({rpcId:v,instance:I}){for(;I.state.lastRpcId===v||I.state.lastRpcId===void 0;)yield Ji(200);return I.state.lastRpcId}))({instance:c,rpcId:d}),m=yield kf(y,c.state.rpcMethodTracker,200);return{type:ji.SKIPPED_RPC,result:m}}),p=yield Promise.race([f,g]);if(p.type===ji.RPC_CHECK){const y=p.result;W.SocketService(`[SocketService:handleRpcReplies()] id=${l.id} ${h} ( ${y.elapsedTime} ms)`,y.result)}else{if(p.type!==ji.SKIPPED_RPC)throw new Error(`Error handling RPC replies for ${d}`);{const y=Object.assign(Object.assign({},c.state.rpcMethodTracker[d]),{error:new Error("SDK_CONNECTION_ISSUE")});c.emit(re.RPC_UPDATE,y);const m={data:Object.assign(Object.assign({},y),{jsonrpc:"2.0"}),name:"metamask-provider"};c.emit(re.MESSAGE,{message:m})}}}catch(f){throw f}})}(n,r).catch(c=>{}),a})}(this,e)})}ping(){return function(e){return X(this,void 0,void 0,function*(){var n,r;W.SocketService(`[SocketService: ping()] context=${e.state.context} originator=${e.state.isOriginator} keysExchanged=${(n=e.state.keyExchange)===null||n===void 0?void 0:n.areKeysExchanged()}`),(r=e.state.socket)===null||r===void 0||r.emit(ze.PING,{id:e.state.channelId,context:"ping",clientType:e.remote.state.isOriginator?"dapp":"wallet",message:""})})}(this)}pause(){return function(e){return X(this,void 0,void 0,function*(){var n,r;W.SocketService(`[SocketService: pause()] context=${e.state.context}`),e.state.manualDisconnect=!0,!((n=e.state.keyExchange)===null||n===void 0)&&n.areKeysExchanged()&&(yield e.sendMessage({type:ze.PAUSE})),(r=e.state.socket)===null||r===void 0||r.disconnect()})}(this)}isConnected(){var e;return(e=this.state.socket)===null||e===void 0?void 0:e.connected}resume(){return function(e){return X(this,void 0,void 0,function*(){const{state:n,remote:r}=e,{socket:i,channelId:s,context:o,keyExchange:a,isOriginator:c}=n,{isOriginator:l}=r.state;if(W.SocketService(`[SocketService: resume()] channelId=${s} context=${o} connected=${i?.connected} manualDisconnect=${n.manualDisconnect} resumed=${n.resumed} keysExchanged=${a?.areKeysExchanged()}`),!s)throw W.SocketService("[SocketService: resume()] channelId is not defined"),new Error("ChannelId is not defined");i?.connected?(W.SocketService("[SocketService: resume()] already connected."),i.emit(ze.PING,{id:s,clientType:l?"dapp":"wallet",context:"on_channel_config",message:""}),r.hasRelayPersistence()||a?.areKeysExchanged()||(c?yield e.sendMessage({type:ze.READY}):a?.start({isOriginator:!1}))):(i?.connect(),W.SocketService(`[SocketService: resume()] after connecting socket --> connected=${i?.connected}`),i?.emit(re.JOIN_CHANNEL,{channelId:s,context:`${o}_resume`,clientType:l?"dapp":"wallet"},(u,d)=>X(this,void 0,void 0,function*(){try{yield Ea(e,u,d)}catch{}}))),n.manualDisconnect=!1,n.resumed=!0})}(this)}getRPCMethodTracker(){return this.state.rpcMethodTracker}disconnect(e){return function(n,r){var i,s,o,a,c;W.SocketService(`[SocketService: disconnect()] context=${n.state.context}`,r),r?.terminate&&((s=(i=n.state).removeFocusListener)===null||s===void 0||s.call(i),n.state.channelId=r.channelId,(o=n.state.socket)===null||o===void 0||o.removeAllListeners(),(a=n.state.keyExchange)===null||a===void 0||a.clean(),n.remote.state.ready=!1,n.state.socket=void 0,n.state.rpcMethodTracker={}),n.state.manualDisconnect=!0,(c=n.state.socket)===null||c===void 0||c.disconnect()}(this,e)}}var gi,At,Tf;function RE(t){return()=>X(this,void 0,void 0,function*(){var e,n,r;const{state:i}=t;if(i.authorized)return;yield X(this,void 0,void 0,function*(){for(;!i.walletInfo;)yield Ji(500)});const s="7.3".localeCompare(((e=i.walletInfo)===null||e===void 0?void 0:e.version)||"");if(W.RemoteCommunication(`[RemoteCommunication: handleAuthorizedEvent()] HACK 'authorized' version=${(n=i.walletInfo)===null||n===void 0?void 0:n.version} compareValue=${s}`),s!==1)return;const o=i.platformType===At.MobileWeb||i.platformType===At.ReactNative||i.platformType===At.MetaMaskMobileWebview;W.RemoteCommunication(`[RemoteCommunication: handleAuthorizedEvent()] HACK 'authorized' platform=${i.platformType} secure=${o} channel=${i.channelId} walletVersion=${(r=i.walletInfo)===null||r===void 0?void 0:r.version}`),o&&(i.authorized=!0,t.emit(re.AUTHORIZED))})}function NE(t){return e=>{const{state:n}=t;W.RemoteCommunication(`[RemoteCommunication: handleChannelCreatedEvent()] context=${n.context} on 'channel_created' channelId=${e}`),t.emit(re.CHANNEL_CREATED,e)}}function ME(t,e){return()=>{var n,r,i,s;const{state:o}=t;W.RemoteCommunication(`[RemoteCommunication: handleClientsConnectedEvent()] on 'clients_connected' channel=${o.channelId} keysExchanged=${(r=(n=o.communicationLayer)===null||n===void 0?void 0:n.getKeyInfo())===null||r===void 0?void 0:r.keysExchanged}`),o.analytics&&ar(Object.assign(Object.assign({id:(i=o.channelId)!==null&&i!==void 0?i:"",event:o.reconnection?tt.RECONNECT:o.isOriginator?tt.REQUEST:tt.REQUEST_MOBILE},o.originatorInfo),{commLayer:e,sdkVersion:o.sdkVersion,walletVersion:(s=o.walletInfo)===null||s===void 0?void 0:s.version,commLayerVersion:$r.version}),o.communicationServerUrl).catch(a=>{}),o.isOriginator&&!o.reconnection&&Ze.analytics.track("sdk_connection_established",{transport_type:"websocket"}),o.clientsConnected=!0,o.originatorInfoSent=!1,t.emit(re.CLIENTS_CONNECTED)}}function BE(t){return e=>{const{state:n}=t;W.RemoteCommunication(`[RemoteCommunication: handleClientsDisconnectedEvent()] context=${n.context} on 'clients_disconnected' channelId=${e}`),n.relayPersistence||(n.clientsConnected=!1,n.ready=!1,n.authorized=!1),t.emit(re.CLIENTS_DISCONNECTED,n.channelId),t.setConnectionStatus(mt.DISCONNECTED)}}function LE(t){return e=>{var n;const{state:r}=t;if(W.RemoteCommunication(`[RemoteCommunication: handleClientsWaitingEvent()] context=${r.context} on 'clients_waiting' numberUsers=${e} ready=${r.ready} autoStarted=${r.originatorConnectStarted}`),t.setConnectionStatus(mt.WAITING),t.emit(re.CLIENTS_WAITING,e),r.originatorConnectStarted){W.RemoteCommunication(`[RemoteCommunication: handleClientsWaitingEvent()] on 'clients_waiting' watch autoStarted=${r.originatorConnectStarted} timeout`,r.autoConnectOptions);const i=((n=r.autoConnectOptions)===null||n===void 0?void 0:n.timeout)||3e3,s=setTimeout(()=>{W.RemoteCommunication(`[RemoteCommunication: handleClientsWaitingEvent()] setTimeout(${i}) terminate channelConfig`,r.autoConnectOptions),r.originatorConnectStarted=!1,r.ready||t.setConnectionStatus(mt.TIMEOUT),clearTimeout(s)},i)}}}function DE(t,e){return n=>{var r,i,s,o,a,c,l,u;const{state:d}=t;if(W.RemoteCommunication(`[RemoteCommunication: handleKeysExchangedEvent()] context=${d.context} on commLayer.'keys_exchanged' channel=${d.channelId}`,n),(i=(r=d.communicationLayer)===null||r===void 0?void 0:r.getKeyInfo())===null||i===void 0?void 0:i.keysExchanged){const h=Object.assign(Object.assign({},d.channelConfig),{channelId:(s=d.channelId)!==null&&s!==void 0?s:"",validUntil:((o=d.channelConfig)===null||o===void 0?void 0:o.validUntil)||ss,localKey:d.communicationLayer.getKeyInfo().ecies.private,otherKey:d.communicationLayer.getKeyInfo().ecies.otherPubKey});(a=d.storageManager)===null||a===void 0||a.persistChannelConfig(h).catch(f=>{}),t.setConnectionStatus(mt.LINKED)}(function(h,f){var g,p,y,m,C,v,I,R;const{state:L}=h;W.RemoteCommunication(`[RemoteCommunication: setLastActiveDate()] channel=${L.channelId}`,f);const z=Object.assign(Object.assign({},L.channelConfig),{channelId:(g=L.channelId)!==null&&g!==void 0?g:"",validUntil:(y=(p=L.channelConfig)===null||p===void 0?void 0:p.validUntil)!==null&&y!==void 0?y:0,relayPersistence:L.relayPersistence,localKey:(C=(m=L.communicationLayer)===null||m===void 0?void 0:m.state.keyExchange)===null||C===void 0?void 0:C.getKeyInfo().ecies.private,otherKey:(I=(v=L.communicationLayer)===null||v===void 0?void 0:v.state.keyExchange)===null||I===void 0?void 0:I.getKeyInfo().ecies.otherPubKey,lastActive:f.getTime()});(R=L.storageManager)===null||R===void 0||R.persistChannelConfig(z)})(t,new Date),d.analytics&&d.channelId&&ar(Object.assign(Object.assign({id:d.channelId,event:n.isOriginator?tt.CONNECTED:tt.CONNECTED_MOBILE},d.originatorInfo),{sdkVersion:d.sdkVersion,commLayer:e,commLayerVersion:$r.version,walletVersion:(c=d.walletInfo)===null||c===void 0?void 0:c.version}),d.communicationServerUrl).catch(h=>{}),d.isOriginator=n.isOriginator,n.isOriginator||((l=d.communicationLayer)===null||l===void 0||l.sendMessage({type:ze.READY}),d.ready=!0,d.paused=!1),n.isOriginator&&!d.originatorInfoSent&&((u=d.communicationLayer)===null||u===void 0||u.sendMessage({type:ze.ORIGINATOR_INFO,originatorInfo:d.originatorInfo,originator:d.originatorInfo}),d.originatorInfoSent=!0)}}function UE(t){return e=>{let n=e;e.message&&(n=n.message),function(r,i){const{state:s}=i;if(W.RemoteCommunication(`[RemoteCommunication: onCommunicationLayerMessage()] context=${s.context} on 'message' typeof=${typeof r}`,r),i.state.ready=!0,s.isOriginator||r.type!==ze.ORIGINATOR_INFO)if(s.isOriginator&&r.type===ze.WALLET_INFO)(function(o,a){const{state:c}=o;c.walletInfo=a.walletInfo,c.paused=!1})(i,r);else{if(s.isOriginator&&r.type===ze.WALLET_INIT)(function(o,a){return X(this,void 0,void 0,function*(){var c,l,u;const{state:d}=o;if(d.isOriginator){const h=a.data||{};if(typeof h=="object"&&"accounts"in h&&"chainId"in h&&"walletKey"in h)try{const{channelConfig:f}=o.state;if(W.RemoteCommunication("WALLET_INIT: channelConfig",JSON.stringify(f,null,2)),f){const g=h.accounts,p=h.chainId,y=h.walletKey;let m,C=!1;"deeplinkProtocol"in h&&(C=!!h.deeplinkProtocol,o.state.deeplinkProtocolAvailable=C),"walletVersion"in h&&(m=h.walletVersion),yield(c=o.state.storageManager)===null||c===void 0?void 0:c.persistChannelConfig(Object.assign(Object.assign({},f),{otherKey:y,walletVersion:m,deeplinkProtocolAvailable:C,relayPersistence:!0})),yield(l=o.state.storageManager)===null||l===void 0?void 0:l.persistAccounts(g),yield(u=o.state.storageManager)===null||u===void 0?void 0:u.persistChainId(p)}o.emit(re.WALLET_INIT,{accounts:h.accounts,chainId:h.chainId})}catch{}}})})(i,r).catch(o=>{W.RemoteCommunication(`[RemoteCommunication: onCommunicationLayerMessage()] error=${o}`)});else if(r.type===ze.TERMINATE)(function(o){return X(this,void 0,void 0,function*(){const{state:a}=o;a.isOriginator&&(yield Jm({options:{terminate:!0,sendMessage:!1},instance:o}),o.emit(re.TERMINATE))})})(i).catch(o=>{W.RemoteCommunication(`[RemoteCommunication: onCommunicationLayerMessage()] error=${o}`)});else if(r.type===ze.PAUSE)(function(o){const{state:a}=o;a.paused=!0,o.setConnectionStatus(mt.PAUSED)})(i);else if(r.type===ze.READY&&s.isOriginator)(function(o){const{state:a}=o;o.setConnectionStatus(mt.LINKED);const c=a.paused;a.paused=!1,o.emit(re.CLIENTS_READY,{isOriginator:a.isOriginator,walletInfo:a.walletInfo}),c&&(a.authorized=!0,o.emit(re.AUTHORIZED))})(i);else{if(r.type===ze.OTP&&s.isOriginator)return void function(o,a){var c;const{state:l}=o;o.emit(re.OTP,a.otpAnswer),"6.6".localeCompare(((c=l.walletInfo)===null||c===void 0?void 0:c.version)||"")===1&&o.emit(re.SDK_RPC_CALL,{method:vt.ETH_REQUESTACCOUNTS,params:[]})}(i,r);r.type===ze.AUTHORIZED&&s.isOriginator&&function(o){const{state:a}=o;a.authorized=!0,o.emit(re.AUTHORIZED)}(i)}i.emit(re.MESSAGE,r)}else(function(o,a){var c;const{state:l}=o;(c=l.communicationLayer)===null||c===void 0||c.sendMessage({type:ze.WALLET_INFO,walletInfo:l.walletInfo}),l.originatorInfo=a.originatorInfo||a.originator,o.emit(re.CLIENTS_READY,{isOriginator:l.isOriginator,originatorInfo:l.originatorInfo}),l.paused=!1})(i,r)}(n,t)}}function FE(t){return()=>{const{state:e}=t;W.RemoteCommunication("[RemoteCommunication: handleSocketReconnectEvent()] on 'socket_reconnect' -- reset key exchange status / set ready to false"),e.ready=!1,e.authorized=!1,qm(e),t.emitServiceStatusEvent({context:"socket_reconnect"})}}function HE(t){return()=>{const{state:e}=t;W.RemoteCommunication("[RemoteCommunication: handleSocketDisconnectedEvent()] on 'socket_Disconnected' set ready to false"),e.ready=!1}}function KE(t){return()=>X(this,void 0,void 0,function*(){var e,n,r,i,s,o,a;const{state:c}=t;W.RemoteCommunication(`[RemoteCommunication: handleFullPersistenceEvent()] context=${c.context}`),t.state.ready=!0,t.state.clientsConnected=!0,t.state.authorized=!0,t.state.relayPersistence=!0,(e=t.state.communicationLayer)===null||e===void 0||e.getKeyExchange().setKeysExchanged(!0),t.emit(re.KEYS_EXCHANGED,{keysExchanged:!0,isOriginator:!0}),t.emit(re.AUTHORIZED),t.emit(re.CLIENTS_READY),t.emit(re.CHANNEL_PERSISTENCE);try{c.channelConfig=Object.assign(Object.assign({},c.channelConfig),{localKey:(n=c.communicationLayer)===null||n===void 0?void 0:n.getKeyExchange().getKeyInfo().ecies.private,otherKey:(r=c.communicationLayer)===null||r===void 0?void 0:r.getKeyExchange().getOtherPublicKey(),channelId:(i=c.channelId)!==null&&i!==void 0?i:"",validUntil:(o=(s=c.channelConfig)===null||s===void 0?void 0:s.validUntil)!==null&&o!==void 0?o:ss,relayPersistence:!0}),yield(a=c.storageManager)===null||a===void 0?void 0:a.persistChannelConfig(c.channelConfig)}catch{}})}function If({communicationLayerPreference:t,otherPublicKey:e,reconnect:n,ecies:r,communicationServerUrl:i=is,instance:s}){var o,a,c,l,u,d,h,f,g,p,y;const{state:m}=s;if(W.RemoteCommunication("[initCommunicationLayer()] ",JSON.stringify(m,null,2)),t!==gi.SOCKET)throw new Error("Invalid communication protocol");m.communicationLayer=new OE({communicationLayerPreference:t,otherPublicKey:e,reconnect:n,transports:m.transports,communicationServerUrl:i,context:m.context,ecies:r,logging:m.logging,remote:s});let C=typeof document<"u"&&document.URL||"",v=typeof document<"u"&&document.title||"";!((o=m.dappMetadata)===null||o===void 0)&&o.url&&(C=m.dappMetadata.url),!((a=m.dappMetadata)===null||a===void 0)&&a.name&&(v=m.dappMetadata.name);const I=(d=(l=(c=m.dappMetadata)===null||c===void 0?void 0:c.name)!==null&&l!==void 0?l:(u=m.dappMetadata)===null||u===void 0?void 0:u.url)!==null&&d!==void 0?d:"N/A",R=typeof window<"u"&&window.location!==void 0&&(h=window.location.hostname)!==null&&h!==void 0?h:I,L={url:C,title:v,source:(f=m.dappMetadata)===null||f===void 0?void 0:f.source,dappId:R,anonId:m.anonId,icon:((g=m.dappMetadata)===null||g===void 0?void 0:g.iconUrl)||((p=m.dappMetadata)===null||p===void 0?void 0:p.base64Icon),platform:m.platformType,apiVersion:$r.version,connector:(y=m.dappMetadata)===null||y===void 0?void 0:y.connector};m.originatorInfo=L;const z={[re.AUTHORIZED]:RE(s),[re.MESSAGE]:UE(s),[re.CHANNEL_PERSISTENCE]:KE(s),[re.CLIENTS_CONNECTED]:ME(s,t),[re.KEYS_EXCHANGED]:DE(s,t),[re.SOCKET_DISCONNECTED]:HE(s),[re.SOCKET_RECONNECT]:FE(s),[re.CLIENTS_DISCONNECTED]:BE(s),[re.KEY_INFO]:()=>{},[re.CHANNEL_CREATED]:NE(s),[re.CLIENTS_WAITING]:LE(s),[re.RPC_UPDATE]:j=>{s.emit(re.RPC_UPDATE,j)}};for(const[j,D]of Object.entries(z))try{m.communicationLayer.on(j,D)}catch{}}function Jm(t){return X(this,arguments,void 0,function*({options:e,instance:n}){const{state:r}=n;return W.RemoteCommunication(`[RemoteCommunication: disconnect()] channel=${r.channelId}`,e),new Promise((i,s)=>{var o,a,c,l,u,d;e?.terminate?(n.state.ready&&ar({id:(o=n.state.channelId)!==null&&o!==void 0?o:"",event:tt.TERMINATED},n.state.communicationServerUrl).catch(h=>{}),r.ready=!1,r.paused=!1,(a=r.storageManager)===null||a===void 0||a.terminate((c=r.channelId)!==null&&c!==void 0?c:""),n.state.terminated=!0,e.sendMessage?!((l=r.communicationLayer)===null||l===void 0)&&l.getKeyInfo().keysExchanged&&n.state.communicationLayer&&Wm(n.state.communicationLayer,{type:ze.TERMINATE}).then(()=>{i(!0)}).catch(h=>{s(h)}):i(!0),r.authorized=!1,r.relayPersistence=!1,r.channelId=Nr(),e.channelId=r.channelId,r.channelConfig=void 0,r.originatorConnectStarted=!1,(u=r.communicationLayer)===null||u===void 0||u.disconnect(e),n.setConnectionStatus(mt.TERMINATED)):((d=r.communicationLayer)===null||d===void 0||d.disconnect(e),n.setConnectionStatus(mt.DISCONNECTED),i(!0))})})}(gi||(gi={})).SOCKET="socket",function(t){t.NonBrowser="nodejs",t.MetaMaskMobileWebview="in-app-browser",t.DesktopWeb="web-desktop",t.MobileWeb="web-mobile",t.ReactNative="react-native"}(At||(At={}));class $E extends vc.EventEmitter2{constructor(e){super(),this.state={ready:!1,anonId:"",authorized:!1,isOriginator:!1,terminated:!1,protocolVersion:1,paused:!1,deeplinkProtocolAvailable:!1,platformType:"metamask-mobile",analytics:!1,reconnection:!1,originatorInfoSent:!1,communicationServerUrl:is,context:"",persist:!1,clientsConnected:!1,sessionDuration:ss,originatorConnectStarted:!1,debug:!1,_connectionStatus:mt.DISCONNECTED},this._options=e;const{anonId:n,platformType:r,communicationLayerPreference:i,otherPublicKey:s,reconnect:o,walletInfo:a,dappMetadata:c,protocolVersion:l,transports:u,context:d,relayPersistence:h,ecies:f,analytics:g=!1,storage:p,sdkVersion:y,communicationServerUrl:m=is,logging:C,autoConnect:v={timeout:xE}}=e;this.state.anonId=n,this.state.otherPublicKey=s,this.state.dappMetadata=c,this.state.walletInfo=a,this.state.transports=u,this.state.platformType=r,this.state.analytics=g,this.state.protocolVersion=l??1,this.state.isOriginator=!s,this.state.relayPersistence=h,this.state.communicationServerUrl=m,this.state.context=d,this.state.terminated=!1,this.state.sdkVersion=y,this.setMaxListeners(50),this.setConnectionStatus(mt.DISCONNECTED),p?.duration&&(this.state.sessionDuration=ss),this.state.storageOptions=p,this.state.autoConnectOptions=v,this.state.debug=C?.remoteLayer===!0,C?.remoteLayer===!0&&Tt.enable("RemoteCommunication:Layer"),C?.serviceLayer===!0&&Tt.enable("SocketService:Layer"),C?.eciesLayer===!0&&Tt.enable("ECIES:Layer"),C?.keyExchangeLayer===!0&&Tt.enable("KeyExchange:Layer"),this.state.logging=C,p?.storageManager&&(this.state.storageManager=p.storageManager),W.RemoteCommunication(`[RemoteCommunication: constructor()] protocolVersion=${l} relayPersistence=${h} isOriginator=${this.state.isOriginator} communicationLayerPreference=${i} otherPublicKey=${s} reconnect=${o}`),this.state.isOriginator||If({communicationLayerPreference:i,otherPublicKey:s,reconnect:o,ecies:f,communicationServerUrl:m,instance:this}),this.emitServiceStatusEvent({context:"constructor"})}initFromDappStorage(){return X(this,void 0,void 0,function*(){var e;if(this.state.storageManager){const n=yield this.state.storageManager.getPersistedChannelConfig({});n&&(this.state.channelConfig=n,this.state.channelId=n.channelId,this.state.deeplinkProtocolAvailable=(e=n.deeplinkProtocolAvailable)!==null&&e!==void 0&&e,n.relayPersistence&&(this.state.authorized=!0,this.state.ready=!0,this.setConnectionStatus(mt.LINKED),yield this.connectToChannel({channelId:n.channelId})))}If({communicationLayerPreference:gi.SOCKET,otherPublicKey:this.state.otherPublicKey,reconnect:this._options.reconnect,ecies:this._options.ecies,communicationServerUrl:this.state.communicationServerUrl,instance:this})})}originatorSessionConnect(){return X(this,void 0,void 0,function*(){return yield function(e){return X(this,void 0,void 0,function*(){var n;const{state:r}=e;if(!r.storageManager)return void W.RemoteCommunication("[RemoteCommunication: originatorSessionConnect()] no storage manager defined - skip");const i=yield r.storageManager.getPersistedChannelConfig({});if(W.RemoteCommunication(`[RemoteCommunication: originatorSessionConnect()] autoStarted=${r.originatorConnectStarted} channelConfig`,i),(n=r.communicationLayer)===null||n===void 0?void 0:n.isConnected())return W.RemoteCommunication("[RemoteCommunication: originatorSessionConnect()] socket already connected - skip"),i;if(i){if(i.validUntil>Date.now())return r.channelConfig=i,r.originatorConnectStarted=!0,r.channelId=i?.channelId,r.reconnection=!0,i;W.RemoteCommunication("[RemoteCommunication: autoConnect()] Session has expired")}r.originatorConnectStarted=!1})}(this)})}generateChannelIdConnect(){return X(this,void 0,void 0,function*(){return function(e){return X(this,void 0,void 0,function*(){var n,r,i,s,o,a;if(!e.communicationLayer)throw new Error("communication layer not initialized");if(e.ready)throw new Error("Channel already connected");if(e.channelId&&(!((n=e.communicationLayer)===null||n===void 0)&&n.isConnected()))return e.channelConfig=Object.assign(Object.assign({},e.channelConfig),{channelId:e.channelId,validUntil:Date.now()+e.sessionDuration}),(r=e.storageManager)===null||r===void 0||r.persistChannelConfig(e.channelConfig),{channelId:e.channelId,privKey:(s=(i=e.communicationLayer)===null||i===void 0?void 0:i.getKeyInfo())===null||s===void 0?void 0:s.ecies.private,pubKey:(a=(o=e.communicationLayer)===null||o===void 0?void 0:o.getKeyInfo())===null||a===void 0?void 0:a.ecies.public};W.RemoteCommunication("[RemoteCommunication: generateChannelId()]");const c=yield e.communicationLayer.createChannel();W.RemoteCommunication("[RemoteCommunication: generateChannelId()] channel created",c);const l=Object.assign(Object.assign({},e.channelConfig),{channelId:c.channelId,localKey:c.privKey,validUntil:Date.now()+e.sessionDuration});return e.channelId=c.channelId,e.channelConfig=l,{channelId:e.channelId,pubKey:c.pubKey,privKey:c.privKey}})}(this.state)})}clean(){return qm(this.state)}connectToChannel({channelId:e,withKeyExchange:n,authorized:r}){return function(i){return X(this,arguments,void 0,function*({channelId:s,withKeyExchange:o,authorized:a,state:c}){var l,u,d;if(!cu(s))throw W.RemoteCommunication(`[RemoteCommunication: connectToChannel()] context=${c.context} invalid channel channelId=${s}`),new Error(`Invalid channel ${s}`);if(W.RemoteCommunication(`[RemoteCommunication: connectToChannel()] context=${c.context} channelId=${s} withKeyExchange=${o}`),(l=c.communicationLayer)===null||l===void 0?void 0:l.isConnected())return void W.RemoteCommunication(`[RemoteCommunication: connectToChannel()] context=${c.context} already connected - interrupt connection.`);c.channelId=s,yield(u=c.communicationLayer)===null||u===void 0?void 0:u.connectToChannel({channelId:s,authorized:a,withKeyExchange:o});const h=Object.assign(Object.assign({},c.channelConfig),{channelId:s,validUntil:Date.now()+c.sessionDuration});c.channelConfig=h,(d=c.storageManager)===null||d===void 0||d.persistChannelConfig(h)})}({channelId:e,authorized:r,withKeyExchange:n,state:this.state})}sendMessage(e){return X(this,void 0,void 0,function*(){const n=this.state.isOriginator&&e.method&&Eo(e.method);n&&Ze.analytics.track("sdk_action_requested",{action:e.method});try{return yield function(r,i){return X(this,void 0,void 0,function*(){var s,o;const{state:a}=r;W.RemoteCommunication(`[RemoteCommunication: sendMessage()] context=${a.context} paused=${a.paused} ready=${a.ready} relayPersistence=${a.relayPersistence} authorized=${a.authorized} socket=${(s=a.communicationLayer)===null||s===void 0?void 0:s.isConnected()} clientsConnected=${a.clientsConnected} status=${a._connectionStatus}`,i),a.relayPersistence||a.ready&&(!((o=a.communicationLayer)===null||o===void 0)&&o.isConnected())&&a.clientsConnected||(W.RemoteCommunication(`[RemoteCommunication: sendMessage()] context=${a.context}  SKIP message waiting for MM mobile readiness.`),yield new Promise(c=>{r.once(re.CLIENTS_READY,c)}),W.RemoteCommunication(`[RemoteCommunication: sendMessage()] context=${a.context}  AFTER SKIP / READY -- sending pending message`));try{return yield function(l,u){return X(this,void 0,void 0,function*(){return new Promise(d=>{var h;const{state:f}=l;W.RemoteCommunication(`[RemoteCommunication: handleAuthorization()] context=${f.context} ready=${f.ready} authorized=${f.authorized} method=${u.method}`),!f.isOriginator||f.authorized||f.relayPersistence?(h=f.communicationLayer)===null||h===void 0||h.sendMessage(u).then(g=>{d(g)}).catch(g=>{d(!1)}):l.once(re.AUTHORIZED,()=>{var g;W.RemoteCommunication(`[RemoteCommunication: handleAuthorization()] context=${f.context}  AFTER SKIP / AUTHORIZED -- sending pending message`),(g=f.communicationLayer)===null||g===void 0||g.sendMessage(u).then(p=>{d(p)}).catch(p=>{d(!1)})})})})}(r,i)}catch(c){throw c}})}(this,e)}catch(r){throw n&&Ze.analytics.track("sdk_action_failed",{action:e.method}),r}})}testStorage(){return X(this,void 0,void 0,function*(){return function(e){return X(this,void 0,void 0,function*(){var n;const r=yield(n=e.storageManager)===null||n===void 0?void 0:n.getPersistedChannelConfig();W.RemoteCommunication("[RemoteCommunication: testStorage()] res",r)})}(this.state)})}hasDeeplinkProtocol(){return this.state.deeplinkProtocolAvailable}getChannelConfig(){return this.state.channelConfig}isReady(){return this.state.ready}isConnected(){var e;return(e=this.state.communicationLayer)===null||e===void 0?void 0:e.isConnected()}isAuthorized(){return this.state.authorized}isPaused(){return this.state.paused}getCommunicationLayer(){return this.state.communicationLayer}ping(){return X(this,void 0,void 0,function*(){var e;W.RemoteCommunication(`[RemoteCommunication: ping()] channel=${this.state.channelId}`),yield(e=this.state.communicationLayer)===null||e===void 0?void 0:e.ping()})}testLogger(){W.RemoteCommunication(`testLogger() channel=${this.state.channelId}`),W.SocketService(`testLogger() channel=${this.state.channelId}`),W.Ecies(`testLogger() channel=${this.state.channelId}`),W.KeyExchange(`testLogger() channel=${this.state.channelId}`)}keyCheck(){var e;W.RemoteCommunication(`[RemoteCommunication: keyCheck()] channel=${this.state.channelId}`),(e=this.state.communicationLayer)===null||e===void 0||e.keyCheck()}setConnectionStatus(e){this.state._connectionStatus!==e&&(this.state._connectionStatus=e,this.emit(re.CONNECTION_STATUS,e),this.emitServiceStatusEvent({context:"setConnectionStatus"}))}emitServiceStatusEvent(e={}){this.emit(re.SERVICE_STATUS,this.getServiceStatus())}getConnectionStatus(){return this.state._connectionStatus}getServiceStatus(){return{originatorInfo:this.state.originatorInfo,keyInfo:this.getKeyInfo(),connectionStatus:this.state._connectionStatus,channelConfig:this.state.channelConfig,channelId:this.state.channelId}}getKeyInfo(){var e;return(e=this.state.communicationLayer)===null||e===void 0?void 0:e.getKeyInfo()}resetKeys(){var e;(e=this.state.communicationLayer)===null||e===void 0||e.resetKeys()}setOtherPublicKey(e){var n;const r=(n=this.state.communicationLayer)===null||n===void 0?void 0:n.getKeyExchange();if(!r)throw new Error("KeyExchange is not initialized.");r.getOtherPublicKey()!==e&&r.setOtherPublicKey(e)}pause(){return X(this,void 0,void 0,function*(){var e;W.RemoteCommunication(`[RemoteCommunication: pause()] channel=${this.state.channelId}`),yield(e=this.state.communicationLayer)===null||e===void 0?void 0:e.pause(),this.setConnectionStatus(mt.PAUSED)})}getVersion(){return $r.version}hasRelayPersistence(){var e;return(e=this.state.relayPersistence)!==null&&e!==void 0&&e}resume(){return X(this,void 0,void 0,function*(){return function(e){return X(this,void 0,void 0,function*(){var n;const{state:r}=e;W.RemoteCommunication(`[RemoteCommunication: resume()] channel=${r.channelId}`),yield(n=r.communicationLayer)===null||n===void 0?void 0:n.resume(),e.setConnectionStatus(mt.LINKED)})}(this)})}encrypt(e){var n,r,i;const s=(n=this.state.communicationLayer)===null||n===void 0?void 0:n.getKeyExchange(),o=s?.getOtherPublicKey();if(!o)throw new Error("KeyExchange not completed");return(i=(r=this.state.communicationLayer)===null||r===void 0?void 0:r.state.eciesInstance)===null||i===void 0?void 0:i.encrypt(e,o)}decrypt(e){var n,r,i;if(!(!((n=this.state.communicationLayer)===null||n===void 0)&&n.state.eciesInstance))throw new Error("ECIES instance is not initialized");return(i=(r=this.state.communicationLayer)===null||r===void 0?void 0:r.state.eciesInstance)===null||i===void 0?void 0:i.decrypt(e)}getChannelId(){return this.state.channelId}getRPCMethodTracker(){var e;return(e=this.state.communicationLayer)===null||e===void 0?void 0:e.getRPCMethodTracker()}reject({channelId:e}){return function(n){return X(this,arguments,void 0,function*({channelId:r,state:i}){var s,o,a;if(!cu(r))throw W.RemoteCommunication(`[RemoteCommunication: connectToChannel()] context=${i.context} invalid channel channelId=${r}`),new Error(`Invalid channel ${r}`);if(i.isOriginator)return void W.RemoteCommunication(`[RemoteCommunication: reject()] context=${i.context} isOriginator=${i.isOriginator} channelId=${r}`);const{socket:c}=(o=(s=i.communicationLayer)===null||s===void 0?void 0:s.state)!==null&&o!==void 0?o:{};c?.connected||(W.RemoteCommunication(`[RemoteCommunication: reject()] context=${i.context} socket already connected`),c?.connect()),ar(Object.assign(Object.assign({id:r,event:tt.REJECTED},i.originatorInfo),{sdkVersion:i.sdkVersion,commLayerVersion:$r.version,walletVersion:(a=i.walletInfo)===null||a===void 0?void 0:a.version}),i.communicationServerUrl).catch(l=>{}),yield new Promise((l,u)=>{c?.emit(re.REJECTED,{channelId:r},(d,h)=>{W.RemoteCommunication(`[RemoteCommunication: reject()] context=${i.context} socket=${c?.id}`,{error:d,response:h}),d?u(d):l(h)})})})}({channelId:e,state:this.state})}disconnect(e){return X(this,void 0,void 0,function*(){return Jm({options:e,instance:this})})}}(function(t){t.RENEW="renew",t.LINK="link"})(Tf||(Tf={}));var jE="ERC721",zE="ERC1155",Qe={errors:{disconnected:()=>"MetaMask: Disconnected from chain. Attempting to connect.",permanentlyDisconnected:()=>"MetaMask: Disconnected from MetaMask background. Page reload required.",sendSiteMetadata:()=>"MetaMask: Failed to send site metadata. This is an internal error, please report this bug.",unsupportedSync:t=>`MetaMask: The MetaMask Ethereum provider does not support synchronous methods like ${t} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidNetworkParams:()=>"MetaMask: Received invalid network parameters. Please report this bug.",invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:t=>`'args.logger' must include required method '${t}'.`},info:{connected:t=>`MetaMask: Connected to chain with ID "${t}".`},warnings:{chainIdDeprecation:`MetaMask: 'ethereum.chainId' is deprecated and may be removed in the future. Please use the 'eth_chainId' RPC method instead.
For more information, see: https://github.com/MetaMask/metamask-improvement-proposals/discussions/23`,networkVersionDeprecation:`MetaMask: 'ethereum.networkVersion' is deprecated and may be removed in the future. Please use the 'net_version' RPC method instead.
For more information, see: https://github.com/MetaMask/metamask-improvement-proposals/discussions/23`,selectedAddressDeprecation:`MetaMask: 'ethereum.selectedAddress' is deprecated and may be removed in the future. Please use the 'eth_accounts' RPC method instead.
For more information, see: https://github.com/MetaMask/metamask-improvement-proposals/discussions/23`,enableDeprecation:`MetaMask: 'ethereum.enable()' is deprecated and may be removed in the future. Please use the 'eth_requestAccounts' RPC method instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1102`,sendDeprecation:`MetaMask: 'ethereum.send(...)' is deprecated and may be removed in the future. Please use 'ethereum.sendAsync(...)' or 'ethereum.request(...)' instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`,events:{close:`MetaMask: The event 'close' is deprecated and may be removed in the future. Please use 'disconnect' instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193#disconnect`,data:`MetaMask: The event 'data' is deprecated and will be removed in the future. Use 'message' instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193#message`,networkChanged:`MetaMask: The event 'networkChanged' is deprecated and may be removed in the future. Use 'chainChanged' instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193#chainchanged`,notification:`MetaMask: The event 'notification' is deprecated and may be removed in the future. Use 'message' instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193#message`},rpc:{ethDecryptDeprecation:`MetaMask: The RPC method 'eth_decrypt' is deprecated and may be removed in the future.
For more information, see: https://medium.com/metamask/metamask-api-method-deprecation-2b0564a84686`,ethGetEncryptionPublicKeyDeprecation:`MetaMask: The RPC method 'eth_getEncryptionPublicKey' is deprecated and may be removed in the future.
For more information, see: https://medium.com/metamask/metamask-api-method-deprecation-2b0564a84686`,walletWatchAssetNFTExperimental:`MetaMask: The RPC method 'wallet_watchAsset' is experimental for ERC721/ERC1155 assets and may change in the future.
For more information, see: https://github.com/MetaMask/metamask-improvement-proposals/blob/main/MIPs/mip-1.md and https://github.com/MetaMask/metamask-improvement-proposals/blob/main/PROCESS-GUIDE.md#proposal-lifecycle`},experimentalMethods:"MetaMask: 'ethereum._metamask' exposes non-standard, experimental methods. They may be removed or changed without warning."}};function GE(t){const e={ethDecryptDeprecation:!1,ethGetEncryptionPublicKeyDeprecation:!1,walletWatchAssetNFTExperimental:!1};return(n,r,i)=>{e.ethDecryptDeprecation||n.method!=="eth_decrypt"?e.ethGetEncryptionPublicKeyDeprecation||n.method!=="eth_getEncryptionPublicKey"?!e.walletWatchAssetNFTExperimental&&n.method==="wallet_watchAsset"&&[jE,zE].includes(n.params?.type||"")&&(t.warn(Qe.warnings.rpc.walletWatchAssetNFTExperimental),e.walletWatchAssetNFTExperimental=!0):(t.warn(Qe.warnings.rpc.ethGetEncryptionPublicKeyDeprecation),e.ethGetEncryptionPublicKeyDeprecation=!0):(t.warn(Qe.warnings.rpc.ethDecryptDeprecation),e.ethDecryptDeprecation=!0),i()}}var Ym=4294967295,Of=Math.floor(Math.random()*Ym);function VE(){return(t,e,n,r)=>{const i=t.id,s=Of=(Of+1)%Ym;t.id=s,e.id=s,n(o=>{t.id=i,e.id=i,o()})}}var Id=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},Br=(t,e,n)=>(Id(t,e,"read from private field"),n?n.call(t):e.get(t)),yn=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Zo=(t,e,n,r)=>(Id(t,e,"write to private field"),e.set(t,n),n),Ct=(t,e,n)=>(Id(t,e,"access private method"),n),Tr={invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},Rf={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}};function Nf(t){return!!t&&typeof t=="object"&&!Array.isArray(t)}var Wa=(t,e)=>Object.hasOwnProperty.call(t,e);class qE extends TypeError{constructor(e,n){let r;const{message:i,explanation:s,...o}=e,{path:a}=e,c=a.length===0?i:`At path: ${a.join(".")} -- ${i}`;super(s??c),s!=null&&(this.cause=c),Object.assign(this,o),this.name=this.constructor.name,this.failures=()=>r??(r=[e,...n()])}}function ir(t){return typeof t=="object"&&t!=null}function Kn(t){return typeof t=="symbol"?t.toString():typeof t=="string"?JSON.stringify(t):`${t}`}function WE(t,e,n,r){if(t===!0)return;t===!1?t={}:typeof t=="string"&&(t={message:t});const{path:i,branch:s}=e,{type:o}=n,{refinement:a,message:c=`Expected a value of type \`${o}\`${a?` with refinement \`${a}\``:""}, but received: \`${Kn(r)}\``}=t;return{value:r,type:o,refinement:a,key:i[i.length-1],path:i,branch:s,...t,message:c}}function*Mf(t,e,n,r){(function(i){return ir(i)&&typeof i[Symbol.iterator]=="function"})(t)||(t=[t]);for(const i of t){const s=WE(i,e,n,r);s&&(yield s)}}function*Od(t,e,n={}){const{path:r=[],branch:i=[t],coerce:s=!1,mask:o=!1}=n,a={path:r,branch:i};if(s&&(t=e.coercer(t,a),o&&e.type!=="type"&&ir(e.schema)&&ir(t)&&!Array.isArray(t)))for(const l in t)e.schema[l]===void 0&&delete t[l];let c="valid";for(const l of e.validator(t,a))l.explanation=n.message,c="not_valid",yield[l,void 0];for(let[l,u,d]of e.entries(t,a)){const h=Od(u,d,{path:l===void 0?r:[...r,l],branch:l===void 0?i:[...i,u],coerce:s,mask:o,message:n.message});for(const f of h)f[0]?(c=f[0].refinement!=null?"not_refined":"not_valid",yield[f[0],void 0]):s&&(u=f[1],l===void 0?t=u:t instanceof Map?t.set(l,u):t instanceof Set?t.add(u):ir(t)&&(u!==void 0||l in t)&&(t[l]=u))}if(c!=="not_valid")for(const l of e.refiner(t,a))l.explanation=n.message,c="not_refined",yield[l,void 0];c==="valid"&&(yield[void 0,t])}class An{constructor(e){const{type:n,schema:r,validator:i,refiner:s,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=n,this.schema=r,this.entries=a,this.coercer=o,this.validator=i?(c,l)=>Mf(i(c,l),l,this,c):()=>[],this.refiner=s?(c,l)=>Mf(s(c,l),l,this,c):()=>[]}assert(e,n){return Zm(e,this,n)}create(e,n){return Xm(e,this,n)}is(e){return ys(e,this)}mask(e,n){return function(r,i,s){const o=eo(r,i,{coerce:!0,mask:!0,message:s});if(o[0])throw o[0];return o[1]}(e,this,n)}validate(e,n={}){return eo(e,this,n)}}function Zm(t,e,n){const r=eo(t,e,{message:n});if(r[0])throw r[0]}function Xm(t,e,n){const r=eo(t,e,{coerce:!0,message:n});if(r[0])throw r[0];return r[1]}function ys(t,e){return!eo(t,e)[0]}function eo(t,e,n={}){const r=Od(t,e,n),i=function(s){const{done:o,value:a}=s.next();return o?void 0:a}(r);return i[0]?[new qE(i[0],function*(){for(const o of r)o[0]&&(yield o[0])}),void 0]:[void 0,i[1]]}function jr(t,e){return new An({type:t,schema:null,validator:e})}function Bf(t){let e;return new An({type:"lazy",schema:null,*entries(n,r){e??(e=t()),yield*e.entries(n,r)},validator:(n,r)=>(e??(e=t()),e.validator(n,r)),coercer:(n,r)=>(e??(e=t()),e.coercer(n,r)),refiner:(n,r)=>(e??(e=t()),e.refiner(n,r))})}function ey(t){return new An({type:"array",schema:t,*entries(e){if(t&&Array.isArray(e))for(const[n,r]of e.entries())yield[n,r,t]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||`Expected an array value, but received: ${Kn(e)}`})}function ty(t){const e=Kn(t),n=typeof t;return new An({type:"literal",schema:n==="string"||n==="number"||n==="boolean"?t:null,validator:r=>r===t||`Expected the literal \`${e}\`, but received: ${Kn(r)}`})}function ny(){return jr("number",t=>typeof t=="number"&&!isNaN(t)||`Expected a number, but received: ${Kn(t)}`)}function ry(t){const e=t?Object.keys(t):[],n=jr("never",()=>!1);return new An({type:"object",schema:t||null,*entries(r){if(t&&ir(r)){const i=new Set(Object.keys(r));for(const s of e)i.delete(s),yield[s,r[s],t[s]];for(const s of i)yield[s,r[s],n]}},validator:r=>ir(r)||`Expected an object, but received: ${Kn(r)}`,coercer:r=>ir(r)?{...r}:r})}function Lf(t){return new An({...t,validator:(e,n)=>e===void 0||t.validator(e,n),refiner:(e,n)=>e===void 0||t.refiner(e,n)})}function iy(t,e){return new An({type:"record",schema:null,*entries(n){if(ir(n))for(const r in n){const i=n[r];yield[r,r,t],yield[r,i,e]}},validator:n=>ir(n)||`Expected an object, but received: ${Kn(n)}`})}function zr(){return jr("string",t=>typeof t=="string"||`Expected a string, but received: ${Kn(t)}`)}function _c(t){const e=t.map(n=>n.type).join(" | ");return new An({type:"union",schema:null,coercer(n){for(const r of t){const[i,s]=r.validate(n,{coerce:!0});if(!i)return s}return n},validator(n,r){const i=[];for(const s of t){const[...o]=Od(n,s,r),[a]=o;if(!a[0])return[];for(const[c]of o)c&&i.push(c)}return[`Expected the value to satisfy a union of \`${e}\`, but received: ${Kn(n)}`,...i]}})}function QE(t){return function(e){return function(n){return typeof n=="object"&&n!==null&&"message"in n}(e)&&typeof e.message=="string"?e.message:e==null?"":String(e)}(t).replace(/\.$/u,"")}function JE(t,e){return n=t,typeof n?.prototype?.constructor?.name=="string"?new t({message:e}):t({message:e});var n}var YE=class extends Error{constructor(t){super(t.message),this.code="ERR_ASSERTION"}};function sy(){throw new Error("setTimeout has not been defined")}function oy(){throw new Error("clearTimeout has not been defined")}var Ar=sy,Sr=oy;function ay(t){if(Ar===setTimeout)return setTimeout(t,0);if((Ar===sy||!Ar)&&setTimeout)return Ar=setTimeout,setTimeout(t,0);try{return Ar(t,0)}catch{try{return Ar.call(null,t,0)}catch{return Ar.call(this,t,0)}}}typeof Nt.setTimeout=="function"&&(Ar=setTimeout),typeof Nt.clearTimeout=="function"&&(Sr=clearTimeout);var oi,tr=[],Yi=!1,Aa=-1;function ZE(){Yi&&oi&&(Yi=!1,oi.length?tr=oi.concat(tr):Aa=-1,tr.length&&cy())}function cy(){if(!Yi){var t=ay(ZE);Yi=!0;for(var e=tr.length;e;){for(oi=tr,tr=[];++Aa<e;)oi&&oi[Aa].run();Aa=-1,e=tr.length}oi=null,Yi=!1,function(n){if(Sr===clearTimeout)return clearTimeout(n);if((Sr===oy||!Sr)&&clearTimeout)return Sr=clearTimeout,clearTimeout(n);try{return Sr(n)}catch{try{return Sr.call(null,n)}catch{return Sr.call(this,n)}}}(t)}}function ly(t,e){this.fun=t,this.array=e}ly.prototype.run=function(){this.fun.apply(null,this.array)};function Ei(){}var XE=Ei,eA=Ei,tA=Ei,nA=Ei,rA=Ei,iA=Ei,sA=Ei,Bi=Nt.performance||{},oA=Bi.now||Bi.mozNow||Bi.msNow||Bi.oNow||Bi.webkitNow||function(){return new Date().getTime()},aA=new Date,Re={nextTick:function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];tr.push(new ly(t,e)),tr.length!==1||Yi||ay(cy)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:XE,addListener:eA,once:tA,off:nA,removeListener:rA,removeAllListeners:iA,emit:sA,binding:function(t){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(t){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(t){var e=.001*oA.call(Bi),n=Math.floor(e),r=Math.floor(e%1*1e9);return t&&(n-=t[0],(r-=t[1])<0&&(n--,r+=1e9)),[n,r]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-aA)/1e3}},to=t=>ry(t);function Df({path:t,branch:e}){const n=t[t.length-1];return Wa(e[e.length-2],n)}function Qa(t){return new An({...t,type:`optional ${t.type}`,validator:(e,n)=>!Df(n)||t.validator(e,n),refiner:(e,n)=>!Df(n)||t.refiner(e,n)})}var Xo,Uf,Ff,Ja=_c([ty(null),jr("boolean",t=>typeof t=="boolean"),jr("finite number",t=>ys(t,ny())&&Number.isFinite(t)),zr(),ey(Bf(()=>Ja)),iy(zr(),Bf(()=>Ja))]),no=(Xo=Ja,Uf=jr("any",()=>!0),Ff=t=>(function(e,n,r="Assertion failed",i=YE){try{Zm(e,n)}catch(s){throw JE(i,`${r}: ${QE(s)}.`)}}(t,Ja),JSON.parse(JSON.stringify(t,(e,n)=>{if(e!=="__proto__"&&e!=="constructor")return n}))),new An({...Xo,coercer:(t,e)=>ys(t,Uf)?Xo.coercer(Ff(t,e),e):Xo.coercer(t,e)}));function ku(t){try{return function(e){Xm(e,no)}(t),!0}catch{return!1}}var Fs=ty("2.0"),Sa=function(t){return new An({...t,validator:(e,n)=>e===null||t.validator(e,n),refiner:(e,n)=>e===null||t.refiner(e,n)})}(_c([ny(),zr()])),Pu=to({code:jr("integer",t=>typeof t=="number"&&!isNaN(t)&&Number.isInteger(t)||`Expected an integer, but received: ${Kn(t)}`),message:zr(),data:Qa(no),stack:Qa(zr())}),uy=_c([iy(zr(),no),ey(no)]),cA=to({id:Sa,jsonrpc:Fs,method:zr(),params:Qa(uy)}),lA=to({jsonrpc:Fs,method:zr(),params:Qa(uy)});function Hf(t){return ys(t,cA)}function Kf(t){return ys(t,Pu)}ry({id:Sa,jsonrpc:Fs,result:Lf(jr("unknown",()=>!0)),error:Lf(Pu)}),_c([to({id:Sa,jsonrpc:Fs,result:no}),to({id:Sa,jsonrpc:Fs,error:Pu})]);var $f=Tr.internal,uA="Unspecified error message. This is a bug, please report it.",dA={code:$f,message:dy($f)},hA="Unspecified server error.";function dy(t,e=uA){if(function(n){return Number.isInteger(n)}(t)){const n=t.toString();if(Wa(Rf,n))return Rf[n].message;if(function(r){return r>=-32099&&r<=-32e3}(t))return hA}return e}function jf(t,{fallbackError:e=dA,shouldIncludeStack:n=!0}={}){if(!Kf(e))throw new Error("Must provide fallback error with integer number code and string message.");const r=function(i,s){if(i&&typeof i=="object"&&"serialize"in i&&typeof i.serialize=="function")return i.serialize();if(Kf(i))return i;const o=hy(i);return{...s,data:{cause:o}}}(t,e);return n||delete r.stack,r}function hy(t){return Array.isArray(t)?t.map(e=>ku(e)?e:Nf(e)?zf(e):null):Nf(t)?zf(t):ku(t)?t:null}function zf(t){return Object.getOwnPropertyNames(t).reduce((e,n)=>{const r=t[n];return ku(r)&&(e[n]=r),e},{})}var fy=Ns;Ns.default=Ns,Ns.stable=Gf,Ns.stableStringify=Gf;var Ya="[...]",py="[Circular]",mi=[],ai=[];function gy(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Ns(t,e,n,r){var i;r===void 0&&(r=gy()),Tu(t,"",0,[],void 0,0,r);try{i=ai.length===0?JSON.stringify(t,e,n):JSON.stringify(t,my(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;mi.length!==0;){var s=mi.pop();s.length===4?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return i}function Zi(t,e,n,r){var i=Object.getOwnPropertyDescriptor(r,n);i.get!==void 0?i.configurable?(Object.defineProperty(r,n,{value:t}),mi.push([r,n,e,i])):ai.push([e,n,t]):(r[n]=t,mi.push([r,n,e]))}function Tu(t,e,n,r,i,s,o){var a;if(s+=1,typeof t=="object"&&t!==null){for(a=0;a<r.length;a++)if(r[a]===t)return void Zi(py,t,e,i);if(o.depthLimit!==void 0&&s>o.depthLimit||o.edgesLimit!==void 0&&n+1>o.edgesLimit)return void Zi(Ya,t,e,i);if(r.push(t),Array.isArray(t))for(a=0;a<t.length;a++)Tu(t[a],a,a,r,t,s,o);else{var c=Object.keys(t);for(a=0;a<c.length;a++){var l=c[a];Tu(t[l],l,a,r,t,s,o)}}r.pop()}}function fA(t,e){return t<e?-1:t>e?1:0}function Gf(t,e,n,r){r===void 0&&(r=gy());var i,s=Iu(t,"",0,[],void 0,0,r)||t;try{i=ai.length===0?JSON.stringify(s,e,n):JSON.stringify(s,my(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;mi.length!==0;){var o=mi.pop();o.length===4?Object.defineProperty(o[0],o[1],o[3]):o[0][o[1]]=o[2]}}return i}function Iu(t,e,n,r,i,s,o){var a;if(s+=1,typeof t=="object"&&t!==null){for(a=0;a<r.length;a++)if(r[a]===t)return void Zi(py,t,e,i);try{if(typeof t.toJSON=="function")return}catch{return}if(o.depthLimit!==void 0&&s>o.depthLimit||o.edgesLimit!==void 0&&n+1>o.edgesLimit)return void Zi(Ya,t,e,i);if(r.push(t),Array.isArray(t))for(a=0;a<t.length;a++)Iu(t[a],a,a,r,t,s,o);else{var c={},l=Object.keys(t).sort(fA);for(a=0;a<l.length;a++){var u=l[a];Iu(t[u],u,a,r,t,s,o),c[u]=t[u]}if(i===void 0)return c;mi.push([i,e,t]),i[e]=c}r.pop()}}function my(t){return t=t!==void 0?t:function(e,n){return n},function(e,n){if(ai.length>0)for(var r=0;r<ai.length;r++){var i=ai[r];if(i[1]===e&&i[0]===n){n=i[2],ai.splice(r,1);break}}return t.call(this,e,n)}}var pA=Sc(fy),Vn=class extends Error{constructor(t,e,n){if(!Number.isInteger(t))throw new Error('"code" must be an integer.');if(!e||typeof e!="string")throw new Error('"message" must be a non-empty string.');super(e),this.code=t,n!==void 0&&(this.data=n)}serialize(){const t={code:this.code,message:this.message};return this.data!==void 0&&(t.data=this.data,function(e){if(typeof e!="object"||e===null)return!1;try{let n=e;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}catch{return!1}}(this.data)&&(t.data.cause=hy(this.data.cause))),this.stack&&(t.stack=this.stack),t}toString(){return pA(this.serialize(),gA,2)}};function gA(t,e){if(e!=="[Circular]")return e}var Hs=t=>mA(Tr.invalidRequest,t);function mA(t,e){const[n,r]=function(i){if(i){if(typeof i=="string")return[i];if(typeof i=="object"&&!Array.isArray(i)){const{message:s,data:o}=i;if(s&&typeof s!="string")throw new Error("Must specify string message.");return[s??void 0,o]}}return[]}(e);return new Vn(t,n??dy(t),r)}var yy={};function Cr(){}function Me(){Me.init.call(this)}function wy(t){return t._maxListeners===void 0?Me.defaultMaxListeners:t._maxListeners}function Vf(t,e,n,r){var i,s,o;if(typeof n!="function")throw new TypeError('"listener" argument must be a function');if((s=t._events)?(s.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]):(s=t._events=new Cr,t._eventsCount=0),o){if(typeof o=="function"?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),!o.warned&&(i=wy(t))&&i>0&&o.length>i){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,function(c){typeof console.warn=="function"?console.warn(c):console.log(c)}(a)}}else o=s[e]=n,++t._eventsCount;return t}function qf(t,e,n){var r=!1;function i(){t.removeListener(e,i),r||(r=!0,n.apply(t,arguments))}return i.listener=n,i}function Wf(t){var e=this._events;if(e){var n=e[t];if(typeof n=="function")return 1;if(n)return n.length}return 0}function xs(t,e){for(var n=new Array(e);e--;)n[e]=t[e];return n}Cr.prototype=Object.create(null),Me.EventEmitter=Me,Me.usingDomains=!1,Me.prototype.domain=void 0,Me.prototype._events=void 0,Me.prototype._maxListeners=void 0,Me.defaultMaxListeners=10,Me.init=function(){this.domain=null,Me.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Cr,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Me.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},Me.prototype.getMaxListeners=function(){return wy(this)},Me.prototype.emit=function(t){var e,n,r,i,s,o,a,c=t==="error";if(o=this._events)c=c&&o.error==null;else if(!c)return!1;if(a=this.domain,c){if(e=arguments[1],!a){if(e instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=a,e.domainThrown=!1,a.emit("error",e),!1}if(!(n=o[t]))return!1;var u=typeof n=="function";switch(r=arguments.length){case 1:(function(d,h,f){if(h)d.call(f);else for(var g=d.length,p=xs(d,g),y=0;y<g;++y)p[y].call(f)})(n,u,this);break;case 2:(function(d,h,f,g){if(h)d.call(f,g);else for(var p=d.length,y=xs(d,p),m=0;m<p;++m)y[m].call(f,g)})(n,u,this,arguments[1]);break;case 3:(function(d,h,f,g,p){if(h)d.call(f,g,p);else for(var y=d.length,m=xs(d,y),C=0;C<y;++C)m[C].call(f,g,p)})(n,u,this,arguments[1],arguments[2]);break;case 4:(function(d,h,f,g,p,y){if(h)d.call(f,g,p,y);else for(var m=d.length,C=xs(d,m),v=0;v<m;++v)C[v].call(f,g,p,y)})(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),s=1;s<r;s++)i[s-1]=arguments[s];(function(d,h,f,g){if(h)d.apply(f,g);else for(var p=d.length,y=xs(d,p),m=0;m<p;++m)y[m].apply(f,g)})(n,u,this,i)}return!0},Me.prototype.addListener=function(t,e){return Vf(this,t,e,!1)},Me.prototype.on=Me.prototype.addListener,Me.prototype.prependListener=function(t,e){return Vf(this,t,e,!0)},Me.prototype.once=function(t,e){if(typeof e!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,qf(this,t,e)),this},Me.prototype.prependOnceListener=function(t,e){if(typeof e!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,qf(this,t,e)),this},Me.prototype.removeListener=function(t,e){var n,r,i,s,o;if(typeof e!="function")throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[t]))return this;if(n===e||n.listener&&n.listener===e)--this._eventsCount==0?this._events=new Cr:(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if(typeof n!="function"){for(i=-1,s=n.length;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){o=n[s].listener,i=s;break}if(i<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount==0)return this._events=new Cr,this;delete r[t]}else(function(a,c){for(var l=c,u=l+1,d=a.length;u<d;l+=1,u+=1)a[l]=a[u];a.pop()})(n,i);r.removeListener&&this.emit("removeListener",t,o||e)}return this},Me.prototype.off=function(t,e){return this.removeListener(t,e)},Me.prototype.removeAllListeners=function(t){var e,n;if(!(n=this._events))return this;if(!n.removeListener)return arguments.length===0?(this._events=new Cr,this._eventsCount=0):n[t]&&(--this._eventsCount==0?this._events=new Cr:delete n[t]),this;if(arguments.length===0){for(var r,i=Object.keys(n),s=0;s<i.length;++s)(r=i[s])!=="removeListener"&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new Cr,this._eventsCount=0,this}if(typeof(e=n[t])=="function")this.removeListener(t,e);else if(e)do this.removeListener(t,e[e.length-1]);while(e[0]);return this},Me.prototype.listeners=function(t){var e,n,r=this._events;return n=r&&(e=r[t])?typeof e=="function"?[e.listener||e]:function(i){for(var s=new Array(i.length),o=0;o<s.length;++o)s[o]=i[o].listener||i[o];return s}(e):[],n},Me.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Wf.call(t,e)},Me.prototype.listenerCount=Wf,Me.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Rd=vo(Object.freeze({__proto__:null,EventEmitter:Me,default:Me}));Object.defineProperty(yy,"__esModule",{value:!0});const yA=Rd;function Qf(t,e,n){try{Reflect.apply(t,e,n)}catch(r){setTimeout(()=>{throw r})}}let wA=class extends yA.EventEmitter{emit(t,...e){let n=t==="error";const r=this._events;if(r!==void 0)n=n&&r.error===void 0;else if(!n)return!1;if(n){let s;if(e.length>0&&([s]=e),s instanceof Error)throw s;const o=new Error("Unhandled error."+(s?` (${s.message})`:""));throw o.context=s,o}const i=r[t];if(i===void 0)return!1;if(typeof i=="function")Qf(i,this,e);else{const s=i.length,o=function(a){const c=a.length,l=new Array(c);for(let u=0;u<c;u+=1)l[u]=a[u];return l}(i);for(let a=0;a<s;a+=1)Qf(o[a],this,e)}return!0}};var Za,Ir,zi,Ms,Ca,_a,Ou,xa,Ru,Sl,Jf,ka,Nu,Cl,Yf,Ks,Xa,_l,Zf,vy=yy.default=wA,hn=class Pa extends vy{constructor({notificationHandler:e}={}){super(),yn(this,Ms),yn(this,_a),yn(this,xa),yn(this,Za,!1),yn(this,Ir,void 0),yn(this,zi,void 0),Zo(this,Ir,[]),Zo(this,zi,e)}destroy(){Br(this,Ir).forEach(e=>{"destroy"in e&&typeof e.destroy=="function"&&e.destroy()}),Zo(this,Ir,[]),Zo(this,Za,!0)}push(e){Ct(this,Ms,Ca).call(this),Br(this,Ir).push(e)}handle(e,n){if(Ct(this,Ms,Ca).call(this),n&&typeof n!="function")throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?n?Ct(this,_a,Ou).call(this,e,n):Ct(this,_a,Ou).call(this,e):n?Ct(this,xa,Ru).call(this,e,n):this._promiseHandle(e)}asMiddleware(){return Ct(this,Ms,Ca).call(this),async(e,n,r,i)=>{var s,o;try{const[a,c,l]=await Ct(s=Pa,ka,Nu).call(s,e,n,Br(this,Ir));return c?(await Ct(o=Pa,Ks,Xa).call(o,l),i(a)):r(async u=>{var d;try{await Ct(d=Pa,Ks,Xa).call(d,l)}catch(h){return u(h)}return u()})}catch(a){return i(a)}}}async _promiseHandle(e){return new Promise((n,r)=>{Ct(this,xa,Ru).call(this,e,(i,s)=>{i&&s===void 0?r(i):n(s)}).catch(r)})}};Za=new WeakMap,Ir=new WeakMap,zi=new WeakMap,Ms=new WeakSet,Ca=function(){if(Br(this,Za))throw new Error("This engine is destroyed and can no longer be used.")},_a=new WeakSet,Ou=async function(t,e){try{if(t.length===0){const r=[{id:null,jsonrpc:"2.0",error:new Vn(Tr.invalidRequest,"Request batch must contain plain objects. Received an empty array")}];return e?e(null,r):r}const n=(await Promise.all(t.map(this._promiseHandle.bind(this)))).filter(r=>r!==void 0);return e?e(null,n):n}catch(n){if(e)return e(n);throw n}},xa=new WeakSet,Ru=async function(t,e){var n;if(!t||Array.isArray(t)||typeof t!="object"){const o=new Vn(Tr.invalidRequest,"Requests must be plain objects. Received: "+typeof t,{request:t});return e(o,{id:null,jsonrpc:"2.0",error:o})}if(typeof t.method!="string"){const o=new Vn(Tr.invalidRequest,"Must specify a string method. Received: "+typeof t.method,{request:t});return Br(this,zi)&&!Hf(t)?e(null):e(o,{id:t.id??null,jsonrpc:"2.0",error:o})}if(Br(this,zi)&&ys(t,lA)&&!Hf(t)){try{await Br(this,zi).call(this,t)}catch(o){return e(o)}return e(null)}let r=null;const i={...t},s={id:i.id,jsonrpc:i.jsonrpc};try{await Ct(n=hn,Sl,Jf).call(n,i,s,Br(this,Ir))}catch(o){r=o}return r&&(delete s.result,s.error||(s.error=jf(r))),e(r,s)},Sl=new WeakSet,Jf=async function(t,e,n){var r,i,s;const[o,a,c]=await Ct(r=hn,ka,Nu).call(r,t,e,n);if(Ct(i=hn,_l,Zf).call(i,t,e,a),await Ct(s=hn,Ks,Xa).call(s,c),o)throw o},ka=new WeakSet,Nu=async function(t,e,n){var r;const i=[];let s=null,o=!1;for(const a of n)if([s,o]=await Ct(r=hn,Cl,Yf).call(r,t,e,a,i),o)break;return[s,o,i.reverse()]},Cl=new WeakSet,Yf=async function(t,e,n,r){return new Promise(i=>{const s=a=>{const c=a||e.error;c&&(e.error=jf(c)),i([c,!0])},o=a=>{e.error?s(e.error):(a&&(typeof a!="function"&&s(new Vn(Tr.internal,`JsonRpcEngine: "next" return handlers must be functions. Received "${typeof a}" for request:
${xl(t)}`,{request:t})),r.push(a)),i([null,!1]))};try{n(t,e,o,s)}catch(a){s(a)}})},Ks=new WeakSet,Xa=async function(t){for(const e of t)await new Promise((n,r)=>{e(i=>i?r(i):n())})},_l=new WeakSet,Zf=function(t,e,n){if(!Wa(e,"result")&&!Wa(e,"error"))throw new Vn(Tr.internal,`JsonRpcEngine: Response has no error or result for request:
${xl(t)}`,{request:t});if(!n)throw new Vn(Tr.internal,`JsonRpcEngine: Nothing ended request:
${xl(t)}`,{request:t})},yn(hn,Sl),yn(hn,ka),yn(hn,Cl),yn(hn,Ks),yn(hn,_l);var vA=hn;function xl(t){return JSON.stringify(t,null,2)}var by=Object.freeze(["eth_subscription"]),bA=(t=console)=>[VE(),EA(t),GE(t)];function EA(t){return(e,n,r)=>{typeof e.method=="string"&&e.method||(n.error=Hs({message:"The request 'method' must be a non-empty string.",data:e})),r(i=>{const{error:s}=n;return s&&t.error(`MetaMask - RPC Error: ${s.message}`,s),i()})}}var Ta=(t,e,n=!0)=>(r,i)=>{r||i.error?e(r||i.error):!n||Array.isArray(i)?t(i):t(i.result)},Ey=t=>!!t&&typeof t=="string"&&t.startsWith("0x"),Ay=()=>{};async function Xf(t,e){try{const n=await async function(){return{name:AA(window),icon:await SA(window)}}();t.handle({jsonrpc:"2.0",id:1,method:"metamask_sendDomainMetadata",params:n},Ay)}catch(n){e.error({message:Qe.errors.sendSiteMetadata(),originalError:n})}}function AA(t){const{document:e}=t,n=e.querySelector('head > meta[property="og:site_name"]');if(n)return n.content;const r=e.querySelector('head > meta[name="title"]');return r?r.content:e.title&&e.title.length>0?e.title:window.location.hostname}async function SA(t){const{document:e}=t,n=e.querySelectorAll('head > link[rel~="icon"]');for(const r of Array.from(n))if(r&&await CA(r.href))return r.href;return null}async function CA(t){return new Promise((e,n)=>{try{const r=document.createElement("img");r.onload=()=>e(!0),r.onerror=()=>e(!1),r.src=t}catch(r){n(r)}})}var Sy=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},On=(t,e,n)=>(Sy(t,e,"read from private field"),n?n.call(t):e.get(t)),Mu=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},qn=(t,e,n,r)=>(Sy(t,e,"write to private field"),e.set(t,n),n);function ep(t,e,n){try{Reflect.apply(t,e,n)}catch(r){setTimeout(()=>{throw r})}}class _A extends Me{emit(e,...n){let r=e==="error";const i=this._events;if(i!==void 0)r=r&&i.error===void 0;else if(!r)return!1;if(r){let o;if(n.length>0&&([o]=n),o instanceof Error)throw o;const a=new Error("Unhandled error."+(o?` (${o.message})`:""));throw a.context=o,a}const s=i[e];if(s===void 0)return!1;if(typeof s=="function")ep(s,this,n);else{const o=s.length,a=function(c){const l=c.length,u=new Array(l);for(let d=0;d<l;d+=1)u[d]=c[d];return u}(s);for(let c=0;c<o;c+=1)ep(a[c],this,n)}return!0}}var _r,Zr,xA=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;i--!=0;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(s=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;i--!=0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!=0;){var o=s[i];if(!t(e[o],n[o]))return!1}return!0}return e!=e&&n!=n},kA=Sc(xA),Cy=class _y extends _A{constructor({logger:e=console,maxEventListeners:n=100,rpcMiddleware:r=[]}={}){super(),Mu(this,_r,void 0),Mu(this,Zr,void 0),this._log=e,this.setMaxListeners(n),this._state={..._y._defaultState},qn(this,Zr,null),qn(this,_r,null),this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleConnect=this._handleConnect.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this.request=this.request.bind(this);const i=new vA;r.forEach(s=>i.push(s)),this._rpcEngine=i}get chainId(){return On(this,_r)}get selectedAddress(){return On(this,Zr)}isConnected(){return this._state.isConnected}async request(e){if(!e||typeof e!="object"||Array.isArray(e))throw Hs({message:Qe.errors.invalidRequestArgs(),data:e});const{method:n,params:r}=e;if(typeof n!="string"||n.length===0)throw Hs({message:Qe.errors.invalidRequestMethod(),data:e});if(r!==void 0&&!Array.isArray(r)&&(typeof r!="object"||r===null))throw Hs({message:Qe.errors.invalidRequestParams(),data:e});const i=r==null?{method:n}:{method:n,params:r};return new Promise((s,o)=>{this._rpcRequest(i,Ta(s,o))})}_initializeState(e){if(this._state.initialized)throw new Error("Provider already initialized.");if(e){const{accounts:n,chainId:r,isUnlocked:i,networkVersion:s}=e;this._handleConnect(r),this._handleChainChanged({chainId:r,networkVersion:s}),this._handleUnlockStateChanged({accounts:n,isUnlocked:i}),this._handleAccountsChanged(n)}this._state.initialized=!0,this.emit("_initialized")}_rpcRequest(e,n){let r=n;return Array.isArray(e)||(e.jsonrpc||(e.jsonrpc="2.0"),e.method!=="eth_accounts"&&e.method!=="eth_requestAccounts"||(r=(i,s)=>{this._handleAccountsChanged(s.result??[],e.method==="eth_accounts"),n(i,s)})),this._rpcEngine.handle(e,r)}_handleConnect(e){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:e}),this._log.debug(Qe.info.connected(e)))}_handleDisconnect(e,n){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){let r;this._state.isConnected=!1,e?(r=new Vn(1013,n??Qe.errors.disconnected()),this._log.debug(r)):(r=new Vn(1011,n??Qe.errors.permanentlyDisconnected()),this._log.error(r),qn(this,_r,null),this._state.accounts=null,qn(this,Zr,null),this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleChainChanged({chainId:e}={}){Ey(e)?(this._handleConnect(e),e!==On(this,_r)&&(qn(this,_r,e),this._state.initialized&&this.emit("chainChanged",On(this,_r)))):this._log.error(Qe.errors.invalidNetworkParams(),{chainId:e})}_handleAccountsChanged(e,n=!1){let r=e;Array.isArray(e)||(this._log.error("MetaMask: Received invalid accounts parameter. Please report this bug.",e),r=[]);for(const i of e)if(typeof i!="string"){this._log.error("MetaMask: Received non-string account. Please report this bug.",e),r=[];break}if(!kA(this._state.accounts,r)&&(n&&this._state.accounts!==null&&this._log.error("MetaMask: 'eth_accounts' unexpectedly updated accounts. Please report this bug.",r),this._state.accounts=r,On(this,Zr)!==r[0]&&qn(this,Zr,r[0]||null),this._state.initialized)){const i=[...r];this.emit("accountsChanged",i)}}_handleUnlockStateChanged({accounts:e,isUnlocked:n}={}){typeof n=="boolean"?n!==this._state.isUnlocked&&(this._state.isUnlocked=n,this._handleAccountsChanged(e??[])):this._log.error("MetaMask: Received invalid isUnlocked parameter. Please report this bug.")}};_r=new WeakMap,Zr=new WeakMap,Cy._defaultState={accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1};var tp,np,PA=Cy,Bu={exports:{}};function xy(){return np?tp:(np=1,tp=Rd.EventEmitter)}var Nd,Md=vo(j1);Nd=typeof Object.create=="function"?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t};var ky=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},TA=/%[sdj%]/g;function xc(t){if(!ro(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(Un(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(TA,function(a){if(a==="%%")return"%";if(n>=i)return a;switch(a){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch{return"[Circular]"}default:return a}}),o=r[n];n<i;o=r[++n])Ao(o)||!Ai(o)?s+=" "+o:s+=" "+Un(o);return s}function Bd(t,e){if(Bn(Nt.process))return function(){return Bd(t,e).apply(this,arguments)};if(Re.noDeprecation===!0)return t;var n=!1;return function(){if(!n){if(Re.throwDeprecation)throw new Error(e);Re.traceDeprecation?console.trace(e):console.error(e),n=!0}return t.apply(this,arguments)}}var kl,ea={};function Py(t){return Bn(kl)&&(kl=Re.env.NODE_DEBUG||""),t=t.toUpperCase(),!ea[t]&&(new RegExp("\\b"+t+"\\b","i").test(kl)?ea[t]=function(){var e=xc.apply(null,arguments);console.error("%s %d: %s",t,0,e)}:ea[t]=function(){}),ea[t]}function Un(t,e){var n={seen:[],stylize:OA};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),kc(e)?n.showHidden=e:e&&Fd(n,e),Bn(n.showHidden)&&(n.showHidden=!1),Bn(n.depth)&&(n.depth=2),Bn(n.colors)&&(n.colors=!1),Bn(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=IA),ec(n,t,n.depth)}function IA(t,e){var n=Un.styles[e];return n?"\x1B["+Un.colors[n][0]+"m"+t+"\x1B["+Un.colors[n][1]+"m":t}function OA(t,e){return t}function ec(t,e,n){if(t.customInspect&&e&&zs(e.inspect)&&e.inspect!==Un&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(n,t);return ro(r)||(r=ec(t,r,n)),r}var i=function(h,f){if(Bn(f))return h.stylize("undefined","undefined");if(ro(f)){var g="'"+JSON.stringify(f).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return h.stylize(g,"string")}if(Dd(f))return h.stylize(""+f,"number");if(kc(f))return h.stylize(""+f,"boolean");if(Ao(f))return h.stylize("null","null")}(t,e);if(i)return i;var s=Object.keys(e),o=function(h){var f={};return h.forEach(function(g,p){f[g]=!0}),f}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),js(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return Pl(e);if(s.length===0){if(zs(e)){var a=e.name?": "+e.name:"";return t.stylize("[Function"+a+"]","special")}if($s(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(tc(e))return t.stylize(Date.prototype.toString.call(e),"date");if(js(e))return Pl(e)}var c,l="",u=!1,d=["{","}"];return Ld(e)&&(u=!0,d=["[","]"]),zs(e)&&(l=" [Function"+(e.name?": "+e.name:"")+"]"),$s(e)&&(l=" "+RegExp.prototype.toString.call(e)),tc(e)&&(l=" "+Date.prototype.toUTCString.call(e)),js(e)&&(l=" "+Pl(e)),s.length!==0||u&&e.length!=0?n<0?$s(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),c=u?function(h,f,g,p,y){for(var m=[],C=0,v=f.length;C<v;++C)My(f,String(C))?m.push(Tl(h,f,g,p,String(C),!0)):m.push("");return y.forEach(function(I){I.match(/^\d+$/)||m.push(Tl(h,f,g,p,I,!0))}),m}(t,e,n,o,s):s.map(function(h){return Tl(t,e,n,o,h,u)}),t.seen.pop(),function(h,f,g){var p=h.reduce(function(y,m){return m.indexOf(`
`),y+m.replace(/\u001b\[\d\d?m/g,"").length+1},0);return p>60?g[0]+(f===""?"":f+`
 `)+" "+h.join(`,
  `)+" "+g[1]:g[0]+f+" "+h.join(", ")+" "+g[1]}(c,l,d)):d[0]+l+d[1]}function Pl(t){return"["+Error.prototype.toString.call(t)+"]"}function Tl(t,e,n,r,i,s){var o,a,c;if((c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),My(r,i)||(o="["+i+"]"),a||(t.seen.indexOf(c.value)<0?(a=Ao(n)?ec(t,c.value,null):ec(t,c.value,n-1)).indexOf(`
`)>-1&&(a=s?a.split(`
`).map(function(l){return"  "+l}).join(`
`).substr(2):`
`+a.split(`
`).map(function(l){return"   "+l}).join(`
`)):a=t.stylize("[Circular]","special")),Bn(o)){if(s&&i.match(/^\d+$/))return a;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function Ld(t){return Array.isArray(t)}function kc(t){return typeof t=="boolean"}function Ao(t){return t===null}function Ty(t){return t==null}function Dd(t){return typeof t=="number"}function ro(t){return typeof t=="string"}function Iy(t){return typeof t=="symbol"}function Bn(t){return t===void 0}function $s(t){return Ai(t)&&Ud(t)==="[object RegExp]"}function Ai(t){return typeof t=="object"&&t!==null}function tc(t){return Ai(t)&&Ud(t)==="[object Date]"}function js(t){return Ai(t)&&(Ud(t)==="[object Error]"||t instanceof Error)}function zs(t){return typeof t=="function"}function Oy(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||t===void 0}function Ry(t){return ee.isBuffer(t)}function Ud(t){return Object.prototype.toString.call(t)}function Il(t){return t<10?"0"+t.toString(10):t.toString(10)}Un.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Un.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var RA=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Ny(){var t,e;console.log("%s - %s",(t=new Date,e=[Il(t.getHours()),Il(t.getMinutes()),Il(t.getSeconds())].join(":"),[t.getDate(),RA[t.getMonth()],e].join(" ")),xc.apply(null,arguments))}function Fd(t,e){if(!e||!Ai(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}function My(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Xr=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;function Hd(t){if(typeof t!="function")throw new TypeError('The "original" argument must be of type Function');if(Xr&&t[Xr]){var e;if(typeof(e=t[Xr])!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,Xr,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var n,r,i=new Promise(function(a,c){n=a,r=c}),s=[],o=0;o<arguments.length;o++)s.push(arguments[o]);s.push(function(a,c){a?r(a):n(c)});try{t.apply(this,s)}catch(a){r(a)}return i}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),Xr&&Object.defineProperty(e,Xr,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,ky(t))}function NA(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}function By(t){if(typeof t!="function")throw new TypeError('The "original" argument must be of type Function');function e(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if(typeof i!="function")throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return i.apply(s,arguments)};t.apply(this,n).then(function(a){Re.nextTick(o.bind(null,null,a))},function(a){Re.nextTick(NA.bind(null,a,o))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),Object.defineProperties(e,ky(t)),e}Hd.custom=Xr;var Ol,rp,Rl,ip,MA={inherits:Nd,_extend:Fd,log:Ny,isBuffer:Ry,isPrimitive:Oy,isFunction:zs,isError:js,isDate:tc,isObject:Ai,isRegExp:$s,isUndefined:Bn,isSymbol:Iy,isString:ro,isNumber:Dd,isNullOrUndefined:Ty,isNull:Ao,isBoolean:kc,isArray:Ld,inspect:Un,deprecate:Bd,format:xc,debuglog:Py,promisify:Hd,callbackify:By},Ly=vo(Object.freeze({__proto__:null,_extend:Fd,callbackify:By,debuglog:Py,default:MA,deprecate:Bd,format:xc,inherits:Nd,inspect:Un,isArray:Ld,isBoolean:kc,isBuffer:Ry,isDate:tc,isError:js,isFunction:zs,isNull:Ao,isNullOrUndefined:Ty,isNumber:Dd,isObject:Ai,isPrimitive:Oy,isRegExp:$s,isString:ro,isSymbol:Iy,isUndefined:Bn,log:Ny,promisify:Hd}));function BA(){if(rp)return Ol;function t(c,l){var u=Object.keys(c);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(c);l&&(d=d.filter(function(h){return Object.getOwnPropertyDescriptor(c,h).enumerable})),u.push.apply(u,d)}return u}function e(c){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?t(Object(u),!0).forEach(function(d){n(c,d,u[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(u)):t(Object(u)).forEach(function(d){Object.defineProperty(c,d,Object.getOwnPropertyDescriptor(u,d))})}return c}function n(c,l,u){return(l=i(l))in c?Object.defineProperty(c,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):c[l]=u,c}function r(c,l,u){return l&&function(d,h){for(var f=0;f<h.length;f++){var g=h[f];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(d,i(g.key),g)}}(c.prototype,l),Object.defineProperty(c,"prototype",{writable:!1}),c}function i(c){var l=function(u,d){if(typeof u!="object"||u===null)return u;var h=u[Symbol.toPrimitive];if(h!==void 0){var f=h.call(u,d);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(u)}(c,"string");return typeof l=="symbol"?l:String(l)}rp=1;var s=Md.Buffer,o=Ly.inspect,a=o&&o.custom||"inspect";return Ol=function(){function c(){(function(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")})(this,c),this.head=null,this.tail=null,this.length=0}return r(c,[{key:"push",value:function(l){var u={data:l,next:null};this.length>0?this.tail.next=u:this.head=u,this.tail=u,++this.length}},{key:"unshift",value:function(l){var u={data:l,next:this.head};this.length===0&&(this.tail=u),this.head=u,++this.length}},{key:"shift",value:function(){if(this.length!==0){var l=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,l}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(l){if(this.length===0)return"";for(var u=this.head,d=""+u.data;u=u.next;)d+=l+u.data;return d}},{key:"concat",value:function(l){if(this.length===0)return s.alloc(0);for(var u,d,h,f=s.allocUnsafe(l>>>0),g=this.head,p=0;g;)u=g.data,d=f,h=p,s.prototype.copy.call(u,d,h),p+=g.data.length,g=g.next;return f}},{key:"consume",value:function(l,u){var d;return l<this.head.data.length?(d=this.head.data.slice(0,l),this.head.data=this.head.data.slice(l)):d=l===this.head.data.length?this.shift():u?this._getString(l):this._getBuffer(l),d}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(l){var u=this.head,d=1,h=u.data;for(l-=h.length;u=u.next;){var f=u.data,g=l>f.length?f.length:l;if(g===f.length?h+=f:h+=f.slice(0,l),(l-=g)===0){g===f.length?(++d,u.next?this.head=u.next:this.head=this.tail=null):(this.head=u,u.data=f.slice(g));break}++d}return this.length-=d,h}},{key:"_getBuffer",value:function(l){var u=s.allocUnsafe(l),d=this.head,h=1;for(d.data.copy(u),l-=d.data.length;d=d.next;){var f=d.data,g=l>f.length?f.length:l;if(f.copy(u,u.length-l,0,g),(l-=g)===0){g===f.length?(++h,d.next?this.head=d.next:this.head=this.tail=null):(this.head=d,d.data=f.slice(g));break}++h}return this.length-=h,u}},{key:a,value:function(l,u){return o(this,e(e({},u),{},{depth:0,customInspect:!1}))}}]),c}(),Ol}function Dy(){if(ip)return Rl;function t(r,i){n(r,i),e(r)}function e(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function n(r,i){r.emit("error",i)}return ip=1,Rl={destroy:function(r,i){var s=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(i?i(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Re.nextTick(n,this,r)):Re.nextTick(n,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(c){!i&&c?s._writableState?s._writableState.errorEmitted?Re.nextTick(e,s):(s._writableState.errorEmitted=!0,Re.nextTick(t,s,c)):Re.nextTick(t,s,c):i?(Re.nextTick(e,s),i(c)):Re.nextTick(e,s)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(r,i){var s=r._readableState,o=r._writableState;s&&s.autoDestroy||o&&o.autoDestroy?r.destroy(i):r.emit("error",i)}},Rl}var Si={},sp,op,Uy={};function Zt(t,e,n){n||(n=Error);var r=function(i){var s,o;function a(c,l,u){return i.call(this,function(d,h,f){return typeof e=="string"?e:e(d,h,f)}(c,l,u))||this}return o=i,(s=a).prototype=Object.create(o.prototype),s.prototype.constructor=s,s.__proto__=o,a}(n);r.prototype.name=n.name,r.prototype.code=t,Uy[t]=r}function ap(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map(function(r){return String(r)}),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:n===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}function Fy(){if(op)return sp;op=1;var t=Si.codes.ERR_INVALID_OPT_VALUE;return sp={getHighWaterMark:function(e,n,r,i){var s=function(o,a,c){return o.highWaterMark!=null?o.highWaterMark:a?o[c]:null}(n,i,r);if(s!=null){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new t(i?r:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}}Zt("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError),Zt("ERR_INVALID_ARG_TYPE",function(t,e,n){var r,i,s;if(typeof e=="string"&&(i="not ",e.substr(0,i.length)===i)?(r="must not be",e=e.replace(/^not /,"")):r="must be",function(a,c,l){return(l===void 0||l>a.length)&&(l=a.length),a.substring(l-c.length,l)===c}(t," argument"))s="The ".concat(t," ").concat(r," ").concat(ap(e,"type"));else{var o=function(a,c,l){return typeof l!="number"&&(l=0),!(l+c.length>a.length)&&a.indexOf(c,l)!==-1}(t,".")?"property":"argument";s='The "'.concat(t,'" ').concat(o," ").concat(r," ").concat(ap(e,"type"))}return s+=". Received type ".concat(typeof n)},TypeError),Zt("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),Zt("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"}),Zt("ERR_STREAM_PREMATURE_CLOSE","Premature close"),Zt("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"}),Zt("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),Zt("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),Zt("ERR_STREAM_WRITE_AFTER_END","write after end"),Zt("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),Zt("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError),Zt("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Si.codes=Uy;var Nl,cp,Ml,lp,Bl,up,LA=typeof Object.create=="function"?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t},So=vo(Object.freeze({__proto__:null,default:LA}));function DA(){if(cp)return Nl;function t(e){try{if(!ln.localStorage)return!1}catch{return!1}var n=ln.localStorage[e];return n!=null&&String(n).toLowerCase()==="true"}return cp=1,Nl=function(e,n){if(t("noDeprecation"))return e;var r=!1;return function(){if(!r){if(t("throwDeprecation"))throw new Error(n);t("traceDeprecation")?console.trace(n):console.warn(n),r=!0}return e.apply(this,arguments)}},Nl}function Hy(){if(lp)return Ml;function t(U){var M=this;this.next=null,this.entry=null,this.finish=function(){(function(O,A,T){var F=O.entry;for(O.entry=null;F;){var w=F.callback;A.pendingcb--,w(T),F=F.next}A.corkedRequestsFree.next=O})(M,U)}}var e;lp=1,Ml=R,R.WritableState=I;var n={deprecate:DA()},r=xy(),i=Md.Buffer,s=(ln!==void 0?ln:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},o,a=Dy(),c=Fy().getHighWaterMark,l=Si.codes,u=l.ERR_INVALID_ARG_TYPE,d=l.ERR_METHOD_NOT_IMPLEMENTED,h=l.ERR_MULTIPLE_CALLBACK,f=l.ERR_STREAM_CANNOT_PIPE,g=l.ERR_STREAM_DESTROYED,p=l.ERR_STREAM_NULL_VALUES,y=l.ERR_STREAM_WRITE_AFTER_END,m=l.ERR_UNKNOWN_ENCODING,C=a.errorOrDestroy;function v(){}function I(U,M,O){e=e||os(),U=U||{},typeof O!="boolean"&&(O=M instanceof e),this.objectMode=!!U.objectMode,O&&(this.objectMode=this.objectMode||!!U.writableObjectMode),this.highWaterMark=c(this,U,"writableHighWaterMark",O),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var A=U.decodeStrings===!1;this.decodeStrings=!A,this.defaultEncoding=U.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(T){(function(F,w){var S=F._writableState,_=S.sync,k=S.writecb;if(typeof k!="function")throw new h;if(function(b){b.writing=!1,b.writecb=null,b.length-=b.writelen,b.writelen=0}(S),w)(function(b,x,P,N,H){--x.pendingcb,P?(Re.nextTick(H,N),Re.nextTick($,b,x),b._writableState.errorEmitted=!0,C(b,N)):(H(N),b._writableState.errorEmitted=!0,C(b,N),$(b,x))})(F,S,_,w,k);else{var E=D(S)||F.destroyed;E||S.corked||S.bufferProcessing||!S.bufferedRequest||j(F,S),_?Re.nextTick(z,F,S,E,k):z(F,S,E,k)}})(M,T)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=U.emitClose!==!1,this.autoDestroy=!!U.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}function R(U){var M=this instanceof(e=e||os());if(!M&&!o.call(R,this))return new R(U);this._writableState=new I(U,this,M),this.writable=!0,U&&(typeof U.write=="function"&&(this._write=U.write),typeof U.writev=="function"&&(this._writev=U.writev),typeof U.destroy=="function"&&(this._destroy=U.destroy),typeof U.final=="function"&&(this._final=U.final)),r.call(this)}function L(U,M,O,A,T,F,w){M.writelen=A,M.writecb=w,M.writing=!0,M.sync=!0,M.destroyed?M.onwrite(new g("write")):O?U._writev(T,M.onwrite):U._write(T,F,M.onwrite),M.sync=!1}function z(U,M,O,A){O||function(T,F){F.length===0&&F.needDrain&&(F.needDrain=!1,T.emit("drain"))}(U,M),M.pendingcb--,A(),$(U,M)}function j(U,M){M.bufferProcessing=!0;var O=M.bufferedRequest;if(U._writev&&O&&O.next){var A=M.bufferedRequestCount,T=new Array(A),F=M.corkedRequestsFree;F.entry=O;for(var w=0,S=!0;O;)T[w]=O,O.isBuf||(S=!1),O=O.next,w+=1;T.allBuffers=S,L(U,M,!0,M.length,T,"",F.finish),M.pendingcb++,M.lastBufferedRequest=null,F.next?(M.corkedRequestsFree=F.next,F.next=null):M.corkedRequestsFree=new t(M),M.bufferedRequestCount=0}else{for(;O;){var _=O.chunk,k=O.encoding,E=O.callback;if(L(U,M,!1,M.objectMode?1:_.length,_,k,E),O=O.next,M.bufferedRequestCount--,M.writing)break}O===null&&(M.lastBufferedRequest=null)}M.bufferedRequest=O,M.bufferProcessing=!1}function D(U){return U.ending&&U.length===0&&U.bufferedRequest===null&&!U.finished&&!U.writing}function B(U,M){U._final(function(O){M.pendingcb--,O&&C(U,O),M.prefinished=!0,U.emit("prefinish"),$(U,M)})}function $(U,M){var O=D(M);if(O&&(function(T,F){F.prefinished||F.finalCalled||(typeof T._final!="function"||F.destroyed?(F.prefinished=!0,T.emit("prefinish")):(F.pendingcb++,F.finalCalled=!0,Re.nextTick(B,T,F)))}(U,M),M.pendingcb===0&&(M.finished=!0,U.emit("finish"),M.autoDestroy))){var A=U._readableState;(!A||A.autoDestroy&&A.endEmitted)&&U.destroy()}return O}return So(R,r),I.prototype.getBuffer=function(){for(var U=this.bufferedRequest,M=[];U;)M.push(U),U=U.next;return M},function(){try{Object.defineProperty(I.prototype,"buffer",{get:n.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(R,Symbol.hasInstance,{value:function(U){return!!o.call(this,U)||this===R&&U&&U._writableState instanceof I}})):o=function(U){return U instanceof this},R.prototype.pipe=function(){C(this,new f)},R.prototype.write=function(U,M,O){var A,T=this._writableState,F=!1,w=!T.objectMode&&(A=U,i.isBuffer(A)||A instanceof s);return w&&!i.isBuffer(U)&&(U=function(S){return i.from(S)}(U)),typeof M=="function"&&(O=M,M=null),w?M="buffer":M||(M=T.defaultEncoding),typeof O!="function"&&(O=v),T.ending?function(S,_){var k=new y;C(S,k),Re.nextTick(_,k)}(this,O):(w||function(S,_,k,E){var b;return k===null?b=new p:typeof k=="string"||_.objectMode||(b=new u("chunk",["string","Buffer"],k)),!b||(C(S,b),Re.nextTick(E,b),!1)}(this,T,U,O))&&(T.pendingcb++,F=function(S,_,k,E,b,x){if(!k){var P=function(V,q,Y){return V.objectMode||V.decodeStrings===!1||typeof q!="string"||(q=i.from(q,Y)),q}(_,E,b);E!==P&&(k=!0,b="buffer",E=P)}var N=_.objectMode?1:E.length;_.length+=N;var H=_.length<_.highWaterMark;if(H||(_.needDrain=!0),_.writing||_.corked){var K=_.lastBufferedRequest;_.lastBufferedRequest={chunk:E,encoding:b,isBuf:k,callback:x,next:null},K?K.next=_.lastBufferedRequest:_.bufferedRequest=_.lastBufferedRequest,_.bufferedRequestCount+=1}else L(S,_,!1,N,E,b,x);return H}(this,T,w,U,M,O)),F},R.prototype.cork=function(){this._writableState.corked++},R.prototype.uncork=function(){var U=this._writableState;U.corked&&(U.corked--,U.writing||U.corked||U.bufferProcessing||!U.bufferedRequest||j(this,U))},R.prototype.setDefaultEncoding=function(U){if(typeof U=="string"&&(U=U.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((U+"").toLowerCase())>-1))throw new m(U);return this._writableState.defaultEncoding=U,this},Object.defineProperty(R.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(R.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),R.prototype._write=function(U,M,O){O(new d("_write()"))},R.prototype._writev=null,R.prototype.end=function(U,M,O){var A=this._writableState;return typeof U=="function"?(O=U,U=null,M=null):typeof M=="function"&&(O=M,M=null),U!=null&&this.write(U,M),A.corked&&(A.corked=1,this.uncork()),A.ending||function(T,F,w){F.ending=!0,$(T,F),w&&(F.finished?Re.nextTick(w):T.once("finish",w)),F.ended=!0,T.writable=!1}(this,A,O),this},Object.defineProperty(R.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(U){this._writableState&&(this._writableState.destroyed=U)}}),R.prototype.destroy=a.destroy,R.prototype._undestroy=a.undestroy,R.prototype._destroy=function(U,M){M(U)},Ml}function os(){if(up)return Bl;up=1;var t=Object.keys||function(l){var u=[];for(var d in l)u.push(d);return u};Bl=o;var e=Ky(),n=Hy();So(o,e);for(var r=t(n.prototype),i=0;i<r.length;i++){var s=r[i];o.prototype[s]||(o.prototype[s]=n.prototype[s])}function o(l){if(!(this instanceof o))return new o(l);e.call(this,l),n.call(this,l),this.allowHalfOpen=!0,l&&(l.readable===!1&&(this.readable=!1),l.writable===!1&&(this.writable=!1),l.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",a)))}function a(){this._writableState.ended||Re.nextTick(c,this)}function c(l){l.end()}return Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(l){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=l,this._writableState.destroyed=l)}}),Bl}var UA=ee.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Ia(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!UA(e))throw new Error("Unknown encoding: "+e)}(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=HA;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=KA;break;default:return void(this.write=FA)}this.charBuffer=new ee(6),this.charReceived=0,this.charLength=0}function FA(t){return t.toString(this.encoding)}function HA(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function KA(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}Ia.prototype.write=function(t){for(var e="";this.charLength;){var n=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(t=t.slice(n,t.length),!((i=(e=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(e.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,t.length===0)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var r=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,r),r-=this.charReceived);var i;if(r=(e+=t.toString(this.encoding,0,r)).length-1,(i=e.charCodeAt(r))>=55296&&i<=56319){var s=this.surrogateSize;return this.charLength+=s,this.charReceived+=s,this.charBuffer.copy(this.charBuffer,s,0,s),t.copy(this.charBuffer,0,0,s),e.substring(0,r)}return e},Ia.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var n=t[t.length-e];if(e==1&&n>>5==6){this.charLength=2;break}if(e<=2&&n>>4==14){this.charLength=3;break}if(e<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=e},Ia.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;e+=r.slice(0,n).toString(i)}return e};var dp=vo(Object.freeze({__proto__:null,StringDecoder:Ia})),hp=Si.codes.ERR_STREAM_PREMATURE_CLOSE;function $A(){}var Ll,fp,pp,gp,Dl,mp,Kd=function t(e,n,r){if(typeof n=="function")return t(e,null,n);n||(n={}),r=function(g){var p=!1;return function(){if(!p){p=!0;for(var y=arguments.length,m=new Array(y),C=0;C<y;C++)m[C]=arguments[C];g.apply(this,m)}}}(r||$A);var i=n.readable||n.readable!==!1&&e.readable,s=n.writable||n.writable!==!1&&e.writable,o=function(){e.writable||c()},a=e._writableState&&e._writableState.finished,c=function(){s=!1,a=!0,i||r.call(e)},l=e._readableState&&e._readableState.endEmitted,u=function(){i=!1,l=!0,s||r.call(e)},d=function(g){r.call(e,g)},h=function(){var g;return i&&!l?(e._readableState&&e._readableState.ended||(g=new hp),r.call(e,g)):s&&!a?(e._writableState&&e._writableState.ended||(g=new hp),r.call(e,g)):void 0},f=function(){e.req.on("finish",c)};return function(g){return g.setHeader&&typeof g.abort=="function"}(e)?(e.on("complete",c),e.on("abort",h),e.req?f():e.on("request",f)):s&&!e._writableState&&(e.on("end",o),e.on("close",o)),e.on("end",u),e.on("finish",c),n.error!==!1&&e.on("error",d),e.on("close",h),function(){e.removeListener("complete",c),e.removeListener("abort",h),e.removeListener("request",f),e.req&&e.req.removeListener("finish",c),e.removeListener("end",o),e.removeListener("close",o),e.removeListener("finish",c),e.removeListener("end",u),e.removeListener("error",d),e.removeListener("close",h)}};function jA(){if(fp)return Ll;var t;function e(p,y,m){return(y=function(C){var v=function(I,R){if(typeof I!="object"||I===null)return I;var L=I[Symbol.toPrimitive];if(L!==void 0){var z=L.call(I,R);if(typeof z!="object")return z;throw new TypeError("@@toPrimitive must return a primitive value.")}return(R==="string"?String:Number)(I)}(C,"string");return typeof v=="symbol"?v:String(v)}(y))in p?Object.defineProperty(p,y,{value:m,enumerable:!0,configurable:!0,writable:!0}):p[y]=m,p}fp=1;var n=Kd,r=Symbol("lastResolve"),i=Symbol("lastReject"),s=Symbol("error"),o=Symbol("ended"),a=Symbol("lastPromise"),c=Symbol("handlePromise"),l=Symbol("stream");function u(p,y){return{value:p,done:y}}function d(p){var y=p[r];if(y!==null){var m=p[l].read();m!==null&&(p[a]=null,p[r]=null,p[i]=null,y(u(m,!1)))}}function h(p){Re.nextTick(d,p)}var f=Object.getPrototypeOf(function(){}),g=Object.setPrototypeOf((e(t={get stream(){return this[l]},next:function(){var p=this,y=this[s];if(y!==null)return Promise.reject(y);if(this[o])return Promise.resolve(u(void 0,!0));if(this[l].destroyed)return new Promise(function(I,R){Re.nextTick(function(){p[s]?R(p[s]):I(u(void 0,!0))})});var m,C=this[a];if(C)m=new Promise(function(I,R){return function(L,z){I.then(function(){R[o]?L(u(void 0,!0)):R[c](L,z)},z)}}(C,this));else{var v=this[l].read();if(v!==null)return Promise.resolve(u(v,!1));m=new Promise(this[c])}return this[a]=m,m}},Symbol.asyncIterator,function(){return this}),e(t,"return",function(){var p=this;return new Promise(function(y,m){p[l].destroy(null,function(C){C?m(C):y(u(void 0,!0))})})}),t),f);return Ll=function(p){var y,m=Object.create(g,(e(y={},l,{value:p,writable:!0}),e(y,r,{value:null,writable:!0}),e(y,i,{value:null,writable:!0}),e(y,s,{value:null,writable:!0}),e(y,o,{value:p._readableState.endEmitted,writable:!0}),e(y,c,{value:function(C,v){var I=m[l].read();I?(m[a]=null,m[r]=null,m[i]=null,C(u(I,!1))):(m[r]=C,m[i]=v)},writable:!0}),y));return m[a]=null,n(p,function(C){if(C&&C.code!=="ERR_STREAM_PREMATURE_CLOSE"){var v=m[i];return v!==null&&(m[a]=null,m[r]=null,m[i]=null,v(C)),void(m[s]=C)}var I=m[r];I!==null&&(m[a]=null,m[r]=null,m[i]=null,I(u(void 0,!0))),m[o]=!0}),p.on("readable",h.bind(null,m)),m},Ll}function Ky(){if(mp)return Dl;var t;mp=1,Dl=R,R.ReadableState=I,Rd.EventEmitter;var e=function(E,b){return E.listeners(b).length},n=xy(),r=Md.Buffer,i=(ln!==void 0?ln:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},s,o=Ly;s=o&&o.debuglog?o.debuglog("stream"):function(){};var a,c,l,u=BA(),d=Dy(),h=Fy().getHighWaterMark,f=Si.codes,g=f.ERR_INVALID_ARG_TYPE,p=f.ERR_STREAM_PUSH_AFTER_EOF,y=f.ERR_METHOD_NOT_IMPLEMENTED,m=f.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;So(R,n);var C=d.errorOrDestroy,v=["error","close","destroy","pause","resume"];function I(E,b,x){t=t||os(),E=E||{},typeof x!="boolean"&&(x=b instanceof t),this.objectMode=!!E.objectMode,x&&(this.objectMode=this.objectMode||!!E.readableObjectMode),this.highWaterMark=h(this,E,"readableHighWaterMark",x),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=E.emitClose!==!1,this.autoDestroy=!!E.autoDestroy,this.destroyed=!1,this.defaultEncoding=E.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,E.encoding&&(a||(a=dp.StringDecoder),this.decoder=new a(E.encoding),this.encoding=E.encoding)}function R(E){if(t=t||os(),!(this instanceof R))return new R(E);var b=this instanceof t;this._readableState=new I(E,this,b),this.readable=!0,E&&(typeof E.read=="function"&&(this._read=E.read),typeof E.destroy=="function"&&(this._destroy=E.destroy)),n.call(this)}function L(E,b,x,P,N){s("readableAddChunk",b);var H,K=E._readableState;if(b===null)K.reading=!1,function(V,q){if(s("onEofChunk"),!q.ended){if(q.decoder){var Y=q.decoder.end();Y&&Y.length&&(q.buffer.push(Y),q.length+=q.objectMode?1:Y.length)}q.ended=!0,q.sync?B(V):(q.needReadable=!1,q.emittedReadable||(q.emittedReadable=!0,$(V)))}}(E,K);else if(N||(H=function(V,q){var Y;Z=q,r.isBuffer(Z)||Z instanceof i||typeof q=="string"||q===void 0||V.objectMode||(Y=new g("chunk",["string","Buffer","Uint8Array"],q));var Z;return Y}(K,b)),H)C(E,H);else if(K.objectMode||b&&b.length>0)if(typeof b=="string"||K.objectMode||Object.getPrototypeOf(b)===r.prototype||(b=function(V){return r.from(V)}(b)),P)K.endEmitted?C(E,new m):z(E,K,b,!0);else if(K.ended)C(E,new p);else{if(K.destroyed)return!1;K.reading=!1,K.decoder&&!x?(b=K.decoder.write(b),K.objectMode||b.length!==0?z(E,K,b,!1):U(E,K)):z(E,K,b,!1)}else P||(K.reading=!1,U(E,K));return!K.ended&&(K.length<K.highWaterMark||K.length===0)}function z(E,b,x,P){b.flowing&&b.length===0&&!b.sync?(b.awaitDrain=0,E.emit("data",x)):(b.length+=b.objectMode?1:x.length,P?b.buffer.unshift(x):b.buffer.push(x),b.needReadable&&B(E)),U(E,b)}Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(E){this._readableState&&(this._readableState.destroyed=E)}}),R.prototype.destroy=d.destroy,R.prototype._undestroy=d.undestroy,R.prototype._destroy=function(E,b){b(E)},R.prototype.push=function(E,b){var x,P=this._readableState;return P.objectMode?x=!0:typeof E=="string"&&((b=b||P.defaultEncoding)!==P.encoding&&(E=r.from(E,b),b=""),x=!0),L(this,E,b,!1,x)},R.prototype.unshift=function(E){return L(this,E,null,!0,!1)},R.prototype.isPaused=function(){return this._readableState.flowing===!1},R.prototype.setEncoding=function(E){a||(a=dp.StringDecoder);var b=new a(E);this._readableState.decoder=b,this._readableState.encoding=this._readableState.decoder.encoding;for(var x=this._readableState.buffer.head,P="";x!==null;)P+=b.write(x.data),x=x.next;return this._readableState.buffer.clear(),P!==""&&this._readableState.buffer.push(P),this._readableState.length=P.length,this};var j=1073741824;function D(E,b){return E<=0||b.length===0&&b.ended?0:b.objectMode?1:E!=E?b.flowing&&b.length?b.buffer.head.data.length:b.length:(E>b.highWaterMark&&(b.highWaterMark=function(x){return x>=j?x=j:(x--,x|=x>>>1,x|=x>>>2,x|=x>>>4,x|=x>>>8,x|=x>>>16,x++),x}(E)),E<=b.length?E:b.ended?b.length:(b.needReadable=!0,0))}function B(E){var b=E._readableState;s("emitReadable",b.needReadable,b.emittedReadable),b.needReadable=!1,b.emittedReadable||(s("emitReadable",b.flowing),b.emittedReadable=!0,Re.nextTick($,E))}function $(E){var b=E._readableState;s("emitReadable_",b.destroyed,b.length,b.ended),b.destroyed||!b.length&&!b.ended||(E.emit("readable"),b.emittedReadable=!1),b.needReadable=!b.flowing&&!b.ended&&b.length<=b.highWaterMark,F(E)}function U(E,b){b.readingMore||(b.readingMore=!0,Re.nextTick(M,E,b))}function M(E,b){for(;!b.reading&&!b.ended&&(b.length<b.highWaterMark||b.flowing&&b.length===0);){var x=b.length;if(s("maybeReadMore read 0"),E.read(0),x===b.length)break}b.readingMore=!1}function O(E){var b=E._readableState;b.readableListening=E.listenerCount("readable")>0,b.resumeScheduled&&!b.paused?b.flowing=!0:E.listenerCount("data")>0&&E.resume()}function A(E){s("readable nexttick read 0"),E.read(0)}function T(E,b){s("resume",b.reading),b.reading||E.read(0),b.resumeScheduled=!1,E.emit("resume"),F(E),b.flowing&&!b.reading&&E.read(0)}function F(E){var b=E._readableState;for(s("flow",b.flowing);b.flowing&&E.read()!==null;);}function w(E,b){return b.length===0?null:(b.objectMode?x=b.buffer.shift():!E||E>=b.length?(x=b.decoder?b.buffer.join(""):b.buffer.length===1?b.buffer.first():b.buffer.concat(b.length),b.buffer.clear()):x=b.buffer.consume(E,b.decoder),x);var x}function S(E){var b=E._readableState;s("endReadable",b.endEmitted),b.endEmitted||(b.ended=!0,Re.nextTick(_,b,E))}function _(E,b){if(s("endReadableNT",E.endEmitted,E.length),!E.endEmitted&&E.length===0&&(E.endEmitted=!0,b.readable=!1,b.emit("end"),E.autoDestroy)){var x=b._writableState;(!x||x.autoDestroy&&x.finished)&&b.destroy()}}function k(E,b){for(var x=0,P=E.length;x<P;x++)if(E[x]===b)return x;return-1}return R.prototype.read=function(E){s("read",E),E=parseInt(E,10);var b=this._readableState,x=E;if(E!==0&&(b.emittedReadable=!1),E===0&&b.needReadable&&((b.highWaterMark!==0?b.length>=b.highWaterMark:b.length>0)||b.ended))return s("read: emitReadable",b.length,b.ended),b.length===0&&b.ended?S(this):B(this),null;if((E=D(E,b))===0&&b.ended)return b.length===0&&S(this),null;var P,N=b.needReadable;return s("need readable",N),(b.length===0||b.length-E<b.highWaterMark)&&s("length less than watermark",N=!0),b.ended||b.reading?s("reading or ended",N=!1):N&&(s("do read"),b.reading=!0,b.sync=!0,b.length===0&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1,b.reading||(E=D(x,b))),(P=E>0?w(E,b):null)===null?(b.needReadable=b.length<=b.highWaterMark,E=0):(b.length-=E,b.awaitDrain=0),b.length===0&&(b.ended||(b.needReadable=!0),x!==E&&b.ended&&S(this)),P!==null&&this.emit("data",P),P},R.prototype._read=function(E){C(this,new y("_read()"))},R.prototype.pipe=function(E,b){var x=this,P=this._readableState;switch(P.pipesCount){case 0:P.pipes=E;break;case 1:P.pipes=[P.pipes,E];break;default:P.pipes.push(E)}P.pipesCount+=1,s("pipe count=%d opts=%j",P.pipesCount,b);var N=(!b||b.end!==!1)&&E!==Re.stdout&&E!==Re.stderr?K:pe;function H(se,ae){s("onunpipe"),se===x&&ae&&ae.hasUnpiped===!1&&(ae.hasUnpiped=!0,s("cleanup"),E.removeListener("close",ie),E.removeListener("finish",oe),E.removeListener("drain",V),E.removeListener("error",Z),E.removeListener("unpipe",H),x.removeListener("end",K),x.removeListener("end",pe),x.removeListener("data",Y),q=!0,!P.awaitDrain||E._writableState&&!E._writableState.needDrain||V())}function K(){s("onend"),E.end()}P.endEmitted?Re.nextTick(N):x.once("end",N),E.on("unpipe",H);var V=function(se){return function(){var ae=se._readableState;s("pipeOnDrain",ae.awaitDrain),ae.awaitDrain&&ae.awaitDrain--,ae.awaitDrain===0&&e(se,"data")&&(ae.flowing=!0,F(se))}}(x);E.on("drain",V);var q=!1;function Y(se){s("ondata");var ae=E.write(se);s("dest.write",ae),ae===!1&&((P.pipesCount===1&&P.pipes===E||P.pipesCount>1&&k(P.pipes,E)!==-1)&&!q&&(s("false write response, pause",P.awaitDrain),P.awaitDrain++),x.pause())}function Z(se){s("onerror",se),pe(),E.removeListener("error",Z),e(E,"error")===0&&C(E,se)}function ie(){E.removeListener("finish",oe),pe()}function oe(){s("onfinish"),E.removeListener("close",ie),pe()}function pe(){s("unpipe"),x.unpipe(E)}return x.on("data",Y),function(se,ae,fe){if(typeof se.prependListener=="function")return se.prependListener(ae,fe);se._events&&se._events[ae]?Array.isArray(se._events[ae])?se._events[ae].unshift(fe):se._events[ae]=[fe,se._events[ae]]:se.on(ae,fe)}(E,"error",Z),E.once("close",ie),E.once("finish",oe),E.emit("pipe",x),P.flowing||(s("pipe resume"),x.resume()),E},R.prototype.unpipe=function(E){var b=this._readableState,x={hasUnpiped:!1};if(b.pipesCount===0)return this;if(b.pipesCount===1)return E&&E!==b.pipes||(E||(E=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,E&&E.emit("unpipe",this,x)),this;if(!E){var P=b.pipes,N=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var H=0;H<N;H++)P[H].emit("unpipe",this,{hasUnpiped:!1});return this}var K=k(b.pipes,E);return K===-1||(b.pipes.splice(K,1),b.pipesCount-=1,b.pipesCount===1&&(b.pipes=b.pipes[0]),E.emit("unpipe",this,x)),this},R.prototype.on=function(E,b){var x=n.prototype.on.call(this,E,b),P=this._readableState;return E==="data"?(P.readableListening=this.listenerCount("readable")>0,P.flowing!==!1&&this.resume()):E==="readable"&&(P.endEmitted||P.readableListening||(P.readableListening=P.needReadable=!0,P.flowing=!1,P.emittedReadable=!1,s("on readable",P.length,P.reading),P.length?B(this):P.reading||Re.nextTick(A,this))),x},R.prototype.addListener=R.prototype.on,R.prototype.removeListener=function(E,b){var x=n.prototype.removeListener.call(this,E,b);return E==="readable"&&Re.nextTick(O,this),x},R.prototype.removeAllListeners=function(E){var b=n.prototype.removeAllListeners.apply(this,arguments);return E!=="readable"&&E!==void 0||Re.nextTick(O,this),b},R.prototype.resume=function(){var E=this._readableState;return E.flowing||(s("resume"),E.flowing=!E.readableListening,function(b,x){x.resumeScheduled||(x.resumeScheduled=!0,Re.nextTick(T,b,x))}(this,E)),E.paused=!1,this},R.prototype.pause=function(){return s("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(s("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},R.prototype.wrap=function(E){var b=this,x=this._readableState,P=!1;for(var N in E.on("end",function(){if(s("wrapped end"),x.decoder&&!x.ended){var K=x.decoder.end();K&&K.length&&b.push(K)}b.push(null)}),E.on("data",function(K){s("wrapped data"),x.decoder&&(K=x.decoder.write(K)),x.objectMode&&K==null||(x.objectMode||K&&K.length)&&(b.push(K)||(P=!0,E.pause()))}),E)this[N]===void 0&&typeof E[N]=="function"&&(this[N]=function(K){return function(){return E[K].apply(E,arguments)}}(N));for(var H=0;H<v.length;H++)E.on(v[H],this.emit.bind(this,v[H]));return this._read=function(K){s("wrapped _read",K),P&&(P=!1,E.resume())},this},typeof Symbol=="function"&&(R.prototype[Symbol.asyncIterator]=function(){return c===void 0&&(c=jA()),c(this)}),Object.defineProperty(R.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(R.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(R.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(E){this._readableState&&(this._readableState.flowing=E)}}),R._fromList=w,Object.defineProperty(R.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(R.from=function(E,b){return l===void 0&&(l=gp?pp:(gp=1,pp=function(){throw new Error("Readable.from is not available in the browser")})),l(R,E,b)}),Dl}var $y=Wn,Pc=Si.codes,zA=Pc.ERR_METHOD_NOT_IMPLEMENTED,GA=Pc.ERR_MULTIPLE_CALLBACK,VA=Pc.ERR_TRANSFORM_ALREADY_TRANSFORMING,qA=Pc.ERR_TRANSFORM_WITH_LENGTH_0,Oa=os();function WA(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(r===null)return this.emit("error",new GA);n.writechunk=null,n.writecb=null,e!=null&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Wn(t){if(!(this instanceof Wn))return new Wn(t);Oa.call(this,t),this._transformState={afterTransform:WA.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",QA)}function QA(){var t=this;typeof this._flush!="function"||this._readableState.destroyed?yp(this,null,null):this._flush(function(e,n){yp(t,e,n)})}function yp(t,e,n){if(e)return t.emit("error",e);if(n!=null&&t.push(n),t._writableState.length)throw new qA;if(t._transformState.transforming)throw new VA;return t.push(null)}So(Wn,Oa),Wn.prototype.push=function(t,e){return this._transformState.needTransform=!1,Oa.prototype.push.call(this,t,e)},Wn.prototype._transform=function(t,e,n){n(new zA("_transform()"))},Wn.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Wn.prototype._read=function(t){var e=this._transformState;e.writechunk===null||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},Wn.prototype._destroy=function(t,e){Oa.prototype._destroy.call(this,t,function(n){e(n)})};var Ul,JA=io,jy=$y;function io(t){if(!(this instanceof io))return new io(t);jy.call(this,t)}So(io,jy),io.prototype._transform=function(t,e,n){n(null,t)};var zy=Si.codes,YA=zy.ERR_MISSING_ARGS,ZA=zy.ERR_STREAM_DESTROYED;function wp(t){if(t)throw t}function vp(t){t()}function XA(t,e){return t.pipe(e)}var e2=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,i=function(o){return o.length?typeof o[o.length-1]!="function"?wp:o.pop():wp}(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new YA("streams");var s=e.map(function(o,a){var c=a<e.length-1;return function(l,u,d,h){h=function(p){var y=!1;return function(){y||(y=!0,p.apply(void 0,arguments))}}(h);var f=!1;l.on("close",function(){f=!0}),Ul===void 0&&(Ul=Kd),Ul(l,{readable:u,writable:d},function(p){if(p)return h(p);f=!0,h()});var g=!1;return function(p){if(!f&&!g)return g=!0,function(y){return y.setHeader&&typeof y.abort=="function"}(l)?l.abort():typeof l.destroy=="function"?l.destroy():void h(p||new ZA("pipe"))}}(o,c,a>0,function(l){r||(r=l),l&&s.forEach(vp),c||(s.forEach(vp),i(r))})});return e.reduce(XA)};(function(t,e){(e=Bu.exports=Ky()).Stream=e,e.Readable=e,e.Writable=Hy(),e.Duplex=os(),e.Transform=$y,e.PassThrough=JA,e.finished=Kd,e.pipeline=e2})(0,Bu.exports);var as=Bu.exports;function t2(t={}){const e={},n=new as.Duplex({objectMode:!0,read:()=>{},write:function(s,o,a){let c=null;try{s.id?function(l){const{id:u}=l;if(u===null)return;const d=e[u];if(!d)return void console.warn(`StreamMiddleware - Unknown response id "${u}"`);delete e[u],Object.assign(d.res,l),setTimeout(d.end)}(s):function(l){t?.retryOnMessage&&l.method===t.retryOnMessage&&Object.values(e).forEach(({req:u,retryCount:d=0})=>{if(!u.id)return;if(d>=3)throw new Error(`StreamMiddleware - Retry limit exceeded for request id "${u.id}"`);const h=e[u.id];h&&(h.retryCount=d+1),i(u)}),r.emit("notification",l)}(s)}catch(l){c=l}a(c)}}),r=new vy;return{events:r,middleware:(s,o,a,c)=>{e[s.id]={req:s,res:o,next:a,end:c},i(s)},stream:n};function i(s){n.push(s)}}var nc={},Lu={exports:{}},n2=function t(e,n){if(e&&n)return t(e)(n);if(typeof e!="function")throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(i){r[i]=e[i]}),r;function r(){for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];var o=e.apply(this,i),a=i[i.length-1];return typeof o=="function"&&o!==a&&Object.keys(a).forEach(function(c){o[c]=a[c]}),o}},bp=n2;function ta(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function Ep(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},n=t.name||"Function wrapped with `once`";return e.onceError=n+" shouldn't be called more than once",e.called=!1,e}Lu.exports=bp(ta),Lu.exports.strict=bp(Ep),ta.proto=ta(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return ta(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Ep(this)},configurable:!0})});var r2=Lu.exports,rc={};Object.defineProperty(rc,"__esModule",{value:!0}),rc.Substream=void 0;const i2=as;class s2 extends i2.Duplex{constructor({parent:e,name:n}){super({objectMode:!0}),this._parent=e,this._name=n}_read(){}_write(e,n,r){this._parent.push({name:this._name,data:e}),r()}}rc.Substream=s2;var o2=ln&&ln.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(nc,"__esModule",{value:!0}),nc.ObjectMultiplex=void 0;const Fl=as,a2=o2(r2),c2=rc,Ap=Symbol("IGNORE_SUBSTREAM");let l2=class extends Fl.Duplex{constructor(t={}){super(Object.assign(Object.assign({},t),{objectMode:!0})),this._substreams={}}createStream(t){if(this.destroyed)throw new Error(`ObjectMultiplex - parent stream for name "${t}" already destroyed`);if(this._readableState.ended||this._writableState.ended)throw new Error(`ObjectMultiplex - parent stream for name "${t}" already ended`);if(!t)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[t])throw new Error(`ObjectMultiplex - Substream for name "${t}" already exists`);const e=new c2.Substream({parent:this,name:t});return this._substreams[t]=e,function(n,r){const i=(0,a2.default)(r);(0,Fl.finished)(n,{readable:!1},i),(0,Fl.finished)(n,{writable:!1},i)}(this,n=>e.destroy(n||void 0)),e}ignoreStream(t){if(!t)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[t])throw new Error(`ObjectMultiplex - Substream for name "${t}" already exists`);this._substreams[t]=Ap}_read(){}_write(t,e,n){const{name:r,data:i}=t;if(!r)return console.warn(`ObjectMultiplex - malformed chunk without name "${t}"`),n();const s=this._substreams[r];return s?(s!==Ap&&s.push(i),n()):(console.warn(`ObjectMultiplex - orphaned data for stream "${r}"`),n())}};nc.ObjectMultiplex=l2;var u2=Sc(nc.ObjectMultiplex);const xn=t=>t!==null&&typeof t=="object"&&typeof t.pipe=="function";xn.writable=t=>xn(t)&&t.writable!==!1&&typeof t._write=="function"&&typeof t._writableState=="object",xn.readable=t=>xn(t)&&t.readable!==!1&&typeof t._read=="function"&&typeof t._readableState=="object",xn.duplex=t=>xn.writable(t)&&xn.readable(t),xn.transform=t=>xn.duplex(t)&&typeof t._transform=="function";var kn,d2=xn,h2=class extends PA{constructor(t,{jsonRpcStreamName:e,logger:n=console,maxEventListeners:r=100,rpcMiddleware:i=[]}){if(super({logger:n,maxEventListeners:r,rpcMiddleware:i}),!d2.duplex(t))throw new Error(Qe.errors.invalidDuplexStream());this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this);const s=new u2;as.pipeline(t,s,t,this._handleStreamDisconnect.bind(this,"MetaMask")),this._jsonRpcConnection=t2({retryOnMessage:"METAMASK_EXTENSION_CONNECT_CAN_RETRY"}),as.pipeline(this._jsonRpcConnection.stream,s.createStream(e),this._jsonRpcConnection.stream,this._handleStreamDisconnect.bind(this,"MetaMask RpcProvider")),this._rpcEngine.push(this._jsonRpcConnection.middleware),this._jsonRpcConnection.events.on("notification",o=>{const{method:a,params:c}=o;a==="metamask_accountsChanged"?this._handleAccountsChanged(c):a==="metamask_unlockStateChanged"?this._handleUnlockStateChanged(c):a==="metamask_chainChanged"?this._handleChainChanged(c):by.includes(a)?this.emit("message",{type:a,data:c}):a==="METAMASK_STREAM_FAILURE"&&t.destroy(new Error(Qe.errors.permanentlyDisconnected()))})}async _initializeStateAsync(){let t;try{t=await this.request({method:"metamask_getProviderState"})}catch(e){this._log.error("MetaMask: Failed to get initial state. Please report this bug.",e)}this._initializeState(t)}_handleStreamDisconnect(t,e){let n=`MetaMask: Lost connection to "${t}".`;e?.stack&&(n+=`
${e.stack}`),this._log.warn(n),this.listenerCount("error")>0&&this.emit("error",n),this._handleDisconnect(!1,e?e.message:void 0)}_handleChainChanged({chainId:t,networkVersion:e}={}){Ey(t)&&(n=>!!n&&typeof n=="string")(e)?e==="loading"?this._handleDisconnect(!0):super._handleChainChanged({chainId:t}):this._log.error(Qe.errors.invalidNetworkParams(),{chainId:t,networkVersion:e})}},f2=class extends h2{constructor(t,{jsonRpcStreamName:e="metamask-provider",logger:n=console,maxEventListeners:r=100,shouldSendMetadata:i}={}){if(super(t,{jsonRpcStreamName:e,logger:n,maxEventListeners:r,rpcMiddleware:bA(n)}),this._sentWarnings={chainId:!1,networkVersion:!1,selectedAddress:!1,enable:!1,experimentalMethods:!1,send:!1,events:{close:!1,data:!1,networkChanged:!1,notification:!1}},Mu(this,kn,void 0),this._initializeStateAsync(),qn(this,kn,null),this.isMetaMask=!0,this._sendSync=this._sendSync.bind(this),this.enable=this.enable.bind(this),this.send=this.send.bind(this),this.sendAsync=this.sendAsync.bind(this),this._warnOfDeprecation=this._warnOfDeprecation.bind(this),this._metamask=this._getExperimentalApi(),this._jsonRpcConnection.events.on("notification",s=>{const{method:o}=s;by.includes(o)&&(this.emit("data",s),this.emit("notification",s.params.result))}),i)if(document.readyState==="complete")Xf(this._rpcEngine,this._log);else{const s=()=>{Xf(this._rpcEngine,this._log),window.removeEventListener("DOMContentLoaded",s)};window.addEventListener("DOMContentLoaded",s)}}get chainId(){return this._sentWarnings.chainId||(this._log.warn(Qe.warnings.chainIdDeprecation),this._sentWarnings.chainId=!0),super.chainId}get networkVersion(){return this._sentWarnings.networkVersion||(this._log.warn(Qe.warnings.networkVersionDeprecation),this._sentWarnings.networkVersion=!0),On(this,kn)}get selectedAddress(){return this._sentWarnings.selectedAddress||(this._log.warn(Qe.warnings.selectedAddressDeprecation),this._sentWarnings.selectedAddress=!0),super.selectedAddress}sendAsync(t,e){this._rpcRequest(t,e)}addListener(t,e){return this._warnOfDeprecation(t),super.addListener(t,e)}on(t,e){return this._warnOfDeprecation(t),super.on(t,e)}once(t,e){return this._warnOfDeprecation(t),super.once(t,e)}prependListener(t,e){return this._warnOfDeprecation(t),super.prependListener(t,e)}prependOnceListener(t,e){return this._warnOfDeprecation(t),super.prependOnceListener(t,e)}_handleDisconnect(t,e){super._handleDisconnect(t,e),On(this,kn)&&!t&&qn(this,kn,null)}_warnOfDeprecation(t){this._sentWarnings?.events[t]===!1&&(this._log.warn(Qe.warnings.events[t]),this._sentWarnings.events[t]=!0)}async enable(){return this._sentWarnings.enable||(this._log.warn(Qe.warnings.enableDeprecation),this._sentWarnings.enable=!0),new Promise((t,e)=>{try{this._rpcRequest({method:"eth_requestAccounts",params:[]},Ta(t,e))}catch(n){e(n)}})}send(t,e){return this._sentWarnings.send||(this._log.warn(Qe.warnings.sendDeprecation),this._sentWarnings.send=!0),typeof t!="string"||e&&!Array.isArray(e)?t&&typeof t=="object"&&typeof e=="function"?this._rpcRequest(t,e):this._sendSync(t):new Promise((n,r)=>{try{this._rpcRequest({method:t,params:e},Ta(n,r,!1))}catch(i){r(i)}})}_sendSync(t){let e;switch(t.method){case"eth_accounts":e=this.selectedAddress?[this.selectedAddress]:[];break;case"eth_coinbase":e=this.selectedAddress??null;break;case"eth_uninstallFilter":this._rpcRequest(t,Ay),e=!0;break;case"net_version":e=On(this,kn)??null;break;default:throw new Error(Qe.errors.unsupportedSync(t.method))}return{id:t.id,jsonrpc:t.jsonrpc,result:e}}_getExperimentalApi(){return new Proxy({isUnlocked:async()=>(this._state.initialized||await new Promise(t=>{this.on("_initialized",()=>t())}),this._state.isUnlocked),requestBatch:async t=>{if(!Array.isArray(t))throw Hs({message:"Batch requests must be made with an array of request objects.",data:t});return new Promise((e,n)=>{this._rpcRequest(t,Ta(e,n))})}},{get:(t,e,...n)=>(this._sentWarnings.experimentalMethods||(this._log.warn(Qe.warnings.experimentalMethods),this._sentWarnings.experimentalMethods=!0),Reflect.get(t,e,...n))})}_handleChainChanged({chainId:t,networkVersion:e}={}){super._handleChainChanged({chainId:t,networkVersion:e}),this._state.isConnected&&e!==On(this,kn)&&(qn(this,kn,e),this._state.initialized&&this.emit("networkChanged",On(this,kn)))}};kn=new WeakMap;const Q=Tt("MM_SDK");let Sp;Q.color="#FFAC1C";var Gy={},Fr={};Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.EthereumProviderError=Fr.EthereumRpcError=void 0;const p2=fy;class Vy extends Error{constructor(e,n,r){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!n||typeof n!="string")throw new Error('"message" must be a nonempty string.');super(n),this.code=e,r!==void 0&&(this.data=r)}serialize(){const e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),this.stack&&(e.stack=this.stack),e}toString(){return p2.default(this.serialize(),g2,2)}}Fr.EthereumRpcError=Vy;function g2(t,e){if(e!=="[Circular]")return e}Fr.EthereumProviderError=class extends Vy{constructor(t,e,n){if(!function(r){return Number.isInteger(r)&&r>=1e3&&r<=4999}(t))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(t,e,n)}};var $d={},Or={};Object.defineProperty(Or,"__esModule",{value:!0}),Or.errorValues=Or.errorCodes=void 0,Or.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}},Or.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}},function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.serializeError=t.isValidCode=t.getMessageFromCode=t.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const e=Or,n=Fr,r=e.errorCodes.rpc.internal,i="Unspecified error message. This is a bug, please report it.",s={code:r,message:o(r)};function o(d,h=i){if(Number.isInteger(d)){const f=d.toString();if(u(e.errorValues,f))return e.errorValues[f].message;if(c(d))return t.JSON_RPC_SERVER_ERROR_MESSAGE}return h}function a(d){if(!Number.isInteger(d))return!1;const h=d.toString();return!!e.errorValues[h]||!!c(d)}function c(d){return d>=-32099&&d<=-32e3}function l(d){return d&&typeof d=="object"&&!Array.isArray(d)?Object.assign({},d):d}function u(d,h){return Object.prototype.hasOwnProperty.call(d,h)}t.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.",t.getMessageFromCode=o,t.isValidCode=a,t.serializeError=function(d,{fallbackError:h=s,shouldIncludeStack:f=!1}={}){var g,p;if(!h||!Number.isInteger(h.code)||typeof h.message!="string")throw new Error("Must provide fallback error with integer number code and string message.");if(d instanceof n.EthereumRpcError)return d.serialize();const y={};if(d&&typeof d=="object"&&!Array.isArray(d)&&u(d,"code")&&a(d.code)){const C=d;y.code=C.code,C.message&&typeof C.message=="string"?(y.message=C.message,u(C,"data")&&(y.data=C.data)):(y.message=o(y.code),y.data={originalError:l(d)})}else{y.code=h.code;const C=(g=d)===null||g===void 0?void 0:g.message;y.message=C&&typeof C=="string"?C:h.message,y.data={originalError:l(d)}}const m=(p=d)===null||p===void 0?void 0:p.stack;return f&&d&&m&&typeof m=="string"&&(y.stack=m),y}}($d);var ic={};Object.defineProperty(ic,"__esModule",{value:!0}),ic.ethErrors=void 0;const jd=Fr,qy=$d,wt=Or;function Xt(t,e){const[n,r]=Wy(e);return new jd.EthereumRpcError(t,n||qy.getMessageFromCode(t),r)}function ks(t,e){const[n,r]=Wy(e);return new jd.EthereumProviderError(t,n||qy.getMessageFromCode(t),r)}function Wy(t){if(t){if(typeof t=="string")return[t];if(typeof t=="object"&&!Array.isArray(t)){const{message:e,data:n}=t;if(e&&typeof e!="string")throw new Error("Must specify string message.");return[e||void 0,n]}}return[]}ic.ethErrors={rpc:{parse:t=>Xt(wt.errorCodes.rpc.parse,t),invalidRequest:t=>Xt(wt.errorCodes.rpc.invalidRequest,t),invalidParams:t=>Xt(wt.errorCodes.rpc.invalidParams,t),methodNotFound:t=>Xt(wt.errorCodes.rpc.methodNotFound,t),internal:t=>Xt(wt.errorCodes.rpc.internal,t),server:t=>{if(!t||typeof t!="object"||Array.isArray(t))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:e}=t;if(!Number.isInteger(e)||e>-32005||e<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return Xt(e,t)},invalidInput:t=>Xt(wt.errorCodes.rpc.invalidInput,t),resourceNotFound:t=>Xt(wt.errorCodes.rpc.resourceNotFound,t),resourceUnavailable:t=>Xt(wt.errorCodes.rpc.resourceUnavailable,t),transactionRejected:t=>Xt(wt.errorCodes.rpc.transactionRejected,t),methodNotSupported:t=>Xt(wt.errorCodes.rpc.methodNotSupported,t),limitExceeded:t=>Xt(wt.errorCodes.rpc.limitExceeded,t)},provider:{userRejectedRequest:t=>ks(wt.errorCodes.provider.userRejectedRequest,t),unauthorized:t=>ks(wt.errorCodes.provider.unauthorized,t),unsupportedMethod:t=>ks(wt.errorCodes.provider.unsupportedMethod,t),disconnected:t=>ks(wt.errorCodes.provider.disconnected,t),chainDisconnected:t=>ks(wt.errorCodes.provider.chainDisconnected,t),custom:t=>{if(!t||typeof t!="object"||Array.isArray(t))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:e,message:n,data:r}=t;if(!n||typeof n!="string")throw new Error('"message" must be a nonempty string');return new jd.EthereumProviderError(e,n,r)}}},function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getMessageFromCode=t.serializeError=t.EthereumProviderError=t.EthereumRpcError=t.ethErrors=t.errorCodes=void 0;const e=Fr;Object.defineProperty(t,"EthereumRpcError",{enumerable:!0,get:function(){return e.EthereumRpcError}}),Object.defineProperty(t,"EthereumProviderError",{enumerable:!0,get:function(){return e.EthereumProviderError}});const n=$d;Object.defineProperty(t,"serializeError",{enumerable:!0,get:function(){return n.serializeError}}),Object.defineProperty(t,"getMessageFromCode",{enumerable:!0,get:function(){return n.getMessageFromCode}});const r=ic;Object.defineProperty(t,"ethErrors",{enumerable:!0,get:function(){return r.ethErrors}});const i=Or;Object.defineProperty(t,"errorCodes",{enumerable:!0,get:function(){return i.errorCodes}})}(Gy);var Qy={exports:{}};Qy.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(r,i,s){n.o(r,i)||Object.defineProperty(r,i,{enumerable:!0,get:s})},n.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},n.t=function(r,i){if(1&i&&(r=n(r)),8&i||4&i&&typeof r=="object"&&r&&r.__esModule)return r;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:r}),2&i&&typeof r!="string")for(var o in r)n.d(s,o,(function(a){return r[a]}).bind(null,o));return s},n.n=function(r){var i=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(i,"a",i),i},n.o=function(r,i){return Object.prototype.hasOwnProperty.call(r,i)},n.p="",n(n.s=90)}({17:function(t,e,n){e.__esModule=!0,e.default=void 0;var r=n(18),i=function(){function s(){}return s.getFirstMatch=function(o,a){var c=a.match(o);return c&&c.length>0&&c[1]||""},s.getSecondMatch=function(o,a){var c=a.match(o);return c&&c.length>1&&c[2]||""},s.matchAndReturnConst=function(o,a,c){if(o.test(a))return c},s.getWindowsVersionName=function(o){switch(o){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},s.getMacOSVersionName=function(o){var a=o.split(".").splice(0,2).map(function(c){return parseInt(c,10)||0});if(a.push(0),a[0]===10)switch(a[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},s.getAndroidVersionName=function(o){var a=o.split(".").splice(0,2).map(function(c){return parseInt(c,10)||0});if(a.push(0),!(a[0]===1&&a[1]<5))return a[0]===1&&a[1]<6?"Cupcake":a[0]===1&&a[1]>=6?"Donut":a[0]===2&&a[1]<2?"Eclair":a[0]===2&&a[1]===2?"Froyo":a[0]===2&&a[1]>2?"Gingerbread":a[0]===3?"Honeycomb":a[0]===4&&a[1]<1?"Ice Cream Sandwich":a[0]===4&&a[1]<4?"Jelly Bean":a[0]===4&&a[1]>=4?"KitKat":a[0]===5?"Lollipop":a[0]===6?"Marshmallow":a[0]===7?"Nougat":a[0]===8?"Oreo":a[0]===9?"Pie":void 0},s.getVersionPrecision=function(o){return o.split(".").length},s.compareVersions=function(o,a,c){c===void 0&&(c=!1);var l=s.getVersionPrecision(o),u=s.getVersionPrecision(a),d=Math.max(l,u),h=0,f=s.map([o,a],function(g){var p=d-s.getVersionPrecision(g),y=g+new Array(p+1).join(".0");return s.map(y.split("."),function(m){return new Array(20-m.length).join("0")+m}).reverse()});for(c&&(h=d-Math.min(l,u)),d-=1;d>=h;){if(f[0][d]>f[1][d])return 1;if(f[0][d]===f[1][d]){if(d===h)return 0;d-=1}else if(f[0][d]<f[1][d])return-1}},s.map=function(o,a){var c,l=[];if(Array.prototype.map)return Array.prototype.map.call(o,a);for(c=0;c<o.length;c+=1)l.push(a(o[c]));return l},s.find=function(o,a){var c,l;if(Array.prototype.find)return Array.prototype.find.call(o,a);for(c=0,l=o.length;c<l;c+=1){var u=o[c];if(a(u,c))return u}},s.assign=function(o){for(var a,c,l=o,u=arguments.length,d=new Array(u>1?u-1:0),h=1;h<u;h++)d[h-1]=arguments[h];if(Object.assign)return Object.assign.apply(Object,[o].concat(d));var f=function(){var g=d[a];typeof g=="object"&&g!==null&&Object.keys(g).forEach(function(p){l[p]=g[p]})};for(a=0,c=d.length;a<c;a+=1)f();return o},s.getBrowserAlias=function(o){return r.BROWSER_ALIASES_MAP[o]},s.getBrowserTypeByAlias=function(o){return r.BROWSER_MAP[o]||""},s}();e.default=i,t.exports=e.default},18:function(t,e,n){e.__esModule=!0,e.ENGINE_MAP=e.OS_MAP=e.PLATFORMS_MAP=e.BROWSER_MAP=e.BROWSER_ALIASES_MAP=void 0,e.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},e.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},e.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},e.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},e.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(91))&&r.__esModule?r:{default:r},s=n(18);function o(c,l){for(var u=0;u<l.length;u++){var d=l[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}var a=function(){function c(){}var l,u,d;return c.getParser=function(h,f){if(f===void 0&&(f=!1),typeof h!="string")throw new Error("UserAgent should be a string");return new i.default(h,f)},c.parse=function(h){return new i.default(h).getResult()},l=c,d=[{key:"BROWSER_MAP",get:function(){return s.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return s.ENGINE_MAP}},{key:"OS_MAP",get:function(){return s.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return s.PLATFORMS_MAP}}],(u=null)&&o(l.prototype,u),d&&o(l,d),c}();e.default=a,t.exports=e.default},91:function(t,e,n){e.__esModule=!0,e.default=void 0;var r=c(n(92)),i=c(n(93)),s=c(n(94)),o=c(n(95)),a=c(n(17));function c(u){return u&&u.__esModule?u:{default:u}}var l=function(){function u(h,f){if(f===void 0&&(f=!1),h==null||h==="")throw new Error("UserAgent parameter can't be empty");this._ua=h,this.parsedResult={},f!==!0&&this.parse()}var d=u.prototype;return d.getUA=function(){return this._ua},d.test=function(h){return h.test(this._ua)},d.parseBrowser=function(){var h=this;this.parsedResult.browser={};var f=a.default.find(r.default,function(g){if(typeof g.test=="function")return g.test(h);if(g.test instanceof Array)return g.test.some(function(p){return h.test(p)});throw new Error("Browser's test function is not valid")});return f&&(this.parsedResult.browser=f.describe(this.getUA())),this.parsedResult.browser},d.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},d.getBrowserName=function(h){return h?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},d.getBrowserVersion=function(){return this.getBrowser().version},d.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},d.parseOS=function(){var h=this;this.parsedResult.os={};var f=a.default.find(i.default,function(g){if(typeof g.test=="function")return g.test(h);if(g.test instanceof Array)return g.test.some(function(p){return h.test(p)});throw new Error("Browser's test function is not valid")});return f&&(this.parsedResult.os=f.describe(this.getUA())),this.parsedResult.os},d.getOSName=function(h){var f=this.getOS().name;return h?String(f).toLowerCase()||"":f||""},d.getOSVersion=function(){return this.getOS().version},d.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},d.getPlatformType=function(h){h===void 0&&(h=!1);var f=this.getPlatform().type;return h?String(f).toLowerCase()||"":f||""},d.parsePlatform=function(){var h=this;this.parsedResult.platform={};var f=a.default.find(s.default,function(g){if(typeof g.test=="function")return g.test(h);if(g.test instanceof Array)return g.test.some(function(p){return h.test(p)});throw new Error("Browser's test function is not valid")});return f&&(this.parsedResult.platform=f.describe(this.getUA())),this.parsedResult.platform},d.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},d.getEngineName=function(h){return h?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},d.parseEngine=function(){var h=this;this.parsedResult.engine={};var f=a.default.find(o.default,function(g){if(typeof g.test=="function")return g.test(h);if(g.test instanceof Array)return g.test.some(function(p){return h.test(p)});throw new Error("Browser's test function is not valid")});return f&&(this.parsedResult.engine=f.describe(this.getUA())),this.parsedResult.engine},d.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},d.getResult=function(){return a.default.assign({},this.parsedResult)},d.satisfies=function(h){var f=this,g={},p=0,y={},m=0;if(Object.keys(h).forEach(function(D){var B=h[D];typeof B=="string"?(y[D]=B,m+=1):typeof B=="object"&&(g[D]=B,p+=1)}),p>0){var C=Object.keys(g),v=a.default.find(C,function(D){return f.isOS(D)});if(v){var I=this.satisfies(g[v]);if(I!==void 0)return I}var R=a.default.find(C,function(D){return f.isPlatform(D)});if(R){var L=this.satisfies(g[R]);if(L!==void 0)return L}}if(m>0){var z=Object.keys(y),j=a.default.find(z,function(D){return f.isBrowser(D,!0)});if(j!==void 0)return this.compareVersion(y[j])}},d.isBrowser=function(h,f){f===void 0&&(f=!1);var g=this.getBrowserName().toLowerCase(),p=h.toLowerCase(),y=a.default.getBrowserTypeByAlias(p);return f&&y&&(p=y.toLowerCase()),p===g},d.compareVersion=function(h){var f=[0],g=h,p=!1,y=this.getBrowserVersion();if(typeof y=="string")return h[0]===">"||h[0]==="<"?(g=h.substr(1),h[1]==="="?(p=!0,g=h.substr(2)):f=[],h[0]===">"?f.push(1):f.push(-1)):h[0]==="="?g=h.substr(1):h[0]==="~"&&(p=!0,g=h.substr(1)),f.indexOf(a.default.compareVersions(y,g,p))>-1},d.isOS=function(h){return this.getOSName(!0)===String(h).toLowerCase()},d.isPlatform=function(h){return this.getPlatformType(!0)===String(h).toLowerCase()},d.isEngine=function(h){return this.getEngineName(!0)===String(h).toLowerCase()},d.is=function(h,f){return f===void 0&&(f=!1),this.isBrowser(h,f)||this.isOS(h)||this.isPlatform(h)},d.some=function(h){var f=this;return h===void 0&&(h=[]),h.some(function(g){return f.is(g)})},u}();e.default=l,t.exports=e.default},92:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},s=/version\/(\d+(\.?_?\d+)+)/i,o=[{test:[/googlebot/i],describe:function(a){var c={name:"Googlebot"},l=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/opera/i],describe:function(a){var c={name:"Opera"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/opr\/|opios/i],describe:function(a){var c={name:"Opera"},l=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/SamsungBrowser/i],describe:function(a){var c={name:"Samsung Internet for Android"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/Whale/i],describe:function(a){var c={name:"NAVER Whale Browser"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/MZBrowser/i],describe:function(a){var c={name:"MZ Browser"},l=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/focus/i],describe:function(a){var c={name:"Focus"},l=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/swing/i],describe:function(a){var c={name:"Swing"},l=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/coast/i],describe:function(a){var c={name:"Opera Coast"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(a){var c={name:"Opera Touch"},l=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/yabrowser/i],describe:function(a){var c={name:"Yandex Browser"},l=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/ucbrowser/i],describe:function(a){var c={name:"UC Browser"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/Maxthon|mxios/i],describe:function(a){var c={name:"Maxthon"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/epiphany/i],describe:function(a){var c={name:"Epiphany"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/puffin/i],describe:function(a){var c={name:"Puffin"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/sleipnir/i],describe:function(a){var c={name:"Sleipnir"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/k-meleon/i],describe:function(a){var c={name:"K-Meleon"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/micromessenger/i],describe:function(a){var c={name:"WeChat"},l=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/qqbrowser/i],describe:function(a){var c={name:/qqbrowserlite/i.test(a)?"QQ Browser Lite":"QQ Browser"},l=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/msie|trident/i],describe:function(a){var c={name:"Internet Explorer"},l=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/\sedg\//i],describe:function(a){var c={name:"Microsoft Edge"},l=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/edg([ea]|ios)/i],describe:function(a){var c={name:"Microsoft Edge"},l=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/vivaldi/i],describe:function(a){var c={name:"Vivaldi"},l=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/seamonkey/i],describe:function(a){var c={name:"SeaMonkey"},l=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/sailfish/i],describe:function(a){var c={name:"Sailfish"},l=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,a);return l&&(c.version=l),c}},{test:[/silk/i],describe:function(a){var c={name:"Amazon Silk"},l=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/phantom/i],describe:function(a){var c={name:"PhantomJS"},l=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/slimerjs/i],describe:function(a){var c={name:"SlimerJS"},l=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(a){var c={name:"BlackBerry"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/(web|hpw)[o0]s/i],describe:function(a){var c={name:"WebOS Browser"},l=i.default.getFirstMatch(s,a)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/bada/i],describe:function(a){var c={name:"Bada"},l=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/tizen/i],describe:function(a){var c={name:"Tizen"},l=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/qupzilla/i],describe:function(a){var c={name:"QupZilla"},l=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/firefox|iceweasel|fxios/i],describe:function(a){var c={name:"Firefox"},l=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/electron/i],describe:function(a){var c={name:"Electron"},l=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/MiuiBrowser/i],describe:function(a){var c={name:"Miui"},l=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/chromium/i],describe:function(a){var c={name:"Chromium"},l=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,a)||i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/chrome|crios|crmo/i],describe:function(a){var c={name:"Chrome"},l=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/GSA/i],describe:function(a){var c={name:"Google Search"},l=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:function(a){var c=!a.test(/like android/i),l=a.test(/android/i);return c&&l},describe:function(a){var c={name:"Android Browser"},l=i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/playstation 4/i],describe:function(a){var c={name:"PlayStation 4"},l=i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/safari|applewebkit/i],describe:function(a){var c={name:"Safari"},l=i.default.getFirstMatch(s,a);return l&&(c.version=l),c}},{test:[/.*/i],describe:function(a){var c=a.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(c,a),version:i.default.getSecondMatch(c,a)}}}];e.default=o,t.exports=e.default},93:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},s=n(18),o=[{test:[/Roku\/DVP/],describe:function(a){var c=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,a);return{name:s.OS_MAP.Roku,version:c}}},{test:[/windows phone/i],describe:function(a){var c=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,a);return{name:s.OS_MAP.WindowsPhone,version:c}}},{test:[/windows /i],describe:function(a){var c=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,a),l=i.default.getWindowsVersionName(c);return{name:s.OS_MAP.Windows,version:c,versionName:l}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(a){var c={name:s.OS_MAP.iOS},l=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,a);return l&&(c.version=l),c}},{test:[/macintosh/i],describe:function(a){var c=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,a).replace(/[_\s]/g,"."),l=i.default.getMacOSVersionName(c),u={name:s.OS_MAP.MacOS,version:c};return l&&(u.versionName=l),u}},{test:[/(ipod|iphone|ipad)/i],describe:function(a){var c=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,a).replace(/[_\s]/g,".");return{name:s.OS_MAP.iOS,version:c}}},{test:function(a){var c=!a.test(/like android/i),l=a.test(/android/i);return c&&l},describe:function(a){var c=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,a),l=i.default.getAndroidVersionName(c),u={name:s.OS_MAP.Android,version:c};return l&&(u.versionName=l),u}},{test:[/(web|hpw)[o0]s/i],describe:function(a){var c=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,a),l={name:s.OS_MAP.WebOS};return c&&c.length&&(l.version=c),l}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(a){var c=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,a)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,a)||i.default.getFirstMatch(/\bbb(\d+)/i,a);return{name:s.OS_MAP.BlackBerry,version:c}}},{test:[/bada/i],describe:function(a){var c=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,a);return{name:s.OS_MAP.Bada,version:c}}},{test:[/tizen/i],describe:function(a){var c=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,a);return{name:s.OS_MAP.Tizen,version:c}}},{test:[/linux/i],describe:function(){return{name:s.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:s.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(a){var c=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,a);return{name:s.OS_MAP.PlayStation4,version:c}}}];e.default=o,t.exports=e.default},94:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},s=n(18),o=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(a){var c=i.default.getFirstMatch(/(can-l01)/i,a)&&"Nova",l={type:s.PLATFORMS_MAP.mobile,vendor:"Huawei"};return c&&(l.model=c),l}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(a){var c=a.test(/ipod|iphone/i),l=a.test(/like (ipod|iphone)/i);return c&&!l},describe:function(a){var c=i.default.getFirstMatch(/(ipod|iphone)/i,a);return{type:s.PLATFORMS_MAP.mobile,vendor:"Apple",model:c}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(a){return a.getBrowserName(!0)==="blackberry"},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(a){return a.getBrowserName(!0)==="bada"},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(a){return a.getBrowserName()==="windows phone"},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(a){var c=Number(String(a.getOSVersion()).split(".")[0]);return a.getOSName(!0)==="android"&&c>=3},describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(a){return a.getOSName(!0)==="android"},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(a){return a.getOSName(!0)==="macos"},describe:function(){return{type:s.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(a){return a.getOSName(!0)==="windows"},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(a){return a.getOSName(!0)==="linux"},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(a){return a.getOSName(!0)==="playstation 4"},describe:function(){return{type:s.PLATFORMS_MAP.tv}}},{test:function(a){return a.getOSName(!0)==="roku"},describe:function(){return{type:s.PLATFORMS_MAP.tv}}}];e.default=o,t.exports=e.default},95:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},s=n(18),o=[{test:function(a){return a.getBrowserName(!0)==="microsoft edge"},describe:function(a){if(/\sedg\//i.test(a))return{name:s.ENGINE_MAP.Blink};var c=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,a);return{name:s.ENGINE_MAP.EdgeHTML,version:c}}},{test:[/trident/i],describe:function(a){var c={name:s.ENGINE_MAP.Trident},l=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:function(a){return a.test(/presto/i)},describe:function(a){var c={name:s.ENGINE_MAP.Presto},l=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:function(a){var c=a.test(/gecko/i),l=a.test(/like gecko/i);return c&&!l},describe:function(a){var c={name:s.ENGINE_MAP.Gecko},l=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:s.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(a){var c={name:s.ENGINE_MAP.WebKit},l=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,a);return l&&(c.version=l),c}}];e.default=o,t.exports=e.default}});var Jy=Sc(Qy.exports);const Ft={Initialized:"initialized",DisplayURI:"display_uri",ProviderUpdate:"provider_update",ConnectWithResponse:"connectWithResponse",ConnectionStatus:"connection_status",ServiceStatus:"service_status"};class En{constructor({shouldSetOnWindow:e,connectionStream:n,shouldSendMetadata:r=!1,shouldShimWeb3:i,sdkInstance:s}){const o=new m2({connectionStream:n,shouldSendMetadata:r,shouldSetOnWindow:e,shouldShimWeb3:i,autoRequestAccounts:!1}),a=new Proxy(o,{deleteProperty:()=>!0});if(this.provider=a,this.sdkInstance=s,e&&typeof window<"u")try{c=o,window.ethereum=c,window.dispatchEvent(new Event("ethereum#initialized"))}catch(l){Q("[Ethereum] Unable to set global provider - window.ethereum may be read-only",l)}var c;if(i&&typeof window<"u")try{(function(l,u=console){let d=!1,h=!1;if(!window.web3){const f="__isMetaMaskShim__";let g={currentProvider:l};Object.defineProperty(g,f,{value:!0,enumerable:!0,configurable:!1,writable:!1}),g=new Proxy(g,{get:(p,y,...m)=>(y!=="currentProvider"||d?y==="currentProvider"||y===f||h||(h=!0,u.error("MetaMask no longer injects web3. For details, see: https://docs.metamask.io/guide/provider-migration.html#replacing-window-web3"),l.request({method:"metamask_logWeb3ShimUsage"}).catch(C=>{u.debug("MetaMask: Failed to log web3 shim usage.",C)})):(d=!0,u.warn("You are accessing the MetaMask window.web3.currentProvider shim. This property is deprecated; use window.ethereum instead. For details, see: https://docs.metamask.io/guide/provider-migration.html#replacing-window-web3")),Reflect.get(p,y,...m)),set:(...p)=>(u.warn("You are accessing the MetaMask window.web3 shim. This object is deprecated; use window.ethereum instead. For details, see: https://docs.metamask.io/guide/provider-migration.html#replacing-window-web3"),Reflect.set(...p))}),Object.defineProperty(window,"web3",{value:g,enumerable:!1,configurable:!0,writable:!0})}})(this.provider)}catch(l){Q("[Ethereum] Unable to shim web3 - window.web3 may be read-only",l)}this.provider.on("display_uri",l=>{this.sdkInstance.emit(Ft.DisplayURI,l)}),this.provider.on("_initialized",()=>{const l={chainId:this.provider.getChainId(),isConnected:this.provider.isConnected(),isMetaMask:this.provider.isMetaMask,selectedAddress:this.provider.getSelectedAddress(),networkVersion:this.provider.getNetworkVersion()};this.sdkInstance.emit(Ft.Initialized,l),Q("[Ethereum: constructor()] provider initialized",l)})}static init(e){var n;return Q("[Ethereum: init()] Initializing Ethereum service"),this.instance=new En(e),(n=this.instance)===null||n===void 0?void 0:n.provider}static destroy(){}static getInstance(){var e;if(!(!((e=this.instance)===null||e===void 0)&&e.provider))throw new Error("Ethereum instance not intiialized - call Ethereum.factory first.");return this.instance}static getProvider(){var e;if(!(!((e=this.instance)===null||e===void 0)&&e.provider))throw new Error("Ethereum instance not intiialized - call Ethereum.factory first.");return this.instance.provider}}class so{constructor({useDeepLink:e,preferredOpenLink:n,debug:r=!1}){this.state={platformType:void 0,useDeeplink:!1,preferredOpenLink:void 0,debug:!1},this.state.platformType=this.getPlatformType(),this.state.useDeeplink=e,this.state.preferredOpenLink=n,this.state.debug=r}openDeeplink(e,n,r){return function(i,s,o,a){const{state:c}=i;Q(`[PlatfformManager: openDeeplink()] universalLink --> ${s}`),Q(`[PlatfformManager: openDeeplink()] deepLink --> ${o}`);try{if(c.preferredOpenLink)return void c.preferredOpenLink(c.useDeeplink?o:s,a);if(Q(`[PlatfformManager: openDeeplink()] open link now useDeepLink=${c.useDeeplink} link=${c.useDeeplink?o:s}`),c.useDeeplink)typeof window<"u"&&(window.location.href=o);else if(typeof document<"u"){const l=document.createElement("a");l.href=s,l.target="_self",l.rel="noreferrer noopener",l.click()}}catch(l){console.log("[PlatfformManager: openDeeplink()] can't open link",l)}}(this,e,n,r)}isReactNative(){var e;return this.isNotBrowser()&&typeof window<"u"&&window?.navigator&&((e=window.navigator)===null||e===void 0?void 0:e.product)==="ReactNative"}isMetaMaskInstalled(){return function(){const e=En.getProvider()||window?.ethereum;return Q(`[PlatfformManager: isMetaMaskInstalled()] isMetaMask=${e?.isMetaMask} isConnected=${e?.isConnected()}`),e?.isMetaMask&&e?.isConnected()}()}isDesktopWeb(){return this.isBrowser()&&!this.isMobileWeb()}isMobile(){var e,n;const r=Jy.parse(window.navigator.userAgent);return((e=r?.platform)===null||e===void 0?void 0:e.type)==="mobile"||((n=r?.platform)===null||n===void 0?void 0:n.type)==="tablet"}isSecure(){return this.isReactNative()||this.isMobileWeb()}isMetaMaskMobileWebView(){return typeof window<"u"&&!!window.ReactNativeWebView&&!!navigator.userAgent.endsWith("MetaMaskMobile")}isMobileWeb(){return this.state.platformType===At.MobileWeb}static isNotBrowser(){var e;return typeof window>"u"||!window?.navigator||Nt!==void 0&&((e=Nt?.navigator)===null||e===void 0?void 0:e.product)==="ReactNative"||navigator?.product==="ReactNative"}isNotBrowser(){return so.isNotBrowser()}static isBrowser(){return!this.isNotBrowser()}isBrowser(){return so.isBrowser()}isNodeJS(){return this.isNotBrowser()&&!this.isReactNative()}isUseDeepLink(){return this.state.useDeeplink}getPlatformType(){return function(e){const{state:n}=e;return n.platformType?n.platformType:e.isReactNative()?At.ReactNative:e.isNotBrowser()?At.NonBrowser:e.isMetaMaskMobileWebView()?At.MetaMaskMobileWebview:e.isMobile()?At.MobileWeb:At.DesktopWeb}(this)}}const Yy=t=>X(void 0,void 0,void 0,function*(){if(so.isBrowser()){const{StorageManagerWeb:n}=yield Promise.resolve().then(function(){return z2});return new n(t)}const e={persistChannelConfig:()=>X(void 0,void 0,void 0,function*(){}),getPersistedChannelConfig:()=>X(void 0,void 0,void 0,function*(){}),persistAccounts:()=>X(void 0,void 0,void 0,function*(){}),getCachedAccounts:()=>X(void 0,void 0,void 0,function*(){return[]}),persistChainId:()=>X(void 0,void 0,void 0,function*(){}),getCachedChainId:()=>X(void 0,void 0,void 0,function*(){}),terminate:()=>X(void 0,void 0,void 0,function*(){})};return Promise.resolve(e)});class m2 extends f2{constructor({connectionStream:e,shouldSendMetadata:n,autoRequestAccounts:r=!1}){super(e,{logger:console,maxEventListeners:100,shouldSendMetadata:n}),this.state={accounts:null,autoRequestAccounts:!1,providerStateRequested:!1,chainId:"",networkVersion:""},Q(`[SDKProvider: constructor()] autoRequestAccounts=${r}`),this.state.autoRequestAccounts=r}forceInitializeState(){return X(this,void 0,void 0,function*(){return Q(`[SDKProvider: forceInitializeState()] autoRequestAccounts=${this.state.autoRequestAccounts}`),this._initializeStateAsync()})}_setConnected(){Q("[SDKProvider: _setConnected()] Setting connected state"),this._state.isConnected=!0}getState(){return this._state}getSDKProviderState(){return this.state}getSelectedAddress(){var e;const{accounts:n}=this._state;return n&&n.length!==0?((e=n[0])===null||e===void 0?void 0:e.toLowerCase())||"":(Q("[SDKProvider: getSelectedAddress] No accounts found"),null)}getChainId(){return this.state.chainId}getNetworkVersion(){return this.state.networkVersion}setSDKProviderState(e){this.state=Object.assign(Object.assign({},this.state),e)}handleAccountsChanged(e,n){return this._handleAccountsChanged(e,n)}handleDisconnect({terminate:e=!1}){(function({terminate:n=!1,instance:r}){const{state:i}=r;Q(`[SDKProvider: handleDisconnect()] cleaning up provider state terminate=${n}`,r),n&&(r._state.accounts=null,r._state.isUnlocked=!1,r._state.isPermanentlyDisconnected=!0,r._state.initialized=!1),r._handleAccountsChanged([]),r._state.isConnected=!1,r.emit("disconnect",Gy.ethErrors.provider.disconnected()),i.providerStateRequested=!1})({terminate:e,instance:this})}_initializeStateAsync(){return X(this,void 0,void 0,function*(){return function(e){var n,r;return X(this,void 0,void 0,function*(){e.state===void 0&&(e.state={accounts:null,autoRequestAccounts:!1,providerStateRequested:!1,chainId:""});const{state:i}=e;let s;if(i.providerStateRequested)Q("[SDKProvider: initializeStateAsync()] initialization already in progress");else{let o;i.providerStateRequested=!0;let a=null,c=!1,l=!1;const u=yield Yy({enabled:!0});if(u){const d=yield u.getPersistedChannelConfig({});c=(n=d?.relayPersistence)!==null&&n!==void 0&&n,o=yield u.getCachedChainId();const h=yield u.getCachedAccounts();h.length>0&&(a=h[0])}if(Q(`[SDKProvider: initializeStateAsync()] relayPersistence=${c}`,{relayPersistence:c,cachedChainId:o,cachedSelectedAddress:a}),c)if(o&&a)s={accounts:[a],chainId:o,isUnlocked:!1},l=!0;else try{s=yield e.request({method:"metamask_getProviderState"})}catch(d){return e._log.error("MetaMask: Failed to get initial state. Please report this bug.",d),void(i.providerStateRequested=!1)}if(((r=s?.accounts)===null||r===void 0?void 0:r.length)===0)if(e.getSelectedAddress())s.accounts=[e.getSelectedAddress()];else{Q("[SDKProvider: initializeStateAsync()] Fetch accounts remotely.");const d=yield e.request({method:"eth_requestAccounts",params:[]});s.accounts=d}e._initializeState(s),i.providerStateRequested=!1,l&&(e._state.isConnected=!0,e.emit("connect",{chainId:s?.chainId}))}})}(this)})}_initializeState(e){return Q("[SDKProvider: _initializeState()]",e),function(n,r,i){return Q("[SDKProvider: initializeState()] set state._initialized to false"),n._state.initialized=!1,r(i)}(this,super._initializeState.bind(this),e)}_handleChainChanged({chainId:e,networkVersion:n}={}){this.state.chainId=e,this.state.networkVersion=n,function({instance:r,chainId:i,networkVersion:s,superHandleChainChanged:o}){Q(`[SDKProvider: handleChainChanged()] chainId=${i} networkVersion=${s}`);let a=s;s||(Q("[SDKProvider: handleChainChanged()] forced network version to prevent provider error"),a="1"),i!==Sp&&(Ze.analytics.track("sdk_used_chain",{caip_chain_id:`eip155:${parseInt(i??"0x1",16)}`}),Sp=i),r._state.isConnected=!0,r.emit("connect",{chainId:i}),o({chainId:i,networkVersion:a})}({instance:this,chainId:e,networkVersion:n,superHandleChainChanged:super._handleChainChanged.bind(this)})}}var oo,Ci={name:"@metamask/sdk",version:"0.33.0",description:"",homepage:"https://github.com/MetaMask/metamask-sdk#readme",bugs:{url:"https://github.com/MetaMask/metamask-sdk/issues"},repository:{type:"git",url:"https://github.com/MetaMask/metamask-sdk",directory:"packages/sdk"},main:"dist/node/cjs/metamask-sdk.js",module:"dist/browser/es/metamask-sdk.js",browser:"dist/browser/es/metamask-sdk.js",unpkg:"dist/browser/umd/metamask-sdk.js","react-native":"dist/react-native/es/metamask-sdk.js",types:"dist/types/src/index.d.ts",sideEffects:!1,files:["/dist"],scripts:{"build:types":"tsc --project tsconfig.build.json --emitDeclarationOnly --outDir dist/types",build:"yarn build:types && rollup -c --bundleConfigAsCjs","build:clean":"yarn clean && yarn build","build:post-tsc":"echo 'N/A'","build:pre-tsc":"echo 'N/A'",typecheck:"tsc --noEmit",clean:"rimraf ./dist",size:"node bundle-size && size-limit",lint:"yarn lint:eslint && yarn lint:misc --check","lint:changelog":"../../scripts/validate-changelog.sh @metamask/sdk","lint:eslint":"eslint . --cache --ext js,ts","lint:fix":"yarn lint:eslint --fix && yarn lint:misc --write","lint:misc":"prettier '**/*.json' '**/*.md' '!CHANGELOG.md' --ignore-path ../../.gitignore",prepack:"../../scripts/prepack.sh","publish:preview":"yarn npm publish --tag preview",reset:"yarn clean && rimraf ./node_modules/",test:'jest --testPathIgnorePatterns "/e2e/"',"test:coverage":'jest --coverage --testPathIgnorePatterns "/e2e/"',"test:e2e":'jest --testPathPattern "/e2e/"',"test:ci":'jest --coverage --passWithNoTests --setupFilesAfterEnv ./jest-preload.js --testPathIgnorePatterns "/e2e/"',"test:dev":'jest -c ./jest.config.ts --detectOpenHandles  --testPathIgnorePatterns "/e2e/"',watch:"rollup -c -w",dev:'concurrently "tsc --watch" "rollup -c -w --bundleConfigAsCjs"',"build:dev":"yarn build:types && NODE_ENV=dev rollup -c --bundleConfigAsCjs"},dependencies:{"@babel/runtime":"^7.26.0","@metamask/onboarding":"^1.0.1","@metamask/providers":"16.1.0","@metamask/sdk-analytics":"workspace:*","@metamask/sdk-communication-layer":"workspace:*","@metamask/sdk-install-modal-web":"workspace:*","@paulmillr/qr":"^0.2.1",bowser:"^2.9.0","cross-fetch":"^4.0.0",debug:"^4.3.4",eciesjs:"^0.4.11","eth-rpc-errors":"^4.0.3",eventemitter2:"^6.4.9","obj-multiplex":"^1.0.0",pump:"^3.0.0","readable-stream":"^3.6.2","socket.io-client":"^4.5.1",tslib:"^2.6.0",util:"^0.12.4",uuid:"^8.3.2"},devDependencies:{"@jest/globals":"^29.3.1","@lavamoat/allow-scripts":"^2.3.1","@metamask/auto-changelog":"3.1.0","@metamask/eslint-config":"^6.0.0","@metamask/eslint-config-nodejs":"^6.0.0","@metamask/eslint-config-typescript":"^6.0.0","@react-native-async-storage/async-storage":"^1.19.6","@rollup/plugin-alias":"^5.1.1","@rollup/plugin-commonjs":"^25.0.7","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.2","@rollup/plugin-replace":"^6.0.1","@rollup/plugin-terser":"^0.4.1","@size-limit/preset-big-lib":"^11.0.2","@types/dom-screen-wake-lock":"^1.0.2","@types/node":"^20.1.3","@types/pump":"^1.1.1","@types/qrcode-terminal":"^0.12.0","@types/uuid":"^10.0.0","@typescript-eslint/eslint-plugin":"^4.26.0","@typescript-eslint/parser":"^4.26.0","browserify-zlib":"^0.2.0",buffer:"^6.0.3",concurrently:"^9.1.2","crypto-browserify":"^3.12.0",eslint:"^7.30.0","eslint-config-prettier":"^8.3.0","eslint-plugin-import":"^2.23.4","eslint-plugin-jest":"^24.4.0","eslint-plugin-jsdoc":"^36.1.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^3.4.0","https-browserify":"^1.0.0",jest:"^29.3.1","jest-environment-jsdom":"^29.3.1",prettier:"^2.3.0",process:"^0.11.10",rimraf:"^4.4.0",rollup:"^4.26.0","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-jscc":"^2.0.0","rollup-plugin-natives":"^0.7.5","rollup-plugin-node-builtins":"^2.1.2","rollup-plugin-polyfill-node":"^0.13.0","rollup-plugin-sizes":"^1.0.6","rollup-plugin-typescript2":"^0.31.2","rollup-plugin-visualizer":"^5.12.0","size-limit":"^11.0.2","stream-browserify":"^3.0.0","stream-http":"^3.2.0","ts-jest":"^29.0.3","ts-node":"^10.9.1",typescript:"^4.3.2",url:"^0.11.0",webpack:"^5.0.0"},publishConfig:{access:"public",registry:"https://registry.npmjs.org/"},lavamoat:{allowScripts:{"eciesjs>secp256k1":!1,"socket.io-client>engine.io-client>ws>bufferutil":!1,"socket.io-client>engine.io-client>ws>utf-8-validate":!1,"@metamask/sdk-communication-layer>bufferutil":!1,"@metamask/sdk-communication-layer>eciesjs>secp256k1":!1,"@metamask/sdk-communication-layer>utf-8-validate":!1}}};(function(t){t.INPAGE="metamask-inpage",t.CONTENT_SCRIPT="metamask-contentscript",t.PROVIDER="metamask-provider"})(oo||(oo={}));const Cp="direct",ao="https://metamask.app.link/connect",co="metamask://connect",_p={NAME:"MetaMask",RDNS:["io.metamask","io.metamask.flask"]},y2=/(?:^[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}$)|(?:^0{8}-0{4}-0{4}-0{4}-0{12}$)/u,me={METAMASK_GETPROVIDERSTATE:"metamask_getProviderState",METAMASK_CONNECTSIGN:"metamask_connectSign",METAMASK_CONNECTWITH:"metamask_connectWith",METAMASK_OPEN:"metamask_open",METAMASK_BATCH:"metamask_batch",PERSONAL_SIGN:"personal_sign",WALLET_REQUESTPERMISSIONS:"wallet_requestPermissions",WALLET_REVOKEPERMISSIONS:"wallet_revokePermissions",WALLET_GETPERMISSIONS:"wallet_getPermissions",WALLET_WATCHASSET:"wallet_watchAsset",WALLET_ADDETHEREUMCHAIN:"wallet_addEthereumChain",WALLET_SWITCHETHETHEREUMCHAIN:"wallet_switchEthereumChain",ETH_REQUESTACCOUNTS:"eth_requestAccounts",ETH_ACCOUNTS:"eth_accounts",ETH_CHAINID:"eth_chainId",ETH_SENDTRANSACTION:"eth_sendTransaction",ETH_SIGNTYPEDDATA:"eth_signTypedData",ETH_SIGNTYPEDDATA_V3:"eth_signTypedData_v3",ETH_SIGNTYPEDDATA_V4:"eth_signTypedData_v4",ETH_SIGNTRANSACTION:"eth_signTransaction",ETH_SIGN:"eth_sign",PERSONAL_EC_RECOVER:"personal_ecRecover"},lo={[me.ETH_REQUESTACCOUNTS]:!0,[me.ETH_SENDTRANSACTION]:!0,[me.ETH_SIGNTRANSACTION]:!0,[me.ETH_SIGN]:!0,[me.PERSONAL_SIGN]:!0,[me.ETH_ACCOUNTS]:!1,[me.ETH_CHAINID]:!1,[me.PERSONAL_SIGN]:!0,[me.ETH_SIGNTYPEDDATA]:!0,[me.ETH_SIGNTYPEDDATA_V3]:!0,[me.ETH_SIGNTYPEDDATA_V4]:!0,[me.WALLET_REQUESTPERMISSIONS]:!0,[me.WALLET_GETPERMISSIONS]:!0,[me.WALLET_WATCHASSET]:!0,[me.WALLET_ADDETHEREUMCHAIN]:!0,[me.WALLET_SWITCHETHETHEREUMCHAIN]:!0,[me.METAMASK_CONNECTSIGN]:!0,[me.METAMASK_CONNECTWITH]:!0,[me.PERSONAL_EC_RECOVER]:!0,[me.METAMASK_BATCH]:!0,[me.METAMASK_OPEN]:!0},w2=Object.keys(lo).filter(t=>lo[t]===!0).map(t=>t.toLowerCase()),Zy=["eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sign"].map(t=>t.toLowerCase()),Hl=".sdk-comm",sc="providerType",Du=".MMSDK_cached_address",Uu=".MMSDK_cached_chainId",Cn={CHAIN_CHANGED:"chainChanged",ACCOUNTS_CHANGED:"accountsChanged",DISCONNECT:"disconnect",CONNECT:"connect",CONNECTED:"connected"},v2=1e6;var Fn;(function(t){t.TERMINATE="terminate",t.EXTENSION="extension",t.INITIALIZED="initialized"})(Fn||(Fn={}));const b2=typeof window<"u"&&window.localStorage;function E2({instance:t,msg:e}){return X(this,void 0,void 0,function*(){if(t._initialized||(Q("[MetaMaskSDK: connectAndSign()] provider not ready -- wait for init()"),yield t.init()),Q(`[MetaMaskSDK: connectAndSign()] activeProvider=${t.activeProvider}`),!t.activeProvider)throw new Error("SDK state invalid -- undefined provider");const n=/^0x([0-9A-Fa-f]{2})*$/u.test(e)?e:function(r){let i;if(ee!==void 0)i=ee.from(r,"utf8").toString("hex");else if(typeof TextEncoder<"u"){const s=new TextEncoder().encode(r);i=Array.from(s).map(o=>o.toString(16).padStart(2,"0")).join("")}else{if(typeof Nt!="object"||!("Buffer"in Nt))throw new Error("Unable to convert string to hex: No available method.");i=Nt.Buffer.from(r,"utf8").toString("hex")}return`0x${i}`}(e);return t.activeProvider.request({method:me.METAMASK_CONNECTWITH,params:[{method:me.PERSONAL_SIGN,params:[n]}]})})}function xp(t){var e,n;return X(this,void 0,void 0,function*(){Q("[MetaMaskSDK: connectWithExtensionProvider()] ",t),t.sdkProvider=t.activeProvider,t.activeProvider=window.extension,window.ethereum=window.extension;try{const r=yield(e=window.extension)===null||e===void 0?void 0:e.request({method:"eth_requestAccounts"});Q(`[MetaMaskSDK: connectWithExtensionProvider()] accounts=${r}`)}catch(r){return void console.warn("[MetaMaskSDK: connectWithExtensionProvider()] can't request accounts error",r)}localStorage.setItem(sc,"extension"),t.extensionActive=!0,t.emit(Ft.ProviderUpdate,Fn.EXTENSION),t.options.enableAnalytics&&((n=t.analytics)===null||n===void 0||n.send({event:tt.SDK_USE_EXTENSION}))})}function oc(t){let e;if(ee!==void 0)e=ee.from(t,"utf8").toString("base64");else if(typeof btoa=="function")e=btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/gu,(n,r)=>String.fromCharCode(parseInt(r,16))));else{if(typeof Nt!="object"||!("Buffer"in Nt))throw new Error("Unable to base64 encode: No available method.");e=Nt.Buffer.from(t,"utf8").toString("base64")}return e}function A2(t,e,n,r){var i,s,o,a,c,l,u,d,h,f,g,p,y,m,C,v,I,R,L,z;return X(this,void 0,void 0,function*(){const j=(i=t.state.remote)===null||i===void 0?void 0:i.isReady(),D=(s=t.state.remote)===null||s===void 0?void 0:s.isConnected(),B=(o=t.state.remote)===null||o===void 0?void 0:o.isPaused(),$=En.getProvider(),U=(a=t.state.remote)===null||a===void 0?void 0:a.getChannelId(),M=(c=t.state.remote)===null||c===void 0?void 0:c.isAuthorized(),{deeplinkProtocol:O}=t.state,{method:A,data:T,triggeredInstaller:F}=(k=>{var E,b,x,P;let N;ee.isBuffer(k)?(N=k.toJSON(),N._isBuffer=!0):N=k;const H=(E=N?.data)===null||E===void 0?void 0:E.method;let K=!1;return typeof((b=N?.data)===null||b===void 0?void 0:b.params)=="object"&&((P=(x=N?.data)===null||x===void 0?void 0:x.params)===null||P===void 0?void 0:P.__triggeredInstaller)===!0&&(K=!0,N.data.params=N.data.params.wrappedParams),{method:H,data:N,triggeredInstaller:K}})(e);if(Q(`[RCPMS: write()] method='${A}' isRemoteReady=${j} channelId=${U} isSocketConnected=${D} isRemotePaused=${B} providerConnected=${$.isConnected()}`,e),!U)return A!==me.METAMASK_GETPROVIDERSTATE&&Q(`[RCPMS: write()] ${A} --> channelId is undefined`),r(new Error("disconnected"));Q(`[RCPMS: write()] remote.isPaused()=${(l=t.state.remote)===null||l===void 0?void 0:l.isPaused()} authorized=${M} ready=${j} socketConnected=${D}`,e);const w=(u=t.state.platformManager)===null||u===void 0?void 0:u.isSecure(),S=(h=(d=t.state.platformManager)===null||d===void 0?void 0:d.isMobileWeb())!==null&&h!==void 0&&h,_=(g=(f=t.state.remote)===null||f===void 0?void 0:f.hasDeeplinkProtocol())!==null&&g!==void 0&&g&&S&&M;try{if(!F){const b=JSON.stringify(T?.data);if(b.length>v2)return r(new Error(`Message size ${b.length} exceeds maximum allowed size of 1000000 bytes`));(p=t.state.remote)===null||p===void 0||p.sendMessage(T?.data).then(()=>{Q(`[RCPMS: _write()] ${A} sent successfully`)}).catch(x=>{Q("[RCPMS: _write()] error sending message",x)})}if(!w)return Q(`[RCPMS: _write()] unsecure platform for method ${A} -- return callback`),r();if(F)return Q("[RCPMS: _write()] prevent deeplink -- installation completed separately."),r();const k=(C=(m=(y=t.state.remote)===null||y===void 0?void 0:y.getKeyInfo())===null||m===void 0?void 0:m.ecies.public)!==null&&C!==void 0?C:"";let E=encodeURI(`channelId=${U}&pubkey=${k}&comm=socket&t=d&v=2`);if(_){const b=JSON.stringify(T?.data),x=(v=t.state.remote)===null||v===void 0?void 0:v.encrypt(b);if(!x)return Q("[RCPMS: _write()] error encrypting message"),r(new Error("RemoteCommunicationPostMessageStream - disconnected"));E+=`&scheme=${O}&rpc=${oc(x)}`}if(!(!((I=t.state.platformManager)===null||I===void 0)&&I.isMetaMaskInstalled()))return Q("[RCPMS: _write()] prevent deeplink until installation is completed."),r();lo[A]?(Q(`[RCPMS: _write()] redirect link for '${A}' socketConnected=${D} connect?${E}`),(R=t.state.platformManager)===null||R===void 0||R.openDeeplink(`${ao}?${E}`,`${co}?${E}`,"_self")):!((L=t.state.remote)===null||L===void 0)&&L.isPaused()?(Q(`[RCPMS: _write()] MM is PAUSED! deeplink with connect! targetMethod=${A}`),(z=t.state.platformManager)===null||z===void 0||z.openDeeplink(`${ao}?redirect=true&${E}`,`${co}?redirect=true&${E}`,"_self")):Q(`[RCPMS: _write()] method ${A} doesn't need redirect.`)}catch(k){return Q("[RCPMS: _write()] error sending message",k),r(new Error("RemoteCommunicationPostMessageStream - disconnected"))}return r()})}class S2 extends as.Duplex{constructor({name:e,remote:n,deeplinkProtocol:r,platformManager:i}){super({objectMode:!0}),this.state={_name:null,remote:null,deeplinkProtocol:!1,platformManager:null},this.state._name=e,this.state.remote=n,this.state.deeplinkProtocol=r,this.state.platformManager=i,this._onMessage=this._onMessage.bind(this),this.state.remote.on(re.MESSAGE,this._onMessage)}_write(e,n,r){return X(this,void 0,void 0,function*(){return A2(this,e,0,r)})}_read(){}_onMessage(e){return function(n,r){try{if(Q("[RCPMS: onMessage()] message",r),!r||typeof r!="object"||typeof r?.data!="object")return;if(!r?.name)return void Q("[RCPMS: onMessage()] ignore message without name",r);if(r?.name!==oo.PROVIDER)return void Q(`[RCPMS: onMessage()] ignore message with wrong name message=${r}`);if(ee.isBuffer(r)){const i=ee.from(r);n.push(i)}else n.push(r)}catch(i){Q(`[RCPMS: onMessage()] ignore message error err=${i}`)}}(this,e)}start(){}}let kp=1;const Xy=t=>new Promise(e=>{setTimeout(()=>{e(!0)},t)}),C2=({checkInstallationOnAllCalls:t=!1,communicationLayerPreference:e,injectProvider:n,shouldShimWeb3:r,platformManager:i,installer:s,sdk:o,remoteConnection:a,debug:c})=>X(void 0,void 0,void 0,function*(){var l,u;const d=(({name:B,remoteConnection:$})=>{if(!$||!$?.getConnector())throw new Error("Missing remote connection parameter");return new S2({name:B,remote:$?.getConnector(),deeplinkProtocol:$?.state.deeplinkProtocol,platformManager:$?.getPlatformManager()})})({name:oo.INPAGE,target:oo.CONTENT_SCRIPT,remoteConnection:a}),h=i.getPlatformType(),f=o.options.dappMetadata,g=`Sdk/Javascript SdkVersion/${Ci.version} Platform/${h} dApp/${(l=f.url)!==null&&l!==void 0?l:f.name} dAppTitle/${f.name}`;let p=null,y=null;const m=(u=o.options.storage)===null||u===void 0?void 0:u.storageManager;if(m){try{const B=yield m.getCachedAccounts();B.length>0&&(p=B[0])}catch(B){console.error(`[initializeMobileProvider] failed to get cached addresses: ${B}`)}try{const B=yield m.getCachedChainId();B&&(y=B)}catch(B){console.error(`[initializeMobileProvider] failed to parse cached chainId: ${B}`)}}Q(`[initializeMobileProvider] cachedAccountAddress: ${p}, cachedChainId: ${y}`);const C=!(!n||h===At.NonBrowser||h===At.ReactNative),v=En.init({shouldSetOnWindow:C,connectionStream:d,shouldShimWeb3:r,sdkInstance:o});let I=!1;const R=B=>{I=B},L=()=>I,z=(B,$,U,M)=>X(void 0,void 0,void 0,function*(){var O,A,T,F,w,S,_,k,E;const b=En.getProvider();if(I){b.emit("display_uri",a?.state.qrcodeLink||""),a?.showActiveModal();let Z=L();for(;Z;){const ie=L(),oe=a?.isAuthorized();Z=ie&&!oe,Q(`[initializeMobileProvider: sendRequest()] waiting for initialization to complete - initializing: ${ie} authorized: ${oe}`),yield Xy(1e3)}return Q("[initializeMobileProvider: sendRequest()] initial method completed -- prevent installation and call provider"),U(...$)}const x=i.isMetaMaskInstalled(),P=a?.isConnected();let N=null,H=null,K=null;if(N=(O=b.getSelectedAddress())!==null&&O!==void 0?O:p,K=b.getChainId()||y,N&&m&&N!==p&&m.persistAccounts([N]).catch(Z=>{console.error(`[initializeMobileProvider] failed to persist account: ${Z}`)}),K&&(y=K,m&&m.persistChainId(K).catch(Z=>{console.error(`[initializeMobileProvider] failed to persist chainId: ${Z}`)})),Q("[initializeMobileProvider: sendRequest()]",{selectedAddress:N,chainId:K}),M&&Q(`[initializeMobileProvider: sendRequest()] method=${B} ongoing=${I} selectedAddress=${N} isInstalled=${x} checkInstallationOnAllCalls=${t} socketConnected=${P}`),N&&B.toLowerCase()===me.ETH_ACCOUNTS.toLowerCase())return[N];if(K&&B.toLowerCase()===me.ETH_CHAINID.toLowerCase())return K;const V=[me.ETH_REQUESTACCOUNTS,me.WALLET_REQUESTPERMISSIONS,me.METAMASK_CONNECTSIGN,me.METAMASK_CONNECTWITH],q=!lo[B],Y=(A=o.options.readonlyRPCMap)===null||A===void 0?void 0:A[K];if(Y&&q)try{const Z=(T=$?.[0])===null||T===void 0?void 0:T.params,ie=yield(({rpcEndpoint:oe,method:pe,sdkInfo:se,params:ae})=>X(void 0,void 0,void 0,function*(){const fe=JSON.stringify({jsonrpc:"2.0",method:pe,params:ae,id:(kp+=1,kp)}),le={Accept:"application/json","Content-Type":"application/json"};let ye;oe.includes("infura")&&(le["Metamask-Sdk-Info"]=se);try{ye=yield pg(oe,{method:"POST",headers:le,body:fe})}catch(Ae){throw Ae instanceof Error?new Error(`Failed to fetch from RPC: ${Ae.message}`):new Error(`Failed to fetch from RPC: ${Ae}`)}if(!ye.ok)throw new Error(`Server responded with a status of ${ye.status}`);return(yield ye.json()).result}))({rpcEndpoint:Y,sdkInfo:g,method:B,params:Z||[]});return M&&Q(`initializeProvider::ReadOnlyRPCResponse ${ie}`),ie}catch(Z){console.warn(`[initializeMobileProvider: sendRequest()] method=${B} readOnlyRPCRequest failed:`,Z)}if((!x||x&&!P)&&B!==me.METAMASK_GETPROVIDERSTATE){const Z=((F=$?.[0])===null||F===void 0?void 0:F.params)||[];if(V.indexOf(B)!==-1||t){R(!0);const ie=B===me.METAMASK_CONNECTWITH,oe=`${Date.now()}`;try{yield s.start({wait:!1,connectWith:ie?{method:B,id:oe,params:Z}:void 0}),yield new Promise((pe,se)=>{a?.isAuthorized()&&(Q("[initializeMobileProvider: sendRequest()] already authorized"),pe(!0)),a?.getConnector().once(re.AUTHORIZED,()=>{pe(!0)}),o.once(re.PROVIDER_UPDATE,ae=>{Q(`[initializeMobileProvider: sendRequest()] PROVIDER_UPDATE --- remote provider request interupted type=${ae}`),ae===Fn.EXTENSION?se(re.PROVIDER_UPDATE):se(new Error("Connection Terminated"))})})}catch(pe){if(Fn.EXTENSION===pe){if(Q(`[initializeMobileProvider: sendRequest()] extension provider detect: re-create ${B} on the active provider`),B.toLowerCase()===me.METAMASK_CONNECTSIGN.toLowerCase()){const se=yield(w=o.getProvider())===null||w===void 0?void 0:w.request({method:me.ETH_REQUESTACCOUNTS,params:[]});if(!se.length)throw new Error("SDK state invalid -- undefined accounts");const ae=yield(S=o.getProvider())===null||S===void 0?void 0:S.request({method:me.PERSONAL_SIGN,params:[Z[0],se[0]]});return o.emit(Ft.ConnectWithResponse,ae),ae}if(B.toLowerCase()===me.METAMASK_CONNECTWITH.toLowerCase()){const[se]=Z,ae=yield(({method:fe,sdk:le,params:ye})=>X(void 0,void 0,void 0,function*(){var Ae,ge,we,Ee;if(!le.isExtensionActive())throw new Error("SDK state invalid -- extension is not active");Q("[MetaMaskProvider: extensionConnectWithOverwrite()] Overwriting request method",fe,ye);const je=yield(Ae=le.getProvider())===null||Ae===void 0?void 0:Ae.request({method:me.ETH_REQUESTACCOUNTS,params:[]});if(!je.length)throw new Error("SDK state invalid -- undefined accounts");if(fe?.toLowerCase()===me.PERSONAL_SIGN.toLowerCase()){const st={method:fe,params:[ye[0],je[0]]};return yield(ge=le.getProvider())===null||ge===void 0?void 0:ge.request(st)}if(fe?.toLowerCase()===me.ETH_SENDTRANSACTION.toLowerCase()){const st={method:fe,params:[Object.assign(Object.assign({},ye[0]),{from:je[0]})]};return yield(we=le.getProvider())===null||we===void 0?void 0:we.request(st)}return Zy.includes(fe.toLowerCase())?(console.warn(`MetaMaskSDK connectWith method=${fe} -- not handled by the extension -- call separately`),je):yield(Ee=le.getProvider())===null||Ee===void 0?void 0:Ee.request({method:fe,params:ye})}))({method:se.method,sdk:o,params:se.params});return o.emit(Ft.ConnectWithResponse,ae),ae}return Q(`[initializeMobileProvider: sendRequest()] sending '${B}' on active provider`,Z),yield(_=o.getProvider())===null||_===void 0?void 0:_.request({method:B,params:Z})}throw pe===re.REJECTED?(a?.closeModal(),(k=o.getProvider())===null||k===void 0||k.handleDisconnect({terminate:!1}),Object.assign(new Error("User rejected connection"),{code:4001})):(Q(`[initializeMobileProvider: sendRequest()] failed to start installer: ${pe}`),pe)}finally{R(!1)}if(B===me.ETH_REQUESTACCOUNTS)return H=yield new Promise(pe=>{const se=setInterval(()=>{const{accounts:ae}=b.getState();ae&&(clearInterval(se),pe(ae))},100)}),Q(`[initializeMobileProvider: sendRequest()] selectedAddress: ${N} --- SKIP rpc call`),H;if(B===me.METAMASK_CONNECTWITH)try{let pe=0;const se=5,ae=({resolve:Ae,reject:ge})=>{pe+=1;const we=a?.getConnector().getRPCMethodTracker(),Ee=we?.[oe];return Q(`TRACKER: update method ${oe}`,Ee),Ee?.result?(Q("[initializeMobileProvider: sendRequest()] found result",Ee.result),o.emit(Ft.ConnectWithResponse,Ee.result),void Ae(Ee.result)):Ee?.error?(Q("[initializeMobileProvider: sendRequest()] found error",Ee.error),void ge(Ee.error)):pe>=se?(Q("[initializeMobileProvider: sendRequest()] max message count reached without result"),void ge(new Error("Max message count reached without result"))):void Q("[initializeMobileProvider: sendRequest()] not found yet, need to wait for next update")};let fe,le;const ye=yield new Promise((Ae,ge)=>{const we=a?.getConnector().getRPCMethodTracker();Q(`TRACKER: method ${oe}`,we),we?.[oe].result?(Q("[initializeMobileProvider: sendRequest()] found result",we?.[oe].result),Ae(we?.[oe].result)):we?.[oe].error&&(Q("[initializeMobileProvider: sendRequest()] found error",we?.[oe].error),ge(we?.[oe].error)),le=()=>ae({resolve:Ae,reject:ge}),fe=a?.getConnector().on(re.RPC_UPDATE,le)});return le&&fe?.off(re.RPC_UPDATE,le),Q("TRACKER: result",ye),ye}catch(pe){throw Q("[initializeMobileProvider: sendRequest()] error:",pe),pe}return $[0]&&typeof $[0]=="object"&&($[0].params={__triggeredInstaller:!0,wrappedParams:$[0].params}),U(...$)}if(i.isSecure()&&lo[B])return U(...$);if(o.isExtensionActive())return Q(`[initializeMobileProvider: sendRequest()] EXTENSION active - redirect request '${B}' to it`,$,Z),yield(E=o.getProvider())===null||E===void 0?void 0:E.request({method:B,params:Z});throw Q(`[initializeMobileProvider: sendRequest()] method=${B} --- skip --- not connected/installed`),new Error("MetaMask is not connected/installed, please call eth_requestAccounts to connect first.")}try{const Z=yield U(...$);if(Q(`[initializeMobileProvider: sendRequest()] method=${B} rpcResponse`,Z),B===me.WALLET_REQUESTPERMISSIONS){const ie=Z.reduce((oe,pe)=>{var se;if(pe.parentCapability==="eth_accounts"){const ae=(se=pe.caveats.find(fe=>fe.type==="restrictReturnedAccounts"))===null||se===void 0?void 0:se.value;ae&&oe.push(...ae)}return oe},[]);Q("[initializeMobileProvider: sendRequest()] accountsToPersist:",ie),ie.length>0&&(b.handleAccountsChanged(ie,!1),m?.persistAccounts(ie))}return Z}catch(Z){throw console.error("[initializeMobileProvider: sendRequest()] error:",Z),Z}}),{request:j}=v;v.request=(...B)=>X(void 0,void 0,void 0,function*(){return z(B?.[0].method,B,j,c)});const{send:D}=v;return v.send=(...B)=>X(void 0,void 0,void 0,function*(){return z(B?.[0],B,D,c)}),Q("[initializeMobileProvider: sendRequest()] metamaskStream.start()"),d.start(),v});function _2(t){var e,n,r,i;return X(this,void 0,void 0,function*(){const{options:s}=t,o={communicationLayerPreference:(e=s.communicationLayerPreference)!==null&&e!==void 0?e:gi.SOCKET,platformManager:t.platformManager,sdk:t,checkInstallationOnAllCalls:s.checkInstallationOnAllCalls,injectProvider:(n=s.injectProvider)===null||n===void 0||n,shouldShimWeb3:(r=s.shouldShimWeb3)===null||r===void 0||r,extensionOnly:(i=s.extensionOnly)===null||i===void 0||i,installer:t.installer,remoteConnection:t.remoteConnection,debug:t.debug},a=yield C2(o);t.activeProvider=a,function(c){var l,u,d,h;(u=(l=c.remoteConnection)===null||l===void 0?void 0:l.getConnector())===null||u===void 0||u.on(Ft.ConnectionStatus,f=>{c.emit(Ft.ConnectionStatus,f)}),(h=(d=c.remoteConnection)===null||d===void 0?void 0:d.getConnector())===null||h===void 0||h.on(Ft.ServiceStatus,f=>{c.emit(Ft.ServiceStatus,f)})}(t)})}const x2="sdk";class k2{constructor({serverUrl:e,enabled:n,originatorInfo:r}){this.serverURL=is,this.serverURL=e,this.originatorInfo=r,this.enabled=n==null||n}send({event:e,params:n}){if(!this.enabled)return;const r=Object.assign(Object.assign({id:x2,event:e,sdkVersion:Ci.version},this.originatorInfo),{params:n});Q(`[Analytics: send()] event: ${e}`,r),ar(r,this.serverURL).catch(i=>{Q(`[Analytics: send()] error: ${i}`)})}}const P2=()=>{if(typeof document>"u")return;let t;const e=document.getElementsByTagName("link");for(let n=0;n<e.length;n++)e[n].getAttribute("rel")!=="icon"&&e[n].getAttribute("rel")!=="shortcut icon"||(t=e[n].getAttribute("href"));return t},T2=163400;function Pp(t){var e,n,r;const{dappMetadata:i}=t,s=function({url:u,name:d}){var h;const f=u+d,g=oc(f);if(!localStorage)return"";let p=(h=localStorage.getItem(g))!==null&&h!==void 0?h:"";if(!p){p=Nr();try{localStorage.setItem(g,p)}catch{return""}}return p}({url:(e=i?.url)!==null&&e!==void 0?e:"no_url",name:(n=i?.name)!==null&&n!==void 0?n:"no_name"}),o=(r=t.platformManager)===null||r===void 0?void 0:r.getPlatformType(),a=o===At.DesktopWeb,c=o===At.MetaMaskMobileWebview;let l="N/A";return a?l="extension":c&&(l="mobile"),{id:s,from:l}}const na=(t,e,n)=>{if(Eo(t))if(n||e&&typeof e=="object"&&e!==null&&"error"in e){const r=n||e?.error;r&&r.code===4001?Ze.analytics.track("sdk_action_rejected",{action:t}):Ze.analytics.track("sdk_action_failed",{action:t})}else Ze.analytics.track("sdk_action_succeeded",{action:t})},ew=({provider:t,sdkInstance:e})=>{if("state"in t)throw new Error("INVALID EXTENSION PROVIDER");return new Proxy(t,{get:(n,r)=>r==="request"?function(i){var s,o;return X(this,void 0,void 0,function*(){Q("[wrapExtensionProvider()] Overwriting request method",i);const{method:a,params:c}=i,l=w2.includes(a.toLowerCase()),{id:u,from:d}=Pp(e);if(l&&((s=e.analytics)===null||s===void 0||s.send({event:tt.SDK_RPC_REQUEST,params:{method:a,from:d,id:u}})),Eo(a)&&Ze.analytics.track("sdk_action_requested",{action:a}),a===me.METAMASK_BATCH&&Array.isArray(c))return(({target:g,args:p,trackEvent:y,sdkInstance:m})=>X(void 0,void 0,void 0,function*(){var C,v;if(p.method!=="metamask_batch")throw new Error("Invalid usage");const I=[],R=(C=p?.params)!==null&&C!==void 0?C:[];for(const j of R){const D=yield g?.request({method:j.method,params:j.params});I.push(D)}const{id:L,from:z}=Pp(m);y&&((v=m.analytics)===null||v===void 0||v.send({event:tt.SDK_RPC_REQUEST_DONE,params:{method:p.method,from:z,id:L}}));for(const j of I)na(p.method,j,null);return I}))({target:n,args:i,trackEvent:l,sdkInstance:e});if(a.toLowerCase()===me.METAMASK_CONNECTSIGN.toLowerCase()&&Array.isArray(c))return(({target:g,params:p})=>X(void 0,void 0,void 0,function*(){let y,m=null;try{const C=yield g.request({method:me.ETH_REQUESTACCOUNTS,params:[]});if(!C.length)throw new Error("SDK state invalid -- undefined accounts");return y=yield g.request({method:me.PERSONAL_SIGN,params:[p[0],C[0]]}),y}catch(C){throw m=C,C}finally{na(me.PERSONAL_SIGN,y,m)}}))({target:n,params:c});if(a.toLowerCase()===me.METAMASK_CONNECTWITH.toLowerCase()&&Array.isArray(c))return(({target:g,params:p})=>X(void 0,void 0,void 0,function*(){const[y]=p,m=y.method,C=y.params;let v,I=null;try{const R=yield g.request({method:me.ETH_REQUESTACCOUNTS,params:[]});if(!Array.isArray(R)||!R.length)throw new Error("SDK state invalid -- undefined accounts");return m?.toLowerCase()===me.PERSONAL_SIGN.toLowerCase()?(v=yield g.request({method:m,params:[C[0],R[0]]}),v):m?.toLowerCase()===me.ETH_SENDTRANSACTION.toLowerCase()?(v=yield g.request({method:m,params:[Object.assign(Object.assign({},C[0]),{from:R[0]})]}),v):Zy.includes(m.toLowerCase())?(console.warn(`MetaMaskSDK connectWith method=${m} -- not handled by the extension -- call separately`),v=R,v):(v=yield g.request({method:m,params:C}),v)}catch(R){throw I=R,R}finally{na(m,v,I)}}))({target:n,params:c});let h,f=null;try{return h=yield n.request(i),h}catch(g){throw f=g,g}finally{l&&((o=e.analytics)===null||o===void 0||o.send({event:tt.SDK_RPC_REQUEST_DONE,params:{method:a,from:d,id:u}})),na(a,h,f)}})}:r==="getChainId"?function(){return t.chainId}:r==="getNetworkVersion"?function(){return t.networkVersion}:r==="getSelectedAddress"?function(){return t.selectedAddress}:r==="isConnected"?function(){return t._state.isConnected}:n[r]})};var ac;function I2({mustBeMetaMask:t,sdkInstance:e}){return X(this,void 0,void 0,function*(){if(typeof window>"u")throw new Error("window not available");try{const n=yield new Promise((r,i)=>{const s=setTimeout(()=>{i(new Error("eip6963RequestProvider timed out"))},500);window.addEventListener(ac.Announce,o=>{const a=o,{detail:{info:c,provider:l}={}}=a,{name:u,rdns:d,uuid:h}=c??{};y2.test(h)&&u.startsWith(_p.NAME)&&_p.RDNS.includes(d)&&(clearTimeout(s),r(l))}),window.dispatchEvent(new Event(ac.Request))});return ew({provider:n,sdkInstance:e})}catch{throw new Error("Provider not found")}})}(function(t){t.Announce="eip6963:announceProvider",t.Request="eip6963:requestProvider"})(ac||(ac={}));const O2=t=>X(void 0,void 0,void 0,function*(){const{options:e}=t,{infuraAPIKey:n}=e;if(!n)return;const r={"0x1":`https://mainnet.infura.io/v3/${n}`,"0x5":`https://goerli.infura.io/v3/${n}`,"0xaa36a7":`https://sepolia.infura.io/v3/${n}`,"0xe708":`https://linea-mainnet.infura.io/v3/${n}`,"0xe704":`https://linea-goerli.infura.io/v3/${n}`,"0x89":`https://polygon-mainnet.infura.io/v3/${n}`,"0x13881":`https://polygon-mumbai.infura.io/v3/${n}`,"0x45":`https://optimism-mainnet.infura.io/v3/${n}`,"0x1a4":`https://optimism-goerli.infura.io/v3/${n}`,"0xa4b1":`https://arbitrum-mainnet.infura.io/v3/${n}`,"0x66eed":`https://arbitrum-goerli.infura.io/v3/${n}`,"0x2a15c308d":`https://palm-mainnet.infura.io/v3/${n}`,"0x2a15c3083":`https://palm-testnet.infura.io/v3/${n}`,"0xa86a":`https://avalanche-mainnet.infura.io/v3/${n}`,"0xa869":`https://avalanche-fuji.infura.io/v3/${n}`,"0x4e454152":`https://aurora-mainnet.infura.io/v3/${n}`,"0x4e454153":`https://aurora-testnet.infura.io/v3/${n}`,"0x534e5f4d41494e":`https://starknet-mainnet.infura.io/v3/${n}`,"0x534e5f474f45524c49":`https://starknet-goerli.infura.io/v3/${n}`,"0x534e5f474f45524c4932":`https://starknet-goerli2.infura.io/v3/${n}`,"0xa4ec":`https://celo-mainnet.infura.io/v3/${n}`,"0xaef3":`https://celo-alfajores.infura.io/v3/${n}`};t.options.readonlyRPCMap?t.options.readonlyRPCMap=Object.assign(Object.assign({},t.options.readonlyRPCMap),r):t.options.readonlyRPCMap=r}),R2=t=>X(void 0,void 0,void 0,function*(){const{options:e}=t,{readonlyRPCMap:n}=e;if(n)try{Q("[MetaMaskSDK: setupReadOnlyRPCProviders()] Setting up Readonly RPC Providers",n),t.setReadOnlyRPCCalls(!0)}catch{throw new Error("Invalid Infura Settings")}});function N2(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{c(r.next(l))}catch(u){s(u)}}function a(l){try{c(r.throw(l))}catch(u){s(u)}}function c(l){var u;l.done?i(l.value):(u=l.value,u instanceof n?u:new n(function(d){d(u)})).then(o,a)}c((r=r.apply(t,[])).next())})}function M2(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(l){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(i=o.trys,!((i=i.length>0&&i[i.length-1])||u[0]!==6&&u[0]!==2)){o=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){o.label=u[1];break}if(u[0]===6&&o.label<i[1]){o.label=i[1],i=u;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(u);break}i[2]&&o.ops.pop(),o.trys.pop();continue}u=e.call(t,o)}catch(d){u=[6,d],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([c,l])}}}var Tp="INSTALLED",Ip="NOT_INSTALLED",Op="REGISTERED",Rp="REGISTERING",Np="RELOADING",Mp={CHROME:"https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn",FIREFOX:"https://addons.mozilla.org/firefox/addon/ether-metamask/",DEFAULT:"https://metamask.io"},ra="REGISTRATION_IN_PROGRESS",Bp="FORWARDER_ID",B2=function(){function t(e){var n=e===void 0?{}:e,r=n.forwarderOrigin,i=r===void 0?"https://fwd.metamask.io":r,s=n.forwarderMode,o=s===void 0?t.FORWARDER_MODE.INJECT:s;this.forwarderOrigin=i,this.forwarderMode=o,this.state=t.isMetaMaskInstalled()?Tp:Ip;var a=t._detectBrowser();this.downloadUrl=a?Mp[a]:Mp.DEFAULT,this._onMessage=this._onMessage.bind(this),this._onMessageFromForwarder=this._onMessageFromForwarder.bind(this),this._openForwarder=this._openForwarder.bind(this),this._openDownloadPage=this._openDownloadPage.bind(this),this.startOnboarding=this.startOnboarding.bind(this),this.stopOnboarding=this.stopOnboarding.bind(this),window.addEventListener("message",this._onMessage),o===t.FORWARDER_MODE.INJECT&&sessionStorage.getItem(ra)==="true"&&t._injectForwarder(this.forwarderOrigin)}return t.prototype._onMessage=function(e){if(e.origin===this.forwarderOrigin)return e.data.type==="metamask:reload"?this._onMessageFromForwarder(e):void console.debug("Unknown message from '"+e.origin+"' with data "+JSON.stringify(e.data))},t.prototype._onMessageUnknownStateError=function(e){throw new Error("Unknown state: '"+e+"'")},t.prototype._onMessageFromForwarder=function(e){return N2(this,0,void 0,function(){return M2(this,function(n){switch(n.label){case 0:switch(this.state){case Np:return[3,1];case Ip:return[3,2];case Tp:return[3,3];case Rp:return[3,5];case Op:return[3,6]}return[3,7];case 1:return console.debug("Ignoring message while reloading"),[3,8];case 2:return console.debug("Reloading now to register with MetaMask"),this.state=Np,location.reload(),[3,8];case 3:return console.debug("Registering with MetaMask"),this.state=Rp,[4,t._register()];case 4:return n.sent(),this.state=Op,e.source.postMessage({type:"metamask:registrationCompleted"},e.origin),this.stopOnboarding(),[3,8];case 5:return console.debug("Already registering - ignoring reload message"),[3,8];case 6:return console.debug("Already registered - ignoring reload message"),[3,8];case 7:this._onMessageUnknownStateError(this.state),n.label=8;case 8:return[2]}})})},t.prototype.startOnboarding=function(){sessionStorage.setItem(ra,"true"),this._openDownloadPage(),this._openForwarder()},t.prototype.stopOnboarding=function(){sessionStorage.getItem(ra)==="true"&&(this.forwarderMode===t.FORWARDER_MODE.INJECT&&(console.debug("Removing forwarder"),t._removeForwarder()),sessionStorage.setItem(ra,"false"))},t.prototype._openForwarder=function(){this.forwarderMode===t.FORWARDER_MODE.OPEN_TAB?window.open(this.forwarderOrigin,"_blank"):t._injectForwarder(this.forwarderOrigin)},t.prototype._openDownloadPage=function(){window.open(this.downloadUrl,"_blank")},t.isMetaMaskInstalled=function(){return!!(window.ethereum&&window.ethereum.isMetaMask)},t._register=function(){return window.ethereum.request({method:"wallet_registerOnboarding"})},t._injectForwarder=function(e){var n=document.body,r=document.createElement("iframe");r.setAttribute("height","0"),r.setAttribute("width","0"),r.setAttribute("style","display: none;"),r.setAttribute("src",e),r.setAttribute("id",Bp),n.insertBefore(r,n.children[0])},t._removeForwarder=function(){var e;(e=document.getElementById(Bp))===null||e===void 0||e.remove()},t._detectBrowser=function(){var e=Jy.parse(window.navigator.userAgent);return e.browser.name==="Firefox"?"FIREFOX":["Chrome","Chromium"].includes(e.browser.name||"")?"CHROME":null},t.FORWARDER_MODE={INJECT:"INJECT",OPEN_TAB:"OPEN_TAB"},t}();function L2(t,{wait:e=!1}){return X(this,void 0,void 0,function*(){return Q(`[MetamaskInstaller: startInstaller()] wait=${e}`),e&&(yield Xy(1e3)),yield t.checkInstallation()})}class D2{constructor({remote:e,preferDesktop:n,platformManager:r,debug:i=!1}){this.state={isInstalling:!1,hasInstalled:!1,resendRequest:null,preferDesktop:!1,platformManager:null,remote:null,debug:!1,connectWith:void 0},this.state.remote=e,this.state.preferDesktop=n,this.state.platformManager=r,this.state.debug=i}startDesktopOnboarding(){return function(){return X(this,void 0,void 0,function*(){Q("[MetamaskInstaller: startDesktopOnboarding() starting desktop onboarding"),window.ethereum&&(window.ethereum=void 0),new B2().startOnboarding()})}()}redirectToProperInstall(){return X(this,void 0,void 0,function*(){return function(e){var n,r;return X(this,void 0,void 0,function*(){const{state:i}=e,s=(n=i.platformManager)===null||n===void 0?void 0:n.getPlatformType();if(Q(`[MetamaskInstaller: redirectToProperInstall()] platform=${s}`),s===At.MetaMaskMobileWebview)return!1;i.isInstalling=!0;try{yield(r=i.remote)===null||r===void 0?void 0:r.startConnection({connectWith:i.connectWith}),i.isInstalling=!1,i.hasInstalled=!0}catch(o){throw i.isInstalling=!1,o}return!0})}(this)})}checkInstallation(){return X(this,void 0,void 0,function*(){return function(e){var n;return X(this,void 0,void 0,function*(){const{state:r}=e,i=(n=r.platformManager)===null||n===void 0?void 0:n.isMetaMaskInstalled();return Q(`[MetamaskInstaller: checkInstallation()] isInstalled=${i}`),!!i||(yield e.redirectToProperInstall())})}(this)})}start({wait:e=!1,connectWith:n}){return X(this,void 0,void 0,function*(){this.state.connectWith=n,Q(`[MetaMaskInstaller: start()] wait=${e}`,n),yield L2(this,{wait:e})})}}class tw{constructor({debug:e,sdkVersion:n}){this.containers={install:void 0,pending:void 0,select:void 0},this.defined={install:!1,pending:!1,select:!1},this.debug=e!=null&&e,this.sdkVersion=n}loadComponent(e){return X(this,void 0,void 0,function*(){if(!this.defined[e]){this.defined[e]=!0;try{const n=yield Promise.resolve().then(function(){return mS});console.log("loader",n),n.defineCustomElements()}catch(n){console.error(`Failed to load ${e} modal:`,n)}}})}renderInstallModal(e){var n;return X(this,void 0,void 0,function*(){this.debug&&console.debug("ModalLoader: renderInstallModal",e),this.containers.install=e.parentElement,yield this.loadComponent("install");const r=document.createElement("mm-install-modal");r.link=e.link,r.preferDesktop=e.preferDesktop,r.sdkVersion=(n=e.sdkVersion)!==null&&n!==void 0?n:this.sdkVersion,r.addEventListener("close",({detail:{shouldTerminate:i}})=>e.onClose(i)),r.addEventListener("startDesktopOnboarding",e.metaMaskInstaller.startDesktopOnboarding),r.addEventListener("trackAnalytics",i=>{var s;return(s=e.onAnalyticsEvent)===null||s===void 0?void 0:s.call(e,i.detail)}),e.parentElement.appendChild(r)})}renderSelectModal(e){var n;return X(this,void 0,void 0,function*(){this.containers.select=e.parentElement,yield this.loadComponent("select");const r=document.createElement("mm-select-modal");r.link=e.link,r.sdkVersion=(n=e.sdkVersion)!==null&&n!==void 0?n:this.sdkVersion,r.preferDesktop=e.preferDesktop,r.addEventListener("close",({detail:{shouldTerminate:i}})=>e.onClose(i)),r.addEventListener("connectWithExtension",e.connectWithExtension),e.parentElement.appendChild(r),setTimeout(()=>this.updateQRCode(e.link),100)})}renderPendingModal(e){var n;return X(this,void 0,void 0,function*(){this.containers.pending=e.parentElement,yield this.loadComponent("pending");const r=document.createElement("mm-pending-modal");r.sdkVersion=(n=e.sdkVersion)!==null&&n!==void 0?n:this.sdkVersion,r.displayOTP=e.displayOTP,r.addEventListener("close",e.onClose),r.addEventListener("updateOTPValue",({detail:{otpValue:i}})=>e.updateOTPValue(i)),e.onDisconnect&&r.addEventListener("disconnect",e.onDisconnect),e.parentElement.appendChild(r)})}updateOTPValue(e){const n=()=>{var r;const i=(r=this.containers.pending)===null||r===void 0?void 0:r.querySelector("mm-pending-modal");return!!i&&(i.otpCode=e,!0)};setTimeout(()=>{n()},800)}updateQRCode(e){var n,r;const i=(n=this.containers.install)===null||n===void 0?void 0:n.querySelector("mm-install-modal");if(i)i.link=e;else{const s=(r=this.containers.select)===null||r===void 0?void 0:r.querySelector("mm-select-modal");s&&(s.link=e)}}unmount(){Object.entries(this.containers).forEach(([e,n])=>{var r;(r=n?.parentNode)===null||r===void 0||r.removeChild(n),this.containers[e]=void 0})}}const U2=({link:t,debug:e,installer:n,terminate:r,connectWithExtension:i,preferDesktop:s,onAnalyticsEvent:o})=>{let a=null,c=null;Q("[UI: InstallModal-web: sdkWebInstallModal()] ################## Installing Modal #################"),Q(`[UI: InstallModal-web: sdkWebInstallModal()] link=${t}`),Q(`[UI: InstallModal-web: sdkWebInstallModal()] npx uri-scheme open "${t}" --ios`),Q(`[UI: InstallModal-web: sdkWebInstallModal()] npx uri-scheme open "${t}" --android`),Q(`[UI: InstallModal-web: sdkWebInstallModal()] adb shell am start -a android.intent.action.VIEW -d "${t}"`);const l=u=>{var d;Q("[UI: InstallModal-web: sdkWebInstallModal()] installModal-web unmounting install modal -- shouldTerminate:",u,c),c?.parentNode&&((d=c.parentNode)===null||d===void 0||d.removeChild(c)),c=null,a=null,u===!0&&r?.()};return{mount:u=>{if(Q("[UI: InstallModal-web: sdkWebInstallModal()] installModal-web mounting install modal",c),c)return c.style.display="block",void(a==null||a.updateQRCode(u));a=new tw({debug:e,sdkVersion:Ci.version}),c=document.createElement("div"),document.body.appendChild(c),window.extension?a.renderSelectModal({parentElement:c,connectWithExtension:()=>{l(),i?.()},onClose:l,link:t,preferDesktop:s!=null&&s}).catch(d=>{console.error(d)}):a.renderInstallModal({parentElement:c,preferDesktop:s!=null&&s,link:t,metaMaskInstaller:n,onClose:l,onAnalyticsEvent:o}).catch(d=>{console.error("[UI: InstallModal-web: sdkWebInstallModal()]",d)})},unmount:l}},F2=({onDisconnect:t,debug:e})=>{let n=null,r=null;const i=()=>{Q("[UI: pendingModal-web: sdkWebPendingModal()] pendingModal-web unmount",n),n?.parentNode&&n.parentNode.removeChild(n),n=null,r=null},s=a=>{Q("[UI: pendingModal-web: sdkWebPendingModal()] pendingModal-web updateOTPValue",a),r&&r.updateOTPValue(a)},o=({displayOTP:a}={displayOTP:!0})=>{Q("[UI: pendingModal-web: sdkWebPendingModal()] pendingModal-web mount",n),n?n.style.display="block":(r=new tw({debug:e,sdkVersion:Ci.version}),n=document.createElement("div"),document.body.appendChild(n),r.renderPendingModal({parentElement:n,onClose:i,onDisconnect:t,updateOTPValue:s,displayOTP:a}).catch(c=>{console.error("[UI: pendingModal-web: sdkWebPendingModal()]",c)}))};return o(),{mount:o,unmount:i,updateOTPValue:s}};function nw(t,e){var n,r,i,s;t.connector||(Q("[RemoteConnection: initializeConnector()] initialize connector"),t.connector=new $E({anonId:e.anonId,platformType:e.platformManager.getPlatformType(),communicationLayerPreference:e.communicationLayerPreference,transports:e.transports,dappMetadata:Object.assign(Object.assign({},e.dappMetadata),{source:e._source}),analytics:e.enableAnalytics,communicationServerUrl:e.communicationServerUrl,sdkVersion:Ci.version,context:"dapp",ecies:e.ecies,storage:e.storage,logging:e.logging}),e.timer&&(Q("[RemoteConnection: initializeConnector()] reset background timer",e.timer),(r=(n=e.timer)===null||n===void 0?void 0:n.stopBackgroundTimer)===null||r===void 0||r.call(n),(s=(i=e.timer)===null||i===void 0?void 0:i.runBackgroundTimer)===null||s===void 0||s.call(i,()=>!1,1e4)))}function Fu(t){t.listeners.forEach(({event:e,handler:n})=>{var r;(r=t.connector)===null||r===void 0||r.off(e,n)}),t.listeners=[]}function H2(t,e,n){return X(this,void 0,void 0,function*(){const r=setTimeout(()=>{Ze.analytics.track("sdk_connection_failed",{transport_type:"websocket"})},6e4);return new Promise((i,s)=>{if(!t.connector)return void s(new Error("No connector available"));Q("[RemoteConnection: connectWithModalInstaller()]",{state:t,options:e,linkParams:n});const o=`${t.useDeeplink?co:ao}?${n}`;(function(a,c,l){var u,d,h,f;a.installModal=(d=(u=c.modals).install)===null||d===void 0?void 0:d.call(u,{link:l,preferDesktop:a.preferDesktop,installer:c.getMetaMaskInstaller(),terminate:()=>{Q("[RemoteConnection: showInstallModal() => terminate()] terminate connection"),c.sdk.terminate().catch(g=>{console.warn("[MMSDK] failed to terminate connection",g)})},debug:a.developerMode,connectWithExtension:()=>{var g;return(g=c.connectWithExtensionProvider)===null||g===void 0||g.call(c),!1},onAnalyticsEvent:({event:g,params:p})=>{var y,m,C;const v=Object.assign(Object.assign({},p),{sdkVersion:c.sdk.getVersion(),dappId:(y=c.dappMetadata)===null||y===void 0?void 0:y.name,source:c._source,url:(m=c.dappMetadata)===null||m===void 0?void 0:m.url});(C=a.analytics)===null||C===void 0||C.send({event:g,params:v})}}),(f=(h=a.installModal)===null||h===void 0?void 0:h.mount)===null||f===void 0||f.call(h,l)})(t,e,o),e.sdk.once(re.PROVIDER_UPDATE,a=>X(this,void 0,void 0,function*(){if(Q("[RemoteConnection: connectWithModalInstaller()] once provider_update -- resolving startConnection promise"),a===Fn.TERMINATE){const c={code:4001,message:"User rejected the request."};return clearTimeout(r),void s(c)}s(a)})),t.connector.once(re.AUTHORIZED,()=>{clearTimeout(r),i()}),t.connector.once(re.REJECTED,()=>{clearTimeout(r),s(re.REJECTED)}),t.connector.once(re.CLIENTS_READY,()=>X(this,void 0,void 0,function*(){Q("[RemoteConnection: connectWithModalInstaller()] once clients_ready -- resolving startConnection promise"),clearTimeout(r),i()}))})})}function rw(t,e){function n(r,i){var s;(s=t.connector)===null||s===void 0||s.on(r,i),t.listeners.push({event:r,handler:i})}t.connector&&(Fu(t),n(re.WALLET_INIT,({accounts:r,chainId:i})=>X(this,void 0,void 0,function*(){Q(`[RemoteConnection: setupListeners() => EventType.WALLET_INIT] 'wallet_init' accounts=${r} chainId=${i}`);const s=En.getProvider();s._setConnected();const o={accounts:r,chainId:i,isUnlocked:!1};s._initializeState(o),s.emit("chainChanged",i),s.emit("accountsChanged",r)})),n(re.AUTHORIZED,()=>X(this,void 0,void 0,function*(){var r,i,s,o;try{Q("[RemoteConnection: setupListeners() => EventType.AUTHORIZED] 'authorized' closing modals",t.pendingModal,t.installModal);const a=En.getProvider();a._setConnected(),(i=(r=t.pendingModal)===null||r===void 0?void 0:r.unmount)===null||i===void 0||i.call(r),(o=(s=t.installModal)===null||s===void 0?void 0:s.unmount)===null||o===void 0||o.call(s,!1),t.otpAnswer=void 0,t.authorized=!0,Q("[RemoteConnection: setupListeners() => EventType.AUTHORIZED] 'authorized' provider.state",a.getState()),yield a.forceInitializeState()}catch{}})),n(re.TERMINATE,()=>{var r,i,s,o,a;(i=(r=t.pendingModal)===null||r===void 0?void 0:r.unmount)===null||i===void 0||i.call(r),(o=(s=t.installModal)===null||s===void 0?void 0:s.unmount)===null||o===void 0||o.call(s,!0),t.pendingModal=void 0,t.installModal=void 0,t.otpAnswer=void 0,(a=t.connector)===null||a===void 0||a.disconnect({terminate:!0}),t.authorized=!1,En.getProvider().handleDisconnect({terminate:!0}),Fu(t),Q("[RemoteConnection: setupListeners()] All listeners cleaned up")}))}function K2(t,e,{initialCheck:n,connectWith:r}={}){var i,s,o,a,c,l,u,d,h,f,g,p,y,m,C,v,I,R,L;return X(this,void 0,void 0,function*(){try{if(nw(t,e),!t.connector)throw new Error("no connector defined");rw(t);const z=En.getProvider();t.authorized=!1,z.emit("connecting");const j=yield(i=t.connector)===null||i===void 0?void 0:i.originatorSessionConnect();Q(`[RemoteConnection: startConnection()] after originatorSessionConnect initialCheck=${n}`,j);let D=(s=j?.channelId)!==null&&s!==void 0?s:"",B=(a=(o=t.connector.getKeyInfo())===null||o===void 0?void 0:o.ecies.public)!==null&&a!==void 0?a:"",$=(l=(c=t.connector.getKeyInfo())===null||c===void 0?void 0:c.ecies.private)!==null&&l!==void 0?l:"";if(n&&!j)return Promise.resolve();if(!j&&!n){const P=yield t.connector.generateChannelIdConnect();D=(u=P.channelId)!==null&&u!==void 0?u:"",B=(d=P.pubKey)!==null&&d!==void 0?d:"",$=(h=P.privKey)!==null&&h!==void 0?h:"";const N=Date.now();(f=t.connector.state.storageManager)===null||f===void 0||f.persistChannelConfig({channelId:D,localKey:$,lastActive:N,validUntil:N+ss})}if(n&&j?.channelId)return!((g=t.connector)===null||g===void 0)&&g.isConnected()||(Q(`[RemoteConnection: startConnection()] reconnecting to channel initialCheck=${n}`,j),yield(p=t.connector)===null||p===void 0?void 0:p.connectToChannel({channelId:D})),Promise.resolve();j&&!(!((y=t.connector)===null||y===void 0)&&y.isConnected())&&(Q("[RemoteConnection: startConnection()] reconnecting to channel",j),yield(m=t.connector)===null||m===void 0?void 0:m.connectToChannel({channelId:D}));const U=!((C=t.platformManager)===null||C===void 0)&&C.isSecure()?"":"&t=q",M=Ci.version,{iconUrl:O,name:A,url:T,scheme:F}=e.dappMetadata||{},w=(v=t.platformManager)===null||v===void 0?void 0:v.getPlatformType();let S="N/A";typeof window<"u"&&window.location&&window.location.hostname?S=window.location.hostname:A!==void 0?S=A:T!==void 0&&(S=T);const _={url:T??"",title:A??"",icon:O,scheme:F??"",apiVersion:M,dappId:S||T||"N/A",anonId:e.anonId,platform:w??"",source:(I=e._source)!==null&&I!==void 0?I:""},k=oc(JSON.stringify(_));let E=`channelId=${D}&v=2&comm=${(R=t.communicationLayerPreference)!==null&&R!==void 0?R:""}&pubkey=${B}${U}&originatorInfo=${k}`;if(r){E+=`&rpc=${oc(JSON.stringify(r))}`;const P=t.connector.getRPCMethodTracker();P&&(P[`${r.id}`]=Object.assign(Object.assign({},r),{id:`${r.id}`,timestamp:Date.now()}))}const b=encodeURI(E),x=`${t.useDeeplink?co:ao}?${E}`;if(t.qrcodeLink=x,t.developerMode&&Q(`[RemoteConnection: startConnection()] qrcodeLink=${b}`),z.emit("display_uri",x),Ze.analytics.track("sdk_connection_initiated",{transport_type:"websocket"}),(L=t.platformManager)===null||L===void 0?void 0:L.isSecure()){const P=setTimeout(()=>{Ze.analytics.track("sdk_connection_failed",{transport_type:"websocket"})},6e4);return yield function(N,H){var K,V;return X(this,void 0,void 0,function*(){const q=`${ao}?${H}`,Y=`${co}?${H}`;(V=(K=N.platformManager)===null||K===void 0?void 0:K.openDeeplink)===null||V===void 0||V.call(K,q,Y,"_self")})}(t,b),new Promise((N,H)=>{var K,V,q;if(!((K=t.connector)===null||K===void 0)&&K.isAuthorized())return clearTimeout(P),void N();(V=t.connector)===null||V===void 0||V.once(re.AUTHORIZED,()=>{clearTimeout(P),N()}),(q=t.connector)===null||q===void 0||q.once(re.REJECTED,()=>{clearTimeout(P),H(re.REJECTED)})})}return H2(t,e,b)}catch(z){throw console.error("[startConnection] error",z),z}})}class $2{constructor(e){var n,r,i;this.state={connector:void 0,qrcodeLink:void 0,analytics:void 0,developerMode:!1,authorized:!1,reconnection:!1,preferDesktop:!1,deeplinkProtocol:!1,listeners:[],communicationLayerPreference:void 0,platformManager:void 0,pendingModal:void 0,installModal:void 0,otpAnswer:void 0},this.options=e;const s=((n=e.logging)===null||n===void 0?void 0:n.developerMode)===!0||((r=e.logging)===null||r===void 0?void 0:r.sdk)===!0;this.state.developerMode=s,this.state.analytics=e.analytics,this.state.preferDesktop=(i=e.preferDesktop)!==null&&i!==void 0&&i,this.state.useDeeplink=e.sdk.options.useDeeplink,this.state.communicationLayerPreference=e.communicationLayerPreference,this.state.platformManager=e.platformManager,e.modals.install||(e.modals.install=U2),e.modals.otp||(e.modals.otp=F2)}startConnection(e){return X(this,void 0,void 0,function*(){return K2(this.state,this.options,e)})}initRemoteCommunication({sdkInstance:e}){var n,r,i;return X(this,void 0,void 0,function*(){const s=yield(r=(n=e.options.storage)===null||n===void 0?void 0:n.storageManager)===null||r===void 0?void 0:r.getPersistedChannelConfig();if(!this.options.ecies){const o={privateKey:s?.localKey};this.options.ecies=o}nw(this.state,this.options),yield(i=this.getConnector())===null||i===void 0?void 0:i.initFromDappStorage(),rw(this.state,this.options)})}showActiveModal(){return function(e){var n,r,i,s;e.authorized?Q("[RemoteConnection: showActiveModal()] already authorized"):e.pendingModal?(r=(n=e.pendingModal).mount)===null||r===void 0||r.call(n):e.installModal&&((s=(i=e.installModal).mount)===null||s===void 0||s.call(i,e.qrcodeLink||""))}(this.state)}closeModal(){var e,n,r,i;(n=(e=this.state.pendingModal)===null||e===void 0?void 0:e.unmount)===null||n===void 0||n.call(e),(i=(r=this.state.installModal)===null||r===void 0?void 0:r.unmount)===null||i===void 0||i.call(r,!1)}getUniversalLink(){if(!this.state.qrcodeLink)throw new Error("connection not started. run startConnection() first.");return this.state.qrcodeLink}getChannelConfig(){var e;return(e=this.state.connector)===null||e===void 0?void 0:e.getChannelConfig()}getKeyInfo(){var e;return(e=this.state.connector)===null||e===void 0?void 0:e.getKeyInfo()}getConnector(){if(!this.state.connector)throw new Error("invalid remote connector");return this.state.connector}getPlatformManager(){if(!this.state.platformManager)throw new Error("PlatformManager not available");return this.state.platformManager}isConnected(){var e;return((e=this.state.connector)===null||e===void 0?void 0:e.isReady())||!1}isAuthorized(){var e;return((e=this.state.connector)===null||e===void 0?void 0:e.isAuthorized())||!1}isPaused(){var e;return(e=this.state.connector)===null||e===void 0?void 0:e.isPaused()}disconnect(e){var n,r,i;Q("[RemoteConnection: disconnect()]",e),e?.terminate&&(En.getProvider().handleDisconnect({terminate:!0}),(r=(n=this.state.pendingModal)===null||n===void 0?void 0:n.unmount)===null||r===void 0||r.call(n),this.state.otpAnswer=void 0),(i=this.state.connector)===null||i===void 0||i.disconnect(e),function(s){Q("[RemoteConnection: cleanupConnector()] cleaning up connector"),s.connector&&(Fu(s),s.connector.disconnect({terminate:!0}).catch(o=>{Q("[RemoteConnection: cleanupConnector()] error disconnecting connector",o)}))}(this.state)}}function j2(t){var e,n,r,i,s,o,a,c,l,u,d;return X(this,void 0,void 0,function*(){const{options:h}=t;if(h.logging=(e=h.logging)!==null&&e!==void 0?e:{},h.communicationLayerPreference=(n=h.communicationLayerPreference)!==null&&n!==void 0?n:gi.SOCKET,h.enableDebug!==void 0&&(Tt.enable("MM_SDK"),console.warn("enableDebug is removed. Please use enableAnalytics instead.")),h.enableAnalytics=(r=h.enableAnalytics)===null||r===void 0||r,h.injectProvider=(i=h.injectProvider)===null||i===void 0||i,h.shouldShimWeb3=(s=h.shouldShimWeb3)===null||s===void 0||s,h.extensionOnly=(o=h.extensionOnly)===null||o===void 0||o,h.useDeeplink=(a=h.useDeeplink)===null||a===void 0||a,h.storage=(c=h.storage)!==null&&c!==void 0?c:{enabled:!0},h.headless){Tt("[MetaMaskSDK: performSDKInitialization()] headless mode enabled");const C=()=>{},v={install:()=>({mount:C,unmount:C})},I={installer:C};h.modals=v,h.ui=I}const f=((l=h.logging)===null||l===void 0?void 0:l.developerMode)===!0;t.debug=((u=h.logging)===null||u===void 0?void 0:u.sdk)||f,Q("[MetaMaskSDK: performSDKInitialization()] options",t.options);const g=Object.assign({},h.logging);f&&(g.sdk=!0,g.eciesLayer=!0,g.keyExchangeLayer=!0,g.remoteLayer=!0,g.serviceLayer=!0,g.plaintext=!0),yield function(C){var v;return X(this,void 0,void 0,function*(){const{options:I}=C;C.platformManager=new so({useDeepLink:(v=I.useDeeplink)!==null&&v!==void 0&&v,preferredOpenLink:I.openDeeplink,debug:C.debug})})}(t),yield function(C){var v,I,R,L,z;return X(this,void 0,void 0,function*(){const{options:j}=C,D=(v=C.platformManager)===null||v===void 0?void 0:v.getPlatformType();C.analytics=new k2({serverUrl:(I=j.communicationServerUrl)!==null&&I!==void 0?I:is,enabled:j.enableAnalytics,originatorInfo:{url:(R=j.dappMetadata.url)!==null&&R!==void 0?R:"",title:(L=j.dappMetadata.name)!==null&&L!==void 0?L:"",dappId:C.getDappId(),platform:D??"",source:(z=j._source)!==null&&z!==void 0?z:"",anonId:""}})})}(t),yield function(C){var v,I,R;return X(this,void 0,void 0,function*(){if(!C.options.enableAnalytics||!(!((v=C.platformManager)===null||v===void 0)&&v.isBrowser())&&!(!((I=C.platformManager)===null||I===void 0)&&I.isReactNative()))return;const L=C.getVersion(),z=C.getDappId(),j=yield C.getAnonId(),D=(R=C.platformManager)===null||R===void 0?void 0:R.getPlatformType(),B=C.options._source;Ze.analytics.setGlobalProperty("sdk_version",L),Ze.analytics.setGlobalProperty("dapp_id",z),Ze.analytics.setGlobalProperty("anon_id",j),Ze.analytics.setGlobalProperty("platform",D),Ze.analytics.setGlobalProperty("integration_type",B),Ze.analytics.enable(),Ze.analytics.track("sdk_initialized",{})})}(t),yield function(C){var v;return X(this,void 0,void 0,function*(){const{options:I}=C;((v=I.storage)===null||v===void 0?void 0:v.enabled)!==!0||I.storage.storageManager||(I.storage.storageManager=yield Yy(I.storage))})}(t),yield function(C){return X(this,void 0,void 0,function*(){const{options:v}=C,I=/^(http|https):\/\/[^\s]*$/;if(v.dappMetadata){v.dappMetadata.iconUrl&&!I.test(v.dappMetadata.iconUrl)&&(console.warn("Invalid dappMetadata.iconUrl: URL must start with http:// or https://"),v.dappMetadata.iconUrl=void 0),v.dappMetadata.base64Icon&&v.dappMetadata.base64Icon.length>T2&&(console.warn("Invalid dappMetadata.base64Icon: Base64-encoded icon string length must be less than 163400 characters"),v.dappMetadata.base64Icon=void 0),v.dappMetadata.url&&!I.test(v.dappMetadata.url)&&console.warn("Invalid dappMetadata.url: URL must start with http:// or https://");const R=P2();if(R&&!v.dappMetadata.iconUrl&&!v.dappMetadata.base64Icon){const L=`${window.location.protocol}//${window.location.host}${R}`;v.dappMetadata.iconUrl=L}}C.dappMetadata=v.dappMetadata})}(t),yield O2(t),yield R2(t);const{metamaskBrowserExtension:p,preferExtension:y,shouldReturn:m}=yield function(C){var v,I,R,L;return X(this,void 0,void 0,function*(){const{options:z}=C;let j,D=!1,B=!1;if(typeof window<"u"&&window.ethereum&&!(!((v=C.platformManager)===null||v===void 0)&&v.isMetaMaskMobileWebView())){D=localStorage.getItem(sc)==="extension";try{j=yield I2({mustBeMetaMask:!0,sdkInstance:C}),window.extension=j,j.on(Cn.CHAIN_CHANGED,$=>{Q(`[MetaMaskSDK: setupExtensionPreferences()] PROPAGATE chainChanged chainId=${$}`),C.sdkProvider&&C.getMobileProvider().emit(Cn.CHAIN_CHANGED,$)}),j.on(Cn.ACCOUNTS_CHANGED,$=>X(this,void 0,void 0,function*(){var U;Q(`[MetaMaskSDK: setupExtensionPreferences()] PROPAGATE accountsChanged accounts=${$}`);const M=!!C.sdkProvider,O=!!C.extensionActive;if(M&&C.getMobileProvider().emit(Cn.ACCOUNTS_CHANGED,$),O&&$?.length===0&&(yield(U=C.getProvider())===null||U===void 0?void 0:U.request({method:me.WALLET_GETPERMISSIONS,params:[]})).length===0)try{yield C.terminate()}catch(A){Q("[MetaMaskSDK: setupExtensionPreferences()] error terminating on permissions revoked",A)}})),j.on(Cn.DISCONNECT,$=>{Q(`[MetaMaskSDK: setupExtensionPreferences()] PROPAGATE disconnect error=${$}`),C.sdkProvider&&C.getMobileProvider().emit(Cn.DISCONNECT,$)}),j.on(Cn.CONNECT,$=>{Q(`[MetaMaskSDK: setupExtensionPreferences()] PROPAGATE connect args=${$}`),C.sdkProvider&&C.getMobileProvider().emit(Cn.CONNECT,$)}),j.on(Cn.CONNECTED,$=>{Q("[MetaMaskSDK: setupExtensionPreferences()] PROPAGATE connected",$),C.sdkProvider&&C.getMobileProvider().emit(Cn.CONNECTED,$)})}catch{window.extension=void 0}}else!((I=C.platformManager)===null||I===void 0)&&I.isMetaMaskMobileWebView()&&((R=C.analytics)===null||R===void 0||R.send({event:tt.SDK_USE_INAPP_BROWSER}),C.activeProvider=ew({provider:window.ethereum,sdkInstance:C}),C._initialized=!0,B=!0);return j&&z.extensionOnly&&(Q("[MetaMaskSDK: setupExtensionPreferences()] EXTENSION ONLY --- prevent sdk initialization"),(L=C.analytics)===null||L===void 0||L.send({event:tt.SDK_USE_EXTENSION}),C.activeProvider=j,C.extensionActive=!0,C.extension=j,C._initialized=!0,B=!0),{preferExtension:D,shouldReturn:B,metamaskBrowserExtension:j}})}(t);if(m)Q("[MetaMaskSDK: performSDKInitialization()] shouldReturn=true --- prevent sdk initialization");else{yield function(C,v){var I,R,L,z,j;return X(this,void 0,void 0,function*(){const{options:D}=C,B=Object.assign({},D.logging);C.remoteConnection=new $2({anonId:yield C.getAnonId(),preferDesktop:(I=D.preferDesktop)!==null&&I!==void 0&&I,communicationLayerPreference:(R=D.communicationLayerPreference)!==null&&R!==void 0?R:gi.SOCKET,analytics:C.analytics,dappMetadata:D.dappMetadata,_source:D._source,enableAnalytics:(L=D.enableAnalytics)===null||L===void 0||L,timer:D.timer,sdk:C,platformManager:C.platformManager,transports:D.transports,communicationServerUrl:D.communicationServerUrl,storage:(z=D.storage)!==null&&z!==void 0?z:{enabled:!0},getMetaMaskInstaller:()=>{if(!C.installer)throw new Error("Invalid SDK status -- installer not initialized");return C.installer},logging:B,connectWithExtensionProvider:v===void 0?void 0:()=>xp(C),modals:Object.assign(Object.assign({},D.modals),{onPendingModalDisconnect:C.terminate.bind(C)})}),yield C.remoteConnection.initRemoteCommunication({sdkInstance:C}),C.installer=new D2({remote:C.remoteConnection,preferDesktop:(j=D.preferDesktop)!==null&&j!==void 0&&j,platformManager:C.platformManager,debug:C.debug})})}(t,p),yield _2(t),yield function(C,v){var I,R;return X(this,void 0,void 0,function*(){const{options:L}=C;v?(Q("[MetaMaskSDK: handleAutoAndExtensionConnections()] preferExtension is detected -- connect with it."),(I=C.analytics)===null||I===void 0||I.send({event:tt.SDK_EXTENSION_UTILIZED}),xp(C).catch(z=>{console.warn("Can't connect with MetaMask extension...",z),localStorage.removeItem(sc)})):L.checkInstallationImmediately&&(!((R=C.platformManager)===null||R===void 0)&&R.isDesktopWeb()?(Q("[MetaMaskSDK: handleAutoAndExtensionConnections()] checkInstallationImmediately"),C.connect().catch(z=>{Q(`[MetaMaskSDK: handleAutoAndExtensionConnections()] checkInstallationImmediately --- IGNORED --- error on autoconnect _err=${z}`)})):console.warn("[handleAutoAndExtensionConnections()] checkInstallationImmediately --- IGNORED --- only for web desktop")),C._initialized=!0})}(t,y);try{yield(d=t.remoteConnection)===null||d===void 0?void 0:d.startConnection({initialCheck:!0})}catch(C){console.error("[MetaMaskSDK: setupRemoteConnectionAndInstaller()] Error while checking installation",C)}t.emit(Ft.ProviderUpdate,Fn.INITIALIZED)}})}class f3 extends Pb{constructor(e={storage:{enabled:!0},injectProvider:!0,forceInjectProvider:!1,enableAnalytics:!0,shouldShimWeb3:!0,useDeeplink:!0,extensionOnly:!0,headless:!1,dappMetadata:{name:"",url:"",iconUrl:""},_source:Cp,i18nOptions:{enabled:!1}}){var n,r,i;super(),this.extensionActive=!1,this._initialized=!1,this.sdkInitPromise=void 0,this.debug=!1,this.readonlyRPCCalls=!1,this.availableLanguages=["en"],this.ANON_ID_STORAGE_KEY="mm-sdk-anon-id",Tt.disable();const s=((n=e.logging)===null||n===void 0?void 0:n.developerMode)===!0;if((!((r=e.logging)===null||r===void 0)&&r.sdk||s)&&Tt.enable("MM_SDK"),Q("[MetaMaskSDK: constructor()]: begin."),this.setMaxListeners(50),!(!((i=e.dappMetadata)===null||i===void 0)&&i.url)){if(typeof window>"u"||typeof document>"u")throw new Error("You must provide dAppMetadata url");e.dappMetadata=Object.assign(Object.assign({},e.dappMetadata),{url:`${window.location.protocol}//${window.location.host}`})}this.options=e,this.options._source||(e._source=Cp),this.init().then(()=>{Q("[MetaMaskSDK: constructor()]: initialized successfully."),typeof window<"u"&&(window.mmsdk=this)}).catch(o=>{console.error("[MetaMaskSDK: constructor()] error during initialization",o)})}init(){return X(this,void 0,void 0,function*(){return function(e){var n;return X(this,void 0,void 0,function*(){if(typeof window<"u"&&(!((n=window.mmsdk)===null||n===void 0)&&n.isInitialized()))return Q("[MetaMaskSDK: initializeMetaMaskSDK()] already initialized"),Promise.resolve(window.mmsdk);if(e._initialized)return Q("[MetaMaskSDK: initializeMetaMaskSDK()] already initialized"),e.sdkInitPromise;if(e.sdkInitPromise)return Q("[MetaMaskSDK: initializeMetaMaskSDK()] already initializing"),e.sdkInitPromise;try{e.sdkInitPromise=j2(e),yield e.sdkInitPromise}catch(r){throw console.error(r),r}return e.sdkInitPromise})}(this)})}isExtensionActive(){return this.extensionActive}checkExtensionAvailability(){var e;return typeof window<"u"&&!!(!((e=window.ethereum)===null||e===void 0)&&e.isMetaMask)}connect(){return X(this,void 0,void 0,function*(){return function(e){return X(this,void 0,void 0,function*(){if(e._initialized||(Q("[MetaMaskSDK: connect()] provider not ready -- wait for init()"),yield e.init()),Q(`[MetaMaskSDK: connect()] isExtensionActive=${e.isExtensionActive()} activeProvider`,e.activeProvider),!e.activeProvider)throw new Error("SDK state invalid -- undefined provider");const n=e.activeProvider.getSelectedAddress();return n?[n]:e.activeProvider.request({method:me.ETH_REQUESTACCOUNTS,params:[]})})}(this)})}connectAndSign({msg:e}){return X(this,void 0,void 0,function*(){return E2({instance:this,msg:e})})}connectWith(e){return X(this,void 0,void 0,function*(){return function({instance:n,rpc:r}){return X(this,void 0,void 0,function*(){if(n._initialized||(Q("[MetaMaskSDK: connectWith()] provider not ready -- wait for init()"),yield n.init()),Q(`[MetaMaskSDK: connectWith()] method: ${r.method} rpc=${r}`),!n.activeProvider)throw new Error("SDK state invalid -- undefined provider");return n.activeProvider.request({method:me.METAMASK_CONNECTWITH,params:[r]})})}({instance:this,rpc:e})})}resume(){return function(e){var n,r,i;return X(this,void 0,void 0,function*(){if(!(!((r=(n=e.remoteConnection)===null||n===void 0?void 0:n.getConnector())===null||r===void 0)&&r.isReady()))return Q("[MetaMaskSDK: resume()] channel is not ready -- starting connection"),void((i=e.remoteConnection)===null||i===void 0||i.startConnection());Q("[MetaMaskSDK: resume()] channel is ready")})}(this)}disconnect(){return console.warn("MetaMaskSDK.disconnect() is deprecated, use terminate()"),this.terminate()}isAuthorized(){var e;(e=this.remoteConnection)===null||e===void 0||e.isAuthorized()}terminate(){return function(e){var n,r,i;return X(this,void 0,void 0,function*(){if(!(!((n=e.platformManager)===null||n===void 0)&&n.isMetaMaskMobileWebView())){if(b2&&(window.localStorage.removeItem(sc),window.localStorage.removeItem(Uu),window.localStorage.removeItem(Du)),e.extensionActive){try{yield(r=e.activeProvider)===null||r===void 0?void 0:r.request({method:me.WALLET_REVOKEPERMISSIONS,params:[{eth_accounts:{}}]})}catch(s){Q("[MetaMaskSDK: terminate()] error revoking permissions",s)}return e.options.extensionOnly?(e.emit(Ft.ProviderUpdate,Fn.TERMINATE),void Q("[MetaMaskSDK: terminate()] extensionOnly --- prevent switching providers")):(e.activeProvider=e.sdkProvider,window.ethereum=e.activeProvider,e.extensionActive=!1,void e.emit(Ft.ProviderUpdate,Fn.TERMINATE))}e.emit(Ft.ProviderUpdate,Fn.TERMINATE),Q(`[MetaMaskSDK: terminate()] remoteConnection=${e.remoteConnection}`),(i=e.remoteConnection)===null||i===void 0||i.disconnect({terminate:!0,sendMessage:!0})}})}(this)}isInitialized(){return this._initialized}setReadOnlyRPCCalls(e){this.readonlyRPCCalls=e}hasReadOnlyRPCCalls(){return this.readonlyRPCCalls}getProvider(){if(this.activeProvider)return this.activeProvider;console.warn("MetaMaskSDK: No active provider found")}getMobileProvider(){if(!this.sdkProvider)throw new Error("SDK state invalid -- undefined mobile provider");return this.sdkProvider}getUniversalLink(){var e;const n=(e=this.remoteConnection)===null||e===void 0?void 0:e.getUniversalLink();if(!n)throw new Error("No Universal Link available, please call eth_requestAccounts first.");return n}getChannelId(){var e,n;return(n=(e=this.remoteConnection)===null||e===void 0?void 0:e.getChannelConfig())===null||n===void 0?void 0:n.channelId}getRPCHistory(){var e,n;return(n=(e=this.remoteConnection)===null||e===void 0?void 0:e.getConnector())===null||n===void 0?void 0:n.getRPCMethodTracker()}getVersion(){return Ci.version}getDappId(){var e,n,r,i;return typeof window>"u"||window.location===void 0?(i=(n=(e=this.options.dappMetadata)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:(r=this.options.dappMetadata)===null||r===void 0?void 0:r.url)!==null&&i!==void 0?i:"N/A":window.location.hostname}getAnonId(){var e,n;return X(this,void 0,void 0,function*(){if(this._anonId)return this._anonId;let r;return r=!((e=this.platformManager)===null||e===void 0)&&e.isBrowser()?this.getBrowserAnonId():!((n=this.platformManager)===null||n===void 0)&&n.isReactNative()?yield this.getReactNativeAnonId():Nr(),this._anonId=r,r})}getBrowserAnonId(){const e=this.ANON_ID_STORAGE_KEY;try{const n=localStorage.getItem(e);if(n)return n;const r=Nr();return localStorage.setItem(e,r),r}catch(n){return console.error("[MetaMaskSDK: getBrowserAnonId()] LocalStorage access error:",n),Nr()}}getReactNativeAnonId(){return X(this,void 0,void 0,function*(){const e=this.ANON_ID_STORAGE_KEY;try{const n=require("@react-native-async-storage/async-storage").default,r=yield n.getItem(e);if(r)return r;const i=Nr();return yield n.setItem(e,i),i}catch(n){return console.error("[MetaMaskSDK: getReactNativeAnonId()] Error accessing AsyncStorage:",n),Nr()}})}getWalletStatus(){var e,n;return(n=(e=this.remoteConnection)===null||e===void 0?void 0:e.getConnector())===null||n===void 0?void 0:n.getConnectionStatus()}_getChannelConfig(){var e;return(e=this.remoteConnection)===null||e===void 0?void 0:e.getChannelConfig()}_ping(){var e,n;(n=(e=this.remoteConnection)===null||e===void 0?void 0:e.getConnector())===null||n===void 0||n.ping()}_keyCheck(){var e,n;(n=(e=this.remoteConnection)===null||e===void 0?void 0:e.getConnector())===null||n===void 0||n.keyCheck()}_getServiceStatus(){var e,n;return(n=(e=this.remoteConnection)===null||e===void 0?void 0:e.getConnector())===null||n===void 0?void 0:n.getServiceStatus()}_getRemoteConnection(){return this.remoteConnection}_getDappMetadata(){return this.dappMetadata}_getKeyInfo(){var e;return(e=this.remoteConnection)===null||e===void 0?void 0:e.getKeyInfo()}_resetKeys(){var e,n;(n=(e=this.remoteConnection)===null||e===void 0?void 0:e.getConnector())===null||n===void 0||n.resetKeys()}_getConnection(){return this.remoteConnection}emit(e,n){return super.emit(e,n)}on(e,n){return super.on(e,n)}}var z2=Object.freeze({__proto__:null,StorageManagerWeb:class{constructor({enabled:t}={enabled:!1}){this.enabled=!1,this.enabled=t}persistChannelConfig(t){return X(this,void 0,void 0,function*(){const e=JSON.stringify(t);Q(`[StorageManagerWeb: persistChannelConfig()] enabled=${this.enabled}`,t),localStorage.setItem(Hl,e)})}getPersistedChannelConfig(){return X(this,void 0,void 0,function*(){let t;try{if(Q(`[StorageManagerWeb: getPersistedChannelConfig()] enabled=${this.enabled}`),t=localStorage.getItem(Hl),Q("[StorageManagerWeb: getPersistedChannelConfig()]",t),!t)return;const e=JSON.parse(t);return Q("[StorageManagerWeb: getPersistedChannelConfig()] channelConfig",e),e}catch(e){return void console.error("[StorageManagerWeb: getPersistedChannelConfig()] Can't find existing channel config",e)}})}persistAccounts(t){return X(this,void 0,void 0,function*(){Q(`[StorageManagerWeb: persistAccounts()] enabled=${this.enabled}`,t);const e=JSON.stringify(t);localStorage.setItem(Du,e)})}getCachedAccounts(){return X(this,void 0,void 0,function*(){try{const t=localStorage.getItem(Du);return t?JSON.parse(t):[]}catch(t){throw console.error("[StorageManagerWeb: getCachedAccounts()] Error reading cached accounts",t),t}})}persistChainId(t){return X(this,void 0,void 0,function*(){Q(`[StorageManagerWeb: persistChainId()] enabled=${this.enabled}`,t),localStorage.setItem(Uu,t)})}getCachedChainId(){return X(this,void 0,void 0,function*(){try{const t=localStorage.getItem(Uu);return t??void 0}catch(t){throw console.error("[StorageManagerWeb: getCachedChainId()] Error reading cached chainId",t),t}})}terminate(){return X(this,void 0,void 0,function*(){Q(`[StorageManagerWeb: terminate()] enabled=${this.enabled}`),localStorage.removeItem(Hl)})}}});const G2="hydrated",V2=!1,q2=!0;var W2=Object.defineProperty,zd=new WeakMap,Dr=t=>zd.get(t),Gd=(t,e)=>zd.set(e.$lazyInstance$=t,e),Lp=(t,e)=>e in t,hi=(t,e)=>(0,console.error)(t,e),Kl=new Map,Ra=new Map,iw="slot-fb{display:contents}slot-fb[hidden]{display:none}",Tc=typeof window<"u"?window:{},Ln=Tc.document||{head:{}},pt={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,n,r)=>t.addEventListener(e,n,r),rel:(t,e,n,r)=>t.removeEventListener(e,n,r),ce:(t,e)=>new CustomEvent(t,e)},sw=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),Hu=!1,Dp=[],ow=[],Q2=(t,e)=>n=>{t.push(n),Hu||(Hu=!0,4&pt.$flags$?Vd(Ku):pt.raf(Ku))},Up=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(n){hi(n)}t.length=0},Ku=()=>{Up(Dp),Up(ow),(Hu=Dp.length>0)&&pt.raf(Ku)},Vd=t=>(e=>Promise.resolve(e))().then(t),J2=Q2(ow),Fp={},qd=t=>(t=typeof t)=="object"||t==="function";function aw(t){var e,n,r;return(r=(n=(e=t.head)==null?void 0:e.querySelector('meta[name="csp-nonce"]'))==null?void 0:n.getAttribute("content"))!=null?r:void 0}((t,e)=>{for(var n in e)W2(t,n,{get:e[n],enumerable:!0})})({},{err:()=>cw,map:()=>Y2,ok:()=>$u,unwrap:()=>Z2,unwrapErr:()=>X2});var $u=t=>({isOk:!0,isErr:!1,value:t}),cw=t=>({isOk:!1,isErr:!0,value:t});function Y2(t,e){if(t.isOk){const n=e(t.value);return n instanceof Promise?n.then(r=>$u(r)):$u(n)}if(t.isErr){const n=t.value;return cw(n)}throw"should never get here"}var Wd,Z2=t=>{if(t.isOk)return t.value;throw t.value},X2=t=>{if(t.isErr)return t.value;throw t.value},J=(t,e,...n)=>{let r=null,i=!1,s=!1;const o=[],a=l=>{for(let u=0;u<l.length;u++)r=l[u],Array.isArray(r)?a(r):r!=null&&typeof r!="boolean"&&((i=typeof t!="function"&&!qd(r))&&(r=String(r)),i&&s?o[o.length-1].$text$+=r:o.push(i?cc(null,r):r),s=i)};if(a(n),e){const l=e.className||e.class;l&&(e.class=typeof l!="object"?l:Object.keys(l).filter(u=>l[u]).join(" "))}if(typeof t=="function")return t(e===null?{}:e,o,tS);const c=cc(t,null);return c.$attrs$=e,o.length>0&&(c.$children$=o),c},cc=(t,e)=>({$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null,$attrs$:null}),eS={},tS={forEach:(t,e)=>t.map(Hp).forEach(e),map:(t,e)=>t.map(Hp).map(e).map(nS)},Hp=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),nS=t=>{if(typeof t.vtag=="function"){const n={...t.vattrs};return t.vkey&&(n.key=t.vkey),t.vname&&(n.name=t.vname),J(t.vtag,n,...t.vchildren||[])}const e=cc(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},Ic=t=>Dr(t).$hostElement$,Hr=(t,e,n)=>{const r=Ic(t);return{emit:i=>lw(r,e,{bubbles:!0,composed:!0,cancelable:!0,detail:i})}},lw=(t,e,n)=>{const r=pt.ce(e,n);return t.dispatchEvent(r),r},Kp=new WeakMap,rS=t=>{const e=t.$cmpMeta$,n=t.$hostElement$,r=e.$flags$;e.$tagName$;const i=((s,o,a)=>{var c;const l=uw(o),u=Ra.get(l);if(s=s.nodeType===11?s:Ln,u)if(typeof u=="string"){s=s.head||s;let d,h=Kp.get(s);if(h||Kp.set(s,h=new Set),!h.has(l)){{d=Ln.createElement("style"),d.innerHTML=u;const f=(c=pt.$nonce$)!=null?c:aw(Ln);if(f!=null&&d.setAttribute("nonce",f),!(1&o.$flags$))if(s.nodeName==="HEAD"){const g=s.querySelectorAll("link[rel=preconnect]"),p=g.length>0?g[g.length-1].nextSibling:s.querySelector("style");s.insertBefore(d,p)}else if("host"in s)if(sw){const g=new CSSStyleSheet;g.replaceSync(u),s.adoptedStyleSheets=[g,...s.adoptedStyleSheets]}else{const g=s.querySelector("style");g?g.innerHTML=u+g.innerHTML:s.prepend(d)}else s.append(d);1&o.$flags$&&s.nodeName!=="HEAD"&&s.insertBefore(d,null)}4&o.$flags$&&(d.innerHTML+=iw),h&&h.add(l)}}else s.adoptedStyleSheets.includes(u)||(s.adoptedStyleSheets=[...s.adoptedStyleSheets,u]);return l})(n.shadowRoot?n.shadowRoot:n.getRootNode(),e);10&r&&2&r&&(n["s-sc"]=i,n.classList.add(i+"-h"))},uw=(t,e)=>"sc-"+t.$tagName$,$p=(t,e,n,r,i,s)=>{if(n!==r){let o=Lp(t,e),a=e.toLowerCase();if(e==="class"){const c=t.classList,l=jp(n),u=jp(r);c.remove(...l.filter(d=>d&&!u.includes(d))),c.add(...u.filter(d=>d&&!l.includes(d)))}else if(e==="style"){for(const c in n)r&&r[c]!=null||(c.includes("-")?t.style.removeProperty(c):t.style[c]="");for(const c in r)n&&r[c]===n[c]||(c.includes("-")?t.style.setProperty(c,r[c]):t.style[c]=r[c])}else if(o||e[0]!=="o"||e[1]!=="n"){const c=qd(r);if((o||c&&r!==null)&&!i)try{if(t.tagName.includes("-"))t[e]=r;else{const l=r??"";e==="list"?o=!1:n!=null&&t[e]==l||(typeof t.__lookupSetter__(e)=="function"?t[e]=l:t.setAttribute(e,l))}}catch{}r==null||r===!1?r===!1&&t.getAttribute(e)!==""||t.removeAttribute(e):(!o||4&s||i)&&!c&&(r=r===!0?"":r,t.setAttribute(e,r))}else if(e=e[2]==="-"?e.slice(3):Lp(Tc,a)?a.slice(2):a[2]+e.slice(3),n||r){const c=e.endsWith(dw);e=e.replace(sS,""),n&&pt.rel(t,e,n,c),r&&pt.ael(t,e,r,c)}}},iS=/\s/,jp=t=>t?t.split(iS):[],dw="Capture",sS=new RegExp(dw+"$"),hw=(t,e,n)=>{const r=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,i=t&&t.$attrs$||Fp,s=e.$attrs$||Fp;for(const o of zp(Object.keys(i)))o in s||$p(r,o,i[o],void 0,n,e.$flags$);for(const o of zp(Object.keys(s)))$p(r,o,i[o],s[o],n,e.$flags$)};function zp(t){return t.includes("ref")?[...t.filter(e=>e!=="ref"),"ref"]:t}var on=!1,Qd=(t,e,n,r)=>{const i=e.$children$[n];let s,o,a=0;if(i.$text$!==null)s=i.$elm$=Ln.createTextNode(i.$text$);else{if(on||(on=i.$tag$==="svg"),s=i.$elm$=Ln.createElementNS(on?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",i.$tag$),on&&i.$tag$==="foreignObject"&&(on=!1),hw(null,i,on),s.getRootNode().querySelector("body"),i.$children$)for(a=0;a<i.$children$.length;++a)o=Qd(t,i,a),o&&s.appendChild(o);i.$tag$==="svg"?on=!1:s.tagName==="foreignObject"&&(on=!0)}return s["s-hn"]=Wd,s},Gp=(t,e,n,r,i,s)=>{let o,a=t;for(a.shadowRoot&&a.tagName===Wd&&(a=a.shadowRoot);i<=s;++i)r[i]&&(o=Qd(null,n,i),o&&(r[i].$elm$=o,Na(a,o,e)))},Vp=(t,e,n)=>{for(let r=e;r<=n;++r){const i=t[r];if(i){const s=i.$elm$;s&&s.remove()}}},ia=(t,e,n=!1)=>t.$tag$===e.$tag$,Bs=(t,e,n=!1)=>{const r=e.$elm$=t.$elm$,i=t.$children$,s=e.$children$,o=e.$tag$,a=e.$text$;a===null?(hw(t,e,on=o==="svg"||o!=="foreignObject"&&on),i!==null&&s!==null?((c,l,u,d,h=!1)=>{let f,g=0,p=0,y=l.length-1,m=l[0],C=l[y],v=d.length-1,I=d[0],R=d[v];for(;g<=y&&p<=v;)m==null?m=l[++g]:C==null?C=l[--y]:I==null?I=d[++p]:R==null?R=d[--v]:ia(m,I,h)?(Bs(m,I,h),m=l[++g],I=d[++p]):ia(C,R,h)?(Bs(C,R,h),C=l[--y],R=d[--v]):ia(m,R,h)?(Bs(m,R,h),Na(c,m.$elm$,C.$elm$.nextSibling),m=l[++g],R=d[--v]):ia(C,I,h)?(Bs(C,I,h),Na(c,C.$elm$,m.$elm$),C=l[--y],I=d[++p]):(f=Qd(l&&l[p],u,p),I=d[++p],f&&Na(m.$elm$.parentNode,f,m.$elm$));g>y?Gp(c,d[v+1]==null?null:d[v+1].$elm$,u,d,p,v):p>v&&Vp(l,g,y)})(r,i,e,s,n):s!==null?(t.$text$!==null&&(r.textContent=""),Gp(r,null,e,s,0,s.length-1)):!n&&q2&&i!==null&&Vp(i,0,i.length-1),on&&o==="svg"&&(on=!1)):t.$text$!==a&&(r.data=a)},Na=(t,e,n)=>t?.insertBefore(e,n),oS=(t,e,n=!1)=>{const r=t.$hostElement$,i=t.$cmpMeta$,s=t.$vnode$||cc(null,null),o=(a=e)&&a.$tag$===eS?e:J(null,null,e);var a;if(Wd=r.tagName,n&&o.$attrs$)for(const c of Object.keys(o.$attrs$))r.hasAttribute(c)&&!["key","ref","style","class"].includes(c)&&(o.$attrs$[c]=r[c]);o.$tag$=null,o.$flags$|=4,t.$vnode$=o,o.$elm$=s.$elm$=r.shadowRoot||r,r["s-sc"],1&i.$flags$,Bs(s,o,n)},fw=(t,e)=>{e&&!t.$onRenderResolve$&&e["s-p"]&&e["s-p"].push(new Promise(n=>t.$onRenderResolve$=n))},Jd=(t,e)=>(t.$flags$|=16,4&t.$flags$?void(t.$flags$|=512):(fw(t,t.$ancestorComponent$),J2(()=>aS(t,e)))),aS=(t,e)=>{const n=t.$hostElement$;t.$cmpMeta$.$tagName$;const r=t.$lazyInstance$;if(!r)throw new Error(`Can't render component <${n.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);return cS(void 0,()=>uS(t,r,e))},cS=(t,e)=>lS(t)?t.then(e).catch(n=>{console.error(n),e()}):e(),lS=t=>t instanceof Promise||t&&t.then&&typeof t.then=="function",uS=async(t,e,n)=>{var r;const i=t.$hostElement$;t.$cmpMeta$.$tagName$;const s=i["s-rc"];n&&rS(t),t.$cmpMeta$.$tagName$,dS(t,e,i,n),s&&(s.map(o=>o()),i["s-rc"]=void 0);{const o=(r=i["s-p"])!=null?r:[],a=()=>hS(t);o.length===0?a():(Promise.all(o).then(a),t.$flags$|=4,o.length=0)}},dS=(t,e,n,r)=>{try{e=e.render(),t.$flags$&=-17,t.$flags$|=2,oS(t,e,r)}catch(i){hi(i,t.$hostElement$)}return null},hS=t=>{t.$cmpMeta$.$tagName$;const e=t.$hostElement$,n=()=>{},r=t.$lazyInstance$,i=t.$ancestorComponent$;64&t.$flags$?n():(t.$flags$|=64,gw(e),Yd(r,"componentDidLoad"),t.$onReadyResolve$(e),i||pw()),t.$onRenderResolve$&&(t.$onRenderResolve$(),t.$onRenderResolve$=void 0),512&t.$flags$&&Vd(()=>Jd(t,!1)),t.$flags$&=-517},pw=t=>{gw(Ln.documentElement),Vd(()=>lw(Tc,"appload",{detail:{namespace:"sdk-install-modal-web"}}))},Yd=(t,e,n)=>{if(t&&t[e])try{return t[e](n)}catch(r){hi(r)}},gw=t=>{var e;return t.classList.add((e=G2)!=null?e:"hydrated")},fS=(t,e,n,r)=>{const i=Dr(t);if(!i)throw new Error(`Couldn't find host element for "${r.$tagName$}" as it is unknown to this Stencil runtime. This usually happens when integrating a 3rd party Stencil component with another Stencil component or application. Please reach out to the maintainers of the 3rd party Stencil component or report this on the Stencil Discord server (https://chat.stenciljs.com) or comment on this similar [GitHub issue](https://github.com/ionic-team/stencil/issues/5457).`);const s=i.$hostElement$,o=i.$instanceValues$.get(e),a=i.$flags$,c=i.$lazyInstance$;var l,u;l=n,u=r.$members$[e][0],n=l==null||qd(l)?l:4&u?l!=="false"&&(l===""||!!l):1&u?String(l):l;const d=Number.isNaN(o)&&Number.isNaN(n);if((!(8&a)||o===void 0)&&n!==o&&!d&&(i.$instanceValues$.set(e,n),c)){if(r.$watchers$&&128&a){const h=r.$watchers$[e];h&&h.map(f=>{try{c[f](n,o,e)}catch(g){hi(g,s)}})}(18&a)==2&&Jd(i,!1)}},mw=(t,e,n)=>{var r,i;const s=t.prototype;if(e.$members$||e.$watchers$||t.watchers){t.watchers&&!e.$watchers$&&(e.$watchers$=t.watchers);const o=Object.entries((r=e.$members$)!=null?r:{});if(o.map(([a,[c]])=>{(31&c||2&n&&32&c)&&Object.defineProperty(s,a,{get(){return l=a,Dr(this).$instanceValues$.get(l);var l},set(l){fS(this,a,l,e)},configurable:!0,enumerable:!0})}),1&n){const a=new Map;s.attributeChangedCallback=function(c,l,u){pt.jmp(()=>{var d;const h=a.get(c);if(this.hasOwnProperty(h))u=this[h],delete this[h];else{if(s.hasOwnProperty(h)&&typeof this[h]=="number"&&this[h]==u)return;if(h==null){const f=Dr(this),g=f?.$flags$;if(g&&!(8&g)&&128&g&&u!==l){const p=f.$lazyInstance$,y=(d=e.$watchers$)==null?void 0:d[c];y?.forEach(m=>{p[m]!=null&&p[m].call(p,u,l,c)})}return}}this[h]=(u!==null||typeof this[h]!="boolean")&&u})},t.observedAttributes=Array.from(new Set([...Object.keys((i=e.$watchers$)!=null?i:{}),...o.filter(([c,l])=>15&l[0]).map(([c,l])=>{const u=l[1]||c;return a.set(u,c),u})]))}}return t},pS=async(t,e,n,r)=>{let i;if((32&e.$flags$)==0){if(e.$flags$|=32,n.$lazyBundleId$){const a=((c,l,u)=>{const d=c.$tagName$.replace(/-/g,"_"),h=c.$lazyBundleId$;if(!h)return;const f=Kl.get(h);if(f)return f[d];{const g=p=>(Kl.set(h,p),p[d]);if(h==="mm-install-modal_3")return Promise.resolve().then(function(){return TS}).then(g,hi)}return wb(()=>import(`./${h}.entry.js`),[]).then(g=>(Kl.set(h,g),g[d]),hi)})(n);if(a&&"then"in a?i=await a:i=a,!i)throw new Error(`Constructor for "${n.$tagName$}#${e.$modeName$}" was not found`);i.isProxied||(n.$watchers$=i.watchers,mw(i,n,2),i.isProxied=!0),n.$tagName$,e.$flags$|=8;try{new i(e)}catch(c){hi(c)}e.$flags$&=-9,e.$flags$|=128,ju(e.$lazyInstance$)}else{i=t.constructor;const a=t.localName;customElements.whenDefined(a).then(()=>e.$flags$|=128)}if(i&&i.style){let a;typeof i.style=="string"&&(a=i.style);const c=uw(n);Ra.has(c)||(n.$tagName$,((l,u,d)=>{let h=Ra.get(l);sw&&d?(h=h||new CSSStyleSheet,typeof h=="string"?h=u:h.replaceSync(u)):h=u,Ra.set(l,h)})(c,a,!!(1&n.$flags$)))}}const s=e.$ancestorComponent$,o=()=>Jd(e,!0);s&&s["s-rc"]?s["s-rc"].push(o):o()},ju=t=>{Yd(t,"connectedCallback")},qp=t=>{Yd(t,"disconnectedCallback")},gS=(t,e={})=>{var n;const r=[],i=e.exclude||[],s=Tc.customElements,o=Ln.head,a=o.querySelector("meta[charset]"),c=Ln.createElement("style"),l=[];let u,d=!0;Object.assign(pt,e),pt.$resourcesUrl$=new URL(e.resourcesUrl||"./",Ln.baseURI).href;let h=!1;if(t.map(f=>{f[1].map(g=>{var p;const y={$flags$:g[0],$tagName$:g[1],$members$:g[2],$listeners$:g[3]};4&y.$flags$&&(h=!0),y.$members$=g[2],y.$watchers$=(p=g[4])!=null?p:{};const m=y.$tagName$,C=class extends HTMLElement{constructor(v){if(super(v),this.hasRegisteredEventListeners=!1,((I,R)=>{const L={$flags$:0,$hostElement$:I,$cmpMeta$:R,$instanceValues$:new Map};L.$onReadyPromise$=new Promise(z=>L.$onReadyResolve$=z),I["s-p"]=[],I["s-rc"]=[],zd.set(I,L)})(v=this,y),1&y.$flags$)if(v.shadowRoot){if(v.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${y.$tagName$}! Mode is set to ${v.shadowRoot.mode} but Stencil only supports open shadow roots.`)}else v.attachShadow({mode:"open"})}connectedCallback(){Dr(this),this.hasRegisteredEventListeners||(this.hasRegisteredEventListeners=!0),u&&(clearTimeout(u),u=null),d?l.push(this):pt.jmp(()=>(v=>{if((1&pt.$flags$)==0){const I=Dr(v),R=I.$cmpMeta$;if(R.$tagName$,1&I.$flags$)I?.$lazyInstance$?ju(I.$lazyInstance$):I?.$onReadyPromise$&&I.$onReadyPromise$.then(()=>ju(I.$lazyInstance$));else{I.$flags$|=1;{let L=v;for(;L=L.parentNode||L.host;)if(L["s-p"]){fw(I,I.$ancestorComponent$=L);break}}R.$members$&&Object.entries(R.$members$).map(([L,[z]])=>{if(31&z&&v.hasOwnProperty(L)){const j=v[L];delete v[L],v[L]=j}}),pS(v,I,R)}}})(this))}disconnectedCallback(){pt.jmp(()=>(async v=>{if((1&pt.$flags$)==0){const I=Dr(v);I?.$lazyInstance$?qp(I.$lazyInstance$):I?.$onReadyPromise$&&I.$onReadyPromise$.then(()=>qp(I.$lazyInstance$))}})(this))}componentOnReady(){return Dr(this).$onReadyPromise$}};y.$lazyBundleId$=f[0],i.includes(m)||s.get(m)||(r.push(m),s.define(m,mw(C,y,1)))})}),r.length>0&&(h&&(c.textContent+=iw),c.textContent+=r.sort()+"{visibility:hidden}.hydrated{visibility:inherit}",c.innerHTML.length)){c.setAttribute("data-styles","");const f=(n=pt.$nonce$)!=null?n:aw(Ln);f!=null&&c.setAttribute("nonce",f),o.insertBefore(c,a?a.nextSibling:o.firstChild)}d=!1,l.length?l.map(f=>f.connectedCallback()):pt.jmp(()=>u=setTimeout(pw,30))};(function(){if(typeof window<"u"&&window.Reflect!==void 0&&window.customElements!==void 0){var t=HTMLElement;window.HTMLElement=function(){return Reflect.construct(t,[],this.constructor)},HTMLElement.prototype=t.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,t)}})();var mS=Object.freeze({__proto__:null,defineCustomElements:async(t,e)=>{if(typeof window<"u")return await void 0,gS([["mm-install-modal_3",[[1,"mm-install-modal",{link:[1],sdkVersion:[1,"sdk-version"],preferDesktop:[4,"prefer-desktop"],tab:[32],isDefaultTab:[32],translationsLoaded:[32]},null,{preferDesktop:["updatePreferDesktop"]}],[1,"mm-pending-modal",{displayOTP:[4,"display-o-t-p"],sdkVersion:[1,"sdk-version"],otpCode:[1,"otp-code"],translationsLoaded:[32]}],[1,"mm-select-modal",{link:[1],sdkVersion:[1,"sdk-version"],preferDesktop:[4,"prefer-desktop"],tab:[32],isDefaultTab:[32],translationsLoaded:[32]},null,{preferDesktop:["updatePreferDesktop"]}]]]],e)},setNonce:t=>pt.$nonce$=t});const yS={fontFamily:"Roboto, sans-serif"},Zd=({className:t},e)=>J("div",{style:yS,class:t},e),$l=({Icon:t,text:e})=>J("div",{class:"flexContainer",style:{padding:"6",flexDirection:"row"}},J("div",{class:"flexItem1"},J(t,null)),J("div",{class:"flexItem11"},J("span",{style:{lineHeight:"2",color:"black"}},e))),wS=()=>J("svg",{width:"20",height:"18",viewBox:"0 0 20 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},J("path",{d:"M20.0002 7.9702V10.0302C20.0002 10.5802 19.5602 11.0302 19.0002 11.0502H17.0402C15.9602 11.0502 14.9702 10.2602 14.8802 9.1802C14.8202 8.5502 15.0602 7.9602 15.4802 7.5502C15.8502 7.1702 16.3602 6.9502 16.9202 6.9502H19.0002C19.5602 6.9702 20.0002 7.4202 20.0002 7.9702Z",fill:"#037DD6"}),J("path",{d:"M18.47 12.55H17.04C15.14 12.55 13.54 11.12 13.38 9.3C13.29 8.26 13.67 7.22 14.43 6.48C15.07 5.82 15.96 5.45 16.92 5.45H18.47C18.76 5.45 19 5.21 18.97 4.92C18.75 2.49 17.14 0.83 14.75 0.55C14.51 0.51 14.26 0.5 14 0.5H5C4.72 0.5 4.45 0.52 4.19 0.56C1.64 0.88 0 2.78 0 5.5V12.5C0 15.26 2.24 17.5 5 17.5H14C16.8 17.5 18.73 15.75 18.97 13.08C19 12.79 18.76 12.55 18.47 12.55ZM11 6.75H5C4.59 6.75 4.25 6.41 4.25 6C4.25 5.59 4.59 5.25 5 5.25H11C11.41 5.25 11.75 5.59 11.75 6C11.75 6.41 11.41 6.75 11 6.75Z",fill:"#037DD6"})),vS=()=>J("svg",{width:"20",height:"18",viewBox:"0 0 20 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},J("path",{d:"M14.44 0.0999756C12.63 0.0999756 11.01 0.979976 10 2.32998C8.99 0.979976 7.37 0.0999756 5.56 0.0999756C2.49 0.0999756 0 2.59998 0 5.68998C0 6.87998 0.19 7.97998 0.52 8.99998C2.1 14 6.97 16.99 9.38 17.81C9.72 17.93 10.28 17.93 10.62 17.81C13.03 16.99 17.9 14 19.48 8.99998C19.81 7.97998 20 6.87998 20 5.68998C20 2.59998 17.51 0.0999756 14.44 0.0999756Z",fill:"#037DD6"})),bS=()=>J("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},J("path",{d:"M16.28 7.53V6.28C16.28 3.58 15.63 0 10 0C4.37 0 3.72 3.58 3.72 6.28V7.53C0.92 7.88 0 9.3 0 12.79V14.65C0 18.75 1.25 20 5.35 20H14.65C18.75 20 20 18.75 20 14.65V12.79C20 9.3 19.08 7.88 16.28 7.53ZM10 16.74C8.33 16.74 6.98 15.38 6.98 13.72C6.98 12.05 8.34 10.7 10 10.7C11.66 10.7 13.02 12.06 13.02 13.72C13.02 15.39 11.67 16.74 10 16.74ZM5.35 7.44C5.27 7.44 5.2 7.44 5.12 7.44V6.28C5.12 3.35 5.95 1.4 10 1.4C14.05 1.4 14.88 3.35 14.88 6.28V7.45C14.8 7.45 14.73 7.45 14.65 7.45H5.35V7.44Z",fill:"#037DD6"})),ES=()=>J("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},J("path",{d:"M16.4405 8.8999C20.0405 9.2099 21.5105 11.0599 21.5105 15.1099V15.2399C21.5105 19.7099 19.7205 21.4999 15.2505 21.4999H8.74047C4.27047 21.4999 2.48047 19.7099 2.48047 15.2399V15.1099C2.48047 11.0899 3.93047 9.2399 7.47047 8.9099",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),J("path",{d:"M12 2V14.88",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),J("path",{d:"M15.3504 12.6499L12.0004 15.9999L8.65039 12.6499",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}));function Xd({version:t}){return J("div",{style:{textAlign:"center",color:"#BBC0C5",fontSize:"12"}},"SDK Version ",t?`v${t}`:"unknown")}const eh=()=>J("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},J("rect",{width:"16",height:"16",fill:"white"}),J("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.40554 2.40554C2.94627 1.86482 3.82296 1.86482 4.36369 2.40554L8 6.04186L11.6363 2.40554C12.177 1.86482 13.0537 1.86482 13.5945 2.40554C14.1352 2.94627 14.1352 3.82296 13.5945 4.36369L9.95814 8L13.5945 11.6363C14.1352 12.177 14.1352 13.0537 13.5945 13.5945C13.0537 14.1352 12.177 14.1352 11.6363 13.5945L8 9.95814L4.36369 13.5945C3.82296 14.1352 2.94627 14.1352 2.40554 13.5945C1.86482 13.0537 1.86482 12.177 2.40554 11.6363L6.04186 8L2.40554 4.36369C1.86482 3.82296 1.86482 2.94627 2.40554 2.40554Z",fill:"#BBC0C5"})),th=()=>J("svg",{width:"120",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 127 63"},J("path",{fill:"currentColor",d:"M71.554 48.607v13.81h-7.072v-9.568l-8.059.945c-1.77.205-2.548.79-2.548 1.864 0 1.575 1.478 2.239 4.648 2.239 1.932 0 4.073-.29 5.963-.79l-3.66 5.225c-1.479.332-2.92.496-4.44.496-6.414 0-10.074-2.57-10.074-7.132 0-4.023 2.877-6.136 9.416-6.884l8.638-1.012c-.467-2.532-2.362-3.633-6.13-3.633-3.537 0-7.443.912-10.937 2.613l1.111-6.18c3.248-1.369 6.95-2.074 10.69-2.074 8.226 0 12.461 3.444 12.461 10.075l-.008.005ZM7.938 31.315.208 62.416h7.73l3.836-15.628 6.65 8.039h8.06l6.65-8.039 3.836 15.628h7.73l-7.73-31.105-14.518 17.388L7.934 31.311l.004.004ZM36.97.21 22.452 17.598 7.938.21.208 31.315h7.73l3.836-15.628 6.65 8.039h8.06l6.65-8.039 3.836 15.628h7.73L36.97.21Zm53.17 48.107-6.25-.912c-1.562-.247-2.178-.747-2.178-1.617 0-1.41 1.52-2.032 4.647-2.032 3.62 0 6.868.747 10.283 2.364l-.862-6.094c-2.757-.995-5.922-1.491-9.212-1.491-7.688 0-11.886 2.696-11.886 7.547 0 3.776 2.303 5.889 7.196 6.636l6.335.954c1.603.248 2.261.87 2.261 1.865 0 1.41-1.478 2.074-4.481 2.074-3.948 0-8.225-.953-11.72-2.654l.7 6.094c3.003 1.122 6.91 1.785 10.57 1.785 7.896 0 12.007-2.78 12.007-7.715 0-3.94-2.303-6.057-7.4-6.8l-.01-.004ZM100.3 34.09v28.325h7.071V34.091H100.3Zm15.334 15.595 9.833-10.744h-8.8l-9.296 11.114 9.912 12.356h8.925l-10.574-12.73v.004Zm-16.321-25.09c0 4.56 3.66 7.13 10.074 7.13 1.52 0 2.961-.167 4.44-.495l3.66-5.225c-1.89.496-4.031.79-5.963.79-3.166 0-4.648-.664-4.648-2.239 0-1.079.783-1.659 2.549-1.864l8.058-.945v9.567h7.072v-13.81c0-6.635-4.236-10.075-12.461-10.075-3.744 0-7.442.705-10.691 2.075l-1.112 6.178c3.495-1.701 7.401-2.613 10.937-2.613 3.769 0 5.664 1.1 6.13 3.633l-8.637 1.013c-6.539.747-9.417 2.86-9.417 6.883l.009-.004Zm-19.779-1.492c0 5.725 3.29 8.627 9.787 8.627 2.59 0 4.732-.416 6.785-1.37l.903-6.261c-1.974 1.2-3.99 1.822-6.005 1.822-3.044 0-4.402-1.243-4.402-4.023v-8.295h10.732V7.84H86.601V2.948l-13.448 7.174v3.482h6.372V23.1l.008.004Zm-6.95-2.612v1.411H53.47c.862 2.873 3.423 4.187 7.97 4.187 3.62 0 6.993-.747 9.992-2.196l-.862 6.056c-2.757 1.16-6.251 1.785-9.829 1.785-9.5 0-14.68-4.23-14.68-12.066 0-7.838 5.264-12.235 13.406-12.235s13.119 4.771 13.119 13.062l-.005-.004ZM53.378 17.09h12.086c-.637-2.751-2.732-4.188-6.08-4.188-3.349 0-5.335 1.399-6.006 4.188Z"}));function Qr(t,e){return t.toString(2).padStart(e,"0")}function Wp(t,e){const n=t%e;return n>=0?n:e+n}function Qt(t,e){return new Array(t).fill(e)}function Qp(...t){let e=0;for(const r of t)e=Math.max(e,r.length);const n=[];for(let r=0;r<e;r++)for(const i of t)r>=i.length||n.push(i[r]);return new Uint8Array(n)}function Jp(t,e,n){if(n<0||n+e.length>t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[n+r])return!1;return!0}function Yp(t){return{has:e=>t.includes(e),decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("alphabet.decode input should be array of strings");return e.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=t.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${t}`);return r})},encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return e.map(n=>{if(function(r){if(!Number.isSafeInteger(r))throw new Error(`Wrong integer: ${r}`)}(n),n<0||n>=t.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${t.length})`);return t[n]})}}}class qt{static size(e,n){if(typeof e=="number"&&(e={height:e,width:e}),!Number.isSafeInteger(e.height)&&e.height!==1/0)throw new Error(`Bitmap: wrong height=${e.height} (${typeof e.height})`);if(!Number.isSafeInteger(e.width)&&e.width!==1/0)throw new Error(`Bitmap: wrong width=${e.width} (${typeof e.width})`);return n!==void 0&&(e={width:Math.min(e.width,n.width),height:Math.min(e.height,n.height)}),e}static fromString(e){const n=(e=e.replace(/^\n+/g,"").replace(/\n+$/g,"")).split(`
`),r=n.length,i=new Array(r);let s;for(const o of n){const a=o.split("").map(c=>{if(c==="X")return!0;if(c===" ")return!1;if(c!=="?")throw new Error(`Bitmap.fromString: unknown symbol=${c}`)});if(s&&a.length!==s)throw new Error(`Bitmap.fromString different row sizes: width=${s} cur=${a.length}`);s=a.length,i.push(a)}return s||(s=0),new qt({height:r,width:s},i)}constructor(e,n){const{height:r,width:i}=qt.size(e);this.data=n||Array.from({length:r},()=>Qt(i,void 0)),this.height=r,this.width=i}point(e){return this.data[e.y][e.x]}isInside(e){return 0<=e.x&&e.x<this.width&&0<=e.y&&e.y<this.height}size(e){if(!e)return{height:this.height,width:this.width};const{x:n,y:r}=this.xy(e);return{height:this.height-r,width:this.width-n}}xy(e){if(typeof e=="number"&&(e={x:e,y:e}),!Number.isSafeInteger(e.x))throw new Error(`Bitmap: wrong x=${e.x}`);if(!Number.isSafeInteger(e.y))throw new Error(`Bitmap: wrong y=${e.y}`);return e.x=Wp(e.x,this.width),e.y=Wp(e.y,this.height),e}rect(e,n,r){const{x:i,y:s}=this.xy(e),{height:o,width:a}=qt.size(n,this.size({x:i,y:s}));for(let c=0;c<o;c++)for(let l=0;l<a;l++)this.data[s+c][i+l]=typeof r=="function"?r({x:l,y:c},this.data[s+c][i+l]):r;return this}rectRead(e,n,r){return this.rect(e,n,(i,s)=>(r(i,s),s))}hLine(e,n,r){return this.rect(e,{width:n,height:1},r)}vLine(e,n,r){return this.rect(e,{width:1,height:n},r)}border(e=2,n){const r=this.height+2*e,i=this.width+2*e,s=Qt(e,n),o=Array.from({length:e},()=>Qt(i,n));return new qt({height:r,width:i},[...o,...this.data.map(a=>[...s,...a,...s]),...o])}embed(e,n){return this.rect(e,n.size(),({x:r,y:i})=>n.data[i][r])}rectSlice(e,n=this.size()){const r=new qt(qt.size(n,this.size(this.xy(e))));return this.rect(e,n,({x:i,y:s},o)=>r.data[s][i]=o),r}inverse(){const{height:e,width:n}=this;return new qt({height:n,width:e}).rect({x:0,y:0},1/0,({x:r,y:i})=>this.data[r][i])}scale(e){if(!Number.isSafeInteger(e)||e>1024)throw new Error(`Wrong scale factor: ${e}`);const{height:n,width:r}=this;return new qt({height:e*n,width:e*r}).rect({x:0,y:0},1/0,({x:i,y:s})=>this.data[Math.floor(s/e)][Math.floor(i/e)])}clone(){return new qt(this.size()).rect({x:0,y:0},this.size(),({x:e,y:n})=>this.data[n][e])}assertDrawn(){this.rectRead(0,1/0,(e,n)=>{if(typeof n!="boolean")throw new Error("Invalid color type="+typeof n)})}toString(){return this.data.map(e=>e.map(n=>n===void 0?"?":n?"X":" ").join("")).join(`
`)}toASCII(){const{height:e,width:n,data:r}=this;let i="";for(let s=0;s<e;s+=2){for(let o=0;o<n;o++){const a=r[s][o],c=s+1>=e||r[s+1][o];a||c?!a&&c?i+="â–€":a&&!c?i+="â–„":a&&c&&(i+=" "):i+="â–ˆ"}i+=`
`}return i}toTerm(){const e="\x1B[0m",n=`\x1B[1;47m  ${e}`,r=`\x1B[40m  ${e}`;return this.data.map(i=>i.map(s=>s?r:n).join("")).join(`
`)}toSVG(){let e=`<svg xmlns:svg="http://www.w3.org/2000/svg" viewBox="0 0 ${this.width} ${this.height}" version="1.1" xmlns="http://www.w3.org/2000/svg">`;return this.rectRead(0,1/0,({x:n,y:r},i)=>{i&&(e+=`<rect x="${n}" y="${r}" width="1" height="1" />`)}),e+="</svg>",e}toGIF(){const e=a=>[255&a,a>>>8&255],n=[...e(this.width),...e(this.height)],r=[];this.rectRead(0,1/0,(a,c)=>r.push(+(c===!0)));const i=126,s=[71,73,70,56,55,97,...n,246,0,0,255,255,255,...Qt(381,0),44,0,0,0,0,...n,0,7],o=Math.floor(r.length/i);for(let a=0;a<o;a++)s.push(127,128,...r.slice(i*a,i*(a+1)).map(c=>+c));return s.push(r.length%i+1,128,...r.slice(o*i).map(a=>+a)),s.push(1,129,0,59),new Uint8Array(s)}toImage(e=!1){const{height:n,width:r}=this.size(),i=new Uint8Array(n*r*(e?3:4));let s=0;for(let o=0;o<n;o++)for(let a=0;a<r;a++){const c=this.data[o][a]?0:255;i[s++]=c,i[s++]=c,i[s++]=c,e||(i[s++]=255)}return{height:n,width:r,data:i}}}const Zp=["low","medium","quartile","high"],Xp=["numeric","alphanumeric","byte","kanji","eci"],AS=[26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706],SS={low:[7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],medium:[10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],quartile:[13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],high:[17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]},CS={low:[1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],medium:[1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],quartile:[1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],high:[1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]},St={size:{encode:t=>21+4*(t-1),decode:t=>(t-17)/4},sizeType:t=>Math.floor((t+7)/17),alignmentPatterns(t){if(t===1)return[];const e=St.size.encode(t)-6-1,n=e-6,r=Math.ceil(n/28);let i=Math.floor(n/r);i%2?i+=1:n%r*2>=r&&(i+=2);const s=[6];for(let o=1;o<r;o++)s.push(e-(r-o)*i);return s.push(e),s},ECCode:{low:1,medium:0,quartile:3,high:2},formatMask:21522,formatBits(t,e){const n=St.ECCode[t]<<3|e;let r=n;for(let i=0;i<10;i++)r=r<<1^1335*(r>>9);return(n<<10|r)^St.formatMask},versionBits(t){let e=t;for(let n=0;n<12;n++)e=e<<1^7973*(e>>11);return t<<12|e},alphabet:{numeric:Yp("0123456789"),alphanumerc:Yp("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:")},lengthBits:(t,e)=>({numeric:[10,12,14],alphanumeric:[9,11,13],byte:[8,16,16],kanji:[8,10,12],eci:[0,0,0]})[e][St.sizeType(t)],modeBits:{numeric:"0001",alphanumeric:"0010",byte:"0100",kanji:"1000",eci:"0111"},capacity(t,e){const n=AS[t-1],r=SS[e][t-1],i=CS[e][t-1],s=Math.floor(n/i)-r,o=i-n%i;return{words:r,numBlocks:i,shortBlocks:o,blockLen:s,capacity:8*(n-r*i),total:(r+s)*i+i-o}}},zu=[(t,e)=>(t+e)%2==0,(t,e)=>e%2==0,(t,e)=>t%3==0,(t,e)=>(t+e)%3==0,(t,e)=>(Math.floor(e/2)+Math.floor(t/3))%2==0,(t,e)=>t*e%2+t*e%3==0,(t,e)=>(t*e%2+t*e%3)%2==0,(t,e)=>((t+e)%2+t*e%3)%2==0],ue={tables:(t=>{const e=Qt(256,0),n=Qt(256,0);for(let r=0,i=1;r<256;r++)e[r]=i,n[i]=r,i<<=1,256&i&&(i^=285);return{exp:e,log:n}})(),exp:t=>ue.tables.exp[t],log(t){if(t===0)throw new Error(`GF.log: wrong arg=${t}`);return ue.tables.log[t]%255},mul:(t,e)=>t===0||e===0?0:ue.tables.exp[(ue.tables.log[t]+ue.tables.log[e])%255],add:(t,e)=>t^e,pow:(t,e)=>ue.tables.exp[ue.tables.log[t]*e%255],inv(t){if(t===0)throw new Error(`GF.inverse: wrong arg=${t}`);return ue.tables.exp[255-ue.tables.log[t]]},polynomial(t){if(t.length==0)throw new Error("GF.polymomial: wrong length");if(t[0]!==0)return t;let e=0;for(;e<t.length-1&&t[e]==0;e++);return t.slice(e)},monomial(t,e){if(t<0)throw new Error(`GF.monomial: wrong degree=${t}`);if(e==0)return[0];let n=Qt(t+1,0);return n[0]=e,ue.polynomial(n)},degree:t=>t.length-1,coefficient:(t,e)=>t[ue.degree(t)-e],mulPoly(t,e){if(t[0]===0||e[0]===0)return[0];const n=Qt(t.length+e.length-1,0);for(let r=0;r<t.length;r++)for(let i=0;i<e.length;i++)n[r+i]=ue.add(n[r+i],ue.mul(t[r],e[i]));return ue.polynomial(n)},mulPolyScalar(t,e){if(e==0)return[0];if(e==1)return t;const n=Qt(t.length,0);for(let r=0;r<t.length;r++)n[r]=ue.mul(t[r],e);return ue.polynomial(n)},mulPolyMonomial(t,e,n){if(e<0)throw new Error("GF.mulPolyMonomial: wrong degree");if(n==0)return[0];const r=Qt(t.length+e,0);for(let i=0;i<t.length;i++)r[i]=ue.mul(t[i],n);return ue.polynomial(r)},addPoly(t,e){if(t[0]===0)return e;if(e[0]===0)return t;let n=t,r=e;n.length>r.length&&([n,r]=[r,n]);let i=Qt(r.length,0),s=r.length-n.length,o=r.slice(0,s);for(let a=0;a<o.length;a++)i[a]=o[a];for(let a=s;a<r.length;a++)i[a]=ue.add(n[a-s],r[a]);return ue.polynomial(i)},remainderPoly(t,e){const n=Array.from(t);for(let r=0;r<t.length-e.length+1;r++){const i=n[r];if(i!==0)for(let s=1;s<e.length;s++)e[s]!==0&&(n[r+s]=ue.add(n[r+s],ue.mul(e[s],i)))}return n.slice(t.length-e.length+1,n.length)},divisorPoly(t){let e=[1];for(let n=0;n<t;n++)e=ue.mulPoly(e,[1,ue.pow(2,n)]);return e},evalPoly(t,e){if(e==0)return ue.coefficient(t,0);let n=t[0];for(let r=1;r<t.length;r++)n=ue.add(ue.mul(e,n),t[r]);return n},euclidian(t,e,n){ue.degree(t)<ue.degree(e)&&([t,e]=[e,t]);let r=t,i=e,s=[0],o=[1];for(;2*ue.degree(i)>=n;){let l=r,u=s;if(r=i,s=o,r[0]===0)throw new Error("rLast[0] === 0");i=l;let d=[0];const h=ue.inv(r[0]);for(;ue.degree(i)>=ue.degree(r)&&i[0]!==0;){const f=ue.degree(i)-ue.degree(r),g=ue.mul(i[0],h);d=ue.addPoly(d,ue.monomial(f,g)),i=ue.addPoly(i,ue.mulPolyMonomial(r,f,g))}if(d=ue.mulPoly(d,s),o=ue.addPoly(d,u),ue.degree(i)>=ue.degree(r))throw new Error(`Division failed r: ${i}, rLast: ${r}`)}const a=ue.coefficient(o,0);if(a==0)throw new Error("sigmaTilde(0) was zero");const c=ue.inv(a);return[ue.mulPolyScalar(o,c),ue.mulPolyScalar(i,c)]}};function _S(t,e){const{words:n,shortBlocks:r,numBlocks:i,blockLen:s,total:o}=St.capacity(t,e),a=(c=n,{encode(l){const u=ue.divisorPoly(c),d=Array.from(l);return d.push(...u.slice(0,-1).fill(0)),Uint8Array.from(ue.remainderPoly(d,u))},decode(l){const u=l.slice(),d=ue.polynomial(Array.from(l));let h=Qt(c,0),f=!1;for(let v=0;v<c;v++){const I=ue.evalPoly(d,ue.exp(v));h[h.length-1-v]=I,I!==0&&(f=!0)}if(!f)return u;h=ue.polynomial(h);const g=ue.monomial(c,1),[p,y]=ue.euclidian(g,h,c),m=Qt(ue.degree(p),0);let C=0;for(let v=1;v<256&&C<m.length;v++)ue.evalPoly(p,v)===0&&(m[C++]=ue.inv(v));if(C!==m.length)throw new Error("RS.decode: wrong errors number");for(let v=0;v<m.length;v++){const I=u.length-1-ue.log(m[v]);if(I<0)throw new Error("RS.decode: wrong error location");const R=ue.inv(m[v]);let L=1;for(let z=0;z<m.length;z++)v!==z&&(L=ue.mul(L,ue.add(1,ue.mul(m[z],R))));u[I]=ue.add(u[I],ue.mul(ue.evalPoly(y,R),ue.inv(L)))}return u}});var c;return{encode(l){const u=[],d=[];for(let p=0;p<i;p++){const y=s+(p<r?0:1);u.push(l.subarray(0,y)),d.push(a.encode(l.subarray(0,y))),l=l.subarray(y)}const h=Qp(...u),f=Qp(...d),g=new Uint8Array(h.length+f.length);return g.set(h),g.set(f,h.length),g},decode(l){if(l.length!==o)throw new Error(`interleave.decode: len(data)=${l.length}, total=${o}`);const u=[];for(let f=0;f<i;f++){const g=f<r;u.push(new Uint8Array(n+s+(g?0:1)))}let d=0;for(let f=0;f<s;f++)for(let g=0;g<i;g++)u[g][f]=l[d++];for(let f=r;f<i;f++)u[f][s]=l[d++];for(let f=s;f<s+n;f++)for(let g=0;g<i;g++){const p=g<r;u[g][f+(p?0:1)]=l[d++]}const h=[];for(const f of u)h.push(...Array.from(a.decode(f)).slice(0,-n));return Uint8Array.from(h)}}}function e0(t,e,n,r){let i="",s=n.length;if(r==="numeric"){const d=St.alphabet.numeric.decode(n.split("")),h=d.length;for(let f=0;f<h-2;f+=3)i+=Qr(100*d[f]+10*d[f+1]+d[f+2],10);h%3==1?i+=Qr(d[h-1],4):h%3==2&&(i+=Qr(10*d[h-2]+d[h-1],7))}else if(r==="alphanumeric"){const d=St.alphabet.alphanumerc.decode(n.split("")),h=d.length;for(let f=0;f<h-1;f+=2)i+=Qr(45*d[f]+d[f+1],11);h%2==1&&(i+=Qr(d[h-1],6))}else{if(r!=="byte")throw new Error("encode: unsupported type");{const d=function(h){if(typeof h!="string")throw new Error("utf8ToBytes expected string, got "+typeof h);return new Uint8Array(new TextEncoder().encode(h))}(n);s=d.length,i=Array.from(d).map(h=>Qr(h,8)).join("")}}const{capacity:o}=St.capacity(t,e),a=Qr(s,St.lengthBits(t,r));let c=St.modeBits[r]+a+i;if(c.length>o)throw new Error("Capacity overflow");c+="0".repeat(Math.min(4,Math.max(0,o-c.length))),c.length%8&&(c+="0".repeat(8-c.length%8));const l="1110110000010001";for(let d=0;c.length!==o;d++)c+=l[d%16];const u=Uint8Array.from(c.match(/(.{8})/g).map(d=>+`0b${d}`));return _S(t,e).encode(u)}function t0(t,e,n,r,i=!1){const s=function(c,l,u,d=!1){const h=St.size.encode(c);let f=new qt(h+2);const g=new qt(3).rect(0,3,!0).border(1,!1).border(1,!0).border(1,!1);f=f.embed(0,g).embed({x:-g.width,y:0},g).embed({x:0,y:-g.height},g),f=f.rectSlice(1,h);const p=new qt(1).rect(0,1,!0).border(1,!1).border(1,!0),y=St.alignmentPatterns(c);for(const m of y)for(const C of y)f.data[m][C]===void 0&&f.embed({x:C-2,y:m-2},p);f=f.hLine({x:0,y:6},1/0,({x:m},C)=>C===void 0?m%2==0:C).vLine({x:6,y:0},1/0,({y:m},C)=>C===void 0?m%2==0:C);{const m=St.formatBits(l,u),C=v=>!d&&(m>>v&1)==1;for(let v=0;v<6;v++)f.data[v][8]=C(v);for(let v=6;v<8;v++)f.data[v+1][8]=C(v);for(let v=8;v<15;v++)f.data[h-15+v][8]=C(v);for(let v=0;v<8;v++)f.data[8][h-v-1]=C(v);for(let v=8;v<9;v++)f.data[8][15-v-1+1]=C(v);for(let v=9;v<15;v++)f.data[8][15-v-1]=C(v);f.data[h-8][8]=!d}if(c>=7){const m=St.versionBits(c);for(let C=0;C<18;C+=1){const v=!d&&(m>>C&1)==1,I=Math.floor(C/3),R=C%3+h-8-3;f.data[I][R]=v,f.data[R][I]=v}}return f}(t,e,r,i);let o=0;const a=8*n.length;if(function(c,l,u){const d=c.height,h=zu[l];let f=-1,g=d-1;for(let p=d-1;p>0;p-=2){for(p==6&&(p=5);;g+=f){for(let y=0;y<2;y+=1){const m=p-y;c.data[g][m]===void 0&&u(m,g,h(m,g))}if(g+f<0||g+f>=d)break}f=-f}}(s,r,(c,l,u)=>{let d=!1;o<a&&(d=(n[o>>>3]>>(7-o&7)&1)!=0,o++),s.data[l][c]=d!==u}),o!==a)throw new Error("QR: bytes left after draw");return s}function xS(t){const e=t.inverse(),n=f=>{let g=0;for(let p,y=0,m=1;y<f.length;y++)p===f[y]&&(m++,y!==f.length-1)||(m>=5&&(g+=m-5+3),p=f[y],m=1);return g};let r=0;t.data.forEach(f=>r+=n(f)),e.data.forEach(f=>r+=n(f));let i=0,s=t.data;const o=t.width-1,a=t.height-1;for(let f=0;f<o;f++)for(let g=0;g<a;g++){const p=f+1,y=g+1;s[f][g]===s[p][g]&&s[p][g]===s[f][y]&&s[p][g]===s[p][y]&&(i+=3)}const c=f=>{const g=[!0,!1,!0,!0,!0,!1,!0],p=[!1,!1,!1,!1],y=[...g,...p],m=[...p,...g];let C=0;for(let v=0;v<f.length;v++)Jp(f,y,v)&&(C+=40),Jp(f,m,v)&&(C+=40);return C};let l=0;for(const f of t.data)l+=c(f);for(const f of e.data)l+=c(f);let u=0;t.rectRead(0,1/0,(f,g)=>u+=g?1:0);const d=u/(t.height*t.width)*100,h=10*Math.floor(Math.abs(d-50)/5);return r+i+l+h}function yw(t,e="raw",n={}){const r=n.ecc!==void 0?n.ecc:"medium";(function(u){if(!Zp.includes(u))throw new Error(`Invalid error correction mode=${u}. Expected: ${Zp}`)})(r);const i=n.encoding!==void 0?n.encoding:function(u){let d="numeric";for(let h of u)if(!St.alphabet.numeric.has(h)&&(d="alphanumeric",!St.alphabet.alphanumerc.has(h)))return"byte";return d}(t);(function(u){if(!Xp.includes(u))throw new Error(`Encoding: invalid mode=${u}. Expected: ${Xp}`);if(u==="kanji"||u==="eci")throw new Error(`Encoding: ${u} is not supported (yet?).`)})(i),n.mask!==void 0&&function(u){if(![0,1,2,3,4,5,6,7].includes(u)||!zu[u])throw new Error(`Invalid mask=${u}. Expected number [0..7]`)}(n.mask);let s,o=n.version,a=new Error("Unknown error");if(o!==void 0)(function(u){if(!Number.isSafeInteger(u)||u<1||u>40)throw new Error(`Invalid version=${u}. Expected number [1..40]`)})(o),s=e0(o,r,t,i);else for(let u=1;u<=40;u++)try{s=e0(u,r,t,i),o=u;break}catch(d){a=d}if(!o||!s)throw a;let c=function(u,d,h,f){if(f===void 0){const g=function(){let p,y=1/0;return{add(m,C){m>=y||(p=C,y=m)},get:()=>p,score:()=>y}}();for(let p=0;p<zu.length;p++)g.add(xS(t0(u,d,h,p,!0)),p);f=g.get()}if(f===void 0)throw new Error("Cannot find mask");return t0(u,d,h,f)}(o,r,s,n.mask);c.assertDrawn();const l=n.border===void 0?2:n.border;if(!Number.isSafeInteger(l))throw new Error("Wrong border type="+typeof l);if(c=c.border(l,!1),n.scale!==void 0&&(c=c.scale(n.scale)),e==="raw")return c.data;if(e==="ascii")return c.toASCII();if(e==="svg")return c.toSVG();if(e==="gif")return c.toGIF();if(e==="term")return c.toTerm();throw new Error(`Unknown output: ${e}`)}const jl={DESKTOP:"Desktop",MOBILE:"Mobile",META_MASK_MOBILE_APP:"MetaMask mobile app",SCAN_TO_CONNECT:"Scan to connect and sign with",CONNECT_WITH_EXTENSION:"Connect With MetaMask Extension",INSTALL_MODAL:{TRUSTED_BY_USERS:"Trusted by over 30 million users to buy, store, send and swap crypto securely",LEADING_CRYPTO_WALLET:"The leading crypto wallet & gateway to blockchain apps built on Ethereum Mainnet, Polygon, Optimism, and many other networks",CONTROL_DIGITAL_INTERACTIONS:"Puts you in control of your digital interactions by making power of cryptography more accessible",INSTALL_META_MASK_EXTENSION:"Install MetaMask Extension"},PENDING_MODAL:{OPEN_META_MASK_SELECT_CODE:"Please open the MetaMask wallet app and select the code on the screen OR disconnect",OPEN_META_MASK_CONTINUE:"Open the MetaMask app to continue with your session.",NUMBER_AFTER_OPEN_NOTICE:"If a number doesn't appear after opening MetaMask, please click disconnect and re-scan the QRCode.",DISCONNECT:"Disconnect"},SELECT_MODAL:{CRYPTO_TAKE_CONTROL_TEXT:"Take control of your crypto and explore the blockchain with the wallet trusted by over 30 million people worldwide"},META_MASK_MODAL:{ADDRESS_COPIED:"Address copied to clipboard!",DISCONNECT:"Disconnect",ACTIVE_NETWORK:"Active Network"}};class nh{constructor(e){var n;this.translations=jl,this.supportedLocales=["es","fr","he","it","pt","tr"],this.baseUrl=(n=e?.baseUrl)!==null&&n!==void 0?n:"https://raw.githubusercontent.com/MetaMask/metamask-sdk/refs/heads/gh-pages/locales"}getBrowserLanguage(){if((navigator.languages||[navigator.language]).some(n=>n.toLowerCase().startsWith("en")))return"en";const e=navigator.language.toLowerCase().split("-")[0];return this.supportedLocales.includes(e)?e:"en"}async init(e){const n=this.getBrowserLanguage()||e.fallbackLng;await this.loadTranslations(n)}async loadTranslations(e){const n=e.split("-")[0];if(n!=="en"&&this.supportedLocales.includes(n))try{const r=`${this.baseUrl}/${n}.json`,i=await fetch(r);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);this.translations=await i.json()}catch(r){console.warn(`âŒ Failed to load ${n} translations, falling back to English:`,r),this.translations=jl}else this.translations=jl}t(e){return this.getNestedTranslation(e,this.translations)||e}getNestedTranslation(e,n){const r=e.split(".");let i=n;for(const s of r){if(typeof i!="object")return"";i=i[s]}return typeof i=="string"?i:""}}var Gs;(function(t){t.SDK_MODAL_VIEWED="sdk_modal_viewed",t.SDK_MODAL_BUTTON_CLICKED="sdk_modal_button_clicked",t.SDK_MODAL_TOGGLE_CHANGED="sdk_modal_toggle_changed"})(Gs||(Gs={}));const ww=class{constructor(t){Gd(this,t),this.close=Hr(this,"close"),this.startDesktopOnboarding=Hr(this,"startDesktopOnboarding"),this.trackAnalytics=Hr(this,"trackAnalytics"),this.link=void 0,this.sdkVersion=void 0,this.preferDesktop=void 0,this.tab=1,this.isDefaultTab=!0,this.translationsLoaded=!1,this.onClose=this.onClose.bind(this),this.onStartDesktopOnboardingHandler=this.onStartDesktopOnboardingHandler.bind(this),this.setTab=this.setTab.bind(this),this.render=this.render.bind(this),this.setTab(this.preferDesktop?1:2),this.i18nInstance=new nh}componentDidLoad(){this.trackAnalytics.emit({event:Gs.SDK_MODAL_VIEWED,params:{extensionInstalled:!1,tab:this.tab===1?"desktop":"mobile"}})}async connectedCallback(){await this.i18nInstance.init({fallbackLng:"en"}),this.translationsLoaded=!0}updatePreferDesktop(t){t?this.setTab(1):this.setTab(2)}onClose(t=!1){this.close.emit({shouldTerminate:t})}onStartDesktopOnboardingHandler(){this.trackAnalytics.emit({event:Gs.SDK_MODAL_BUTTON_CLICKED,params:{button_type:"install_extension",tab:"desktop"}}),this.startDesktopOnboarding.emit()}setTab(t,e=!1){e&&this.trackAnalytics.emit({event:Gs.SDK_MODAL_TOGGLE_CHANGED,params:{toggle:this.tab===1?"desktop_to_mobile":"mobile_to_desktop"}}),this.tab=t,this.isDefaultTab=!1}render(){if(!this.translationsLoaded)return null;const t=r=>this.i18nInstance.t(r),e=this.isDefaultTab?this.preferDesktop?1:2:this.tab,n=yw(this.link,"svg",{ecc:"medium",scale:2});return J(Zd,{className:"install-model"},J("div",{class:"backdrop",onClick:()=>this.onClose(!0)}),J("div",{class:"modal"},J("div",{class:"closeButtonContainer"},J("div",{class:"right"},J("span",{class:"closeButton",onClick:()=>this.onClose(!0)},J(eh,null)))),J("div",{class:"logoContainer"},J(th,null)),J("div",null,J("div",{class:"tabcontainer"},J("div",{class:"flexContainer"},J("div",{onClick:()=>this.setTab(1,!0),class:"tab flexItem "+(e===1?"tabactive":"")},t("DESKTOP")),J("div",{onClick:()=>this.setTab(2,!0),class:"tab flexItem "+(e===2?"tabactive":"")},t("MOBILE")))),J("div",{style:{display:e===1?"none":"block"}},J("div",{class:"flexContainer"},J("div",{class:"flexItem",style:{textAlign:"center",marginTop:"4"}},n&&J("div",{id:"sdk-mm-qrcode",class:"center",innerHTML:n}),J("div",{class:"connectMobileText"},t("SCAN_TO_CONNECT")," ",J("br",null),J("span",{class:"blue"},J("b",null,t("META_MASK_MOBILE_APP"))))))),J("div",{style:{display:e===2?"none":"block"}},J("div",{class:"item"},J($l,{Icon:vS,text:t("INSTALL_MODAL.TRUSTED_BY_USERS")})),J("div",{class:"item"},J($l,{Icon:wS,text:t("INSTALL_MODAL.LEADING_CRYPTO_WALLET")})),J("div",{class:"item"},J($l,{Icon:bS,text:t("INSTALL_MODAL.CONTROL_DIGITAL_INTERACTIONS")})),J("button",{class:"button",onClick:()=>this.onStartDesktopOnboardingHandler()},J(ES,null),J("span",{class:"installExtensionText"},t("INSTALL_MODAL.INSTALL_META_MASK_EXTENSION"))))),J(Xd,{version:this.sdkVersion})))}get el(){return Ic(this)}static get watchers(){return{preferDesktop:["updatePreferDesktop"]}}};ww.style=`.flexContainer {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: row;
}

.flexItem {
    flex: 1;
    justify-content: center;
    align-items: center;
}

.flexItem11 {
    flex: 11;
    justify-content: center;
    align-items: center;
}

.flexItem1 {
    flex: 1;
    justify-content: center;
    align-items: center;
}

.tab {
    padding: 8px;
    cursor: pointer;
    background-color: #F2F4F6;
    font-size: 12px;
    text-align: center;
    color: #24292E;
}

.tabcontainer {
    padding: 4px;
    background-color: #F2F4F6;
    border-radius: 8px;
    margin-bottom: 30px;
    margin-top: 30px;
}

.tabactive {
    background-color: white;
    -webkit-transition: background-color 300ms linear;
    -ms-transition: background-color 300ms linear;
    transition: background-color 300ms linear;
    border-radius: 8px;
}

.item {
    font-size: 12px;
    margin-bottom: 16px;
    border-radius: 8px;
    padding: 10px;
    border: 2px #F2F4F6 solid;
    color: #24292E;
}

.extensionLabel {
    font-style: normal;
    font-weight: bold;
    font-size: 14px;
    text-align: cetner;
    color: #24272A;
}

.notice {
    font-size: 12px;
    margin-left: 10px;
    margin-right: 10px;
    color: grey;
}

.button {
    margin-top: 41.5px;
    margin-bottom: 20px;
    width: 100%;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    padding: 12px 20px;
    background: #037DD6;
    border-radius: 32px;
    color: white;
    border: 0;
    font-size: 14px;
    cursor: pointer;
}

.backdrop {
    visibility: visible;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    z-index: 99998;
    background: rgba(0, 0, 0, 0.87);
    opacity: 0.3;
}

.modal {
    visibility: visible;
    position: fixed;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 99999;
    background: white;
    padding: 20px;
    border-radius: 8px;
    top: 50%;
    max-width: 100%;
    width: 460px;
    min-width: 300px;
    box-shadow: rgba(0, 0, 0, 0.2) 0px 11px 15px -7px, rgba(0, 0, 0, 0.14) 0px 24px 38px 3px, rgba(0, 0, 0, 0.12) 0px 9px 46px 8px;
    -webkit-font-smoothing: antialiased;
}

.closeButton {
    color: #BBC0C5;
    cursor: pointer;
}

.logoContainer {
    margin-left: 24px;
    margin-right: 24px;
    margin-top: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.connectMobileText {
    font-size: 14px;
    color: black;
    margin-top: 28px;
    margin-bottom: 28px;
    line-height: 2;
}

.blue {
    color: #037DD6;
    font-weight: 700;
}

.installExtensionText {
    margin-left: 10px;
}

.center {
    display: flex;
    justify-content: center;
    align-items: center;
}

.right {
    display: flex;
    align-items: center;
    justify-content: right;
}

#sdk-mm-qrcode {
    svg {
        width: 50%;
    }
}`;const vw=class{constructor(t){Gd(this,t),this.close=Hr(this,"close"),this.disconnect=Hr(this,"disconnect"),this.updateOTPValue=Hr(this,"updateOTPValue"),this.displayOTP=void 0,this.sdkVersion=void 0,this.otpCode=void 0,this.translationsLoaded=!1,this.i18nInstance=new nh}async connectedCallback(){await this.i18nInstance.init({fallbackLng:"en"}),this.translationsLoaded=!0}onClose(){this.close.emit()}onDisconnect(){this.disconnect.emit()}onUpdateOTPValueHandler(t){this.updateOTPValue.emit({otpValue:t})}disconnectedCallback(){this.onClose()}render(){var t;if(!this.translationsLoaded)return null;const e=(t=this.displayOTP)===null||t===void 0||t,n=this.sdkVersion,r=i=>this.i18nInstance.t(i);return J(Zd,{className:"pending-modal"},J("div",{class:"backdrop",onClick:()=>this.onClose()}),J("div",{class:"modal"},J("div",{class:"closeButtonContainer"},J("div",{class:"right"},J("span",{class:"closeButton",onClick:()=>this.onClose()},J(eh,null)))),J("div",{class:"logoContainer"},J(th,null)),J("div",null,J("div",{class:"flexContainer",style:{flexDirection:"column",color:"black"}},J("div",{class:"flexItem",style:{textAlign:"center",marginTop:"30px",marginBottom:"30px",fontSize:"16px"}},r(e?"PENDING_MODAL.OPEN_META_MASK_SELECT_CODE":"PENDING_MODAL.OPEN_META_MASK_CONTINUE")),J("div",{id:"sdk-mm-otp-value",style:{padding:"10px",fontSize:"32px",display:this.otpCode?"block":"none"}},this.otpCode),e&&J("div",{class:"notice"},"* ",r("PENDING_MODAL.NUMBER_AFTER_OPEN_NOTICE"))),J("div",{style:{marginTop:"20px"}},J("button",{class:"button blue",style:{marginTop:"5px",color:"#0376C9",borderColor:"#0376C9",borderWidth:"1px",borderStyle:"solid",backgroundColor:"white"},onClick:()=>this.onDisconnect()},r("PENDING_MODAL.DISCONNECT")))),J(Xd,{version:n})))}get el(){return Ic(this)}};vw.style=`.flexContainer {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: row;
}

.flexItem {
    flex: 1;
    justify-content: center;
    align-items: center;
}

.flexItem11 {
    flex: 11;
    justify-content: center;
    align-items: center;
}

.flexItem1 {
    flex: 1;
    justify-content: center;
    align-items: center;
}

.tab {
    padding: 8px;
    cursor: pointer;
    background-color: #F2F4F6;
    font-size: 12px;
    text-align: center;
    color: #24292E;
}

.tabcontainer {
    padding: 4px;
    background-color: #F2F4F6;
    border-radius: 8px;
    margin-bottom: 30px;
    margin-top: 30px;
}

.tabactive {
    background-color: white;
    -webkit-transition: background-color 300ms linear;
    -ms-transition: background-color 300ms linear;
    transition: background-color 300ms linear;
    border-radius: 8px;
}

.item {
    font-size: 12px;
    margin-bottom: 16px;
    border-radius: 8px;
    padding: 10px;
    border: 2px #F2F4F6 solid;
    color: #24292E;
}

.extensionLabel {
    font-style: normal;
    font-weight: bold;
    font-size: 14px;
    text-align: cetner;
    color: #24272A;
}

.notice {
    font-size: 12px;
    margin-left: 10px;
    margin-right: 10px;
    color: grey;
}

.button {
    margin-top: 41.5px;
    margin-bottom: 20px;
    width: 100%;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    padding: 12px 20px;
    background: #037DD6;
    border-radius: 32px;
    color: white;
    border: 0;
    font-size: 14px;
    cursor: pointer;
}

.backdrop {
    visibility: visible;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    z-index: 99998;
    background: rgba(0, 0, 0, 0.87);
    opacity: 0.3;
}

.modal {
    visibility: visible;
    position: fixed;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 99999;
    background: white;
    padding: 20px;
    border-radius: 8px;
    top: 50%;
    max-width: 100%;
    width: 460px;
    min-width: 300px;
    box-shadow: rgba(0, 0, 0, 0.2) 0px 11px 15px -7px, rgba(0, 0, 0, 0.14) 0px 24px 38px 3px, rgba(0, 0, 0, 0.12) 0px 9px 46px 8px;
    -webkit-font-smoothing: antialiased;
}

.closeButton {
    color: #BBC0C5;
    cursor: pointer;
}

.logoContainer {
    margin-left: 24px;
    margin-right: 24px;
    margin-top: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.connectMobileText {
    font-size: 14px;
    color: black;
    margin-top: 28px;
    margin-bottom: 28px;
    line-height: 2;
}

.blue {
    color: #037DD6;
    font-weight: 700;
}

.installExtensionText {
    margin-left: 10px;
}

.center {
    display: flex;
    justify-content: center;
    align-items: center;
}

.right {
    display: flex;
    align-items: center;
    justify-content: right;
}

#sdk-mm-qrcode {
    svg {
        width: 50%;
    }
}`;const kS=()=>J("svg",{width:"21",height:"15",viewBox:"0 0 21 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},J("path",{d:"M14.1364 14.9851C13.5909 14.9851 13.2273 14.5851 13.2273 13.9851C13.2273 13.3851 13.5909 12.9851 14.1364 12.9851C16.6818 12.9851 18.6818 10.7851 18.6818 7.98508C18.6818 5.18508 16.6818 2.98508 14.1364 2.98508C11.5909 2.98508 9.59091 5.18508 9.59091 7.98508C9.59091 8.58508 9.22727 8.98508 8.68182 8.98508C8.13636 8.98508 7.77273 8.58508 7.77273 7.98508C7.77273 4.08508 10.5909 0.985077 14.1364 0.985077C17.6818 0.985077 20.5 4.08508 20.5 7.98508C20.5 11.8851 17.6818 14.9851 14.1364 14.9851ZM6.68182 14.7851C3.22727 14.7851 0.5 11.6851 0.5 7.98508C0.5 4.28508 3.22727 1.18508 6.68182 1.18508C7.22727 1.18508 7.59091 1.58508 7.59091 2.18508C7.59091 2.78508 7.22727 3.18508 6.68182 3.18508C4.22727 3.18508 2.31818 5.38508 2.31818 7.98508C2.31818 10.5851 4.22727 12.7851 6.68182 12.7851C9.13636 12.7851 11.0455 10.6851 11.0455 7.98508C11.0455 7.38508 11.4091 6.98508 11.9545 6.98508C12.5 6.98508 12.8636 7.38508 12.8636 7.98508C12.7727 11.6851 10.0455 14.7851 6.68182 14.7851Z",fill:"white"})),PS=()=>J("svg",{width:"400",height:"300",viewBox:"0 0 400 300",fill:"none",xmlns:"http://www.w3.org/2000/svg"},J("rect",{width:"400",height:"300",fill:"white"}),J("path",{d:"M300.116 242.46L250.485 227.681L213.057 250.055L186.944 250.045L149.493 227.681L99.8843 242.46L84.7939 191.518L99.8843 134.979L84.7939 87.1777L99.8843 27.9336L177.402 74.2466H222.598L300.116 27.9336L315.206 87.1777L300.116 134.979L315.206 191.518L300.116 242.46Z",fill:"#FF5C16"}),J("path",{d:"M99.8955 27.9336L177.414 74.2792L174.331 106.085L99.8955 27.9336Z",fill:"#FF5C16"}),J("path",{d:"M149.505 191.539L183.612 217.521L149.505 227.681V191.539Z",fill:"#FF5C16"}),J("path",{d:"M180.886 148.585L174.33 106.107L132.369 134.991L132.348 134.98V135.001L132.477 164.732L149.493 148.585H149.504H180.886Z",fill:"#FF5C16"}),J("path",{d:"M300.116 27.9336L222.598 74.2792L225.67 106.085L300.116 27.9336Z",fill:"#FF5C16"}),J("path",{d:"M250.508 191.539L216.4 217.521L250.508 227.681V191.539Z",fill:"#FF5C16"}),J("path",{d:"M267.652 135.001H267.663H267.652V134.98L267.641 134.991L225.68 106.107L219.125 148.585H250.507L267.533 164.732L267.652 135.001Z",fill:"#FF5C16"}),J("path",{d:"M149.493 227.681L99.8843 242.46L84.7939 191.54H149.493V227.681Z",fill:"#E34807"}),J("path",{d:"M180.875 148.574L190.351 209.98L177.219 175.838L132.456 164.732L149.483 148.574H180.864H180.875Z",fill:"#E34807"}),J("path",{d:"M250.507 227.681L300.116 242.46L315.206 191.54H250.507V227.681Z",fill:"#E34807"}),J("path",{d:"M219.126 148.574L209.649 209.98L222.782 175.838L267.545 164.732L250.507 148.574H219.126Z",fill:"#E34807"}),J("path",{d:"M84.7939 191.517L99.8843 134.979H132.337L132.456 164.721L177.219 175.826L190.351 209.969L183.601 217.488L149.493 191.506H84.7939V191.517Z",fill:"#FF8D5D"}),J("path",{d:"M315.206 191.517L300.116 134.979H267.664L267.545 164.721L222.782 175.826L209.649 209.969L216.4 217.488L250.507 191.506H315.206V191.517Z",fill:"#FF8D5D"}),J("path",{d:"M222.598 74.2466H200H177.402L174.33 106.053L190.351 209.936H209.649L225.681 106.053L222.598 74.2466Z",fill:"#FF8D5D"}),J("path",{d:"M99.8843 27.9336L84.7939 87.1777L99.8843 134.979H132.337L174.319 106.085L99.8843 27.9336Z",fill:"#661800"}),J("path",{d:"M171.496 160.906H156.795L148.79 168.752L177.229 175.804L171.496 160.896V160.906Z",fill:"#661800"}),J("path",{d:"M300.116 27.9336L315.206 87.1777L300.116 134.979H267.663L225.681 106.085L300.116 27.9336Z",fill:"#661800"}),J("path",{d:"M228.525 160.906H243.248L251.253 168.763L222.781 175.826L228.525 160.896V160.906Z",fill:"#661800"}),J("path",{d:"M213.046 229.789L216.399 217.51L209.649 209.991H190.34L183.59 217.51L186.943 229.789",fill:"#661800"}),J("path",{d:"M213.047 229.789V250.066H186.944V229.789H213.047Z",fill:"#C0C4CD"}),J("path",{d:"M149.504 227.66L186.965 250.056V229.779L183.611 217.5L149.504 227.66Z",fill:"#E7EBF6"}),J("path",{d:"M250.506 227.66L213.045 250.056V229.779L216.398 217.5L250.506 227.66Z",fill:"#E7EBF6"})),bw=class{constructor(t){Gd(this,t),this.close=Hr(this,"close"),this.connectWithExtension=Hr(this,"connectWithExtension"),this.link=void 0,this.sdkVersion=void 0,this.preferDesktop=void 0,this.tab=1,this.isDefaultTab=!0,this.translationsLoaded=!1,this.i18nInstance=new nh,this.setTab(this.preferDesktop?1:2)}async connectedCallback(){await this.i18nInstance.init({fallbackLng:"en"}),this.translationsLoaded=!0}onClose(t=!1){this.close.emit({shouldTerminate:t})}connectWithExtensionHandler(){this.connectWithExtension.emit()}setTab(t){this.tab=t,this.isDefaultTab=!1}disconnectedCallback(){this.onClose()}updatePreferDesktop(t){t?this.setTab(1):this.setTab(2)}render(){if(!this.translationsLoaded)return null;const t=i=>this.i18nInstance.t(i),e=this.sdkVersion,n=this.isDefaultTab?this.preferDesktop?1:2:this.tab,r=yw(this.link,"svg",{ecc:"medium",scale:2});return J(Zd,{className:"select-modal"},J("div",{class:"backdrop",onClick:()=>this.onClose(!0)}),J("div",{class:"modal"},J("div",{class:"closeButtonContainer"},J("div",{class:"right"},J("span",{class:"closeButton",onClick:()=>this.onClose(!0)},J(eh,null)))),J("div",{class:"logoContainer"},J(th,null)),J("div",null,J("div",{class:"tabcontainer"},J("div",{class:"flexContainer"},J("div",{onClick:()=>this.setTab(1),class:"tab flexItem "+(n===1?"tabactive":"")},t("DESKTOP")),J("div",{onClick:()=>this.setTab(2),class:"tab flexItem "+(n===2?"tabactive":"")},t("MOBILE")))),J("div",{style:{display:n===1?"none":"block"}},J("div",{class:"flexContainer"},J("div",{class:"flexItem",style:{textAlign:"center",marginTop:"4"}},J("div",{class:"center",id:"sdk-mm-qrcode",innerHTML:r}),J("div",{class:"connectMobileText"},t("SCAN_TO_CONNECT"),J("br",null),J("span",{class:"blue"},J("b",null,t("META_MASK_MOBILE_APP"))))))),J("div",{style:{display:n===2?"none":"block"}},J("div",{style:{display:"flex",justifyContent:"center",height:"300",marginTop:"-20"}},J(PS,null)),J("div",{class:"extensionLabel"},t("SELECT_MODAL.CRYPTO_TAKE_CONTROL_TEXT")),J("button",{class:"button",onClick:()=>this.connectWithExtensionHandler()},J(kS,null),J("span",{class:"installExtensionText"},t("CONNECT_WITH_EXTENSION"))))),J(Xd,{version:e})))}get el(){return Ic(this)}static get watchers(){return{preferDesktop:["updatePreferDesktop"]}}};bw.style=`.flexContainer {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: row;
}

.flexItem {
    flex: 1;
    justify-content: center;
    align-items: center;
}

.flexItem11 {
    flex: 11;
    justify-content: center;
    align-items: center;
}

.flexItem1 {
    flex: 1;
    justify-content: center;
    align-items: center;
}

.tab {
    padding: 8px;
    cursor: pointer;
    background-color: #F2F4F6;
    font-size: 12px;
    text-align: center;
    color: #24292E;
}

.tabcontainer {
    padding: 4px;
    background-color: #F2F4F6;
    border-radius: 8px;
    margin-bottom: 30px;
    margin-top: 30px;
}

.tabactive {
    background-color: white;
    -webkit-transition: background-color 300ms linear;
    -ms-transition: background-color 300ms linear;
    transition: background-color 300ms linear;
    border-radius: 8px;
}

.item {
    font-size: 12px;
    margin-bottom: 16px;
    border-radius: 8px;
    padding: 10px;
    border: 2px #F2F4F6 solid;
    color: #24292E;
}

.extensionLabel {
    font-style: normal;
    font-weight: bold;
    font-size: 14px;
    text-align: cetner;
    color: #24272A;
}

.notice {
    font-size: 12px;
    margin-left: 10px;
    margin-right: 10px;
    color: grey;
}

.button {
    margin-top: 41.5px;
    margin-bottom: 20px;
    width: 100%;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    padding: 12px 20px;
    background: #037DD6;
    border-radius: 32px;
    color: white;
    border: 0;
    font-size: 14px;
    cursor: pointer;
}

.backdrop {
    visibility: visible;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    z-index: 99998;
    background: rgba(0, 0, 0, 0.87);
    opacity: 0.3;
}

.modal {
    visibility: visible;
    position: fixed;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 99999;
    background: white;
    padding: 20px;
    border-radius: 8px;
    top: 50%;
    max-width: 100%;
    width: 460px;
    min-width: 300px;
    box-shadow: rgba(0, 0, 0, 0.2) 0px 11px 15px -7px, rgba(0, 0, 0, 0.14) 0px 24px 38px 3px, rgba(0, 0, 0, 0.12) 0px 9px 46px 8px;
    -webkit-font-smoothing: antialiased;
}

.closeButton {
    color: #BBC0C5;
    cursor: pointer;
}

.logoContainer {
    margin-left: 24px;
    margin-right: 24px;
    margin-top: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.connectMobileText {
    font-size: 14px;
    color: black;
    margin-top: 28px;
    margin-bottom: 28px;
    line-height: 2;
}

.blue {
    color: #037DD6;
    font-weight: 700;
}

.installExtensionText {
    margin-left: 10px;
}

.center {
    display: flex;
    justify-content: center;
    align-items: center;
}

.right {
    display: flex;
    align-items: center;
    justify-content: right;
}

#sdk-mm-qrcode {
    svg {
        width: 50%;
    }
}`;var TS=Object.freeze({__proto__:null,mm_install_modal:ww,mm_pending_modal:vw,mm_select_modal:bw});const IS="6.15.0";function OS(t,e,n){const r=e.split("|").map(s=>s.trim());for(let s=0;s<r.length;s++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const i=new Error(`invalid value for type ${e}`);throw i.code="INVALID_ARGUMENT",i.argument=`value.${n}`,i.value=t,i}async function _t(t){const e=Object.keys(t);return(await Promise.all(e.map(r=>Promise.resolve(t[r])))).reduce((r,i,s)=>(r[e[s]]=i,r),{})}function ve(t,e,n){for(let r in e){let i=e[r];const s=n?n[r]:null;s&&OS(i,s,r),Object.defineProperty(t,r,{enumerable:!0,value:i,writable:!1})}}function Gi(t,e){if(t==null)return"null";if(e==null&&(e=new Set),typeof t=="object"){if(e.has(t))return"[Circular]";e.add(t)}if(Array.isArray(t))return"[ "+t.map(n=>Gi(n,e)).join(", ")+" ]";if(t instanceof Uint8Array){const n="0123456789abcdef";let r="0x";for(let i=0;i<t.length;i++)r+=n[t[i]>>4],r+=n[t[i]&15];return r}if(typeof t=="object"&&typeof t.toJSON=="function")return Gi(t.toJSON(),e);switch(typeof t){case"boolean":case"number":case"symbol":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const n=Object.keys(t);return n.sort(),"{ "+n.map(r=>`${Gi(r,e)}: ${Gi(t[r],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function yt(t,e){return t&&t.code===e}function rh(t){return yt(t,"CALL_EXCEPTION")}function $e(t,e,n){let r=t;{const s=[];if(n){if("message"in n||"code"in n||"name"in n)throw new Error(`value will overwrite populated values: ${Gi(n)}`);for(const o in n){if(o==="shortMessage")continue;const a=n[o];s.push(o+"="+Gi(a))}}s.push(`code=${e}`),s.push(`version=${IS}`),s.length&&(t+=" ("+s.join(", ")+")")}let i;switch(e){case"INVALID_ARGUMENT":i=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":i=new RangeError(t);break;default:i=new Error(t)}return ve(i,{code:e}),n&&Object.assign(i,n),i.shortMessage==null&&ve(i,{shortMessage:r}),i}function te(t,e,n,r){if(!t)throw $e(e,n,r)}function G(t,e,n,r){te(t,e,"INVALID_ARGUMENT",{argument:n,value:r})}function Ew(t,e,n){n==null&&(n=""),n&&(n=": "+n),te(t>=e,"missing argument"+n,"MISSING_ARGUMENT",{count:t,expectedCount:e}),te(t<=e,"too many arguments"+n,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((t,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"Ã©".normalize("NFD")!=="eÌ")throw new Error("broken");t.push(e)}catch{}return t},[]);function Co(t,e,n){if(n==null&&(n=""),t!==e){let r=n,i="new";n&&(r+=".",i+=" "+n),te(!1,`private constructor; use ${r}from* methods`,"UNSUPPORTED_OPERATION",{operation:i})}}function Aw(t,e,n){if(t instanceof Uint8Array)return n?new Uint8Array(t):t;if(typeof t=="string"&&t.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const r=new Uint8Array((t.length-2)/2);let i=2;for(let s=0;s<r.length;s++)r[s]=parseInt(t.substring(i,i+2),16),i+=2;return r}G(!1,"invalid BytesLike value",e||"value",t)}function ke(t,e){return Aw(t,e,!1)}function Pt(t,e){return Aw(t,e,!0)}function Ke(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&t.length!==2+2*e||e===!0&&t.length%2!==0)}function ih(t){return Ke(t,!0)||t instanceof Uint8Array}const n0="0123456789abcdef";function ce(t){const e=ke(t);let n="0x";for(let r=0;r<e.length;r++){const i=e[r];n+=n0[(i&240)>>4]+n0[i&15]}return n}function Ye(t){return"0x"+t.map(e=>ce(e).substring(2)).join("")}function Xi(t){return Ke(t,!0)?(t.length-2)/2:ke(t).length}function qe(t,e,n){const r=ke(t);return n!=null&&n>r.length&&te(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n}),ce(r.slice(e??0,n??r.length))}function Sw(t,e,n){const r=ke(t);te(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const i=new Uint8Array(e);return i.fill(0),n?i.set(r,e-r.length):i.set(r,0),ce(i)}function cr(t,e){return Sw(t,e,!0)}function RS(t,e){return Sw(t,e,!1)}const Oc=BigInt(0),bn=BigInt(1),Vi=9007199254740991;function lc(t,e){const n=Rc(t,"value"),r=BigInt(_e(e,"width"));if(te(n>>r===Oc,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),n>>r-bn){const i=(bn<<r)-bn;return-((~n&i)+bn)}return n}function Cw(t,e){let n=he(t,"value");const r=BigInt(_e(e,"width")),i=bn<<r-bn;if(n<Oc){n=-n,te(n<=i,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});const s=(bn<<r)-bn;return(~n&s)+bn}else te(n<i,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});return n}function ci(t,e){const n=Rc(t,"value"),r=BigInt(_e(e,"bits"));return n&(bn<<r)-bn}function he(t,e){switch(typeof t){case"bigint":return t;case"number":return G(Number.isInteger(t),"underflow",e||"value",t),G(t>=-Vi&&t<=Vi,"overflow",e||"value",t),BigInt(t);case"string":try{if(t==="")throw new Error("empty string");return t[0]==="-"&&t[1]!=="-"?-BigInt(t.substring(1)):BigInt(t)}catch(n){G(!1,`invalid BigNumberish string: ${n.message}`,e||"value",t)}}G(!1,"invalid BigNumberish value",e||"value",t)}function Rc(t,e){const n=he(t,e);return te(n>=Oc,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),n}const r0="0123456789abcdef";function Nc(t){if(t instanceof Uint8Array){let e="0x0";for(const n of t)e+=r0[n>>4],e+=r0[n&15];return BigInt(e)}return he(t)}function _e(t,e){switch(typeof t){case"bigint":return G(t>=-Vi&&t<=Vi,"overflow",e||"value",t),Number(t);case"number":return G(Number.isInteger(t),"underflow",e||"value",t),G(t>=-Vi&&t<=Vi,"overflow",e||"value",t),t;case"string":try{if(t==="")throw new Error("empty string");return _e(BigInt(t),e)}catch(n){G(!1,`invalid numeric string: ${n.message}`,e||"value",t)}}G(!1,"invalid numeric value",e||"value",t)}function NS(t){return _e(Nc(t))}function Gr(t,e){let r=Rc(t,"value").toString(16);if(e==null)r.length%2&&(r="0"+r);else{const i=_e(e,"width");for(te(i*2>=r.length,`value exceeds width (${i} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});r.length<i*2;)r="0"+r}return"0x"+r}function it(t){const e=Rc(t,"value");if(e===Oc)return new Uint8Array([]);let n=e.toString(16);n.length%2&&(n="0"+n);const r=new Uint8Array(n.length/2);for(let i=0;i<r.length;i++){const s=i*2;r[i]=parseInt(n.substring(s,s+2),16)}return r}function wn(t){let e=ce(ih(t)?t:it(t)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const i0="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const s0=BigInt(58);function MS(t){const e=ke(t);let n=Nc(e),r="";for(;n;)r=i0[Number(n%s0)]+r,n/=s0;for(let i=0;i<e.length&&!e[i];i++)r=i0[0]+r;return r}function BS(t){t=atob(t);const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return ke(e)}function LS(t){const e=ke(t);let n="";for(let r=0;r<e.length;r++)n+=String.fromCharCode(e[r]);return btoa(n)}class _w{filter;emitter;#e;constructor(e,n,r){this.#e=n,ve(this,{emitter:e,filter:r})}async removeListener(){this.#e!=null&&await this.emitter.off(this.filter,this.#e)}}function DS(t,e,n,r,i){G(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",n)}function xw(t,e,n,r,i){if(t==="BAD_PREFIX"||t==="UNEXPECTED_CONTINUE"){let s=0;for(let o=e+1;o<n.length&&n[o]>>6===2;o++)s++;return s}return t==="OVERRUN"?n.length-e-1:0}function US(t,e,n,r,i){return t==="OVERLONG"?(G(typeof i=="number","invalid bad code point for replacement","badCodepoint",i),r.push(i),0):(r.push(65533),xw(t,e,n))}const FS=Object.freeze({error:DS,ignore:xw,replace:US});function HS(t,e){e==null&&(e=FS.error);const n=ke(t,"bytes"),r=[];let i=0;for(;i<n.length;){const s=n[i++];if(s>>7===0){r.push(s);continue}let o=null,a=null;if((s&224)===192)o=1,a=127;else if((s&240)===224)o=2,a=2047;else if((s&248)===240)o=3,a=65535;else{(s&192)===128?i+=e("UNEXPECTED_CONTINUE",i-1,n,r):i+=e("BAD_PREFIX",i-1,n,r);continue}if(i-1+o>=n.length){i+=e("OVERRUN",i-1,n,r);continue}let c=s&(1<<8-o-1)-1;for(let l=0;l<o;l++){let u=n[i];if((u&192)!=128){i+=e("MISSING_CONTINUE",i,n,r),c=null;break}c=c<<6|u&63,i++}if(c!==null){if(c>1114111){i+=e("OUT_OF_RANGE",i-1-o,n,r,c);continue}if(c>=55296&&c<=57343){i+=e("UTF16_SURROGATE",i-1-o,n,r,c);continue}if(c<=a){i+=e("OVERLONG",i-1-o,n,r,c);continue}r.push(c)}}return r}function sr(t,e){G(typeof t=="string","invalid string value","str",t);let n=[];for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);if(i<128)n.push(i);else if(i<2048)n.push(i>>6|192),n.push(i&63|128);else if((i&64512)==55296){r++;const s=t.charCodeAt(r);G(r<t.length&&(s&64512)===56320,"invalid surrogate pair","str",t);const o=65536+((i&1023)<<10)+(s&1023);n.push(o>>18|240),n.push(o>>12&63|128),n.push(o>>6&63|128),n.push(o&63|128)}else n.push(i>>12|224),n.push(i>>6&63|128),n.push(i&63|128)}return new Uint8Array(n)}function KS(t){return t.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function uc(t,e){return KS(HS(t,e))}function kw(t){async function e(n,r){te(r==null||!r.cancelled,"request cancelled before sending","CANCELLED");const i=n.url.split(":")[0].toLowerCase();te(i==="http"||i==="https",`unsupported protocol ${i}`,"UNSUPPORTED_OPERATION",{info:{protocol:i},operation:"request"}),te(i==="https"||!n.credentials||n.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let s=null;const o=new AbortController,a=setTimeout(()=>{s=$e("request timeout","TIMEOUT"),o.abort()},n.timeout);r&&r.addListener(()=>{s=$e("request cancelled","CANCELLED"),o.abort()});const c=Object.assign({},t,{method:n.method,headers:new Headers(Array.from(n)),body:n.body||void 0,signal:o.signal});let l;try{l=await fetch(n.url,c)}catch(f){throw clearTimeout(a),s||f}clearTimeout(a);const u={};l.headers.forEach((f,g)=>{u[g.toLowerCase()]=f});const d=await l.arrayBuffer(),h=d==null?null:new Uint8Array(d);return{statusCode:l.status,statusMessage:l.statusText,headers:u,body:h}}return e}const $S=12,jS=250;let o0=kw();const zS=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),GS=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let zl=!1;async function Pw(t,e){try{const n=t.match(zS);if(!n)throw new Error("invalid data");return new Kr(200,"OK",{"content-type":n[1]||"text/plain"},n[2]?BS(n[3]):qS(n[3]))}catch{return new Kr(599,"BAD REQUEST (invalid data: URI)",{},null,new lr(t))}}function Tw(t){async function e(n,r){try{const i=n.match(GS);if(!i)throw new Error("invalid link");return new lr(`${t}${i[2]}`)}catch{return new Kr(599,"BAD REQUEST (invalid IPFS URI)",{},null,new lr(n))}}return e}const sa={data:Pw,ipfs:Tw("https://gateway.ipfs.io/ipfs/")},Iw=new WeakMap;class VS{#e;#t;constructor(e){this.#e=[],this.#t=!1,Iw.set(e,()=>{if(!this.#t){this.#t=!0;for(const n of this.#e)setTimeout(()=>{n()},0);this.#e=[]}})}addListener(e){te(!this.#t,"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),this.#e.push(e)}get cancelled(){return this.#t}checkSignal(){te(!this.cancelled,"cancelled","CANCELLED",{})}}function oa(t){if(t==null)throw new Error("missing signal; should not happen");return t.checkSignal(),t}class lr{#e;#t;#n;#r;#i;#o;#s;#a;#d;#l;#p;#g;#c;#u;#h;get url(){return this.#o}set url(e){this.#o=String(e)}get body(){return this.#s==null?null:new Uint8Array(this.#s)}set body(e){if(e==null)this.#s=void 0,this.#a=void 0;else if(typeof e=="string")this.#s=sr(e),this.#a="text/plain";else if(e instanceof Uint8Array)this.#s=e,this.#a="application/octet-stream";else if(typeof e=="object")this.#s=sr(JSON.stringify(e)),this.#a="application/json";else throw new Error("invalid body")}hasBody(){return this.#s!=null}get method(){return this.#r?this.#r:this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),this.#r=String(e).toUpperCase()}get headers(){const e=Object.assign({},this.#n);return this.#d&&(e.authorization=`Basic ${LS(sr(this.#d))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&this.#a&&(e["content-type"]=this.#a),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,n){this.#n[String(e).toLowerCase()]=String(n)}clearHeaders(){this.#n={}}[Symbol.iterator](){const e=this.headers,n=Object.keys(e);let r=0;return{next:()=>{if(r<n.length){const i=n[r++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return this.#d||null}setCredentials(e,n){G(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),this.#d=`${e}:${n}`}get allowGzip(){return this.#t}set allowGzip(e){this.#t=!!e}get allowInsecureAuthentication(){return!!this.#e}set allowInsecureAuthentication(e){this.#e=!!e}get timeout(){return this.#i}set timeout(e){G(e>=0,"timeout must be non-zero","timeout",e),this.#i=e}get preflightFunc(){return this.#l||null}set preflightFunc(e){this.#l=e}get processFunc(){return this.#p||null}set processFunc(e){this.#p=e}get retryFunc(){return this.#g||null}set retryFunc(e){this.#g=e}get getUrlFunc(){return this.#h||o0}set getUrlFunc(e){this.#h=e}constructor(e){this.#o=String(e),this.#e=!1,this.#t=!0,this.#n={},this.#r="",this.#i=3e5,this.#u={slotInterval:jS,maxAttempts:$S},this.#h=null}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${this.#s?ce(this.#s):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(this.#u.slotInterval=e.slotInterval),e.maxAttempts!=null&&(this.#u.maxAttempts=e.maxAttempts)}async#f(e,n,r,i,s){if(e>=this.#u.maxAttempts)return s.makeServerError("exceeded maximum retry limit");te(a0()<=n,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:i}),r>0&&await WS(r);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in sa){const u=await sa[a](o.url,oa(i.#c));if(u instanceof Kr){let d=u;if(this.processFunc){oa(i.#c);try{d=await this.processFunc(o,d)}catch(h){(h.throttle==null||typeof h.stall!="number")&&d.makeServerError("error in post-processing function",h).assertOk()}}return d}o=u}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,oa(i.#c));let l=new Kr(c.statusCode,c.statusMessage,c.headers,c.body,i);if(l.statusCode===301||l.statusCode===302){try{const u=l.headers.location||"";return o.redirect(u).#f(e+1,n,0,i,l)}catch{}return l}else if(l.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,l,e))){const u=l.headers["retry-after"];let d=this.#u.slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof u=="string"&&u.match(/^[1-9][0-9]*$/)&&(d=parseInt(u)),o.clone().#f(e+1,n,d,i,l)}if(this.processFunc){oa(i.#c);try{l=await this.processFunc(o,l)}catch(u){(u.throttle==null||typeof u.stall!="number")&&l.makeServerError("error in post-processing function",u).assertOk();let d=this.#u.slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return u.stall>=0&&(d=u.stall),o.clone().#f(e+1,n,d,i,l)}}return l}send(){return te(this.#c==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),this.#c=new VS(this),this.#f(0,a0()+this.timeout,0,this,new Kr(0,"",{},null,this))}cancel(){te(this.#c!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=Iw.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const n=this.url.split(":")[0].toLowerCase(),r=e.split(":")[0].toLowerCase();te(this.method==="GET"&&(n!=="https"||r!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const i=new lr(e);return i.method="GET",i.allowGzip=this.allowGzip,i.timeout=this.timeout,i.#n=Object.assign({},this.#n),this.#s&&(i.#s=new Uint8Array(this.#s)),i.#a=this.#a,i}clone(){const e=new lr(this.url);return e.#r=this.#r,this.#s&&(e.#s=this.#s),e.#a=this.#a,e.#n=Object.assign({},this.#n),e.#d=this.#d,this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),e.#l=this.#l,e.#p=this.#p,e.#g=this.#g,e.#u=Object.assign({},this.#u),e.#h=this.#h,e}static lockConfig(){zl=!0}static getGateway(e){return sa[e.toLowerCase()]||null}static registerGateway(e,n){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(zl)throw new Error("gateways locked");sa[e]=n}static registerGetUrl(e){if(zl)throw new Error("gateways locked");o0=e}static createGetUrlFunc(e){return kw(e)}static createDataGateway(){return Pw}static createIpfsGatewayFunc(e){return Tw(e)}}class Kr{#e;#t;#n;#r;#i;#o;toString(){return`<FetchResponse status=${this.statusCode} body=${this.#r?ce(this.#r):"null"}>`}get statusCode(){return this.#e}get statusMessage(){return this.#t}get headers(){return Object.assign({},this.#n)}get body(){return this.#r==null?null:new Uint8Array(this.#r)}get bodyText(){try{return this.#r==null?"":uc(this.#r)}catch{te(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{te(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,n=Object.keys(e);let r=0;return{next:()=>{if(r<n.length){const i=n[r++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}constructor(e,n,r,i,s){this.#e=e,this.#t=n,this.#n=Object.keys(r).reduce((o,a)=>(o[a.toLowerCase()]=String(r[a]),o),{}),this.#r=i==null?null:new Uint8Array(i),this.#i=s||null,this.#o={message:""}}makeServerError(e,n){let r;e?r=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,r=`CLIENT ESCALATED SERVER ERROR (${e})`);const i=new Kr(599,r,this.headers,this.body,this.#i||void 0);return i.#o={message:e,error:n},i}throwThrottleError(e,n){n==null?n=-1:G(Number.isInteger(n)&&n>=0,"invalid stall timeout","stall",n);const r=new Error(e||"throttling requests");throw ve(r,{stall:n,throttle:!0}),r}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return this.#r!=null}get request(){return this.#i}ok(){return this.#o.message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:n}=this.#o;e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let i=null;try{this.#r&&(i=uc(this.#r))}catch{}te(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:n,info:{requestUrl:r,responseBody:i,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}}function a0(){return new Date().getTime()}function qS(t){return sr(t.replace(/%([0-9a-f][0-9a-f])/gi,(e,n)=>String.fromCharCode(parseInt(n,16))))}function WS(t){return new Promise(e=>setTimeout(e,t))}const QS=BigInt(-1),fn=BigInt(0),qi=BigInt(1),JS=BigInt(5),Oi={};let es="0000";for(;es.length<80;)es+=es;function Jr(t){let e=es;for(;e.length<t;)e+=e;return BigInt("1"+e.substring(0,t))}function Ps(t,e,n){const r=BigInt(e.width);if(e.signed){const i=qi<<r-qi;te(n==null||t>=-i&&t<i,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:t}),t>fn?t=lc(ci(t,r),r):t=-lc(ci(-t,r),r)}else{const i=qi<<r;te(n==null||t>=0&&t<i,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:t}),t=(t%i+i)%i&i-qi}return t}function Gl(t){typeof t=="number"&&(t=`fixed128x${t}`);let e=!0,n=128,r=18;if(typeof t=="string"){if(t!=="fixed")if(t==="ufixed")e=!1;else{const s=t.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);G(s,"invalid fixed format","format",t),e=s[1]!=="u",n=parseInt(s[2]),r=parseInt(s[3])}}else if(t){const s=t,o=(a,c,l)=>s[a]==null?l:(G(typeof s[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,s[a]),s[a]);e=o("signed","boolean",e),n=o("width","number",n),r=o("decimals","number",r)}G(n%8===0,"invalid FixedNumber width (not byte aligned)","format.width",n),G(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r);const i=(e?"":"u")+"fixed"+String(n)+"x"+String(r);return{signed:e,width:n,decimals:r,name:i}}function YS(t,e){let n="";t<fn&&(n="-",t*=QS);let r=t.toString();if(e===0)return n+r;for(;r.length<=e;)r=es+r;const i=r.length-e;for(r=r.substring(0,i)+"."+r.substring(i);r[0]==="0"&&r[1]!==".";)r=r.substring(1);for(;r[r.length-1]==="0"&&r[r.length-2]!==".";)r=r.substring(0,r.length-1);return n+r}class Rr{format;#e;#t;#n;_value;constructor(e,n,r){Co(e,Oi,"FixedNumber"),this.#t=n,this.#e=r;const i=YS(n,r.decimals);ve(this,{format:r.name,_value:i}),this.#n=Jr(r.decimals)}get signed(){return this.#e.signed}get width(){return this.#e.width}get decimals(){return this.#e.decimals}get value(){return this.#t}#r(e){G(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)}#i(e,n){return e=Ps(e,this.#e,n),new Rr(Oi,e,this.#e)}#o(e,n){return this.#r(e),this.#i(this.#t+e.#t,n)}addUnsafe(e){return this.#o(e)}add(e){return this.#o(e,"add")}#s(e,n){return this.#r(e),this.#i(this.#t-e.#t,n)}subUnsafe(e){return this.#s(e)}sub(e){return this.#s(e,"sub")}#a(e,n){return this.#r(e),this.#i(this.#t*e.#t/this.#n,n)}mulUnsafe(e){return this.#a(e)}mul(e){return this.#a(e,"mul")}mulSignal(e){this.#r(e);const n=this.#t*e.#t;return te(n%this.#n===fn,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),this.#i(n/this.#n,"mulSignal")}#d(e,n){return te(e.#t!==fn,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#r(e),this.#i(this.#t*this.#n/e.#t,n)}divUnsafe(e){return this.#d(e)}div(e){return this.#d(e,"div")}divSignal(e){te(e.#t!==fn,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#r(e);const n=this.#t*this.#n;return te(n%e.#t===fn,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),this.#i(n/e.#t,"divSignal")}cmp(e){let n=this.value,r=e.value;const i=this.decimals-e.decimals;return i>0?r*=Jr(i):i<0&&(n*=Jr(-i)),n<r?-1:n>r?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=this.#t;return this.#t<fn&&(e-=this.#n-qi),e=this.#t/this.#n*this.#n,this.#i(e,"floor")}ceiling(){let e=this.#t;return this.#t>fn&&(e+=this.#n-qi),e=this.#t/this.#n*this.#n,this.#i(e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const n=this.decimals-e,r=JS*Jr(n-1);let i=this.value+r;const s=Jr(n);return i=i/s*s,Ps(i,this.#e,"round"),new Rr(Oi,i,this.#e)}isZero(){return this.#t===fn}isNegative(){return this.#t<fn}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return Rr.fromString(this.toString(),e)}static fromValue(e,n,r){const i=n==null?0:_e(n),s=Gl(r);let o=he(e,"value");const a=i-s.decimals;if(a>0){const c=Jr(a);te(o%c===fn,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=Jr(-a));return Ps(o,s,"fromValue"),new Rr(Oi,o,s)}static fromString(e,n){const r=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);G(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",e);const i=Gl(n);let s=r[2]||"0",o=r[3]||"";for(;o.length<i.decimals;)o+=es;te(o.substring(i.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,i.decimals);const a=BigInt(r[1]+s+o);return Ps(a,i,"fromString"),new Rr(Oi,a,i)}static fromBytes(e,n){let r=Nc(ke(e,"value"));const i=Gl(n);return i.signed&&(r=lc(r,i.width)),Ps(r,i,"fromBytes"),new Rr(Oi,r,i)}}function ZS(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function c0(t,e,n){let r=0;for(let i=0;i<n;i++)r=r*256+t[e+i];return r}function l0(t,e,n,r){const i=[];for(;n<e+1+r;){const s=Ow(t,n);i.push(s.result),n+=s.consumed,te(n<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:t,length:r,offset:e})}return{consumed:1+r,result:i}}function Ow(t,e){te(t.length!==0,"data too short","BUFFER_OVERRUN",{buffer:t,length:0,offset:1});const n=r=>{te(r<=t.length,"data short segment too short","BUFFER_OVERRUN",{buffer:t,length:t.length,offset:r})};if(t[e]>=248){const r=t[e]-247;n(e+1+r);const i=c0(t,e+1,r);return n(e+1+r+i),l0(t,e,e+1+r,r+i)}else if(t[e]>=192){const r=t[e]-192;return n(e+1+r),l0(t,e,e+1,r)}else if(t[e]>=184){const r=t[e]-183;n(e+1+r);const i=c0(t,e+1,r);n(e+1+r+i);const s=ce(t.slice(e+1+r,e+1+r+i));return{consumed:1+r+i,result:s}}else if(t[e]>=128){const r=t[e]-128;n(e+1+r);const i=ce(t.slice(e+1,e+1+r));return{consumed:1+r,result:i}}return{consumed:1,result:ZS(t[e])}}function _o(t){const e=ke(t,"data"),n=Ow(e,0);return G(n.consumed===e.length,"unexpected junk after rlp payload","data",t),n.result}function u0(t){const e=[];for(;t;)e.unshift(t&255),t>>=8;return e}function Rw(t){if(Array.isArray(t)){let r=[];if(t.forEach(function(s){r=r.concat(Rw(s))}),r.length<=55)return r.unshift(192+r.length),r;const i=u0(r.length);return i.unshift(247+i.length),i.concat(r)}const e=Array.prototype.slice.call(ke(t,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const n=u0(e.length);return n.unshift(183+n.length),n.concat(e)}const d0="0123456789abcdef";function Vr(t){let e="0x";for(const n of Rw(t))e+=d0[n>>4],e+=d0[n&15];return e}function XS(t,e){let n=18;return n=_e(e,"unit"),Rr.fromValue(t,n,{decimals:n,width:512}).toString()}function p3(t){return XS(t,18)}const It=32,Gu=new Uint8Array(It),eC=["then"],aa={},Nw=new WeakMap;function ti(t){return Nw.get(t)}function h0(t,e){Nw.set(t,e)}function Ts(t,e){const n=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw n.error=e,n}function Vu(t,e,n){return t.indexOf(null)>=0?e.map((r,i)=>r instanceof nr?Vu(ti(r),r,n):r):t.reduce((r,i,s)=>{let o=e.getValue(i);return i in r||(n&&o instanceof nr&&(o=Vu(ti(o),o,n)),r[i]=o),r},{})}class nr extends Array{#e;constructor(...e){const n=e[0];let r=e[1],i=(e[2]||[]).slice(),s=!0;n!==aa&&(r=e,i=[],s=!1),super(r.length),r.forEach((c,l)=>{this[l]=c});const o=i.reduce((c,l)=>(typeof l=="string"&&c.set(l,(c.get(l)||0)+1),c),new Map);if(h0(this,Object.freeze(r.map((c,l)=>{const u=i[l];return u!=null&&o.get(u)===1?u:null}))),this.#e=[],this.#e==null&&this.#e,!s)return;Object.freeze(this);const a=new Proxy(this,{get:(c,l,u)=>{if(typeof l=="string"){if(l.match(/^[0-9]+$/)){const h=_e(l,"%index");if(h<0||h>=this.length)throw new RangeError("out of result range");const f=c[h];return f instanceof Error&&Ts(`index ${h}`,f),f}if(eC.indexOf(l)>=0)return Reflect.get(c,l,u);const d=c[l];if(d instanceof Function)return function(...h){return d.apply(this===u?c:this,h)};if(!(l in c))return c.getValue.apply(this===u?c:this,[l])}return Reflect.get(c,l,u)}});return h0(a,ti(this)),a}toArray(e){const n=[];return this.forEach((r,i)=>{r instanceof Error&&Ts(`index ${i}`,r),e&&r instanceof nr&&(r=r.toArray(e)),n.push(r)}),n}toObject(e){const n=ti(this);return n.reduce((r,i,s)=>(te(i!=null,`value at index ${s} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),Vu(n,this,e)),{})}slice(e,n){e==null&&(e=0),e<0&&(e+=this.length,e<0&&(e=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const r=ti(this),i=[],s=[];for(let o=e;o<n;o++)i.push(this[o]),s.push(r[o]);return new nr(aa,i,s)}filter(e,n){const r=ti(this),i=[],s=[];for(let o=0;o<this.length;o++){const a=this[o];a instanceof Error&&Ts(`index ${o}`,a),e.call(n,a,o,this)&&(i.push(a),s.push(r[o]))}return new nr(aa,i,s)}map(e,n){const r=[];for(let i=0;i<this.length;i++){const s=this[i];s instanceof Error&&Ts(`index ${i}`,s),r.push(e.call(n,s,i,this))}return r}getValue(e){const n=ti(this).indexOf(e);if(n===-1)return;const r=this[n];return r instanceof Error&&Ts(`property ${JSON.stringify(e)}`,r.error),r}static fromItems(e,n){return new nr(aa,e,n)}}function f0(t){let e=it(t);return te(e.length<=It,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:It,offset:e.length}),e.length!==It&&(e=Pt(Ye([Gu.slice(e.length%It),e]))),e}class hr{name;type;localName;dynamic;constructor(e,n,r,i){ve(this,{name:e,type:n,localName:r,dynamic:i},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,n){G(!1,e,this.localName,n)}}class qu{#e;#t;constructor(){this.#e=[],this.#t=0}get data(){return Ye(this.#e)}get length(){return this.#t}#n(e){return this.#e.push(e),this.#t+=e.length,e.length}appendWriter(e){return this.#n(Pt(e.data))}writeBytes(e){let n=Pt(e);const r=n.length%It;return r&&(n=Pt(Ye([n,Gu.slice(r)]))),this.#n(n)}writeValue(e){return this.#n(f0(e))}writeUpdatableValue(){const e=this.#e.length;return this.#e.push(Gu),this.#t+=It,n=>{this.#e[e]=f0(n)}}}class sh{allowLoose;#e;#t;#n;#r;#i;constructor(e,n,r){ve(this,{allowLoose:!!n}),this.#e=Pt(e),this.#n=0,this.#r=null,this.#i=r??1024,this.#t=0}get data(){return ce(this.#e)}get dataLength(){return this.#e.length}get consumed(){return this.#t}get bytes(){return new Uint8Array(this.#e)}#o(e){if(this.#r)return this.#r.#o(e);this.#n+=e,te(this.#i<1||this.#n<=this.#i*this.dataLength,`compressed ABI data exceeds inflation ratio of ${this.#i} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Pt(this.#e),offset:this.#t,length:e,info:{bytesRead:this.#n,dataLength:this.dataLength}})}#s(e,n,r){let i=Math.ceil(n/It)*It;return this.#t+i>this.#e.length&&(this.allowLoose&&r&&this.#t+n<=this.#e.length?i=n:te(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Pt(this.#e),length:this.#e.length,offset:this.#t+i})),this.#e.slice(this.#t,this.#t+i)}subReader(e){const n=new sh(this.#e.slice(this.#t+e),this.allowLoose,this.#i);return n.#r=this,n}readBytes(e,n){let r=this.#s(0,e,!!n);return this.#o(e),this.#t+=r.length,r.slice(0,e)}readValue(){return Nc(this.readBytes(It))}readIndex(){return NS(this.readBytes(It))}}function dc(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function oh(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function tC(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");dc(t.outputLen),dc(t.blockLen)}function cs(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Mw(t,e){oh(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Vl=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Bw=t=>t instanceof Uint8Array,nC=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),ql=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),_n=(t,e)=>t<<32-e|t>>>e,rC=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!rC)throw new Error("Non little-endian hardware is not supported");function iC(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Mc(t){if(typeof t=="string"&&(t=iC(t)),!Bw(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function sC(...t){const e=new Uint8Array(t.reduce((r,i)=>r+i.length,0));let n=0;return t.forEach(r=>{if(!Bw(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}class ah{clone(){return this._cloneInto()}}function ch(t){const e=r=>t().update(Mc(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function oC(t=32){if(Vl&&typeof Vl.getRandomValues=="function")return Vl.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class Lw extends ah{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,tC(e);const r=Mc(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return cs(this),this.iHash.update(e),this}digestInto(e){cs(this),oh(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Dw=(t,e,n)=>new Lw(t,e).update(n).digest();Dw.create=(t,e)=>new Lw(t,e);function aC(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}class Uw extends ah{constructor(e,n,r,i){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ql(this.buffer)}update(e){cs(this);const{view:n,buffer:r,blockLen:i}=this;e=Mc(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=ql(e);for(;i<=s-o;o+=i)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){cs(this),Mw(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(r,0),o=0);for(let d=o;d<i;d++)n[d]=0;aC(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=ql(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],s)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%n&&e.buffer.set(r),e}}const cC=(t,e,n)=>t&e^~t&n,lC=(t,e,n)=>t&e^t&n^e&n,uC=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),wr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),vr=new Uint32Array(64);class dC extends Uw{constructor(){super(64,32,8,!1),this.A=wr[0]|0,this.B=wr[1]|0,this.C=wr[2]|0,this.D=wr[3]|0,this.E=wr[4]|0,this.F=wr[5]|0,this.G=wr[6]|0,this.H=wr[7]|0}get(){const{A:e,B:n,C:r,D:i,E:s,F:o,G:a,H:c}=this;return[e,n,r,i,s,o,a,c]}set(e,n,r,i,s,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)vr[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=vr[d-15],f=vr[d-2],g=_n(h,7)^_n(h,18)^h>>>3,p=_n(f,17)^_n(f,19)^f>>>10;vr[d]=p+vr[d-7]+g+vr[d-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=_n(a,6)^_n(a,11)^_n(a,25),f=u+h+cC(a,c,l)+uC[d]+vr[d]|0,p=(_n(r,2)^_n(r,13)^_n(r,22))+lC(r,i,s)|0;u=l,l=c,c=a,a=o+f|0,o=s,s=i,i=r,r=f+p|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,i,s,o,a,c,l,u)}roundClean(){vr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Fw=ch(()=>new dC),ca=BigInt(2**32-1),Wu=BigInt(32);function Hw(t,e=!1){return e?{h:Number(t&ca),l:Number(t>>Wu&ca)}:{h:Number(t>>Wu&ca)|0,l:Number(t&ca)|0}}function Kw(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=Hw(t[i],e);[n[i],r[i]]=[s,o]}return[n,r]}const hC=(t,e)=>BigInt(t>>>0)<<Wu|BigInt(e>>>0),fC=(t,e,n)=>t>>>n,pC=(t,e,n)=>t<<32-n|e>>>n,gC=(t,e,n)=>t>>>n|e<<32-n,mC=(t,e,n)=>t<<32-n|e>>>n,yC=(t,e,n)=>t<<64-n|e>>>n-32,wC=(t,e,n)=>t>>>n-32|e<<64-n,vC=(t,e)=>e,bC=(t,e)=>t,$w=(t,e,n)=>t<<n|e>>>32-n,jw=(t,e,n)=>e<<n|t>>>32-n,zw=(t,e,n)=>e<<n-32|t>>>64-n,Gw=(t,e,n)=>t<<n-32|e>>>64-n;function EC(t,e,n,r){const i=(e>>>0)+(r>>>0);return{h:t+n+(i/2**32|0)|0,l:i|0}}const AC=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),SC=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,CC=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),_C=(t,e,n,r,i)=>e+n+r+i+(t/2**32|0)|0,xC=(t,e,n,r,i)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(i>>>0),kC=(t,e,n,r,i,s)=>e+n+r+i+s+(t/2**32|0)|0,Ce={fromBig:Hw,split:Kw,toBig:hC,shrSH:fC,shrSL:pC,rotrSH:gC,rotrSL:mC,rotrBH:yC,rotrBL:wC,rotr32H:vC,rotr32L:bC,rotlSH:$w,rotlSL:jw,rotlBH:zw,rotlBL:Gw,add:EC,add3L:AC,add3H:SC,add4L:CC,add4H:_C,add5H:kC,add5L:xC},[PC,TC]=Ce.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),br=new Uint32Array(80),Er=new Uint32Array(80);class IC extends Uw{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:g,Hh:p,Hl:y}=this;return[e,n,r,i,s,o,a,c,l,u,d,h,f,g,p,y]}set(e,n,r,i,s,o,a,c,l,u,d,h,f,g,p,y){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=g|0,this.Hh=p|0,this.Hl=y|0}process(e,n){for(let v=0;v<16;v++,n+=4)br[v]=e.getUint32(n),Er[v]=e.getUint32(n+=4);for(let v=16;v<80;v++){const I=br[v-15]|0,R=Er[v-15]|0,L=Ce.rotrSH(I,R,1)^Ce.rotrSH(I,R,8)^Ce.shrSH(I,R,7),z=Ce.rotrSL(I,R,1)^Ce.rotrSL(I,R,8)^Ce.shrSL(I,R,7),j=br[v-2]|0,D=Er[v-2]|0,B=Ce.rotrSH(j,D,19)^Ce.rotrBH(j,D,61)^Ce.shrSH(j,D,6),$=Ce.rotrSL(j,D,19)^Ce.rotrBL(j,D,61)^Ce.shrSL(j,D,6),U=Ce.add4L(z,$,Er[v-7],Er[v-16]),M=Ce.add4H(U,L,B,br[v-7],br[v-16]);br[v]=M|0,Er[v]=U|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:g,Gh:p,Gl:y,Hh:m,Hl:C}=this;for(let v=0;v<80;v++){const I=Ce.rotrSH(d,h,14)^Ce.rotrSH(d,h,18)^Ce.rotrBH(d,h,41),R=Ce.rotrSL(d,h,14)^Ce.rotrSL(d,h,18)^Ce.rotrBL(d,h,41),L=d&f^~d&p,z=h&g^~h&y,j=Ce.add5L(C,R,z,TC[v],Er[v]),D=Ce.add5H(j,m,I,L,PC[v],br[v]),B=j|0,$=Ce.rotrSH(r,i,28)^Ce.rotrBH(r,i,34)^Ce.rotrBH(r,i,39),U=Ce.rotrSL(r,i,28)^Ce.rotrBL(r,i,34)^Ce.rotrBL(r,i,39),M=r&s^r&a^s&a,O=i&o^i&c^o&c;m=p|0,C=y|0,p=f|0,y=g|0,f=d|0,g=h|0,{h:d,l:h}=Ce.add(l|0,u|0,D|0,B|0),l=a|0,u=c|0,a=s|0,c=o|0,s=r|0,o=i|0;const A=Ce.add3L(B,U,O);r=Ce.add3H(A,D,$,M),i=A|0}({h:r,l:i}=Ce.add(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=Ce.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=Ce.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Ce.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Ce.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:g}=Ce.add(this.Fh|0,this.Fl|0,f|0,g|0),{h:p,l:y}=Ce.add(this.Gh|0,this.Gl|0,p|0,y|0),{h:m,l:C}=Ce.add(this.Hh|0,this.Hl|0,m|0,C|0),this.set(r,i,s,o,a,c,l,u,d,h,f,g,p,y,m,C)}roundClean(){br.fill(0),Er.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const OC=ch(()=>new IC);function RC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const p0=RC();p0.crypto||p0.msCrypto;function NC(t){switch(t){case"sha256":return Fw.create();case"sha512":return OC.create()}G(!1,"invalid hashing algorithm name","algorithm",t)}const[Vw,qw,Ww]=[[],[],[]],MC=BigInt(0),Is=BigInt(1),BC=BigInt(2),LC=BigInt(7),DC=BigInt(256),UC=BigInt(113);for(let t=0,e=Is,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],Vw.push(2*(5*r+n)),qw.push((t+1)*(t+2)/2%64);let i=MC;for(let s=0;s<7;s++)e=(e<<Is^(e>>LC)*UC)%DC,e&BC&&(i^=Is<<(Is<<BigInt(s))-Is);Ww.push(i)}const[FC,HC]=Kw(Ww,!0),g0=(t,e,n)=>n>32?zw(t,e,n):$w(t,e,n),m0=(t,e,n)=>n>32?Gw(t,e,n):jw(t,e,n);function KC(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=g0(l,u,1)^n[a],h=m0(l,u,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let i=t[2],s=t[3];for(let o=0;o<24;o++){const a=qw[o],c=g0(i,s,a),l=m0(i,s,a),u=Vw[o];i=t[u],s=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=FC[r],t[1]^=HC[r]}n.fill(0)}class lh extends ah{constructor(e,n,r,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,dc(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=nC(this.state)}keccak(){KC(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){cs(this);const{blockLen:n,state:r}=this;e=Mc(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);for(let a=0;a<o;a++)r[this.pos++]^=e[s++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:i}=this;e[r]^=n,(n&128)!==0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){cs(this,!1),oh(e),this.finish();const n=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,s-i);e.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return dc(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Mw(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new lh(n,r,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const $C=(t,e,n)=>ch(()=>new lh(e,t,n)),jC=$C(1,136,256/8);let Qw=!1;const Jw=function(t){return jC(t)};let Yw=Jw;function nt(t){const e=ke(t,"data");return ce(Yw(e))}nt._=Jw;nt.lock=function(){Qw=!0};nt.register=function(t){if(Qw)throw new TypeError("keccak256 is locked");Yw=t};Object.freeze(nt);const Zw=function(t){return NC("sha256").update(t).digest()};let Xw=Zw,ev=!1;function ws(t){const e=ke(t,"data");return ce(Xw(e))}ws._=Zw;ws.lock=function(){ev=!0};ws.register=function(t){if(ev)throw new Error("sha256 is locked");Xw=t};Object.freeze(ws);Object.freeze(ws);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const tv=BigInt(0),Bc=BigInt(1),zC=BigInt(2),Lc=t=>t instanceof Uint8Array,GC=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ls(t){if(!Lc(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=GC[t[n]];return e}function nv(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function uh(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function us(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const i=r*2,s=t.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");n[r]=o}return n}function fi(t){return uh(ls(t))}function dh(t){if(!Lc(t))throw new Error("Uint8Array expected");return uh(ls(Uint8Array.from(t).reverse()))}function ds(t,e){return us(t.toString(16).padStart(e*2,"0"))}function hh(t,e){return ds(t,e).reverse()}function VC(t){return us(nv(t))}function pn(t,e,n){let r;if(typeof e=="string")try{r=us(e)}catch(s){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${s}`)}else if(Lc(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const i=r.length;if(typeof n=="number"&&i!==n)throw new Error(`${t} expected ${n} bytes, got ${i}`);return r}function uo(...t){const e=new Uint8Array(t.reduce((r,i)=>r+i.length,0));let n=0;return t.forEach(r=>{if(!Lc(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}function qC(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function WC(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function QC(t){let e;for(e=0;t>tv;t>>=Bc,e+=1);return e}function JC(t,e){return t>>BigInt(e)&Bc}const YC=(t,e,n)=>t|(n?Bc:tv)<<BigInt(e),fh=t=>(zC<<BigInt(t-1))-Bc,Wl=t=>new Uint8Array(t),y0=t=>Uint8Array.from(t);function rv(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=Wl(t),i=Wl(t),s=0;const o=()=>{r.fill(1),i.fill(0),s=0},a=(...d)=>n(i,r,...d),c=(d=Wl())=>{i=a(y0([0]),d),r=a(),d.length!==0&&(i=a(y0([1]),d),r=a())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<e;){r=a();const f=r.slice();h.push(f),d+=r.length}return uo(...h)};return(d,h)=>{o(),c(d);let f;for(;!(f=h(l()));)c();return o(),f}}const ZC={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function xo(t,e,n={}){const r=(i,s,o)=>{const a=ZC[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(const[i,s]of Object.entries(e))r(i,s,!1);for(const[i,s]of Object.entries(n))r(i,s,!0);return t}const XC=Object.freeze(Object.defineProperty({__proto__:null,bitGet:JC,bitLen:QC,bitMask:fh,bitSet:YC,bytesToHex:ls,bytesToNumberBE:fi,bytesToNumberLE:dh,concatBytes:uo,createHmacDrbg:rv,ensureBytes:pn,equalBytes:qC,hexToBytes:us,hexToNumber:uh,numberToBytesBE:ds,numberToBytesLE:hh,numberToHexUnpadded:nv,numberToVarBytesBE:VC,utf8ToBytes:WC,validateObject:xo},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const dt=BigInt(0),et=BigInt(1),ni=BigInt(2),e_=BigInt(3),Qu=BigInt(4),w0=BigInt(5),v0=BigInt(8);BigInt(9);BigInt(16);function Dt(t,e){const n=t%e;return n>=dt?n:e+n}function t_(t,e,n){if(n<=dt||e<dt)throw new Error("Expected power/modulo > 0");if(n===et)return dt;let r=et;for(;e>dt;)e&et&&(r=r*t%n),t=t*t%n,e>>=et;return r}function en(t,e,n){let r=t;for(;e-- >dt;)r*=r,r%=n;return r}function Ju(t,e){if(t===dt||e<=dt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=Dt(t,e),r=e,i=dt,s=et;for(;n!==dt;){const a=r/n,c=r%n,l=i-s*a;r=n,n=c,i=s,s=l}if(r!==et)throw new Error("invert: does not exist");return Dt(i,e)}function n_(t){const e=(t-et)/ni;let n,r,i;for(n=t-et,r=0;n%ni===dt;n/=ni,r++);for(i=ni;i<t&&t_(i,e,t)!==t-et;i++);if(r===1){const o=(t+et)/Qu;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const s=(n+et)/ni;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=r,u=a.pow(a.mul(a.ONE,i),n),d=a.pow(c,s),h=a.pow(c,n);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let f=1;for(let p=a.sqr(h);f<l&&!a.eql(p,a.ONE);f++)p=a.sqr(p);const g=a.pow(u,et<<BigInt(l-f-1));u=a.sqr(g),d=a.mul(d,g),h=a.mul(h,u),l=f}return d}}function r_(t){if(t%Qu===e_){const e=(t+et)/Qu;return function(r,i){const s=r.pow(i,e);if(!r.eql(r.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%v0===w0){const e=(t-w0)/v0;return function(r,i){const s=r.mul(i,ni),o=r.pow(s,e),a=r.mul(i,o),c=r.mul(r.mul(a,ni),o),l=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(l),i))throw new Error("Cannot find square root");return l}}return n_(t)}const i_=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function s_(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=i_.reduce((r,i)=>(r[i]="function",r),e);return xo(t,n)}function o_(t,e,n){if(n<dt)throw new Error("Expected power > 0");if(n===dt)return t.ONE;if(n===et)return e;let r=t.ONE,i=e;for(;n>dt;)n&et&&(r=t.mul(r,i)),i=t.sqr(i),n>>=et;return r}function a_(t,e){const n=new Array(e.length),r=e.reduce((s,o,a)=>t.is0(o)?s:(n[a]=s,t.mul(s,o)),t.ONE),i=t.inv(r);return e.reduceRight((s,o,a)=>t.is0(o)?s:(n[a]=t.mul(s,n[a]),t.mul(s,o)),i),n}function iv(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function c_(t,e,n=!1,r={}){if(t<=dt)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:i,nByteLength:s}=iv(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=r_(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:s,MASK:fh(i),ZERO:dt,ONE:et,create:c=>Dt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return dt<=c&&c<t},is0:c=>c===dt,isOdd:c=>(c&et)===et,neg:c=>Dt(-c,t),eql:(c,l)=>c===l,sqr:c=>Dt(c*c,t),add:(c,l)=>Dt(c+l,t),sub:(c,l)=>Dt(c-l,t),mul:(c,l)=>Dt(c*l,t),pow:(c,l)=>o_(a,c,l),div:(c,l)=>Dt(c*Ju(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Ju(c,t),sqrt:r.sqrt||(c=>o(a,c)),invertBatch:c=>a_(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?hh(c,s):ds(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return n?dh(c):fi(c)}});return Object.freeze(a)}function sv(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function ov(t){const e=sv(t);return e+Math.ceil(e/2)}function l_(t,e,n=!1){const r=t.length,i=sv(e),s=ov(e);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);const o=n?fi(t):dh(t),a=Dt(o,e-et)+et;return n?hh(a,i):ds(a,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const u_=BigInt(0),Ql=BigInt(1);function d_(t,e){const n=(i,s)=>{const o=s.negate();return i?o:s},r=i=>{const s=Math.ceil(e/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:n,unsafeLadder(i,s){let o=t.ZERO,a=i;for(;s>u_;)s&Ql&&(o=o.add(a)),a=a.double(),s>>=Ql;return o},precomputeWindow(i,s){const{windows:o,windowSize:a}=r(s),c=[];let l=i,u=l;for(let d=0;d<o;d++){u=l,c.push(u);for(let h=1;h<a;h++)u=u.add(l),c.push(u);l=u.double()}return c},wNAF(i,s,o){const{windows:a,windowSize:c}=r(i);let l=t.ZERO,u=t.BASE;const d=BigInt(2**i-1),h=2**i,f=BigInt(i);for(let g=0;g<a;g++){const p=g*c;let y=Number(o&d);o>>=f,y>c&&(y-=h,o+=Ql);const m=p,C=p+Math.abs(y)-1,v=g%2!==0,I=y<0;y===0?u=u.add(n(v,s[m])):l=l.add(n(I,s[C]))}return{p:l,f:u}},wNAFCached(i,s,o,a){const c=i._WINDOW_SIZE||1;let l=s.get(i);return l||(l=this.precomputeWindow(i,c),c!==1&&s.set(i,a(l))),this.wNAF(c,l,o)}}}function av(t){return s_(t.Fp),xo(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...iv(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function h_(t){const e=av(t);xo(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:i}=e;if(n){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:f_,hexToBytes:p_}=XC,li={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=li;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:f_(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=li,n=typeof t=="string"?p_(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:i,l:s}=li._parseInt(n.subarray(2)),{d:o,l:a}=li._parseInt(s);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(t){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,n=l=>{const u=l.toString(16);return u.length&1?`0${u}`:u},r=e(n(t.s)),i=e(n(t.r)),s=r.length/2,o=i.length/2,a=n(s),c=n(o);return`30${n(o+s+4)}02${c}${i}02${a}${r}`}},Jn=BigInt(0),an=BigInt(1);BigInt(2);const b0=BigInt(3);BigInt(4);function g_(t){const e=h_(t),{Fp:n}=e,r=e.toBytes||((g,p,y)=>{const m=p.toAffine();return uo(Uint8Array.from([4]),n.toBytes(m.x),n.toBytes(m.y))}),i=e.fromBytes||(g=>{const p=g.subarray(1),y=n.fromBytes(p.subarray(0,n.BYTES)),m=n.fromBytes(p.subarray(n.BYTES,2*n.BYTES));return{x:y,y:m}});function s(g){const{a:p,b:y}=e,m=n.sqr(g),C=n.mul(m,g);return n.add(n.add(C,n.mul(g,p)),y)}if(!n.eql(n.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function o(g){return typeof g=="bigint"&&Jn<g&&g<e.n}function a(g){if(!o(g))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(g){const{allowedPrivateKeyLengths:p,nByteLength:y,wrapPrivateKey:m,n:C}=e;if(p&&typeof g!="bigint"){if(g instanceof Uint8Array&&(g=ls(g)),typeof g!="string"||!p.includes(g.length))throw new Error("Invalid key");g=g.padStart(y*2,"0")}let v;try{v=typeof g=="bigint"?g:fi(pn("private key",g,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof g}`)}return m&&(v=Dt(v,C)),a(v),v}const l=new Map;function u(g){if(!(g instanceof d))throw new Error("ProjectivePoint expected")}class d{constructor(p,y,m){if(this.px=p,this.py=y,this.pz=m,p==null||!n.isValid(p))throw new Error("x required");if(y==null||!n.isValid(y))throw new Error("y required");if(m==null||!n.isValid(m))throw new Error("z required")}static fromAffine(p){const{x:y,y:m}=p||{};if(!p||!n.isValid(y)||!n.isValid(m))throw new Error("invalid affine point");if(p instanceof d)throw new Error("projective point not allowed");const C=v=>n.eql(v,n.ZERO);return C(y)&&C(m)?d.ZERO:new d(y,m,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){const y=n.invertBatch(p.map(m=>m.pz));return p.map((m,C)=>m.toAffine(y[C])).map(d.fromAffine)}static fromHex(p){const y=d.fromAffine(i(pn("pointHex",p)));return y.assertValidity(),y}static fromPrivateKey(p){return d.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:p,y}=this.toAffine();if(!n.isValid(p)||!n.isValid(y))throw new Error("bad point: x or y not FE");const m=n.sqr(y),C=s(p);if(!n.eql(m,C))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:p}=this.toAffine();if(n.isOdd)return!n.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);const{px:y,py:m,pz:C}=this,{px:v,py:I,pz:R}=p,L=n.eql(n.mul(y,R),n.mul(v,C)),z=n.eql(n.mul(m,R),n.mul(I,C));return L&&z}negate(){return new d(this.px,n.neg(this.py),this.pz)}double(){const{a:p,b:y}=e,m=n.mul(y,b0),{px:C,py:v,pz:I}=this;let R=n.ZERO,L=n.ZERO,z=n.ZERO,j=n.mul(C,C),D=n.mul(v,v),B=n.mul(I,I),$=n.mul(C,v);return $=n.add($,$),z=n.mul(C,I),z=n.add(z,z),R=n.mul(p,z),L=n.mul(m,B),L=n.add(R,L),R=n.sub(D,L),L=n.add(D,L),L=n.mul(R,L),R=n.mul($,R),z=n.mul(m,z),B=n.mul(p,B),$=n.sub(j,B),$=n.mul(p,$),$=n.add($,z),z=n.add(j,j),j=n.add(z,j),j=n.add(j,B),j=n.mul(j,$),L=n.add(L,j),B=n.mul(v,I),B=n.add(B,B),j=n.mul(B,$),R=n.sub(R,j),z=n.mul(B,D),z=n.add(z,z),z=n.add(z,z),new d(R,L,z)}add(p){u(p);const{px:y,py:m,pz:C}=this,{px:v,py:I,pz:R}=p;let L=n.ZERO,z=n.ZERO,j=n.ZERO;const D=e.a,B=n.mul(e.b,b0);let $=n.mul(y,v),U=n.mul(m,I),M=n.mul(C,R),O=n.add(y,m),A=n.add(v,I);O=n.mul(O,A),A=n.add($,U),O=n.sub(O,A),A=n.add(y,C);let T=n.add(v,R);return A=n.mul(A,T),T=n.add($,M),A=n.sub(A,T),T=n.add(m,C),L=n.add(I,R),T=n.mul(T,L),L=n.add(U,M),T=n.sub(T,L),j=n.mul(D,A),L=n.mul(B,M),j=n.add(L,j),L=n.sub(U,j),j=n.add(U,j),z=n.mul(L,j),U=n.add($,$),U=n.add(U,$),M=n.mul(D,M),A=n.mul(B,A),U=n.add(U,M),M=n.sub($,M),M=n.mul(D,M),A=n.add(A,M),$=n.mul(U,A),z=n.add(z,$),$=n.mul(T,A),L=n.mul(O,L),L=n.sub(L,$),$=n.mul(O,U),j=n.mul(T,j),j=n.add(j,$),new d(L,z,j)}subtract(p){return this.add(p.negate())}is0(){return this.equals(d.ZERO)}wNAF(p){return f.wNAFCached(this,l,p,y=>{const m=n.invertBatch(y.map(C=>C.pz));return y.map((C,v)=>C.toAffine(m[v])).map(d.fromAffine)})}multiplyUnsafe(p){const y=d.ZERO;if(p===Jn)return y;if(a(p),p===an)return this;const{endo:m}=e;if(!m)return f.unsafeLadder(this,p);let{k1neg:C,k1:v,k2neg:I,k2:R}=m.splitScalar(p),L=y,z=y,j=this;for(;v>Jn||R>Jn;)v&an&&(L=L.add(j)),R&an&&(z=z.add(j)),j=j.double(),v>>=an,R>>=an;return C&&(L=L.negate()),I&&(z=z.negate()),z=new d(n.mul(z.px,m.beta),z.py,z.pz),L.add(z)}multiply(p){a(p);let y=p,m,C;const{endo:v}=e;if(v){const{k1neg:I,k1:R,k2neg:L,k2:z}=v.splitScalar(y);let{p:j,f:D}=this.wNAF(R),{p:B,f:$}=this.wNAF(z);j=f.constTimeNegate(I,j),B=f.constTimeNegate(L,B),B=new d(n.mul(B.px,v.beta),B.py,B.pz),m=j.add(B),C=D.add($)}else{const{p:I,f:R}=this.wNAF(y);m=I,C=R}return d.normalizeZ([m,C])[0]}multiplyAndAddUnsafe(p,y,m){const C=d.BASE,v=(R,L)=>L===Jn||L===an||!R.equals(C)?R.multiplyUnsafe(L):R.multiply(L),I=v(this,y).add(v(p,m));return I.is0()?void 0:I}toAffine(p){const{px:y,py:m,pz:C}=this,v=this.is0();p==null&&(p=v?n.ONE:n.inv(C));const I=n.mul(y,p),R=n.mul(m,p),L=n.mul(C,p);if(v)return{x:n.ZERO,y:n.ZERO};if(!n.eql(L,n.ONE))throw new Error("invZ was invalid");return{x:I,y:R}}isTorsionFree(){const{h:p,isTorsionFree:y}=e;if(p===an)return!0;if(y)return y(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:p,clearCofactor:y}=e;return p===an?this:y?y(d,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),r(d,this,p)}toHex(p=!0){return ls(this.toRawBytes(p))}}d.BASE=new d(e.Gx,e.Gy,n.ONE),d.ZERO=new d(n.ZERO,n.ONE,n.ZERO);const h=e.nBitLength,f=d_(d,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:o}}function m_(t){const e=av(t);return xo(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function y_(t){const e=m_(t),{Fp:n,n:r}=e,i=n.BYTES+1,s=2*n.BYTES+1;function o(A){return Jn<A&&A<n.ORDER}function a(A){return Dt(A,r)}function c(A){return Ju(A,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:d,isWithinCurveOrder:h}=g_({...e,toBytes(A,T,F){const w=T.toAffine(),S=n.toBytes(w.x),_=uo;return F?_(Uint8Array.from([T.hasEvenY()?2:3]),S):_(Uint8Array.from([4]),S,n.toBytes(w.y))},fromBytes(A){const T=A.length,F=A[0],w=A.subarray(1);if(T===i&&(F===2||F===3)){const S=fi(w);if(!o(S))throw new Error("Point is not on curve");const _=d(S);let k=n.sqrt(_);const E=(k&an)===an;return(F&1)===1!==E&&(k=n.neg(k)),{x:S,y:k}}else if(T===s&&F===4){const S=n.fromBytes(w.subarray(0,n.BYTES)),_=n.fromBytes(w.subarray(n.BYTES,2*n.BYTES));return{x:S,y:_}}else throw new Error(`Point of length ${T} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),f=A=>ls(ds(A,e.nByteLength));function g(A){const T=r>>an;return A>T}function p(A){return g(A)?a(-A):A}const y=(A,T,F)=>fi(A.slice(T,F));class m{constructor(T,F,w){this.r=T,this.s=F,this.recovery=w,this.assertValidity()}static fromCompact(T){const F=e.nByteLength;return T=pn("compactSignature",T,F*2),new m(y(T,0,F),y(T,F,2*F))}static fromDER(T){const{r:F,s:w}=li.toSig(pn("DER",T));return new m(F,w)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(T){return new m(this.r,this.s,T)}recoverPublicKey(T){const{r:F,s:w,recovery:S}=this,_=z(pn("msgHash",T));if(S==null||![0,1,2,3].includes(S))throw new Error("recovery id invalid");const k=S===2||S===3?F+e.n:F;if(k>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const E=(S&1)===0?"02":"03",b=l.fromHex(E+f(k)),x=c(k),P=a(-_*x),N=a(w*x),H=l.BASE.multiplyAndAddUnsafe(b,P,N);if(!H)throw new Error("point at infinify");return H.assertValidity(),H}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return us(this.toDERHex())}toDERHex(){return li.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return us(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const C={isValidPrivateKey(A){try{return u(A),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const A=ov(e.n);return l_(e.randomBytes(A),e.n)},precompute(A=8,T=l.BASE){return T._setWindowSize(A),T.multiply(BigInt(3)),T}};function v(A,T=!0){return l.fromPrivateKey(A).toRawBytes(T)}function I(A){const T=A instanceof Uint8Array,F=typeof A=="string",w=(T||F)&&A.length;return T?w===i||w===s:F?w===2*i||w===2*s:A instanceof l}function R(A,T,F=!0){if(I(A))throw new Error("first arg must be private key");if(!I(T))throw new Error("second arg must be public key");return l.fromHex(T).multiply(u(A)).toRawBytes(F)}const L=e.bits2int||function(A){const T=fi(A),F=A.length*8-e.nBitLength;return F>0?T>>BigInt(F):T},z=e.bits2int_modN||function(A){return a(L(A))},j=fh(e.nBitLength);function D(A){if(typeof A!="bigint")throw new Error("bigint expected");if(!(Jn<=A&&A<j))throw new Error(`bigint expected < 2^${e.nBitLength}`);return ds(A,e.nByteLength)}function B(A,T,F=$){if(["recovered","canonical"].some(V=>V in F))throw new Error("sign() legacy options not supported");const{hash:w,randomBytes:S}=e;let{lowS:_,prehash:k,extraEntropy:E}=F;_==null&&(_=!0),A=pn("msgHash",A),k&&(A=pn("prehashed msgHash",w(A)));const b=z(A),x=u(T),P=[D(x),D(b)];if(E!=null){const V=E===!0?S(n.BYTES):E;P.push(pn("extraEntropy",V))}const N=uo(...P),H=b;function K(V){const q=L(V);if(!h(q))return;const Y=c(q),Z=l.BASE.multiply(q).toAffine(),ie=a(Z.x);if(ie===Jn)return;const oe=a(Y*a(H+ie*x));if(oe===Jn)return;let pe=(Z.x===ie?0:2)|Number(Z.y&an),se=oe;return _&&g(oe)&&(se=p(oe),pe^=1),new m(ie,se,pe)}return{seed:N,k2sig:K}}const $={lowS:e.lowS,prehash:!1},U={lowS:e.lowS,prehash:!1};function M(A,T,F=$){const{seed:w,k2sig:S}=B(A,T,F),_=e;return rv(_.hash.outputLen,_.nByteLength,_.hmac)(w,S)}l.BASE._setWindowSize(8);function O(A,T,F,w=U){const S=A;if(T=pn("msgHash",T),F=pn("publicKey",F),"strict"in w)throw new Error("options.strict was renamed to lowS");const{lowS:_,prehash:k}=w;let E,b;try{if(typeof S=="string"||S instanceof Uint8Array)try{E=m.fromDER(S)}catch(Z){if(!(Z instanceof li.Err))throw Z;E=m.fromCompact(S)}else if(typeof S=="object"&&typeof S.r=="bigint"&&typeof S.s=="bigint"){const{r:Z,s:ie}=S;E=new m(Z,ie)}else throw new Error("PARSE");b=l.fromHex(F)}catch(Z){if(Z.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(_&&E.hasHighS())return!1;k&&(T=e.hash(T));const{r:x,s:P}=E,N=z(T),H=c(P),K=a(N*H),V=a(x*H),q=l.BASE.multiplyAndAddUnsafe(b,K,V)?.toAffine();return q?a(q.x)===x:!1}return{CURVE:e,getPublicKey:v,getSharedSecret:R,sign:M,verify:O,ProjectivePoint:l,Signature:m,utils:C}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function w_(t){return{hash:t,hmac:(e,...n)=>Dw(t,e,sC(...n)),randomBytes:oC}}function v_(t,e){const n=r=>y_({...t,...w_(r)});return Object.freeze({...n(e),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const cv=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),E0=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),b_=BigInt(1),Yu=BigInt(2),A0=(t,e)=>(t+e/Yu)/e;function E_(t){const e=cv,n=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,d=en(u,n,e)*u%e,h=en(d,n,e)*u%e,f=en(h,Yu,e)*l%e,g=en(f,i,e)*f%e,p=en(g,s,e)*g%e,y=en(p,a,e)*p%e,m=en(y,c,e)*y%e,C=en(m,a,e)*p%e,v=en(C,n,e)*u%e,I=en(v,o,e)*g%e,R=en(I,r,e)*l%e,L=en(R,Yu,e);if(!Zu.eql(Zu.sqr(L),t))throw new Error("Cannot find square root");return L}const Zu=c_(cv,void 0,void 0,{sqrt:E_}),xr=v_({a:BigInt(0),b:BigInt(7),Fp:Zu,n:E0,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=E0,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-b_*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,o=BigInt("0x100000000000000000000000000000000"),a=A0(s*t,e),c=A0(-r*t,e);let l=Dt(t-a*n-c*i,e),u=Dt(-a*r-c*s,e);const d=l>o,h=u>o;if(d&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},Fw);BigInt(0);xr.ProjectivePoint;const ho="0x0000000000000000000000000000000000000000",S0="0x0000000000000000000000000000000000000000000000000000000000000000",C0=BigInt(0),_0=BigInt(1),x0=BigInt(2),k0=BigInt(27),P0=BigInt(28),la=BigInt(35),Ri={};function T0(t){return cr(it(t),32)}class We{#e;#t;#n;#r;get r(){return this.#e}set r(e){G(Xi(e)===32,"invalid r","value",e),this.#e=ce(e)}get s(){return G(parseInt(this.#t.substring(0,3))<8,"non-canonical s; use ._s","s",this.#t),this.#t}set s(e){G(Xi(e)===32,"invalid s","value",e),this.#t=ce(e)}get _s(){return this.#t}isValid(){return parseInt(this.#t.substring(0,3))<8}get v(){return this.#n}set v(e){const n=_e(e,"value");G(n===27||n===28,"invalid v","v",e),this.#n=n}get networkV(){return this.#r}get legacyChainId(){const e=this.networkV;return e==null?null:We.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=ke(this.s);return this.yParity&&(e[0]|=128),ce(e)}get compactSerialized(){return Ye([this.r,this.yParityAndS])}get serialized(){return Ye([this.r,this.s,this.yParity?"0x1c":"0x1b"])}constructor(e,n,r,i){Co(e,Ri,"Signature"),this.#e=n,this.#t=r,this.#n=i,this.#r=null}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new We(Ri,this.r,this._s,this.v);return this.networkV&&(e.#r=this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){const n=he(e,"v");return n==k0||n==P0?C0:(G(n>=la,"invalid EIP-155 v","v",e),(n-la)/x0)}static getChainIdV(e,n){return he(e)*x0+BigInt(35+n-27)}static getNormalizedV(e){const n=he(e);return n===C0||n===k0?27:n===_0||n===P0?28:(G(n>=la,"invalid v","v",e),n&_0?27:28)}static from(e){function n(l,u){G(l,u,"signature",e)}if(e==null)return new We(Ri,S0,S0,27);if(typeof e=="string"){const l=ke(e,"signature");if(l.length===64){const u=ce(l.slice(0,32)),d=l.slice(32,64),h=d[0]&128?28:27;return d[0]&=127,new We(Ri,u,ce(d),h)}if(l.length===65){const u=ce(l.slice(0,32)),d=ce(l.slice(32,64)),h=We.getNormalizedV(l[64]);return new We(Ri,u,d,h)}n(!1,"invalid raw signature length")}if(e instanceof We)return e.clone();const r=e.r;n(r!=null,"missing r");const i=T0(r),s=function(l,u){if(l!=null)return T0(l);if(u!=null){n(Ke(u,32),"invalid yParityAndS");const d=ke(u);return d[0]&=127,ce(d)}n(!1,"missing s")}(e.s,e.yParityAndS),{networkV:o,v:a}=function(l,u,d){if(l!=null){const h=he(l);return{networkV:h>=la?h:void 0,v:We.getNormalizedV(h)}}if(u!=null)return n(Ke(u,32),"invalid yParityAndS"),{v:ke(u)[0]&128?28:27};if(d!=null){switch(_e(d,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}n(!1,"invalid yParity")}n(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),c=new We(Ri,i,s,a);return o&&(c.#r=o),n(e.yParity==null||_e(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),n(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}}class Yn{#e;constructor(e){G(Xi(e)===32,"invalid private key","privateKey","[REDACTED]"),this.#e=ce(e)}get privateKey(){return this.#e}get publicKey(){return Yn.computePublicKey(this.#e)}get compressedPublicKey(){return Yn.computePublicKey(this.#e,!0)}sign(e){G(Xi(e)===32,"invalid digest length","digest",e);const n=xr.sign(Pt(e),Pt(this.#e),{lowS:!0});return We.from({r:Gr(n.r,32),s:Gr(n.s,32),v:n.recovery?28:27})}computeSharedSecret(e){const n=Yn.computePublicKey(e);return ce(xr.getSharedSecret(Pt(this.#e),ke(n),!1))}static computePublicKey(e,n){let r=ke(e,"key");if(r.length===32){const s=xr.getPublicKey(r,!!n);return ce(s)}if(r.length===64){const s=new Uint8Array(65);s[0]=4,s.set(r,1),r=s}const i=xr.ProjectivePoint.fromHex(r);return ce(i.toRawBytes(n))}static recoverPublicKey(e,n){G(Xi(e)===32,"invalid digest length","digest",e);const r=We.from(n);let i=xr.Signature.fromCompact(Pt(Ye([r.r,r.s])));i=i.addRecoveryBit(r.yParity);const s=i.recoverPublicKey(Pt(e));return G(s!=null,"invalid signature for digest","signature",n),"0x"+s.toHex(!1)}static addPoints(e,n,r){const i=xr.ProjectivePoint.fromHex(Yn.computePublicKey(e).substring(2)),s=xr.ProjectivePoint.fromHex(Yn.computePublicKey(n).substring(2));return"0x"+i.add(s).toHex(!!r)}}const A_=BigInt(0),S_=BigInt(36);function I0(t){t=t.toLowerCase();const e=t.substring(2).split(""),n=new Uint8Array(40);for(let i=0;i<40;i++)n[i]=e[i].charCodeAt(0);const r=ke(nt(n));for(let i=0;i<40;i+=2)r[i>>1]>>4>=8&&(e[i]=e[i].toUpperCase()),(r[i>>1]&15)>=8&&(e[i+1]=e[i+1].toUpperCase());return"0x"+e.join("")}const ph={};for(let t=0;t<10;t++)ph[String(t)]=String(t);for(let t=0;t<26;t++)ph[String.fromCharCode(65+t)]=String(10+t);const O0=15;function C_(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map(r=>ph[r]).join("");for(;e.length>=O0;){let r=e.substring(0,O0);e=parseInt(r,10)%97+e.substring(r.length)}let n=String(98-parseInt(e,10)%97);for(;n.length<2;)n="0"+n;return n}const __=function(){const t={};for(let e=0;e<36;e++){const n="0123456789abcdefghijklmnopqrstuvwxyz"[e];t[n]=BigInt(e)}return t}();function x_(t){t=t.toLowerCase();let e=A_;for(let n=0;n<t.length;n++)e=e*S_+__[t[n]];return e}function De(t){if(G(typeof t=="string","invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=I0(t);return G(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){G(t.substring(2,4)===C_(t),"bad icap checksum","address",t);let e=x_(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return I0("0x"+e)}G(!1,"invalid address","address",t)}function k_(t){const e=De(t.from);let r=he(t.nonce,"tx.nonce").toString(16);return r==="0"?r="0x":r.length%2?r="0x0"+r:r="0x"+r,De(qe(nt(Vr([e,r])),12))}function lv(t){return t&&typeof t.getAddress=="function"}async function Jl(t,e){const n=await e;return(n==null||n==="0x0000000000000000000000000000000000000000")&&(te(typeof t!="string","unconfigured name","UNCONFIGURED_NAME",{value:t}),G(!1,"invalid AddressLike value; did not resolve to a value address","target",t)),De(n)}function Ot(t,e){if(typeof t=="string")return t.match(/^0x[0-9a-f]{40}$/i)?De(t):(te(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),Jl(t,e.resolveName(t)));if(lv(t))return Jl(t,t.getAddress());if(t&&typeof t.then=="function")return Jl(t,t);G(!1,"unsupported addressable value","target",t)}const zn={};function de(t,e){let n=!1;return e<0&&(n=!0,e*=-1),new Je(zn,`${n?"":"u"}int${e}`,t,{signed:n,width:e})}function Ne(t,e){return new Je(zn,`bytes${e||""}`,t,{size:e})}const R0=Symbol.for("_ethers_typed");class Je{type;value;#e;_typedSymbol;constructor(e,n,r,i){i==null&&(i=null),Co(zn,e,"Typed"),ve(this,{_typedSymbol:R0,type:n,value:r}),this.#e=i,this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return this.#e}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return this.#e===!0?-1:this.#e===!1?this.value.length:null}static from(e,n){return new Je(zn,e,n)}static uint8(e){return de(e,8)}static uint16(e){return de(e,16)}static uint24(e){return de(e,24)}static uint32(e){return de(e,32)}static uint40(e){return de(e,40)}static uint48(e){return de(e,48)}static uint56(e){return de(e,56)}static uint64(e){return de(e,64)}static uint72(e){return de(e,72)}static uint80(e){return de(e,80)}static uint88(e){return de(e,88)}static uint96(e){return de(e,96)}static uint104(e){return de(e,104)}static uint112(e){return de(e,112)}static uint120(e){return de(e,120)}static uint128(e){return de(e,128)}static uint136(e){return de(e,136)}static uint144(e){return de(e,144)}static uint152(e){return de(e,152)}static uint160(e){return de(e,160)}static uint168(e){return de(e,168)}static uint176(e){return de(e,176)}static uint184(e){return de(e,184)}static uint192(e){return de(e,192)}static uint200(e){return de(e,200)}static uint208(e){return de(e,208)}static uint216(e){return de(e,216)}static uint224(e){return de(e,224)}static uint232(e){return de(e,232)}static uint240(e){return de(e,240)}static uint248(e){return de(e,248)}static uint256(e){return de(e,256)}static uint(e){return de(e,256)}static int8(e){return de(e,-8)}static int16(e){return de(e,-16)}static int24(e){return de(e,-24)}static int32(e){return de(e,-32)}static int40(e){return de(e,-40)}static int48(e){return de(e,-48)}static int56(e){return de(e,-56)}static int64(e){return de(e,-64)}static int72(e){return de(e,-72)}static int80(e){return de(e,-80)}static int88(e){return de(e,-88)}static int96(e){return de(e,-96)}static int104(e){return de(e,-104)}static int112(e){return de(e,-112)}static int120(e){return de(e,-120)}static int128(e){return de(e,-128)}static int136(e){return de(e,-136)}static int144(e){return de(e,-144)}static int152(e){return de(e,-152)}static int160(e){return de(e,-160)}static int168(e){return de(e,-168)}static int176(e){return de(e,-176)}static int184(e){return de(e,-184)}static int192(e){return de(e,-192)}static int200(e){return de(e,-200)}static int208(e){return de(e,-208)}static int216(e){return de(e,-216)}static int224(e){return de(e,-224)}static int232(e){return de(e,-232)}static int240(e){return de(e,-240)}static int248(e){return de(e,-248)}static int256(e){return de(e,-256)}static int(e){return de(e,-256)}static bytes1(e){return Ne(e,1)}static bytes2(e){return Ne(e,2)}static bytes3(e){return Ne(e,3)}static bytes4(e){return Ne(e,4)}static bytes5(e){return Ne(e,5)}static bytes6(e){return Ne(e,6)}static bytes7(e){return Ne(e,7)}static bytes8(e){return Ne(e,8)}static bytes9(e){return Ne(e,9)}static bytes10(e){return Ne(e,10)}static bytes11(e){return Ne(e,11)}static bytes12(e){return Ne(e,12)}static bytes13(e){return Ne(e,13)}static bytes14(e){return Ne(e,14)}static bytes15(e){return Ne(e,15)}static bytes16(e){return Ne(e,16)}static bytes17(e){return Ne(e,17)}static bytes18(e){return Ne(e,18)}static bytes19(e){return Ne(e,19)}static bytes20(e){return Ne(e,20)}static bytes21(e){return Ne(e,21)}static bytes22(e){return Ne(e,22)}static bytes23(e){return Ne(e,23)}static bytes24(e){return Ne(e,24)}static bytes25(e){return Ne(e,25)}static bytes26(e){return Ne(e,26)}static bytes27(e){return Ne(e,27)}static bytes28(e){return Ne(e,28)}static bytes29(e){return Ne(e,29)}static bytes30(e){return Ne(e,30)}static bytes31(e){return Ne(e,31)}static bytes32(e){return Ne(e,32)}static address(e){return new Je(zn,"address",e)}static bool(e){return new Je(zn,"bool",!!e)}static bytes(e){return new Je(zn,"bytes",e)}static string(e){return new Je(zn,"string",e)}static array(e,n){throw new Error("not implemented yet")}static tuple(e,n){throw new Error("not implemented yet")}static overrides(e){return new Je(zn,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===R0}static dereference(e,n){if(Je.isTyped(e)){if(e.type!==n)throw new Error(`invalid type: expecetd ${n}, got ${e.type}`);return e.value}return e}}class P_ extends hr{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,n){let r=Je.dereference(n,"string");try{r=De(r)}catch(i){return this._throwError(i.message,n)}return e.writeValue(r)}decode(e){return De(Gr(e.readValue(),20))}}class T_ extends hr{coder;constructor(e){super(e.name,e.type,"_",e.dynamic),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,n){return this.coder.encode(e,n)}decode(e){return this.coder.decode(e)}}function uv(t,e,n){let r=[];if(Array.isArray(n))r=n;else if(n&&typeof n=="object"){let c={};r=e.map(l=>{const u=l.localName;return te(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:n}),te(!c[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:n}),c[u]=!0,n[u]})}else G(!1,"invalid tuple value","tuple",n);G(e.length===r.length,"types/value length mismatch","tuple",n);let i=new qu,s=new qu,o=[];e.forEach((c,l)=>{let u=r[l];if(c.dynamic){let d=s.length;c.encode(s,u);let h=i.writeUpdatableValue();o.push(f=>{h(f+d)})}else c.encode(i,u)}),o.forEach(c=>{c(i.length)});let a=t.appendWriter(i);return a+=t.appendWriter(s),a}function dv(t,e){let n=[],r=[],i=t.subReader(0);return e.forEach(s=>{let o=null;if(s.dynamic){let a=t.readIndex(),c=i.subReader(a);try{o=s.decode(c)}catch(l){if(yt(l,"BUFFER_OVERRUN"))throw l;o=l,o.baseType=s.name,o.name=s.localName,o.type=s.type}}else try{o=s.decode(t)}catch(a){if(yt(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=s.name,o.name=s.localName,o.type=s.type}if(o==null)throw new Error("investigate");n.push(o),r.push(s.localName||null)}),nr.fromItems(n,r)}class I_ extends hr{coder;length;constructor(e,n,r){const i=e.type+"["+(n>=0?n:"")+"]",s=n===-1||e.dynamic;super("array",i,r,s),ve(this,{coder:e,length:n})}defaultValue(){const e=this.coder.defaultValue(),n=[];for(let r=0;r<this.length;r++)n.push(e);return n}encode(e,n){const r=Je.dereference(n,"array");Array.isArray(r)||this._throwError("expected array value",r);let i=this.length;i===-1&&(i=r.length,e.writeValue(r.length)),Ew(r.length,i,"coder array"+(this.localName?" "+this.localName:""));let s=[];for(let o=0;o<r.length;o++)s.push(this.coder);return uv(e,s,r)}decode(e){let n=this.length;n===-1&&(n=e.readIndex(),te(n*It<=e.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:e.bytes,offset:n*It,length:e.dataLength}));let r=[];for(let i=0;i<n;i++)r.push(new T_(this.coder));return dv(e,r)}}class O_ extends hr{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,n){const r=Je.dereference(n,"bool");return e.writeValue(r?1:0)}decode(e){return!!e.readValue()}}class hv extends hr{constructor(e,n){super(e,e,n,!0)}defaultValue(){return"0x"}encode(e,n){n=Pt(n);let r=e.writeValue(n.length);return r+=e.writeBytes(n),r}decode(e){return e.readBytes(e.readIndex(),!0)}}class R_ extends hv{constructor(e){super("bytes",e)}decode(e){return ce(super.decode(e))}}class N_ extends hr{size;constructor(e,n){let r="bytes"+String(e);super(r,r,n,!1),ve(this,{size:e},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(e,n){let r=Pt(Je.dereference(n,this.type));return r.length!==this.size&&this._throwError("incorrect data length",n),e.writeBytes(r)}decode(e){return ce(e.readBytes(this.size))}}const M_=new Uint8Array([]);class B_ extends hr{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,n){return n!=null&&this._throwError("not null",n),e.writeBytes(M_)}decode(e){return e.readBytes(0),null}}const L_=BigInt(0),D_=BigInt(1),U_=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class F_ extends hr{size;signed;constructor(e,n,r){const i=(n?"int":"uint")+e*8;super(i,i,r,!1),ve(this,{size:e,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(e,n){let r=he(Je.dereference(n,this.type)),i=ci(U_,It*8);if(this.signed){let s=ci(i,this.size*8-1);(r>s||r<-(s+D_))&&this._throwError("value out-of-bounds",n),r=Cw(r,8*It)}else(r<L_||r>ci(i,this.size*8))&&this._throwError("value out-of-bounds",n);return e.writeValue(r)}decode(e){let n=ci(e.readValue(),this.size*8);return this.signed&&(n=lc(n,this.size*8)),n}}class H_ extends hv{constructor(e){super("string",e)}defaultValue(){return""}encode(e,n){return super.encode(e,sr(Je.dereference(n,"string")))}decode(e){return uc(super.decode(e))}}class ua extends hr{coders;constructor(e,n){let r=!1;const i=[];e.forEach(o=>{o.dynamic&&(r=!0),i.push(o.type)});const s="tuple("+i.join(",")+")";super("tuple",s,n,r),ve(this,{coders:Object.freeze(e.slice())})}defaultValue(){const e=[];this.coders.forEach(r=>{e.push(r.defaultValue())});const n=this.coders.reduce((r,i)=>{const s=i.localName;return s&&(r[s]||(r[s]=0),r[s]++),r},{});return this.coders.forEach((r,i)=>{let s=r.localName;!s||n[s]!==1||(s==="length"&&(s="_length"),e[s]==null&&(e[s]=e[i]))}),Object.freeze(e)}encode(e,n){const r=Je.dereference(n,"tuple");return uv(e,this.coders,r)}decode(e){return dv(e,this.coders)}}function Yl(t,e){return{address:De(t),storageKeys:e.map((n,r)=>(G(Ke(n,32),"invalid slot",`storageKeys[${r}]`,n),n.toLowerCase()))}}function _i(t){if(Array.isArray(t))return t.map((n,r)=>Array.isArray(n)?(G(n.length===2,"invalid slot set",`value[${r}]`,n),Yl(n[0],n[1])):(G(n!=null&&typeof n=="object","invalid address-slot set","value",t),Yl(n.address,n.storageKeys)));G(t!=null&&typeof t=="object","invalid access list","value",t);const e=Object.keys(t).map(n=>{const r=t[n].reduce((i,s)=>(i[s]=!0,i),{});return Yl(n,Object.keys(r).sort())});return e.sort((n,r)=>n.address.localeCompare(r.address)),e}function fv(t){return{address:De(t.address),nonce:he(t.nonce!=null?t.nonce:0),chainId:he(t.chainId!=null?t.chainId:0),signature:We.from(t.signature)}}function K_(t){let e;return typeof t=="string"?e=Yn.computePublicKey(t,!1):e=t.publicKey,De(nt("0x"+e.substring(4)).substring(26))}function $_(t,e){return K_(Yn.recoverPublicKey(t,e))}const lt=BigInt(0),j_=BigInt(2),z_=BigInt(27),G_=BigInt(28),V_=BigInt(35),q_=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Zl=4096*32;function W_(t){return{blobToKzgCommitment:r=>{if("computeBlobProof"in t){if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return ke(t.blobToKzgCommitment(ce(r)))}else if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return ke(t.blobToKzgCommitment(r));if("blobToKZGCommitment"in t&&typeof t.blobToKZGCommitment=="function")return ke(t.blobToKZGCommitment(ce(r)));G(!1,"unsupported KZG library","kzg",t)},computeBlobKzgProof:(r,i)=>{if("computeBlobProof"in t&&typeof t.computeBlobProof=="function")return ke(t.computeBlobProof(ce(r),ce(i)));if("computeBlobKzgProof"in t&&typeof t.computeBlobKzgProof=="function")return t.computeBlobKzgProof(r,i);if("computeBlobKZGProof"in t&&typeof t.computeBlobKZGProof=="function")return ke(t.computeBlobKZGProof(ce(r),ce(i)));G(!1,"unsupported KZG library","kzg",t)}}}function N0(t,e){let n=t.toString(16);for(;n.length<2;)n="0"+n;return n+=ws(e).substring(4),"0x"+n}function vs(t){return t==="0x"?null:De(t)}function Dc(t,e){try{return _i(t)}catch(n){G(!1,n.message,e,t)}}function Q_(t,e){try{if(!Array.isArray(t))throw new Error("authorizationList: invalid array");const n=[];for(let r=0;r<t.length;r++){const i=t[r];if(!Array.isArray(i))throw new Error(`authorization[${r}]: invalid array`);if(i.length!==6)throw new Error(`authorization[${r}]: wrong length`);if(!i[1])throw new Error(`authorization[${r}]: null address`);n.push({address:vs(i[1]),nonce:Ue(i[2],"nonce"),chainId:Ue(i[0],"chainId"),signature:We.from({yParity:xi(i[3],"yParity"),r:cr(i[4],32),s:cr(i[5],32)})})}return n}catch(n){G(!1,n.message,e,t)}}function xi(t,e){return t==="0x"?0:_e(t,e)}function Ue(t,e){if(t==="0x")return lt;const n=he(t,e);return G(n<=q_,"value exceeds uint size",e,n),n}function Ie(t,e){const n=he(t,"value"),r=it(n);return G(r.length<=32,"value too large",`tx.${e}`,n),r}function Uc(t){return _i(t).map(e=>[e.address,e.storageKeys])}function J_(t){return t.map(e=>[Ie(e.chainId,"chainId"),e.address,Ie(e.nonce,"nonce"),Ie(e.signature.yParity,"yParity"),it(e.signature.r),it(e.signature.s)])}function Y_(t,e){G(Array.isArray(t),`invalid ${e}`,"value",t);for(let n=0;n<t.length;n++)G(Ke(t[n],32),"invalid ${ param } hash",`value[${n}]`,t[n]);return t}function Z_(t){const e=_o(t);G(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",t);const n={type:0,nonce:xi(e[0],"nonce"),gasPrice:Ue(e[1],"gasPrice"),gasLimit:Ue(e[2],"gasLimit"),to:vs(e[3]),value:Ue(e[4],"value"),data:ce(e[5]),chainId:lt};if(e.length===6)return n;const r=Ue(e[6],"v"),i=Ue(e[7],"r"),s=Ue(e[8],"s");if(i===lt&&s===lt)n.chainId=r;else{let o=(r-V_)/j_;o<lt&&(o=lt),n.chainId=o,G(o!==lt||r===z_||r===G_,"non-canonical legacy v","v",e[6]),n.signature=We.from({r:cr(e[7],32),s:cr(e[8],32),v:r})}return n}function X_(t,e){const n=[Ie(t.nonce,"nonce"),Ie(t.gasPrice||0,"gasPrice"),Ie(t.gasLimit,"gasLimit"),t.to||"0x",Ie(t.value,"value"),t.data];let r=lt;if(t.chainId!=lt)r=he(t.chainId,"tx.chainId"),G(!e||e.networkV==null||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(t.signature){const s=t.signature.legacyChainId;s!=null&&(r=s)}if(!e)return r!==lt&&(n.push(it(r)),n.push("0x"),n.push("0x")),Vr(n);let i=BigInt(27+e.yParity);return r!==lt?i=We.getChainIdV(r,e.v):BigInt(e.v)!==i&&G(!1,"tx.chainId/sig.v mismatch","sig",e),n.push(it(i)),n.push(it(e.r)),n.push(it(e.s)),Vr(n)}function Fc(t,e){let n;try{if(n=xi(e[0],"yParity"),n!==0&&n!==1)throw new Error("bad yParity")}catch{G(!1,"invalid yParity","yParity",e[0])}const r=cr(e[1],32),i=cr(e[2],32),s=We.from({r,s:i,yParity:n});t.signature=s}function ex(t){const e=_o(ke(t).slice(1));G(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",ce(t));const n={type:2,chainId:Ue(e[0],"chainId"),nonce:xi(e[1],"nonce"),maxPriorityFeePerGas:Ue(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Ue(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Ue(e[4],"gasLimit"),to:vs(e[5]),value:Ue(e[6],"value"),data:ce(e[7]),accessList:Dc(e[8],"accessList")};return e.length===9||Fc(n,e.slice(9)),n}function tx(t,e){const n=[Ie(t.chainId,"chainId"),Ie(t.nonce,"nonce"),Ie(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Ie(t.maxFeePerGas||0,"maxFeePerGas"),Ie(t.gasLimit,"gasLimit"),t.to||"0x",Ie(t.value,"value"),t.data,Uc(t.accessList||[])];return e&&(n.push(Ie(e.yParity,"yParity")),n.push(it(e.r)),n.push(it(e.s))),Ye(["0x02",Vr(n)])}function nx(t){const e=_o(ke(t).slice(1));G(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",ce(t));const n={type:1,chainId:Ue(e[0],"chainId"),nonce:xi(e[1],"nonce"),gasPrice:Ue(e[2],"gasPrice"),gasLimit:Ue(e[3],"gasLimit"),to:vs(e[4]),value:Ue(e[5],"value"),data:ce(e[6]),accessList:Dc(e[7],"accessList")};return e.length===8||Fc(n,e.slice(8)),n}function rx(t,e){const n=[Ie(t.chainId,"chainId"),Ie(t.nonce,"nonce"),Ie(t.gasPrice||0,"gasPrice"),Ie(t.gasLimit,"gasLimit"),t.to||"0x",Ie(t.value,"value"),t.data,Uc(t.accessList||[])];return e&&(n.push(Ie(e.yParity,"recoveryParam")),n.push(it(e.r)),n.push(it(e.s))),Ye(["0x01",Vr(n)])}function ix(t){let e=_o(ke(t).slice(1)),n="3",r=null;if(e.length===4&&Array.isArray(e[0])){n="3 (network format)";const s=e[1],o=e[2],a=e[3];G(Array.isArray(s),"invalid network format: blobs not an array","fields[1]",s),G(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),G(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),G(s.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),G(s.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),r=[];for(let c=0;c<e[1].length;c++)r.push({data:s[c],commitment:o[c],proof:a[c]});e=e[0]}G(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${n}`,"data",ce(t));const i={type:3,chainId:Ue(e[0],"chainId"),nonce:xi(e[1],"nonce"),maxPriorityFeePerGas:Ue(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Ue(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Ue(e[4],"gasLimit"),to:vs(e[5]),value:Ue(e[6],"value"),data:ce(e[7]),accessList:Dc(e[8],"accessList"),maxFeePerBlobGas:Ue(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};r&&(i.blobs=r),G(i.to!=null,`invalid address for transaction type: ${n}`,"data",t),G(Array.isArray(i.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",t);for(let s=0;s<i.blobVersionedHashes.length;s++)G(Ke(i.blobVersionedHashes[s],32),`invalid blobVersionedHash at index ${s}: must be length 32`,"data",t);return e.length===11||Fc(i,e.slice(11)),i}function sx(t,e,n){const r=[Ie(t.chainId,"chainId"),Ie(t.nonce,"nonce"),Ie(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Ie(t.maxFeePerGas||0,"maxFeePerGas"),Ie(t.gasLimit,"gasLimit"),t.to||ho,Ie(t.value,"value"),t.data,Uc(t.accessList||[]),Ie(t.maxFeePerBlobGas||0,"maxFeePerBlobGas"),Y_(t.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(r.push(Ie(e.yParity,"yParity")),r.push(it(e.r)),r.push(it(e.s)),n)?Ye(["0x03",Vr([r,n.map(i=>i.data),n.map(i=>i.commitment),n.map(i=>i.proof)])]):Ye(["0x03",Vr(r)])}function ox(t){const e=_o(ke(t).slice(1));G(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",ce(t));const n={type:4,chainId:Ue(e[0],"chainId"),nonce:xi(e[1],"nonce"),maxPriorityFeePerGas:Ue(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Ue(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Ue(e[4],"gasLimit"),to:vs(e[5]),value:Ue(e[6],"value"),data:ce(e[7]),accessList:Dc(e[8],"accessList"),authorizationList:Q_(e[9],"authorizationList")};return e.length===10||Fc(n,e.slice(10)),n}function ax(t,e){const n=[Ie(t.chainId,"chainId"),Ie(t.nonce,"nonce"),Ie(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Ie(t.maxFeePerGas||0,"maxFeePerGas"),Ie(t.gasLimit,"gasLimit"),t.to||"0x",Ie(t.value,"value"),t.data,Uc(t.accessList||[]),J_(t.authorizationList||[])];return e&&(n.push(Ie(e.yParity,"yParity")),n.push(it(e.r)),n.push(it(e.s))),Ye(["0x04",Vr(n)])}class gn{#e;#t;#n;#r;#i;#o;#s;#a;#d;#l;#p;#g;#c;#u;#h;#f;#y;get type(){return this.#e}set type(e){switch(e){case null:this.#e=null;break;case 0:case"legacy":this.#e=0;break;case 1:case"berlin":case"eip-2930":this.#e=1;break;case 2:case"london":case"eip-1559":this.#e=2;break;case 3:case"cancun":case"eip-4844":this.#e=3;break;case 4:case"pectra":case"eip-7702":this.#e=4;break;default:G(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=this.#t;return e==null&&this.type===3?ho:e}set to(e){this.#t=e==null?null:De(e)}get nonce(){return this.#r}set nonce(e){this.#r=_e(e,"value")}get gasLimit(){return this.#i}set gasLimit(e){this.#i=he(e)}get gasPrice(){const e=this.#o;return e==null&&(this.type===0||this.type===1)?lt:e}set gasPrice(e){this.#o=e==null?null:he(e,"gasPrice")}get maxPriorityFeePerGas(){const e=this.#s;return e??(this.type===2||this.type===3?lt:null)}set maxPriorityFeePerGas(e){this.#s=e==null?null:he(e,"maxPriorityFeePerGas")}get maxFeePerGas(){const e=this.#a;return e??(this.type===2||this.type===3?lt:null)}set maxFeePerGas(e){this.#a=e==null?null:he(e,"maxFeePerGas")}get data(){return this.#n}set data(e){this.#n=ce(e)}get value(){return this.#d}set value(e){this.#d=he(e,"value")}get chainId(){return this.#l}set chainId(e){this.#l=he(e)}get signature(){return this.#p||null}set signature(e){this.#p=e==null?null:We.from(e)}get accessList(){const e=this.#g||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){this.#g=e==null?null:_i(e)}get authorizationList(){const e=this.#y||null;return e==null&&this.type===4?[]:e}set authorizationList(e){this.#y=e==null?null:e.map(n=>fv(n))}get maxFeePerBlobGas(){const e=this.#c;return e==null&&this.type===3?lt:e}set maxFeePerBlobGas(e){this.#c=e==null?null:he(e,"maxFeePerBlobGas")}get blobVersionedHashes(){let e=this.#u;return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){G(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let n=0;n<e.length;n++)G(Ke(e[n],32),"invalid blobVersionedHash",`value[${n}]`,e[n])}this.#u=e}get blobs(){return this.#f==null?null:this.#f.map(e=>Object.assign({},e))}set blobs(e){if(e==null){this.#f=null;return}const n=[],r=[];for(let i=0;i<e.length;i++){const s=e[i];if(ih(s)){te(this.#h,"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=ke(s);if(G(o.length<=Zl,"blob is too large",`blobs[${i}]`,s),o.length!==Zl){const l=new Uint8Array(Zl);l.set(o),o=l}const a=this.#h.blobToKzgCommitment(o),c=ce(this.#h.computeBlobKzgProof(o,a));n.push({data:ce(o),commitment:ce(a),proof:c}),r.push(N0(1,a))}else{const o=ce(s.commitment);n.push({data:ce(s.data),commitment:o,proof:ce(s.proof)}),r.push(N0(1,o))}}this.#f=n,this.#u=r}get kzg(){return this.#h}set kzg(e){e==null?this.#h=null:this.#h=W_(e)}constructor(){this.#e=null,this.#t=null,this.#r=0,this.#i=lt,this.#o=null,this.#s=null,this.#a=null,this.#n="0x",this.#d=lt,this.#l=lt,this.#p=null,this.#g=null,this.#c=null,this.#u=null,this.#h=null,this.#f=null,this.#y=null}get hash(){return this.signature==null?null:nt(this.#m(!0,!1))}get unsignedHash(){return nt(this.unsignedSerialized)}get from(){return this.signature==null?null:$_(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:Yn.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}#m(e,n){te(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const r=e?this.signature:null;switch(this.inferType()){case 0:return X_(this,r);case 1:return rx(this,r);case 2:return tx(this,r);case 3:return sx(this,r,n?this.blobs:null);case 4:return ax(this,r)}te(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})}get serialized(){return this.#m(!0,!0)}get unsignedSerialized(){return this.#m(!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,n=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,r=this.accessList!=null,i=this.#c!=null||this.#u;this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&te(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),te(!n||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),te(this.type!==0||!r,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const s=[];return this.type!=null?s.push(this.type):this.authorizationList&&this.authorizationList.length?s.push(4):n?s.push(2):e?(s.push(1),r||s.push(0)):r?(s.push(1),s.push(2)):(i&&this.to||(s.push(0),s.push(1),s.push(2)),s.push(3)),s.sort(),s}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return gn.from(this)}toJSON(){const e=n=>n==null?null:n.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new gn;if(typeof e=="string"){const r=ke(e);if(r[0]>=127)return gn.from(Z_(r));switch(r[0]){case 1:return gn.from(nx(r));case 2:return gn.from(ex(r));case 3:return gn.from(ix(r));case 4:return gn.from(ox(r))}te(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const n=new gn;return e.type!=null&&(n.type=e.type),e.to!=null&&(n.to=e.to),e.nonce!=null&&(n.nonce=e.nonce),e.gasLimit!=null&&(n.gasLimit=e.gasLimit),e.gasPrice!=null&&(n.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(n.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(n.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(n.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(n.data=e.data),e.value!=null&&(n.value=e.value),e.chainId!=null&&(n.chainId=e.chainId),e.signature!=null&&(n.signature=We.from(e.signature)),e.accessList!=null&&(n.accessList=e.accessList),e.authorizationList!=null&&(n.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(n.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(n.kzg=e.kzg),e.blobs!=null&&(n.blobs=e.blobs),e.hash!=null&&(G(n.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),G(n.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(G(n.isSigned(),"unsigned transaction cannot define '.from'","tx",e),G(n.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),n}}function yi(t){return nt(sr(t))}var cx="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const M0=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),B0=4;function lx(t){let e=0;function n(){return t[e++]<<8|t[e++]}let r=n(),i=1,s=[0,1];for(let R=1;R<r;R++)s.push(i+=n());let o=n(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|t[e++],c=8),l>>--c&1}const d=31,h=2**d,f=h>>>1,g=f>>1,p=h-1;let y=0;for(let R=0;R<d;R++)y=y<<1|u();let m=[],C=0,v=h;for(;;){let R=Math.floor(((y-C+1)*i-1)/v),L=0,z=r;for(;z-L>1;){let B=L+z>>>1;R<s[B]?z=B:L=B}if(L==0)break;m.push(L);let j=C+Math.floor(v*s[L]/i),D=C+Math.floor(v*s[L+1]/i)-1;for(;((j^D)&f)==0;)y=y<<1&p|u(),j=j<<1&p,D=D<<1&p|1;for(;j&~D&g;)y=y&f|y<<1&p>>>1|u(),j=j<<1^f,D=(D^f)<<1|f|1;C=j,v=1+D-j}let I=r-4;return m.map(R=>{switch(R-I){case 3:return I+65792+(t[a++]<<16|t[a++]<<8|t[a++]);case 2:return I+256+(t[a++]<<8|t[a++]);case 1:return I+t[a++];default:return R-1}})}function ux(t){let e=0;return()=>t[e++]}function pv(t){return ux(lx(dx(t)))}function dx(t){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((i,s)=>e[i.charCodeAt(0)]=s);let n=t.length,r=new Uint8Array(6*n>>3);for(let i=0,s=0,o=0,a=0;i<n;i++)a=a<<6|e[t.charCodeAt(i)],o+=6,o>=8&&(r[s++]=a>>(o-=8));return r}function hx(t){return t&1?~t>>1:t>>1}function fx(t,e){let n=Array(t);for(let r=0,i=0;r<t;r++)n[r]=i+=hx(e());return n}function fo(t,e=0){let n=[];for(;;){let r=t(),i=t();if(!i)break;e+=r;for(let s=0;s<i;s++)n.push(e+s);e+=i+1}return n}function gv(t){return po(()=>{let e=fo(t);if(e.length)return e})}function mv(t){let e=[];for(;;){let n=t();if(n==0)break;e.push(px(n,t))}for(;;){let n=t()-1;if(n<0)break;e.push(gx(n,t))}return e.flat()}function po(t){let e=[];for(;;){let n=t(e.length);if(!n)break;e.push(n)}return e}function yv(t,e,n){let r=Array(t).fill().map(()=>[]);for(let i=0;i<e;i++)fx(t,n).forEach((s,o)=>r[o].push(s));return r}function px(t,e){let n=1+e(),r=e(),i=po(e);return yv(i.length,1+t,e).flatMap((o,a)=>{let[c,...l]=o;return Array(i[a]).fill().map((u,d)=>{let h=d*r;return[c+d*n,l.map(f=>f+h)]})})}function gx(t,e){let n=1+e();return yv(n,1+t,e).map(i=>[i[0],i.slice(1)])}function mx(t){let e=[],n=fo(t);return i(r([]),[]),e;function r(s){let o=t(),a=po(()=>{let c=fo(t).map(l=>n[l]);if(c.length)return r(c)});return{S:o,B:a,Q:s}}function i({S:s,B:o},a,c){if(!(s&4&&c===a[a.length-1])){s&2&&(c=a[a.length-1]),s&1&&e.push(a);for(let l of o)for(let u of l.Q)i(l,[...a,u],c)}}}function yx(t){return t.toString(16).toUpperCase().padStart(2,"0")}function wv(t){return`{${yx(t)}}`}function wx(t){let e=[];for(let n=0,r=t.length;n<r;){let i=t.codePointAt(n);n+=i<65536?1:2,e.push(i)}return e}function hs(t){let n=t.length;if(n<4096)return String.fromCodePoint(...t);let r=[];for(let i=0;i<n;)r.push(String.fromCodePoint(...t.slice(i,i+=4096)));return r.join("")}function vx(t,e){let n=t.length,r=n-e.length;for(let i=0;r==0&&i<n;i++)r=t[i]-e[i];return r}var bx="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const go=44032,hc=4352,fc=4449,pc=4519,vv=19,bv=21,fs=28,gc=bv*fs,Ex=vv*gc,Ax=go+Ex,Sx=hc+vv,Cx=fc+bv,_x=pc+fs;function Ls(t){return t>>24&255}function Ev(t){return t&16777215}let Xu,L0,ed,Ma;function xx(){let t=pv(bx);Xu=new Map(gv(t).flatMap((e,n)=>e.map(r=>[r,n+1<<24]))),L0=new Set(fo(t)),ed=new Map,Ma=new Map;for(let[e,n]of mv(t)){if(!L0.has(e)&&n.length==2){let[r,i]=n,s=Ma.get(r);s||(s=new Map,Ma.set(r,s)),s.set(i,e)}ed.set(e,n.reverse())}}function Av(t){return t>=go&&t<Ax}function kx(t,e){if(t>=hc&&t<Sx&&e>=fc&&e<Cx)return go+(t-hc)*gc+(e-fc)*fs;if(Av(t)&&e>pc&&e<_x&&(t-go)%fs==0)return t+(e-pc);{let n=Ma.get(t);return n&&(n=n.get(e),n)?n:-1}}function Sv(t){Xu||xx();let e=[],n=[],r=!1;function i(s){let o=Xu.get(s);o&&(r=!0,s|=o),e.push(s)}for(let s of t)for(;;){if(s<128)e.push(s);else if(Av(s)){let o=s-go,a=o/gc|0,c=o%gc/fs|0,l=o%fs;i(hc+a),i(fc+c),l>0&&i(pc+l)}else{let o=ed.get(s);o?n.push(...o):i(s)}if(!n.length)break;s=n.pop()}if(r&&e.length>1){let s=Ls(e[0]);for(let o=1;o<e.length;o++){let a=Ls(e[o]);if(a==0||s<=a){s=a;continue}let c=o-1;for(;;){let l=e[c+1];if(e[c+1]=e[c],e[c]=l,!c||(s=Ls(e[--c]),s<=a))break}s=Ls(e[o])}}return e}function Px(t){let e=[],n=[],r=-1,i=0;for(let s of t){let o=Ls(s),a=Ev(s);if(r==-1)o==0?r=a:e.push(a);else if(i>0&&i>=o)o==0?(e.push(r,...n),n.length=0,r=a):n.push(a),i=o;else{let c=kx(r,a);c>=0?r=c:i==0&&o==0?(e.push(r),r=a):(n.push(a),i=o)}}return r>=0&&e.push(r,...n),e}function Cv(t){return Sv(t).map(Ev)}function Tx(t){return Px(Sv(t))}const D0=45,_v=".",xv=65039,kv=1,mc=t=>Array.from(t);function mo(t,e){return t.P.has(e)||t.Q.has(e)}class Ix extends Array{get is_emoji(){return!0}}let td,Pv,ui,nd,Tv,ts,Xl,Li,ei,U0,rd;function gh(){if(td)return;let t=pv(cx);const e=()=>fo(t),n=()=>new Set(e()),r=(u,d)=>d.forEach(h=>u.add(h));td=new Map(mv(t)),Pv=n(),ui=e(),nd=new Set(e().map(u=>ui[u])),ui=new Set(ui),Tv=n(),n();let i=gv(t),s=t();const o=()=>{let u=new Set;return e().forEach(d=>r(u,i[d])),r(u,e()),u};ts=po(u=>{let d=po(t).map(h=>h+96);if(d.length){let h=u>=s;d[0]-=32,d=hs(d),h&&(d=`Restricted[${d}]`);let f=o(),g=o(),p=!t();return{N:d,P:f,Q:g,M:p,R:h}}}),Xl=n(),Li=new Map;let a=e().concat(mc(Xl)).sort((u,d)=>u-d);a.forEach((u,d)=>{let h=t(),f=a[d]=h?a[d-h]:{V:[],M:new Map};f.V.push(u),Xl.has(u)||Li.set(u,f)});for(let{V:u,M:d}of new Set(Li.values())){let h=[];for(let g of u){let p=ts.filter(m=>mo(m,g)),y=h.find(({G:m})=>p.some(C=>m.has(C)));y||(y={G:new Set,V:[]},h.push(y)),y.V.push(g),r(y.G,p)}let f=h.flatMap(g=>mc(g.G));for(let{G:g,V:p}of h){let y=new Set(f.filter(m=>!g.has(m)));for(let m of p)d.set(m,y)}}ei=new Set;let c=new Set;const l=u=>ei.has(u)?c.add(u):ei.add(u);for(let u of ts){for(let d of u.P)l(d);for(let d of u.Q)l(d)}for(let u of ei)!Li.has(u)&&!c.has(u)&&Li.set(u,kv);r(ei,Cv(ei)),U0=mx(t).map(u=>Ix.from(u)).sort(vx),rd=new Map;for(let u of U0){let d=[rd];for(let h of u){let f=d.map(g=>{let p=g.get(h);return p||(p=new Map,g.set(h,p)),p});h===xv?d.push(...f):d=f}for(let h of d)h.V=u}}function mh(t){return(Iv(t)?"":`${yh(Hc([t]))} `)+wv(t)}function yh(t){return`"${t}"â€Ž`}function Ox(t){if(t.length>=4&&t[2]==D0&&t[3]==D0)throw new Error(`invalid label extension: "${hs(t.slice(0,4))}"`)}function Rx(t){for(let n=t.lastIndexOf(95);n>0;)if(t[--n]!==95)throw new Error("underscore allowed only at start")}function Nx(t){let e=t[0],n=M0.get(e);if(n)throw Vs(`leading ${n}`);let r=t.length,i=-1;for(let s=1;s<r;s++){e=t[s];let o=M0.get(e);if(o){if(i==s)throw Vs(`${n} + ${o}`);i=s+1,n=o}}if(i==r)throw Vs(`trailing ${n}`)}function Hc(t,e=1/0,n=wv){let r=[];Mx(t[0])&&r.push("â—Œ"),t.length>e&&(e>>=1,t=[...t.slice(0,e),8230,...t.slice(-e)]);let i=0,s=t.length;for(let o=0;o<s;o++){let a=t[o];Iv(a)&&(r.push(hs(t.slice(i,o))),r.push(n(a)),i=o+1)}return r.push(hs(t.slice(i,s))),r.join("")}function Mx(t){return gh(),ui.has(t)}function Iv(t){return gh(),Tv.has(t)}function Bx(t){return Fx(Lx(t,Tx,$x))}function Lx(t,e,n){if(!t)return[];gh();let r=0;return t.split(_v).map(i=>{let s=wx(i),o={input:s,offset:r};r+=s.length+1;try{let a=o.tokens=Kx(s,e,n),c=a.length,l;if(!c)throw new Error("empty label");let u=o.output=a.flat();if(Rx(u),!(o.emoji=c>1||a[0].is_emoji)&&u.every(h=>h<128))Ox(u),l="ASCII";else{let h=a.flatMap(f=>f.is_emoji?[]:f);if(!h.length)l="Emoji";else{if(ui.has(u[0]))throw Vs("leading combining mark");for(let p=1;p<c;p++){let y=a[p];if(!y.is_emoji&&ui.has(y[0]))throw Vs(`emoji + combining mark: "${hs(a[p-1])} + ${Hc([y[0]])}"`)}Nx(u);let f=mc(new Set(h)),[g]=Ux(f);Hx(g,h),Dx(g,f),l=g.N}}o.type=l}catch(a){o.error=a}return o})}function Dx(t,e){let n,r=[];for(let i of e){let s=Li.get(i);if(s===kv)return;if(s){let o=s.M.get(i);if(n=n?n.filter(a=>o.has(a)):mc(o),!n.length)return}else r.push(i)}if(n){for(let i of n)if(r.every(s=>mo(i,s)))throw new Error(`whole-script confusable: ${t.N}/${i.N}`)}}function Ux(t){let e=ts;for(let n of t){let r=e.filter(i=>mo(i,n));if(!r.length)throw ts.some(i=>mo(i,n))?Rv(e[0],n):Ov(n);if(e=r,r.length==1)break}return e}function Fx(t){return t.map(({input:e,error:n,output:r})=>{if(n){let i=n.message;throw new Error(t.length==1?i:`Invalid label ${yh(Hc(e,63))}: ${i}`)}return hs(r)}).join(_v)}function Ov(t){return new Error(`disallowed character: ${mh(t)}`)}function Rv(t,e){let n=mh(e),r=ts.find(i=>i.P.has(e));return r&&(n=`${r.N} ${n}`),new Error(`illegal mixture: ${t.N} + ${n}`)}function Vs(t){return new Error(`illegal placement: ${t}`)}function Hx(t,e){for(let n of e)if(!mo(t,n))throw Rv(t,n);if(t.M){let n=Cv(e);for(let r=1,i=n.length;r<i;r++)if(nd.has(n[r])){let s=r+1;for(let o;s<i&&nd.has(o=n[s]);s++)for(let a=r;a<s;a++)if(n[a]==o)throw new Error(`duplicate non-spacing marks: ${mh(o)}`);if(s-r>B0)throw new Error(`excessive non-spacing marks: ${yh(Hc(n.slice(r-1,s)))} (${s-r}/${B0})`);r=s}}}function Kx(t,e,n){let r=[],i=[];for(t=t.slice().reverse();t.length;){let s=jx(t);if(s)i.length&&(r.push(e(i)),i=[]),r.push(n(s));else{let o=t.pop();if(ei.has(o))i.push(o);else{let a=td.get(o);if(a)i.push(...a);else if(!Pv.has(o))throw Ov(o)}}}return i.length&&r.push(e(i)),r}function $x(t){return t.filter(e=>e!=xv)}function jx(t,e){let n=rd,r,i=t.length;for(;i&&(n=n.get(t[--i]),!!n);){let{V:s}=n;s&&(r=s,t.length=i)}return r}const Nv=new Uint8Array(32);Nv.fill(0);function F0(t){return G(t.length!==0,"invalid ENS name; empty component","comp",t),t}function Mv(t){const e=sr(zx(t)),n=[];if(t.length===0)return n;let r=0;for(let i=0;i<e.length;i++)e[i]===46&&(n.push(F0(e.slice(r,i))),r=i+1);return G(r<e.length,"invalid ENS name; empty component","name",t),n.push(F0(e.slice(r))),n}function zx(t){try{if(t.length===0)throw new Error("empty label");return Bx(t)}catch(e){G(!1,`invalid ENS name (${e.message})`,"name",t)}}function id(t){G(typeof t=="string","invalid ENS name; not a string","name",t),G(t.length,"invalid ENS name (empty label)","name",t);let e=Nv;const n=Mv(t);for(;n.length;)e=nt(Ye([e,nt(n.pop())]));return ce(e)}function Gx(t,e){const n=e;return G(n<=255,"DNS encoded label cannot exceed 255","length",n),ce(Ye(Mv(t).map(r=>{G(r.length<=n,`label ${JSON.stringify(t)} exceeds ${n} bytes`,"name",t);const i=new Uint8Array(r.length+1);return i.set(r,1),i[0]=i.length-1,i})))+"00"}const Bv=new Uint8Array(32);Bv.fill(0);const Vx=BigInt(-1),Lv=BigInt(0),Dv=BigInt(1),qx=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Wx(t){const e=ke(t),n=e.length%32;return n?Ye([e,Bv.slice(n)]):ce(e)}const Qx=Gr(Dv,32),Jx=Gr(Lv,32),H0={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},eu=["name","version","chainId","verifyingContract","salt"];function K0(t){return function(e){return G(typeof e=="string",`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const Yx={name:K0("name"),version:K0("version"),chainId:function(t){const e=he(t,"domain.chainId");return G(e>=0,"invalid chain ID","domain.chainId",t),Number.isSafeInteger(e)?Number(e):wn(e)},verifyingContract:function(t){try{return De(t).toLowerCase()}catch{}G(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){const e=ke(t,"domain.salt");return G(e.length===32,'invalid domain value "salt"',"domain.salt",t),ce(e)}};function tu(t){{const e=t.match(/^(u?)int(\d+)$/);if(e){const n=e[1]==="",r=parseInt(e[2]);G(r%8===0&&r!==0&&r<=256&&e[2]===String(r),"invalid numeric width","type",t);const i=ci(qx,n?r-1:r),s=n?(i+Dv)*Vx:Lv;return function(o){const a=he(o,"value");return G(a>=s&&a<=i,`value out-of-bounds for ${t}`,"value",a),Gr(n?Cw(a,256):a,32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const n=parseInt(e[1]);return G(n!==0&&n<=32&&e[1]===String(n),"invalid bytes width","type",t),function(r){const i=ke(r);return G(i.length===n,`invalid length for ${t}`,"value",r),Wx(r)}}}switch(t){case"address":return function(e){return cr(De(e),32)};case"bool":return function(e){return e?Qx:Jx};case"bytes":return function(e){return nt(e)};case"string":return function(e){return yi(e)}}return null}function $0(t,e){return`${t}(${e.map(({name:n,type:r})=>r+" "+n).join(",")})`}function da(t){const e=t.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:t}}class Gt{primaryType;#e;get types(){return JSON.parse(this.#e)}#t;#n;constructor(e){this.#t=new Map,this.#n=new Map;const n=new Map,r=new Map,i=new Map,s={};Object.keys(e).forEach(c=>{s[c]=e[c].map(({name:l,type:u})=>{let{base:d,index:h}=da(u);return d==="int"&&!e.int&&(d="int256"),d==="uint"&&!e.uint&&(d="uint256"),{name:l,type:d+(h||"")}}),n.set(c,new Set),r.set(c,[]),i.set(c,new Set)}),this.#e=JSON.stringify(s);for(const c in s){const l=new Set;for(const u of s[c]){G(!l.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(c)}`,"types",e),l.add(u.name);const d=da(u.type).base;G(d!==c,`circular type reference to ${JSON.stringify(d)}`,"types",e),!tu(d)&&(G(r.has(d),`unknown type ${JSON.stringify(d)}`,"types",e),r.get(d).push(c),n.get(c).add(d))}}const o=Array.from(r.keys()).filter(c=>r.get(c).length===0);G(o.length!==0,"missing primary type","types",e),G(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),ve(this,{primaryType:o[0]});function a(c,l){G(!l.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),l.add(c);for(const u of n.get(c))if(r.has(u)){a(u,l);for(const d of l)i.get(d).add(u)}l.delete(c)}a(this.primaryType,new Set);for(const[c,l]of i){const u=Array.from(l);u.sort(),this.#t.set(c,$0(c,s[c])+u.map(d=>$0(d,s[d])).join(""))}}getEncoder(e){let n=this.#n.get(e);return n||(n=this.#r(e),this.#n.set(e,n)),n}#r(e){{const i=tu(e);if(i)return i}const n=da(e).array;if(n){const i=n.prefix,s=this.getEncoder(i);return o=>{G(n.count===-1||n.count===o.length,`array length mismatch; expected length ${n.count}`,"value",o);let a=o.map(s);return this.#t.has(i)&&(a=a.map(nt)),nt(Ye(a))}}const r=this.types[e];if(r){const i=yi(this.#t.get(e));return s=>{const o=r.map(({name:a,type:c})=>{const l=this.getEncoder(c)(s[a]);return this.#t.has(c)?nt(l):l});return o.unshift(i),Ye(o)}}G(!1,`unknown type: ${e}`,"type",e)}encodeType(e){const n=this.#t.get(e);return G(n,`unknown type: ${JSON.stringify(e)}`,"name",e),n}encodeData(e,n){return this.getEncoder(e)(n)}hashStruct(e,n){return nt(this.encodeData(e,n))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,n,r){if(tu(e))return r(e,n);const i=da(e).array;if(i)return G(i.count===-1||i.count===n.length,`array length mismatch; expected length ${i.count}`,"value",n),n.map(o=>this._visit(i.prefix,o,r));const s=this.types[e];if(s)return s.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,n[a],r),o),{});G(!1,`unknown type: ${e}`,"type",e)}visit(e,n){return this._visit(this.primaryType,e,n)}static from(e){return new Gt(e)}static getPrimaryType(e){return Gt.from(e).primaryType}static hashStruct(e,n,r){return Gt.from(n).hashStruct(e,r)}static hashDomain(e){const n=[];for(const r in e){if(e[r]==null)continue;const i=H0[r];G(i,`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",e),n.push({name:r,type:i})}return n.sort((r,i)=>eu.indexOf(r.name)-eu.indexOf(i.name)),Gt.hashStruct("EIP712Domain",{EIP712Domain:n},e)}static encode(e,n,r){return Ye(["0x1901",Gt.hashDomain(e),Gt.from(n).hash(r)])}static hash(e,n,r){return nt(Gt.encode(e,n,r))}static async resolveNames(e,n,r,i){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const s={};e.verifyingContract&&!Ke(e.verifyingContract,20)&&(s[e.verifyingContract]="0x");const o=Gt.from(n);o.visit(r,(a,c)=>(a==="address"&&!Ke(c,20)&&(s[c]="0x"),c));for(const a in s)s[a]=await i(a);return e.verifyingContract&&s[e.verifyingContract]&&(e.verifyingContract=s[e.verifyingContract]),r=o.visit(r,(a,c)=>a==="address"&&s[c]?s[c]:c),{domain:e,value:r}}static getPayload(e,n,r){Gt.hashDomain(e);const i={},s=[];eu.forEach(c=>{const l=e[c];l!=null&&(i[c]=Yx[c](l),s.push({name:c,type:H0[c]}))});const o=Gt.from(n);n=o.types;const a=Object.assign({},n);return G(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",n),a.EIP712Domain=s,o.encode(r),{types:a,domain:i,primaryType:o.primaryType,message:o.visit(r,(c,l)=>{if(c.match(/^bytes(\d*)/))return ce(ke(l));if(c.match(/^u?int/))return he(l).toString();switch(c){case"address":return l.toLowerCase();case"bool":return!!l;case"string":return G(typeof l=="string","invalid string","value",l),l}G(!1,"unsupported type","type",c)})}}}function Rt(t){const e=new Set;return t.forEach(n=>e.add(n)),Object.freeze(e)}const Zx="external public payable override",Xx=Rt(Zx.split(" ")),Uv="constant external internal payable private public pure view override",ek=Rt(Uv.split(" ")),Fv="constructor error event fallback function receive struct",Hv=Rt(Fv.split(" ")),Kv="calldata memory storage payable indexed",tk=Rt(Kv.split(" ")),nk="tuple returns",rk=[Fv,Kv,nk,Uv].join(" "),ik=Rt(rk.split(" ")),sk={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},ok=new RegExp("^(\\s*)"),ak=new RegExp("^([0-9]+)"),ck=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),$v=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),jv=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");class un{#e;#t;get offset(){return this.#e}get length(){return this.#t.length-this.#e}constructor(e){this.#e=0,this.#t=e.slice()}clone(){return new un(this.#t)}reset(){this.#e=0}#n(e=0,n=0){return new un(this.#t.slice(e,n).map(r=>Object.freeze(Object.assign({},r,{match:r.match-e,linkBack:r.linkBack-e,linkNext:r.linkNext-e}))))}popKeyword(e){const n=this.peek();if(n.type!=="KEYWORD"||!e.has(n.text))throw new Error(`expected keyword ${n.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const n=this.peek();throw new Error(`expected ${e}; got ${n.type} ${JSON.stringify(n.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const n=this.#n(this.#e+1,e.match+1);return this.#e=e.match+1,n}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const n=[];for(;this.#e<e.match-1;){const r=this.peek().linkNext;n.push(this.#n(this.#e+1,r)),this.#e=r}return this.#e=e.match+1,n}peek(){if(this.#e>=this.#t.length)throw new Error("out-of-bounds");return this.#t[this.#e]}peekKeyword(e){const n=this.peekType("KEYWORD");return n!=null&&e.has(n)?n:null}peekType(e){if(this.length===0)return null;const n=this.peek();return n.type===e?n.text:null}pop(){const e=this.peek();return this.#e++,e}toString(){const e=[];for(let n=this.#e;n<this.#t.length;n++){const r=this.#t[n];e.push(`${r.type}:${r.text}`)}return`<TokenString ${e.join(" ")}>`}}function qr(t){const e=[],n=o=>{const a=s<t.length?JSON.stringify(t[s]):"$EOI";throw new Error(`invalid token ${a} at ${s}: ${o}`)};let r=[],i=[],s=0;for(;s<t.length;){let o=t.substring(s),a=o.match(ok);a&&(s+=a[1].length,o=t.substring(s));const c={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:s,value:-1};e.push(c);let l=sk[o[0]]||"";if(l){if(c.type=l,c.text=o[0],s++,l==="OPEN_PAREN")r.push(e.length-1),i.push(e.length-1);else if(l=="CLOSE_PAREN")r.length===0&&n("no matching open bracket"),c.match=r.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=i.pop(),e[c.linkBack].linkNext=e.length-1;else if(l==="COMMA")c.linkBack=i.pop(),e[c.linkBack].linkNext=e.length-1,i.push(e.length-1);else if(l==="OPEN_BRACKET")c.type="BRACKET";else if(l==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const d=e.pop().text;u=d+u,e[e.length-1].value=_e(d)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=o.match(ck),a){if(c.text=a[1],s+=c.text.length,ik.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(jv)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(ak),a){c.text=a[1],c.type="NUMBER",s+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${s}`)}return new un(e.map(o=>Object.freeze(o)))}function j0(t,e){let n=[];for(const r in e.keys())t.has(r)&&n.push(r);if(n.length>1)throw new Error(`conflicting types: ${n.join(", ")}`)}function Kc(t,e){if(e.peekKeyword(Hv)){const n=e.pop().text;if(n!==t)throw new Error(`expected ${t}, got ${n}`)}return e.popType("ID")}function ur(t,e){const n=new Set;for(;;){const r=t.peekType("KEYWORD");if(r==null||e&&!e.has(r))break;if(t.pop(),n.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);n.add(r)}return Object.freeze(n)}function zv(t){let e=ur(t,ek);return j0(e,Rt("constant payable nonpayable".split(" "))),j0(e,Rt("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function or(t,e){return t.popParams().map(n=>Fe.from(n,e))}function Gv(t){if(t.peekType("AT")){if(t.pop(),t.peekType("NUMBER"))return he(t.pop().text);throw new Error("invalid gas")}return null}function wi(t){if(t.length)throw new Error(`unexpected tokens at offset ${t.offset}: ${t.toString()}`)}const lk=new RegExp(/^(.*)\[([0-9]*)\]$/);function z0(t){const e=t.match(jv);if(G(e,"invalid type","type",t),t==="uint")return"uint256";if(t==="int")return"int256";if(e[2]){const n=parseInt(e[2]);G(n!==0&&n<=32,"invalid bytes length","type",t)}else if(e[3]){const n=parseInt(e[3]);G(n!==0&&n<=256&&n%8===0,"invalid numeric width","type",t)}return t}const Ge={},Kt=Symbol.for("_ethers_internal"),G0="_ParamTypeInternal",V0="_ErrorInternal",q0="_EventInternal",W0="_ConstructorInternal",Q0="_FallbackInternal",J0="_FunctionInternal",Y0="_StructInternal";class Fe{name;type;baseType;indexed;components;arrayLength;arrayChildren;constructor(e,n,r,i,s,o,a,c){if(Co(e,Ge,"ParamType"),Object.defineProperty(this,Kt,{value:G0}),o&&(o=Object.freeze(o.slice())),i==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(i==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");ve(this,{name:n,type:r,baseType:i,indexed:s,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const r=this.name||"";if(this.isArray()){const s=JSON.parse(this.arrayChildren.format("json"));return s.name=r,s.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(s)}const i={type:this.baseType==="tuple"?"tuple":this.type,name:r};return typeof this.indexed=="boolean"&&(i.indexed=this.indexed),this.isTuple()&&(i.components=this.components.map(s=>JSON.parse(s.format(e)))),JSON.stringify(i)}let n="";return this.isArray()?(n+=this.arrayChildren.format(e),n+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?n+="("+this.components.map(r=>r.format(e)).join(e==="full"?", ":",")+")":n+=this.type,e!=="sighash"&&(this.indexed===!0&&(n+=" indexed"),e==="full"&&this.name&&(n+=" "+this.name)),n}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,n){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const r=this;return e.map(i=>r.arrayChildren.walk(i,n))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const r=this;return e.map((i,s)=>r.components[s].walk(i,n))}return n(this.type,e)}#e(e,n,r,i){if(this.isArray()){if(!Array.isArray(n))throw new Error("invalid array value");if(this.arrayLength!==-1&&n.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=n.slice();a.forEach((c,l)=>{o.#e(e,c,r,u=>{a[l]=u})}),i(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(n))a=n.slice();else{if(n==null||typeof n!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in n))throw new Error(`missing value for component ${c.name}`);return n[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,l)=>{o[l].#e(e,c,r,u=>{a[l]=u})}),i(a);return}const s=r(this.type,n);s.then?e.push(async function(){i(await s)}()):i(s)}async walkAsync(e,n){const r=[],i=[e];return this.#e(r,e,n,s=>{i[0]=s}),r.length&&await Promise.all(r),i[0]}static from(e,n){if(Fe.isParamType(e))return e;if(typeof e=="string")try{return Fe.from(qr(e),n)}catch{G(!1,"invalid param type","obj",e)}else if(e instanceof un){let a="",c="",l=null;ur(e,Rt(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",l=e.popParams().map(p=>Fe.from(p)),a=`tuple(${l.map(p=>p.format()).join(",")})`):(a=z0(e.popType("TYPE")),c=a);let u=null,d=null;for(;e.length&&e.peekType("BRACKET");){const p=e.pop();u=new Fe(Ge,"",a,c,null,l,d,u),d=p.value,a+=p.text,c="array",l=null}let h=null;if(ur(e,tk).has("indexed")){if(!n)throw new Error("");h=!0}const g=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new Fe(Ge,g,a,c,h,l,d,u)}const r=e.name;G(!r||typeof r=="string"&&r.match($v),"invalid name","obj.name",r);let i=e.indexed;i!=null&&(G(n,"parameter cannot be indexed","obj.indexed",e.indexed),i=!!i);let s=e.type,o=s.match(lk);if(o){const a=parseInt(o[2]||"-1"),c=Fe.from({type:o[1],components:e.components});return new Fe(Ge,r||"",s,"array",i,null,a,c)}if(s==="tuple"||s.startsWith("tuple(")||s.startsWith("(")){const a=e.components!=null?e.components.map(l=>Fe.from(l)):null;return new Fe(Ge,r||"",s,"tuple",i,a,null,null)}return s=z0(e.type),new Fe(Ge,r||"",s,s,i,null,null,null)}static isParamType(e){return e&&e[Kt]===G0}}class vi{type;inputs;constructor(e,n,r){Co(e,Ge,"Fragment"),r=Object.freeze(r.slice()),ve(this,{type:n,inputs:r})}static from(e){if(typeof e=="string"){try{vi.from(JSON.parse(e))}catch{}return vi.from(qr(e))}if(e instanceof un)switch(e.peekKeyword(Hv)){case"constructor":return rr.from(e);case"error":return Ut.from(e);case"event":return Rn.from(e);case"fallback":case"receive":return Qn.from(e);case"function":return Nn.from(e);case"struct":return pi.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return rr.from(e);case"error":return Ut.from(e);case"event":return Rn.from(e);case"fallback":case"receive":return Qn.from(e);case"function":return Nn.from(e);case"struct":return pi.from(e)}te(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}G(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return rr.isFragment(e)}static isError(e){return Ut.isFragment(e)}static isEvent(e){return Rn.isFragment(e)}static isFunction(e){return Nn.isFragment(e)}static isStruct(e){return pi.isFragment(e)}}class $c extends vi{name;constructor(e,n,r,i){super(e,n,i),G(typeof r=="string"&&r.match($v),"invalid identifier","name",r),i=Object.freeze(i.slice()),ve(this,{name:r})}}function yo(t,e){return"("+e.map(n=>n.format(t)).join(t==="full"?", ":",")+")"}class Ut extends $c{constructor(e,n,r){super(e,"error",n,r),Object.defineProperty(this,Kt,{value:V0})}get selector(){return yi(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const n=[];return e!=="sighash"&&n.push("error"),n.push(this.name+yo(e,this.inputs)),n.join(" ")}static from(e){if(Ut.isFragment(e))return e;if(typeof e=="string")return Ut.from(qr(e));if(e instanceof un){const n=Kc("error",e),r=or(e);return wi(e),new Ut(Ge,n,r)}return new Ut(Ge,e.name,e.inputs?e.inputs.map(Fe.from):[])}static isFragment(e){return e&&e[Kt]===V0}}class Rn extends $c{anonymous;constructor(e,n,r,i){super(e,"event",n,r),Object.defineProperty(this,Kt,{value:q0}),ve(this,{anonymous:i})}get topicHash(){return yi(this.format("sighash"))}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const n=[];return e!=="sighash"&&n.push("event"),n.push(this.name+yo(e,this.inputs)),e!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(e,n){return n=(n||[]).map(i=>Fe.from(i)),new Rn(Ge,e,n,!1).topicHash}static from(e){if(Rn.isFragment(e))return e;if(typeof e=="string")try{return Rn.from(qr(e))}catch{G(!1,"invalid event fragment","obj",e)}else if(e instanceof un){const n=Kc("event",e),r=or(e,!0),i=!!ur(e,Rt(["anonymous"])).has("anonymous");return wi(e),new Rn(Ge,n,r,i)}return new Rn(Ge,e.name,e.inputs?e.inputs.map(n=>Fe.from(n,!0)):[],!!e.anonymous)}static isFragment(e){return e&&e[Kt]===q0}}class rr extends vi{payable;gas;constructor(e,n,r,i,s){super(e,n,r),Object.defineProperty(this,Kt,{value:W0}),ve(this,{payable:i,gas:s})}format(e){if(te(e!=null&&e!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),e==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const n=[`constructor${yo(e,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(e){if(rr.isFragment(e))return e;if(typeof e=="string")try{return rr.from(qr(e))}catch{G(!1,"invalid constuctor fragment","obj",e)}else if(e instanceof un){ur(e,Rt(["constructor"]));const n=or(e),r=!!ur(e,Xx).has("payable"),i=Gv(e);return wi(e),new rr(Ge,"constructor",n,r,i)}return new rr(Ge,"constructor",e.inputs?e.inputs.map(Fe.from):[],!!e.payable,e.gas!=null?e.gas:null)}static isFragment(e){return e&&e[Kt]===W0}}class Qn extends vi{payable;constructor(e,n,r){super(e,"fallback",n),Object.defineProperty(this,Kt,{value:Q0}),ve(this,{payable:r})}format(e){const n=this.inputs.length===0?"receive":"fallback";if(e==="json"){const r=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:r})}return`${n}()${this.payable?" payable":""}`}static from(e){if(Qn.isFragment(e))return e;if(typeof e=="string")try{return Qn.from(qr(e))}catch{G(!1,"invalid fallback fragment","obj",e)}else if(e instanceof un){const n=e.toString(),r=e.peekKeyword(Rt(["fallback","receive"]));if(G(r,"type must be fallback or receive","obj",n),e.popKeyword(Rt(["fallback","receive"]))==="receive"){const a=or(e);return G(a.length===0,"receive cannot have arguments","obj.inputs",a),ur(e,Rt(["payable"])),wi(e),new Qn(Ge,[],!0)}let s=or(e);s.length?G(s.length===1&&s[0].type==="bytes","invalid fallback inputs","obj.inputs",s.map(a=>a.format("minimal")).join(", ")):s=[Fe.from("bytes")];const o=zv(e);if(G(o==="nonpayable"||o==="payable","fallback cannot be constants","obj.stateMutability",o),ur(e,Rt(["returns"])).has("returns")){const a=or(e);G(a.length===1&&a[0].type==="bytes","invalid fallback outputs","obj.outputs",a.map(c=>c.format("minimal")).join(", "))}return wi(e),new Qn(Ge,s,o==="payable")}if(e.type==="receive")return new Qn(Ge,[],!0);if(e.type==="fallback"){const n=[Fe.from("bytes")],r=e.stateMutability==="payable";return new Qn(Ge,n,r)}G(!1,"invalid fallback description","obj",e)}static isFragment(e){return e&&e[Kt]===Q0}}class Nn extends $c{constant;outputs;stateMutability;payable;gas;constructor(e,n,r,i,s,o){super(e,"function",n,i),Object.defineProperty(this,Kt,{value:J0}),s=Object.freeze(s.slice()),ve(this,{constant:r==="view"||r==="pure",gas:o,outputs:s,payable:r==="payable",stateMutability:r})}get selector(){return yi(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(r=>JSON.parse(r.format(e))),outputs:this.outputs.map(r=>JSON.parse(r.format(e)))});const n=[];return e!=="sighash"&&n.push("function"),n.push(this.name+yo(e,this.inputs)),e!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(yo(e,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(e,n){return n=(n||[]).map(i=>Fe.from(i)),new Nn(Ge,e,"view",n,[],null).selector}static from(e){if(Nn.isFragment(e))return e;if(typeof e=="string")try{return Nn.from(qr(e))}catch{G(!1,"invalid function fragment","obj",e)}else if(e instanceof un){const r=Kc("function",e),i=or(e),s=zv(e);let o=[];ur(e,Rt(["returns"])).has("returns")&&(o=or(e));const a=Gv(e);return wi(e),new Nn(Ge,r,s,i,o,a)}let n=e.stateMutability;return n==null&&(n="payable",typeof e.constant=="boolean"?(n="view",e.constant||(n="payable",typeof e.payable=="boolean"&&!e.payable&&(n="nonpayable"))):typeof e.payable=="boolean"&&!e.payable&&(n="nonpayable")),new Nn(Ge,e.name,n,e.inputs?e.inputs.map(Fe.from):[],e.outputs?e.outputs.map(Fe.from):[],e.gas!=null?e.gas:null)}static isFragment(e){return e&&e[Kt]===J0}}class pi extends $c{constructor(e,n,r){super(e,"struct",n,r),Object.defineProperty(this,Kt,{value:Y0})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return pi.from(qr(e))}catch{G(!1,"invalid struct fragment","obj",e)}else if(e instanceof un){const n=Kc("struct",e),r=or(e);return wi(e),new pi(Ge,n,r)}return new pi(Ge,e.name,e.inputs?e.inputs.map(Fe.from):[])}static isFragment(e){return e&&e[Kt]===Y0}}const Sn=new Map;Sn.set(0,"GENERIC_PANIC");Sn.set(1,"ASSERT_FALSE");Sn.set(17,"OVERFLOW");Sn.set(18,"DIVIDE_BY_ZERO");Sn.set(33,"ENUM_RANGE_ERROR");Sn.set(34,"BAD_STORAGE_DATA");Sn.set(49,"STACK_UNDERFLOW");Sn.set(50,"ARRAY_RANGE_ERROR");Sn.set(65,"OUT_OF_MEMORY");Sn.set(81,"UNINITIALIZED_FUNCTION_CALL");const uk=new RegExp(/^bytes([0-9]*)$/),dk=new RegExp(/^(u?int)([0-9]*)$/);let nu=null,Z0=1024;function hk(t,e,n,r){let i="missing revert data",s=null;const o=null;let a=null;if(n){i="execution reverted";const l=ke(n);if(n=ce(n),l.length===0)i+=" (no data present; likely require(false) occurred",s="require(false)";else if(l.length%32!==4)i+=" (could not decode reason; invalid data length)";else if(ce(l.slice(0,4))==="0x08c379a0")try{s=r.decode(["string"],l.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[s]},i+=`: ${JSON.stringify(s)}`}catch{i+=" (could not decode reason; invalid string data)"}else if(ce(l.slice(0,4))==="0x4e487b71")try{const u=Number(r.decode(["uint256"],l.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},s=`Panic due to ${Sn.get(u)||"UNKNOWN"}(${u})`,i+=`: ${s}`}catch{i+=" (could not decode panic code)"}else i+=" (unknown custom error)"}const c={to:e.to?De(e.to):null,data:e.data||"0x"};return e.from&&(c.from=De(e.from)),$e(i,"CALL_EXCEPTION",{action:t,data:n,reason:s,transaction:c,invocation:o,revert:a})}class ps{#e(e){if(e.isArray())return new I_(this.#e(e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new ua(e.components.map(r=>this.#e(r)),e.name);switch(e.baseType){case"address":return new P_(e.name);case"bool":return new O_(e.name);case"string":return new H_(e.name);case"bytes":return new R_(e.name);case"":return new B_(e.name)}let n=e.type.match(dk);if(n){let r=parseInt(n[2]||"256");return G(r!==0&&r<=256&&r%8===0,"invalid "+n[1]+" bit length","param",e),new F_(r/8,n[1]==="int",e.name)}if(n=e.type.match(uk),n){let r=parseInt(n[1]);return G(r!==0&&r<=32,"invalid bytes length","param",e),new N_(r,e.name)}G(!1,"invalid type","type",e.type)}getDefaultValue(e){const n=e.map(i=>this.#e(Fe.from(i)));return new ua(n,"_").defaultValue()}encode(e,n){Ew(n.length,e.length,"types/values length mismatch");const r=e.map(o=>this.#e(Fe.from(o))),i=new ua(r,"_"),s=new qu;return i.encode(s,n),s.data}decode(e,n,r){const i=e.map(o=>this.#e(Fe.from(o)));return new ua(i,"_").decode(new sh(n,r,Z0))}static _setDefaultMaxInflation(e){G(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),Z0=e}static defaultAbiCoder(){return nu==null&&(nu=new ps),nu}static getBuiltinCallException(e,n,r){return hk(e,n,r,ps.defaultAbiCoder())}}class fk{fragment;name;signature;topic;args;constructor(e,n,r){const i=e.name,s=e.format();ve(this,{fragment:e,name:i,signature:s,topic:n,args:r})}}class pk{fragment;name;args;signature;selector;value;constructor(e,n,r,i){const s=e.name,o=e.format();ve(this,{fragment:e,name:s,args:r,signature:o,selector:n,value:i})}}class gk{fragment;name;args;signature;selector;constructor(e,n,r){const i=e.name,s=e.format();ve(this,{fragment:e,name:i,args:r,signature:s,selector:n})}}class X0{hash;_isIndexed;static isIndexed(e){return!!(e&&e._isIndexed)}constructor(e){ve(this,{hash:e,_isIndexed:!0})}}const eg={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},tg={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:t=>`reverted with reason string ${JSON.stringify(t)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:t=>{let e="unknown panic code";return t>=0&&t<=255&&eg[t.toString()]&&(e=eg[t.toString()]),`reverted with panic code 0x${t.toString(16)} (${e})`}}};class ri{fragments;deploy;fallback;receive;#e;#t;#n;#r;constructor(e){let n=[];typeof e=="string"?n=JSON.parse(e):n=e,this.#n=new Map,this.#e=new Map,this.#t=new Map;const r=[];for(const o of n)try{r.push(vi.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}ve(this,{fragments:Object.freeze(r)});let i=null,s=!1;this.#r=this.getAbiCoder(),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}ve(this,{deploy:o});return;case"fallback":o.inputs.length===0?s=!0:(G(!i||o.payable!==i.payable,"conflicting fallback fragments",`fragments[${a}]`,o),i=o,s=i.payable);return;case"function":c=this.#n;break;case"event":c=this.#t;break;case"error":c=this.#e;break;default:return}const l=o.format();c.has(l)||c.set(l,o)}),this.deploy||ve(this,{deploy:rr.from("constructor()")}),ve(this,{fallback:i,receive:s})}format(e){const n=e?"minimal":"full";return this.fragments.map(i=>i.format(n))}formatJson(){const e=this.fragments.map(n=>n.format("json"));return JSON.stringify(e.map(n=>JSON.parse(n)))}getAbiCoder(){return ps.defaultAbiCoder()}#i(e,n,r){if(Ke(e)){const s=e.toLowerCase();for(const o of this.#n.values())if(s===o.selector)return o;return null}if(e.indexOf("(")===-1){const s=[];for(const[o,a]of this.#n)o.split("(")[0]===e&&s.push(a);if(n){const o=n.length>0?n[n.length-1]:null;let a=n.length,c=!0;Je.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let l=s.length-1;l>=0;l--){const u=s[l].inputs.length;u!==a&&(!c||u!==a-1)&&s.splice(l,1)}for(let l=s.length-1;l>=0;l--){const u=s[l].inputs;for(let d=0;d<n.length;d++)if(Je.isTyped(n[d])){if(d>=u.length){if(n[d].type==="overrides")continue;s.splice(l,1);break}if(n[d].type!==u[d].baseType){s.splice(l,1);break}}}}if(s.length===1&&n&&n.length!==s[0].inputs.length){const o=n[n.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&s.splice(0,1)}if(s.length===0)return null;if(s.length>1&&r){const o=s.map(a=>JSON.stringify(a.format())).join(", ");G(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return s[0]}const i=this.#n.get(Nn.from(e).format());return i||null}getFunctionName(e){const n=this.#i(e,null,!1);return G(n,"no matching function","key",e),n.name}hasFunction(e){return!!this.#i(e,null,!1)}getFunction(e,n){return this.#i(e,n||null,!0)}forEachFunction(e){const n=Array.from(this.#n.keys());n.sort((r,i)=>r.localeCompare(i));for(let r=0;r<n.length;r++){const i=n[r];e(this.#n.get(i),r)}}#o(e,n,r){if(Ke(e)){const s=e.toLowerCase();for(const o of this.#t.values())if(s===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const s=[];for(const[o,a]of this.#t)o.split("(")[0]===e&&s.push(a);if(n){for(let o=s.length-1;o>=0;o--)s[o].inputs.length<n.length&&s.splice(o,1);for(let o=s.length-1;o>=0;o--){const a=s[o].inputs;for(let c=0;c<n.length;c++)if(Je.isTyped(n[c])&&n[c].type!==a[c].baseType){s.splice(o,1);break}}}if(s.length===0)return null;if(s.length>1&&r){const o=s.map(a=>JSON.stringify(a.format())).join(", ");G(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return s[0]}const i=this.#t.get(Rn.from(e).format());return i||null}getEventName(e){const n=this.#o(e,null,!1);return G(n,"no matching event","key",e),n.name}hasEvent(e){return!!this.#o(e,null,!1)}getEvent(e,n){return this.#o(e,n||null,!0)}forEachEvent(e){const n=Array.from(this.#t.keys());n.sort((r,i)=>r.localeCompare(i));for(let r=0;r<n.length;r++){const i=n[r];e(this.#t.get(i),r)}}getError(e,n){if(Ke(e)){const i=e.toLowerCase();if(tg[i])return Ut.from(tg[i].signature);for(const s of this.#e.values())if(i===s.selector)return s;return null}if(e.indexOf("(")===-1){const i=[];for(const[s,o]of this.#e)s.split("(")[0]===e&&i.push(o);if(i.length===0)return e==="Error"?Ut.from("error Error(string)"):e==="Panic"?Ut.from("error Panic(uint256)"):null;if(i.length>1){const s=i.map(o=>JSON.stringify(o.format())).join(", ");G(!1,`ambiguous error description (i.e. ${s})`,"name",e)}return i[0]}if(e=Ut.from(e).format(),e==="Error(string)")return Ut.from("error Error(string)");if(e==="Panic(uint256)")return Ut.from("error Panic(uint256)");const r=this.#e.get(e);return r||null}forEachError(e){const n=Array.from(this.#e.keys());n.sort((r,i)=>r.localeCompare(i));for(let r=0;r<n.length;r++){const i=n[r];e(this.#e.get(i),r)}}_decodeParams(e,n){return this.#r.decode(e,n)}_encodeParams(e,n){return this.#r.encode(e,n)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,n){if(typeof e=="string"){const r=this.getError(e);G(r,"unknown error","fragment",e),e=r}return G(qe(n,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",n),this._decodeParams(e.inputs,qe(n,4))}encodeErrorResult(e,n){if(typeof e=="string"){const r=this.getError(e);G(r,"unknown error","fragment",e),e=r}return Ye([e.selector,this._encodeParams(e.inputs,n||[])])}decodeFunctionData(e,n){if(typeof e=="string"){const r=this.getFunction(e);G(r,"unknown function","fragment",e),e=r}return G(qe(n,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",n),this._decodeParams(e.inputs,qe(n,4))}encodeFunctionData(e,n){if(typeof e=="string"){const r=this.getFunction(e);G(r,"unknown function","fragment",e),e=r}return Ye([e.selector,this._encodeParams(e.inputs,n||[])])}decodeFunctionResult(e,n){if(typeof e=="string"){const s=this.getFunction(e);G(s,"unknown function","fragment",e),e=s}let r="invalid length for result data";const i=Pt(n);if(i.length%32===0)try{return this.#r.decode(e.outputs,i)}catch{r="could not decode result data"}te(!1,r,"BAD_DATA",{value:ce(i),info:{method:e.name,signature:e.format()}})}makeError(e,n){const r=ke(e,"data"),i=ps.getBuiltinCallException("call",n,r);if(i.message.startsWith("execution reverted (unknown custom error)")){const a=ce(r.slice(0,4)),c=this.getError(a);if(c)try{const l=this.#r.decode(c.inputs,r.slice(4));i.revert={name:c.name,signature:c.format(),args:l},i.reason=i.revert.signature,i.message=`execution reverted: ${i.reason}`}catch{i.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(n);return o&&(i.invocation={method:o.name,signature:o.signature,args:o.args}),i}encodeFunctionResult(e,n){if(typeof e=="string"){const r=this.getFunction(e);G(r,"unknown function","fragment",e),e=r}return ce(this.#r.encode(e.outputs,n||[]))}encodeFilterTopics(e,n){if(typeof e=="string"){const s=this.getEvent(e);G(s,"unknown event","eventFragment",e),e=s}te(n.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:n.length,expectedCount:e.inputs.length});const r=[];e.anonymous||r.push(e.topicHash);const i=(s,o)=>s.type==="string"?yi(o):s.type==="bytes"?nt(ce(o)):(s.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":s.type.match(/^u?int/)?o=Gr(o):s.type.match(/^bytes/)?o=RS(o,32):s.type==="address"&&this.#r.encode(["address"],[o]),cr(ce(o),32));for(n.forEach((s,o)=>{const a=e.inputs[o];if(!a.indexed){G(s==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,s);return}s==null?r.push(null):a.baseType==="array"||a.baseType==="tuple"?G(!1,"filtering with tuples or arrays not supported","contract."+a.name,s):Array.isArray(s)?r.push(s.map(c=>i(a,c))):r.push(i(a,s))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,n){if(typeof e=="string"){const o=this.getEvent(e);G(o,"unknown event","eventFragment",e),e=o}const r=[],i=[],s=[];return e.anonymous||r.push(e.topicHash),G(n.length===e.inputs.length,"event arguments/values mismatch","values",n),e.inputs.forEach((o,a)=>{const c=n[a];if(o.indexed)if(o.type==="string")r.push(yi(c));else if(o.type==="bytes")r.push(nt(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");r.push(this.#r.encode([o.type],[c]))}else i.push(o),s.push(c)}),{data:this.#r.encode(i,s),topics:r}}decodeEventLog(e,n,r){if(typeof e=="string"){const f=this.getEvent(e);G(f,"unknown event","eventFragment",e),e=f}if(r!=null&&!e.anonymous){const f=e.topicHash;G(Ke(r[0],32)&&r[0].toLowerCase()===f,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}const i=[],s=[],o=[];e.inputs.forEach((f,g)=>{f.indexed?f.type==="string"||f.type==="bytes"||f.baseType==="tuple"||f.baseType==="array"?(i.push(Fe.from({type:"bytes32",name:f.name})),o.push(!0)):(i.push(f),o.push(!1)):(s.push(f),o.push(!1))});const a=r!=null?this.#r.decode(i,Ye(r)):null,c=this.#r.decode(s,n,!0),l=[],u=[];let d=0,h=0;return e.inputs.forEach((f,g)=>{let p=null;if(f.indexed)if(a==null)p=new X0(null);else if(o[g])p=new X0(a[h++]);else try{p=a[h++]}catch(y){p=y}else try{p=c[d++]}catch(y){p=y}l.push(p),u.push(f.name||null)}),nr.fromItems(l,u)}parseTransaction(e){const n=ke(e.data,"tx.data"),r=he(e.value!=null?e.value:0,"tx.value"),i=this.getFunction(ce(n.slice(0,4)));if(!i)return null;const s=this.#r.decode(i.inputs,n.slice(4));return new pk(i,i.selector,s,r)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const n=this.getEvent(e.topics[0]);return!n||n.anonymous?null:new fk(n,n.topicHash,this.decodeEventLog(n,e.data,e.topics))}parseError(e){const n=ce(e),r=this.getError(qe(n,0,4));if(!r)return null;const i=this.#r.decode(r.inputs,qe(n,4));return new gk(r,r.selector,i)}static from(e){return e instanceof ri?e:typeof e=="string"?new ri(JSON.parse(e)):typeof e.formatJson=="function"?new ri(e.formatJson()):typeof e.format=="function"?new ri(e.format("json")):new ri(e)}}const Vv=BigInt(0);function ns(t){return t??null}function Xe(t){return t==null?null:t.toString()}class ng{gasPrice;maxFeePerGas;maxPriorityFeePerGas;constructor(e,n,r){ve(this,{gasPrice:ns(e),maxFeePerGas:ns(n),maxPriorityFeePerGas:ns(r)})}toJSON(){const{gasPrice:e,maxFeePerGas:n,maxPriorityFeePerGas:r}=this;return{_type:"FeeData",gasPrice:Xe(e),maxFeePerGas:Xe(n),maxPriorityFeePerGas:Xe(r)}}}function yc(t){const e={};t.to&&(e.to=t.to),t.from&&(e.from=t.from),t.data&&(e.data=ce(t.data));const n="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const i of n)!(i in t)||t[i]==null||(e[i]=he(t[i],`request.${i}`));const r="type,nonce".split(/,/);for(const i of r)!(i in t)||t[i]==null||(e[i]=_e(t[i],`request.${i}`));return t.accessList&&(e.accessList=_i(t.accessList)),t.authorizationList&&(e.authorizationList=t.authorizationList.slice()),"blockTag"in t&&(e.blockTag=t.blockTag),"enableCcipRead"in t&&(e.enableCcipRead=!!t.enableCcipRead),"customData"in t&&(e.customData=t.customData),"blobVersionedHashes"in t&&t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.slice()),"kzg"in t&&(e.kzg=t.kzg),"blobs"in t&&t.blobs&&(e.blobs=t.blobs.map(i=>ih(i)?ce(i):Object.assign({},i))),e}class mk{provider;number;hash;timestamp;parentHash;parentBeaconBlockRoot;nonce;difficulty;gasLimit;gasUsed;stateRoot;receiptsRoot;blobGasUsed;excessBlobGas;miner;prevRandao;extraData;baseFeePerGas;#e;constructor(e,n){this.#e=e.transactions.map(r=>typeof r!="string"?new Po(r,n):r),ve(this,{provider:n,hash:ns(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:ns(e.prevRandao),extraData:e.extraData,baseFeePerGas:ns(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return this.#e.map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=this.#e.slice();return e.length===0?[]:(te(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:n,extraData:r,gasLimit:i,gasUsed:s,hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:d,parentBeaconBlockRoot:h,stateRoot:f,receiptsRoot:g,timestamp:p,transactions:y}=this;return{_type:"Block",baseFeePerGas:Xe(e),difficulty:Xe(n),extraData:r,gasLimit:Xe(i),gasUsed:Xe(s),blobGasUsed:Xe(this.blobGasUsed),excessBlobGas:Xe(this.excessBlobGas),hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:d,timestamp:p,parentBeaconBlockRoot:h,stateRoot:f,receiptsRoot:g,transactions:y}}[Symbol.iterator](){let e=0;const n=this.transactions;return{next:()=>e<this.length?{value:n[e++],done:!1}:{value:void 0,done:!0}}}get length(){return this.#e.length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let n;if(typeof e=="number")n=this.#e[e];else{const r=e.toLowerCase();for(const i of this.#e)if(typeof i=="string"){if(i!==r)continue;n=i;break}else{if(i.hash!==r)continue;n=i;break}}if(n==null)throw new Error("no such tx");return typeof n=="string"?await this.provider.getTransaction(n):n}getPrefetchedTransaction(e){const n=this.prefetchedTransactions;if(typeof e=="number")return n[e];e=e.toLowerCase();for(const r of n)if(r.hash===e)return r;G(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return yk(this)}}class ko{provider;transactionHash;blockHash;blockNumber;removed;address;data;topics;index;transactionIndex;constructor(e,n){this.provider=n;const r=Object.freeze(e.topics.slice());ve(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:r,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:n,blockNumber:r,data:i,index:s,removed:o,topics:a,transactionHash:c,transactionIndex:l}=this;return{_type:"log",address:e,blockHash:n,blockNumber:r,data:i,index:s,removed:o,topics:a,transactionHash:c,transactionIndex:l}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return te(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return te(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return te(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return wk(this)}}class qv{provider;to;from;contractAddress;hash;index;blockHash;blockNumber;logsBloom;gasUsed;blobGasUsed;cumulativeGasUsed;gasPrice;blobGasPrice;type;status;root;#e;constructor(e,n){this.#e=Object.freeze(e.logs.map(i=>new ko(i,n)));let r=Vv;e.effectiveGasPrice!=null?r=e.effectiveGasPrice:e.gasPrice!=null&&(r=e.gasPrice),ve(this,{provider:n,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:r,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return this.#e}toJSON(){const{to:e,from:n,contractAddress:r,hash:i,index:s,blockHash:o,blockNumber:a,logsBloom:c,logs:l,status:u,root:d}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:r,cumulativeGasUsed:Xe(this.cumulativeGasUsed),from:n,gasPrice:Xe(this.gasPrice),blobGasUsed:Xe(this.blobGasUsed),blobGasPrice:Xe(this.blobGasPrice),gasUsed:Xe(this.gasUsed),hash:i,index:s,logs:l,logsBloom:c,root:d,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return Qv(this)}reorderedEvent(e){return te(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),Wv(this,e)}}class Po{provider;blockNumber;blockHash;index;hash;type;to;from;nonce;gasLimit;gasPrice;maxPriorityFeePerGas;maxFeePerGas;maxFeePerBlobGas;data;value;chainId;signature;accessList;blobVersionedHashes;authorizationList;#e;constructor(e,n){this.provider=n,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,this.#e=-1}toJSON(){const{blockNumber:e,blockHash:n,index:r,hash:i,type:s,to:o,from:a,nonce:c,data:l,signature:u,accessList:d,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:d,blockNumber:e,blockHash:n,blobVersionedHashes:h,chainId:Xe(this.chainId),data:l,from:a,gasLimit:Xe(this.gasLimit),gasPrice:Xe(this.gasPrice),hash:i,maxFeePerGas:Xe(this.maxFeePerGas),maxPriorityFeePerGas:Xe(this.maxPriorityFeePerGas),maxFeePerBlobGas:Xe(this.maxFeePerBlobGas),nonce:c,signature:u,to:o,index:r,type:s,value:Xe(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const r=await this.getTransaction();r&&(e=r.blockNumber)}if(e==null)return null;const n=this.provider.getBlock(e);if(n==null)throw new Error("TODO");return n}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:n,blockNumber:r}=await _t({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return n==null||n.blockNumber==null?0:r-n.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,n){const r=e??1,i=n??0;let s=this.#e,o=-1,a=s===-1;const c=async()=>{if(a)return null;const{blockNumber:h,nonce:f}=await _t({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(f<this.nonce){s=h;return}if(a)return null;const g=await this.getTransaction();if(!(g&&g.blockNumber!=null))for(o===-1&&(o=s-3,o<this.#e&&(o=this.#e));o<=h;){if(a)return null;const p=await this.provider.getBlock(o,!0);if(p==null)return;for(const y of p)if(y===this.hash)return;for(let y=0;y<p.length;y++){const m=await p.getTransaction(y);if(m.from===this.from&&m.nonce===this.nonce){if(a)return null;const C=await this.provider.getTransactionReceipt(m.hash);if(C==null||h-C.blockNumber+1<r)return;let v="replaced";m.data===this.data&&m.to===this.to&&m.value===this.value?v="repriced":m.data==="0x"&&m.from===m.to&&m.value===Vv&&(v="cancelled"),te(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:v==="replaced"||v==="cancelled",reason:v,replacement:m.replaceableTransaction(s),hash:m.hash,receipt:C})}}o++}},l=h=>{if(h==null||h.status!==0)return h;te(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:h.to,from:h.from,data:""},receipt:h})},u=await this.provider.getTransactionReceipt(this.hash);if(r===0)return l(u);if(u){if(r===1||await u.confirmations()>=r)return l(u)}else if(await c(),r===0)return null;return await new Promise((h,f)=>{const g=[],p=()=>{g.forEach(m=>m())};if(g.push(()=>{a=!0}),i>0){const m=setTimeout(()=>{p(),f($e("wait for transaction timeout","TIMEOUT"))},i);g.push(()=>{clearTimeout(m)})}const y=async m=>{if(await m.confirmations()>=r){p();try{h(l(m))}catch(C){f(C)}}};if(g.push(()=>{this.provider.off(this.hash,y)}),this.provider.on(this.hash,y),s>=0){const m=async()=>{try{await c()}catch(C){if(yt(C,"TRANSACTION_REPLACED")){p(),f(C);return}}a||this.provider.once("block",m)};g.push(()=>{this.provider.off("block",m)}),this.provider.once("block",m)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return te(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Qv(this)}reorderedEvent(e){return te(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),te(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Wv(this,e)}replaceableTransaction(e){G(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const n=new Po(this,this.provider);return n.#e=e,n}}function yk(t){return{orphan:"drop-block",hash:t.hash,number:t.number}}function Wv(t,e){return{orphan:"reorder-transaction",tx:t,other:e}}function Qv(t){return{orphan:"drop-transaction",tx:t}}function wk(t){return{orphan:"drop-log",log:{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,address:t.address,data:t.data,topics:Object.freeze(t.topics.slice()),index:t.index}}}class wh extends ko{interface;fragment;args;constructor(e,n,r){super(e,e.provider);const i=n.decodeEventLog(r,e.data,e.topics);ve(this,{args:i,fragment:r,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Jv extends ko{error;constructor(e,n){super(e,e.provider),ve(this,{error:n})}}class vk extends qv{#e;constructor(e,n,r){super(r,n),this.#e=e}get logs(){return super.logs.map(e=>{const n=e.topics.length?this.#e.getEvent(e.topics[0]):null;if(n)try{return new wh(e,this.#e,n)}catch(r){return new Jv(e,r)}return e})}}class vh extends Po{#e;constructor(e,n,r){super(r,n),this.#e=e}async wait(e,n){const r=await super.wait(e,n);return r==null?null:new vk(this.#e,this.provider,r)}}class Yv extends _w{log;constructor(e,n,r,i){super(e,n,r),ve(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class bk extends Yv{constructor(e,n,r,i,s){super(e,n,r,new wh(s,e.interface,i));const o=e.interface.decodeEventLog(i,this.log.data,this.log.topics);ve(this,{args:o,fragment:i})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const rg=BigInt(0);function Zv(t){return t&&typeof t.call=="function"}function Xv(t){return t&&typeof t.estimateGas=="function"}function jc(t){return t&&typeof t.resolveName=="function"}function eb(t){return t&&typeof t.sendTransaction=="function"}function tb(t){if(t!=null){if(jc(t))return t;if(t.provider)return t.provider}}class Ek{#e;fragment;constructor(e,n,r){if(ve(this,{fragment:n}),n.inputs.length<r.length)throw new Error("too many arguments");const i=bi(e.runner,"resolveName"),s=jc(i)?i:null;this.#e=async function(){const o=await Promise.all(n.inputs.map((a,c)=>r[c]==null?null:a.walkAsync(r[c],(u,d)=>u==="address"?Array.isArray(d)?Promise.all(d.map(h=>Ot(h,s))):Ot(d,s):d)));return e.interface.encodeFilterTopics(n,o)}()}getTopicFilter(){return this.#e}}function bi(t,e){return t==null?null:typeof t[e]=="function"?t:t.provider&&typeof t.provider[e]=="function"?t.provider:null}function di(t){return t==null?null:t.provider||null}async function nb(t,e){const n=Je.dereference(t,"overrides");G(typeof n=="object","invalid overrides parameter","overrides",t);const r=yc(n);return G(r.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),G(r.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function Ak(t,e,n){const r=bi(t,"resolveName"),i=jc(r)?r:null;return await Promise.all(e.map((s,o)=>s.walkAsync(n[o],(a,c)=>(c=Je.dereference(c,a),a==="address"?Ot(c,i):c))))}function Sk(t){const e=async function(o){const a=await nb(o,["data"]);a.to=await t.getAddress(),a.from&&(a.from=await Ot(a.from,tb(t.runner)));const c=t.interface,l=he(a.value||rg,"overrides.value")===rg,u=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!u&&!l&&G(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),G(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);const d=c.receive||c.fallback&&c.fallback.payable;return G(d||l,"cannot send value to non-payable fallback","overrides.value",a.value),G(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},n=async function(o){const a=bi(t.runner,"call");te(Zv(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await a.call(c)}catch(l){throw rh(l)&&l.data?t.interface.makeError(l.data,c):l}},r=async function(o){const a=t.runner;te(eb(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await a.sendTransaction(await e(o)),l=di(t.runner);return new vh(t.interface,l,c)},i=async function(o){const a=bi(t.runner,"estimateGas");return te(Xv(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},s=async o=>await r(o);return ve(s,{_contract:t,estimateGas:i,populateTransaction:e,send:r,staticCall:n}),s}function Ck(t,e){const n=function(...l){const u=t.interface.getFunction(e,l);return te(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:l}}),u},r=async function(...l){const u=n(...l);let d={};if(u.inputs.length+1===l.length&&(d=await nb(l.pop()),d.from&&(d.from=await Ot(d.from,tb(t.runner)))),u.inputs.length!==l.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const h=await Ak(t.runner,u.inputs,l);return Object.assign({},d,await _t({to:t.getAddress(),data:t.interface.encodeFunctionData(u,h)}))},i=async function(...l){const u=await a(...l);return u.length===1?u[0]:u},s=async function(...l){const u=t.runner;te(eb(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const d=await u.sendTransaction(await r(...l)),h=di(t.runner);return new vh(t.interface,h,d)},o=async function(...l){const u=bi(t.runner,"estimateGas");return te(Xv(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await r(...l))},a=async function(...l){const u=bi(t.runner,"call");te(Zv(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const d=await r(...l);let h="0x";try{h=await u.call(d)}catch(g){throw rh(g)&&g.data?t.interface.makeError(g.data,d):g}const f=n(...l);return t.interface.decodeFunctionResult(f,h)},c=async(...l)=>n(...l).constant?await i(...l):await s(...l);return ve(c,{name:t.interface.getFunctionName(e),_contract:t,_key:e,getFragment:n,estimateGas:o,populateTransaction:r,send:s,staticCall:i,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const l=t.interface.getFunction(e);return te(l,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),l}}),c}function _k(t,e){const n=function(...i){const s=t.interface.getEvent(e,i);return te(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:i}}),s},r=function(...i){return new Ek(t,n(...i),i)};return ve(r,{name:t.interface.getEventName(e),_contract:t,_key:e,getFragment:n}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const i=t.interface.getEvent(e);return te(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),i}}),r}const wc=Symbol.for("_ethersInternal_contract"),rb=new WeakMap;function xk(t,e){rb.set(t[wc],e)}function Vt(t){return rb.get(t[wc])}function kk(t){return t&&typeof t=="object"&&"getTopicFilter"in t&&typeof t.getTopicFilter=="function"&&t.fragment}async function bh(t,e){let n,r=null;if(Array.isArray(e)){const s=function(o){if(Ke(o,32))return o;const a=t.interface.getEvent(o);return G(a,"unknown fragment","name",o),a.topicHash};n=e.map(o=>o==null?null:Array.isArray(o)?o.map(s):s(o))}else e==="*"?n=[null]:typeof e=="string"?Ke(e,32)?n=[e]:(r=t.interface.getEvent(e),G(r,"unknown fragment","event",e),n=[r.topicHash]):kk(e)?n=await e.getTopicFilter():"fragment"in e?(r=e.fragment,n=[r.topicHash]):G(!1,"unknown event name","event",e);n=n.map(s=>{if(s==null)return null;if(Array.isArray(s)){const o=Array.from(new Set(s.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return s.toLowerCase()});const i=n.map(s=>s==null?"null":Array.isArray(s)?s.join("|"):s).join("&");return{fragment:r,tag:i,topics:n}}async function Ds(t,e){const{subs:n}=Vt(t);return n.get((await bh(t,e)).tag)||null}async function ig(t,e,n){const r=di(t.runner);te(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:i,tag:s,topics:o}=await bh(t,n),{addr:a,subs:c}=Vt(t);let l=c.get(s);if(!l){const d={address:a||t,topics:o},h=y=>{let m=i;if(m==null)try{m=t.interface.getEvent(y.topics[0])}catch{}if(m){const C=m,v=i?t.interface.decodeEventLog(i,y.data,y.topics):[];od(t,n,v,I=>new bk(t,I,n,C,y))}else od(t,n,[],C=>new Yv(t,C,n,y))};let f=[];l={tag:s,listeners:[],start:()=>{f.length||f.push(r.on(d,h))},stop:async()=>{if(f.length==0)return;let y=f;f=[],await Promise.all(y),r.off(d,h)}},c.set(s,l)}return l}let sd=Promise.resolve();async function Pk(t,e,n,r){await sd;const i=await Ds(t,e);if(!i)return!1;const s=i.listeners.length;return i.listeners=i.listeners.filter(({listener:o,once:a})=>{const c=Array.from(n);r&&c.push(r(a?null:o));try{o.call(t,...c)}catch{}return!a}),i.listeners.length===0&&(i.stop(),Vt(t).subs.delete(i.tag)),s>0}async function od(t,e,n,r){try{await sd}catch{}const i=Pk(t,e,n,r);return sd=i,await i}const ha=["then"];class qs{target;interface;runner;filters;[wc];fallback;constructor(e,n,r,i){G(typeof e=="string"||lv(e),"invalid value for Contract target","target",e),r==null&&(r=null);const s=ri.from(n);ve(this,{target:e,runner:r,interface:s}),Object.defineProperty(this,wc,{value:{}});let o,a=null,c=null;if(i){const d=di(r);c=new vh(this.interface,d,i)}let l=new Map;if(typeof e=="string")if(Ke(e))a=e,o=Promise.resolve(e);else{const d=bi(r,"resolveName");if(!jc(d))throw $e("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=d.resolveName(e).then(h=>{if(h==null)throw $e("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Vt(this).addr=h,h})}else o=e.getAddress().then(d=>{if(d==null)throw new Error("TODO");return Vt(this).addr=d,d});xk(this,{addrPromise:o,addr:a,deployTx:c,subs:l});const u=new Proxy({},{get:(d,h,f)=>{if(typeof h=="symbol"||ha.indexOf(h)>=0)return Reflect.get(d,h,f);try{return this.getEvent(h)}catch(g){if(!yt(g,"INVALID_ARGUMENT")||g.argument!=="key")throw g}},has:(d,h)=>ha.indexOf(h)>=0?Reflect.has(d,h):Reflect.has(d,h)||this.interface.hasEvent(String(h))});return ve(this,{filters:u}),ve(this,{fallback:s.receive||s.fallback?Sk(this):null}),new Proxy(this,{get:(d,h,f)=>{if(typeof h=="symbol"||h in d||ha.indexOf(h)>=0)return Reflect.get(d,h,f);try{return d.getFunction(h)}catch(g){if(!yt(g,"INVALID_ARGUMENT")||g.argument!=="key")throw g}},has:(d,h)=>typeof h=="symbol"||h in d||ha.indexOf(h)>=0?Reflect.has(d,h):d.interface.hasFunction(h)})}connect(e){return new qs(this.target,this.interface,e)}attach(e){return new qs(e,this.interface,this.runner)}async getAddress(){return await Vt(this).addrPromise}async getDeployedCode(){const e=di(this.runner);te(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const n=await e.getCode(await this.getAddress());return n==="0x"?null:n}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const r=di(this.runner);return te(r!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((i,s)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return i(this);r.once("block",o)}catch(a){s(a)}};o()})}deploymentTransaction(){return Vt(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),Ck(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),_k(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,n,r){n==null&&(n=0),r==null&&(r="latest");const{addr:i,addrPromise:s}=Vt(this),o=i||await s,{fragment:a,topics:c}=await bh(this,e),l={address:o,topics:c,fromBlock:n,toBlock:r},u=di(this.runner);return te(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(l)).map(d=>{let h=a;if(h==null)try{h=this.interface.getEvent(d.topics[0])}catch{}if(h)try{return new wh(d,this.interface,h)}catch(f){return new Jv(d,f)}return new ko(d,u)})}async on(e,n){const r=await ig(this,"on",e);return r.listeners.push({listener:n,once:!1}),r.start(),this}async once(e,n){const r=await ig(this,"once",e);return r.listeners.push({listener:n,once:!0}),r.start(),this}async emit(e,...n){return await od(this,e,n,null)}async listenerCount(e){if(e){const i=await Ds(this,e);return i?i.listeners.length:0}const{subs:n}=Vt(this);let r=0;for(const{listeners:i}of n.values())r+=i.length;return r}async listeners(e){if(e){const i=await Ds(this,e);return i?i.listeners.map(({listener:s})=>s):[]}const{subs:n}=Vt(this);let r=[];for(const{listeners:i}of n.values())r=r.concat(i.map(({listener:s})=>s));return r}async off(e,n){const r=await Ds(this,e);if(!r)return this;if(n){const i=r.listeners.map(({listener:s})=>s).indexOf(n);i>=0&&r.listeners.splice(i,1)}return(n==null||r.listeners.length===0)&&(r.stop(),Vt(this).subs.delete(r.tag)),this}async removeAllListeners(e){if(e){const n=await Ds(this,e);if(!n)return this;n.stop(),Vt(this).subs.delete(n.tag)}else{const{subs:n}=Vt(this);for(const{tag:r,stop:i}of n.values())i(),n.delete(r)}return this}async addListener(e,n){return await this.on(e,n)}async removeListener(e,n){return await this.off(e,n)}static buildClass(e){class n extends qs{constructor(i,s=null){super(i,e,s)}}return n}static from(e,n,r){return r==null&&(r=null),new this(e,n,r)}}function Tk(){return qs}class Ws extends Tk(){}function ru(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):G(!1,"unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}class Ik{name;constructor(e){ve(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,n){throw new Error("unsupported coin")}async decodeAddress(e,n){throw new Error("unsupported coin")}}const ib=new RegExp("^(ipfs)://(.*)$","i"),sg=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),ib,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];class rs{provider;address;name;#e;#t;constructor(e,n,r){ve(this,{provider:e,address:n,name:r}),this.#e=null,this.#t=new Ws(n,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e)}async supportsWildcard(){return this.#e==null&&(this.#e=(async()=>{try{return await this.#t.supportsInterface("0x9061b923")}catch(e){if(yt(e,"CALL_EXCEPTION"))return!1;throw this.#e=null,e}})()),await this.#e}async#n(e,n){n=(n||[]).slice();const r=this.#t.interface;n.unshift(id(this.name));let i=null;await this.supportsWildcard()&&(i=r.getFunction(e),te(i,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),n=[Gx(this.name,255),r.encodeFunctionData(i,n)],e="resolve(bytes,bytes)"),n.push({enableCcipRead:!0});try{const s=await this.#t[e](...n);return i?r.decodeFunctionResult(i,s)[0]:s}catch(s){if(!yt(s,"CALL_EXCEPTION"))throw s}return null}async getAddress(e){if(e==null&&(e=60),e===60)try{const s=await this.#n("addr(bytes32)");return s==null||s===ho?null:s}catch(s){if(yt(s,"CALL_EXCEPTION"))return null;throw s}if(e>=0&&e<2147483648){let s=e+2147483648;const o=await this.#n("addr(bytes32,uint)",[s]);if(Ke(o,20))return De(o)}let n=null;for(const s of this.provider.plugins)if(s instanceof Ik&&s.supportsCoinType(e)){n=s;break}if(n==null)return null;const r=await this.#n("addr(bytes32,uint)",[e]);if(r==null||r==="0x")return null;const i=await n.decodeAddress(e,r);if(i!=null)return i;te(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:r}})}async getText(e){const n=await this.#n("text(bytes32,string)",[e]);return n==null||n==="0x"?null:n}async getContentHash(){const e=await this.#n("contenthash(bytes32)");if(e==null||e==="0x")return null;const n=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(n){const i=n[1]==="e3010170"?"ipfs":"ipns",s=parseInt(n[4],16);if(n[5].length===s*2)return`${i}://${MS("0x"+n[2])}`}const r=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&r[1].length===64)return`bzz://${r[1]}`;te(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const n=await this.getText("avatar");if(n==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:n});for(let r=0;r<sg.length;r++){const i=n.match(sg[r]);if(i==null)continue;const s=i[1].toLowerCase();switch(s){case"https":case"data":return e.push({type:"url",value:n}),{linkage:e,url:n};case"ipfs":{const o=ru(n);return e.push({type:"ipfs",value:n}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=s==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:s,value:n});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(i[2]||"").split("/");if(c.length!==2)return e.push({type:`!${s}caip`,value:i[2]||""}),{url:null,linkage:e};const l=c[1],u=new Ws(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(s==="erc721"){const p=await u.ownerOf(l);if(a!==p)return e.push({type:"!owner",value:p}),{url:null,linkage:e};e.push({type:"owner",value:p})}else if(s==="erc1155"){const p=await u.balanceOf(a,l);if(!p)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:p.toString()})}let d=await u[o](l);if(d==null||d==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:d}),s==="erc1155"&&(d=d.replace("{id}",Gr(l,32).substring(2)),e.push({type:"metadata-url-expanded",value:d})),d.match(/^ipfs:/i)&&(d=ru(d)),e.push({type:"metadata-url",value:d});let h={};const f=await new lr(d).send();f.assertOk();try{h=f.bodyJson}catch{try{e.push({type:"!metadata",value:f.bodyText})}catch{const m=f.body;return m&&e.push({type:"!metadata",value:ce(m)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!h)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(h)});let g=h.image;if(typeof g!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!g.match(/^(https:\/\/|data:)/i)){if(g.match(ib)==null)return e.push({type:"!imageUrl-ipfs",value:g}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:g}),g=ru(g)}return e.push({type:"url",value:g}),{linkage:e,url:g}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const n=await e.getNetwork(),r=n.getPlugin("org.ethers.plugins.network.Ens");return te(r,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:n}}),r.address}static async#r(e,n){const r=await rs.getEnsAddress(e);try{const s=await new Ws(r,["function resolver(bytes32) view returns (address)"],e).resolver(id(n),{enableCcipRead:!0});return s===ho?null:s}catch(i){throw i}return null}static async fromName(e,n){let r=n;for(;;){if(r===""||r==="."||n!=="eth"&&r==="eth")return null;const i=await rs.#r(e,r);if(i!=null){const s=new rs(e,i,n);return r!==n&&!await s.supportsWildcard()?null:s}r=r.split(".").slice(1).join(".")}}}const og=BigInt(0);function Te(t,e){return function(n){return n==null?e:t(n)}}function wo(t,e){return n=>{if(e&&n==null)return null;if(!Array.isArray(n))throw new Error("not an array");return n.map(r=>t(r))}}function To(t,e){return n=>{const r={};for(const i in t){let s=i;if(e&&i in e&&!(s in n)){for(const o of e[i])if(o in n){s=o;break}}try{const o=t[i](n[s]);o!==void 0&&(r[i]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";te(!1,`invalid value for value.${i} (${a})`,"BAD_DATA",{value:n})}}return r}}function Ok(t){switch(t){case!0:case"true":return!0;case!1:case"false":return!1}G(!1,`invalid boolean; ${JSON.stringify(t)}`,"value",t)}function gs(t){return G(Ke(t,!0),"invalid data","value",t),t}function gt(t){return G(Ke(t,32),"invalid hash","value",t),t}const Rk=To({address:De,blockHash:gt,blockNumber:_e,data:gs,index:_e,removed:Te(Ok,!1),topics:wo(gt),transactionHash:gt,transactionIndex:_e},{index:["logIndex"]});function Nk(t){return Rk(t)}const Mk=To({hash:Te(gt),parentHash:gt,parentBeaconBlockRoot:Te(gt,null),number:_e,timestamp:_e,nonce:Te(gs),difficulty:he,gasLimit:he,gasUsed:he,stateRoot:Te(gt,null),receiptsRoot:Te(gt,null),blobGasUsed:Te(he,null),excessBlobGas:Te(he,null),miner:Te(De),prevRandao:Te(gt,null),extraData:gs,baseFeePerGas:Te(he)},{prevRandao:["mixHash"]});function Bk(t){const e=Mk(t);return e.transactions=t.transactions.map(n=>typeof n=="string"?n:sb(n)),e}const Lk=To({transactionIndex:_e,blockNumber:_e,transactionHash:gt,address:De,topics:wo(gt),data:gs,index:_e,blockHash:gt},{index:["logIndex"]});function Dk(t){return Lk(t)}const Uk=To({to:Te(De,null),from:Te(De,null),contractAddress:Te(De,null),index:_e,root:Te(ce),gasUsed:he,blobGasUsed:Te(he,null),logsBloom:Te(gs),blockHash:gt,hash:gt,logs:wo(Dk),blockNumber:_e,cumulativeGasUsed:he,effectiveGasPrice:Te(he),blobGasPrice:Te(he,null),status:Te(_e),type:Te(_e,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function Fk(t){return Uk(t)}function sb(t){t.to&&he(t.to)===og&&(t.to="0x0000000000000000000000000000000000000000");const e=To({hash:gt,index:Te(_e,void 0),type:n=>n==="0x"||n==null?0:_e(n),accessList:Te(_i,null),blobVersionedHashes:Te(wo(gt,!0),null),authorizationList:Te(wo(n=>{let r;if(n.signature)r=n.signature;else{let i=n.yParity;i==="0x1b"?i=0:i==="0x1c"&&(i=1),r=Object.assign({},n,{yParity:i})}return{address:De(n.address),chainId:he(n.chainId),nonce:he(n.nonce),signature:We.from(r)}},!1),null),blockHash:Te(gt,null),blockNumber:Te(_e,null),transactionIndex:Te(_e,null),from:De,gasPrice:Te(he),maxPriorityFeePerGas:Te(he),maxFeePerGas:Te(he),maxFeePerBlobGas:Te(he,null),gasLimit:he,to:Te(De,null),value:he,nonce:_e,data:gs,creates:Te(De,null),chainId:Te(he,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(t);if(e.to==null&&e.creates==null&&(e.creates=k_(e)),(t.type===1||t.type===2)&&t.accessList==null&&(e.accessList=[]),t.signature?e.signature=We.from(t.signature):e.signature=We.from(t),e.chainId==null){const n=e.signature.legacyChainId;n!=null&&(e.chainId=n)}return e.blockHash&&he(e.blockHash)===og&&(e.blockHash=null),e}const Hk="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class Io{name;constructor(e){ve(this,{name:e})}clone(){return new Io(this.name)}}class zc extends Io{effectiveBlock;txBase;txCreate;txDataZero;txDataNonzero;txAccessListStorageKey;txAccessListAddress;constructor(e,n){e==null&&(e=0),super(`org.ethers.network.plugins.GasCost#${e||0}`);const r={effectiveBlock:e};function i(s,o){let a=(n||{})[s];a==null&&(a=o),G(typeof a=="number",`invalud value for ${s}`,"costs",n),r[s]=a}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),ve(this,r)}clone(){return new zc(this.effectiveBlock,this)}}class Gc extends Io{address;targetNetwork;constructor(e,n){super("org.ethers.plugins.network.Ens"),ve(this,{address:e||Hk,targetNetwork:n??1})}clone(){return new Gc(this.address,this.targetNetwork)}}class Kk extends Io{#e;#t;get url(){return this.#e}get processFunc(){return this.#t}constructor(e,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin"),this.#e=e,this.#t=n}clone(){return this}}const iu=new Map;class Jt{#e;#t;#n;constructor(e,n){this.#e=e,this.#t=he(n),this.#n=new Map}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return this.#e}set name(e){this.#e=e}get chainId(){return this.#t}set chainId(e){this.#t=he(e,"chainId")}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===he(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===he(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===he(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(this.#n.values())}attachPlugin(e){if(this.#n.get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return this.#n.set(e.name,e.clone()),this}getPlugin(e){return this.#n.get(e)||null}getPlugins(e){return this.plugins.filter(n=>n.name.split("#")[0]===e)}clone(){const e=new Jt(this.name,this.chainId);return this.plugins.forEach(n=>{e.attachPlugin(n.clone())}),e}computeIntrinsicGas(e){const n=this.getPlugin("org.ethers.plugins.network.GasCost")||new zc;let r=n.txBase;if(e.to==null&&(r+=n.txCreate),e.data)for(let i=2;i<e.data.length;i+=2)e.data.substring(i,i+2)==="00"?r+=n.txDataZero:r+=n.txDataNonzero;if(e.accessList){const i=_i(e.accessList);for(const s in i)r+=n.txAccessListAddress+n.txAccessListStorageKey*i[s].storageKeys.length}return r}static from(e){if($k(),e==null)return Jt.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const n=iu.get(e);if(n)return n();if(typeof e=="bigint")return new Jt("unknown",e);G(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){G(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const n=new Jt(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&n.attachPlugin(new Gc(e.ensAddress,e.ensNetwork)),n}G(!1,"invalid network","network",e)}static register(e,n){typeof e=="number"&&(e=BigInt(e));const r=iu.get(e);r&&G(!1,`conflicting network for ${JSON.stringify(r.name)}`,"nameOrChainId",e),iu.set(e,n)}}function ag(t,e){const n=String(t);if(!n.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${t}`);const r=n.split(".");if(r.length===1&&r.push(""),r.length!==2)throw new Error(`invalid gwei value: ${t}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let i=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||i++,r[1]=i.toString()}return BigInt(r[0]+r[1])}function cg(t){return new Kk(t,async(e,n,r)=>{r.setHeader("User-Agent","ethers");let i;try{const[s,o]=await Promise.all([r.send(),e()]);i=s;const a=i.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:ag(a.maxFee,9),maxPriorityFeePerGas:ag(a.maxPriorityFee,9)}}catch(s){te(!1,`error encountered with polygon gas station (${JSON.stringify(r.url)})`,"SERVER_ERROR",{request:r,response:i,error:s})}})}let lg=!1;function $k(){if(lg)return;lg=!0;function t(e,n,r){const i=function(){const s=new Jt(e,n);return r.ensNetwork!=null&&s.attachPlugin(new Gc(null,r.ensNetwork)),s.attachPlugin(new zc),(r.plugins||[]).forEach(o=>{s.attachPlugin(o)}),s};Jt.register(e,i),Jt.register(n,i),r.altNames&&r.altNames.forEach(s=>{Jt.register(s,i)})}t("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),t("ropsten",3,{ensNetwork:3}),t("rinkeby",4,{ensNetwork:4}),t("goerli",5,{ensNetwork:5}),t("kovan",42,{ensNetwork:42}),t("sepolia",11155111,{ensNetwork:11155111}),t("holesky",17e3,{ensNetwork:17e3}),t("classic",61,{}),t("classicKotti",6,{}),t("arbitrum",42161,{ensNetwork:1}),t("arbitrum-goerli",421613,{}),t("arbitrum-sepolia",421614,{}),t("base",8453,{ensNetwork:1}),t("base-goerli",84531,{}),t("base-sepolia",84532,{}),t("bnb",56,{ensNetwork:1}),t("bnbt",97,{}),t("linea",59144,{ensNetwork:1}),t("linea-goerli",59140,{}),t("linea-sepolia",59141,{}),t("matic",137,{ensNetwork:1,plugins:[cg("https://gasstation.polygon.technology/v2")]}),t("matic-amoy",80002,{}),t("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[cg("https://gasstation-testnet.polygon.technology/v2")]}),t("optimism",10,{ensNetwork:1,plugins:[]}),t("optimism-goerli",420,{}),t("optimism-sepolia",11155420,{}),t("xdai",100,{ensNetwork:1})}function ad(t){return JSON.parse(JSON.stringify(t))}class jk{#e;#t;#n;#r;constructor(e){this.#e=e,this.#t=null,this.#n=4e3,this.#r=-2}get pollingInterval(){return this.#n}set pollingInterval(e){this.#n=e}async#i(){try{const e=await this.#e.getBlockNumber();if(this.#r===-2){this.#r=e;return}if(e!==this.#r){for(let n=this.#r+1;n<=e;n++){if(this.#t==null)return;await this.#e.emit("block",n)}this.#r=e}}catch{}this.#t!=null&&(this.#t=this.#e._setTimeout(this.#i.bind(this),this.#n))}start(){this.#t||(this.#t=this.#e._setTimeout(this.#i.bind(this),this.#n),this.#i())}stop(){this.#t&&(this.#e._clearTimeout(this.#t),this.#t=null)}pause(e){this.stop(),e&&(this.#r=-2)}resume(){this.start()}}class Eh{#e;#t;#n;constructor(e){this.#e=e,this.#n=!1,this.#t=n=>{this._poll(n,this.#e)}}async _poll(e,n){throw new Error("sub-classes must override this")}start(){this.#n||(this.#n=!0,this.#t(-2),this.#e.on("block",this.#t))}stop(){this.#n&&(this.#n=!1,this.#e.off("block",this.#t))}pause(e){this.stop()}resume(){this.start()}}class zk extends Eh{#e;#t;constructor(e,n){super(e),this.#e=n,this.#t=-2}pause(e){e&&(this.#t=-2),super.pause(e)}async _poll(e,n){const r=await n.getBlock(this.#e);r!=null&&(this.#t===-2?this.#t=r.number:r.number>this.#t&&(n.emit(this.#e,r.number),this.#t=r.number))}}class Gk extends Eh{#e;constructor(e,n){super(e),this.#e=ad(n)}async _poll(e,n){throw new Error("@TODO")}}class Vk extends Eh{#e;constructor(e,n){super(e),this.#e=n}async _poll(e,n){const r=await n.getTransactionReceipt(this.#e);r&&n.emit(this.#e,r)}}class Ah{#e;#t;#n;#r;#i;constructor(e,n){this.#e=e,this.#t=ad(n),this.#n=this.#o.bind(this),this.#r=!1,this.#i=-2}async#o(e){if(this.#i===-2)return;const n=ad(this.#t);n.fromBlock=this.#i+1,n.toBlock=e;const r=await this.#e.getLogs(n);if(r.length===0){this.#i<e-60&&(this.#i=e-60);return}for(const i of r)this.#e.emit(this.#t,i),this.#i=i.blockNumber}start(){this.#r||(this.#r=!0,this.#i===-2&&this.#e.getBlockNumber().then(e=>{this.#i=e}),this.#e.on("block",this.#n))}stop(){this.#r&&(this.#r=!1,this.#e.off("block",this.#n))}pause(e){this.stop(),e&&(this.#i=-2)}resume(){this.start()}}const qk=BigInt(2),Wk=10;function fa(t){return t&&typeof t.then=="function"}function Ba(t,e){return t+":"+JSON.stringify(e,(n,r)=>{if(r==null)return"null";if(typeof r=="bigint")return`bigint:${r.toString()}`;if(typeof r=="string")return r.toLowerCase();if(typeof r=="object"&&!Array.isArray(r)){const i=Object.keys(r);return i.sort(),i.reduce((s,o)=>(s[o]=r[o],s),{})}return r})}class ob{name;constructor(e){ve(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function Qk(t){return JSON.parse(JSON.stringify(t))}function cd(t){return t=Array.from(new Set(t).values()),t.sort(),t}async function su(t,e){if(t==null)throw new Error("invalid event");if(Array.isArray(t)&&(t={topics:t}),typeof t=="string")switch(t){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:t,tag:t}}if(Ke(t,32)){const n=t.toLowerCase();return{type:"transaction",tag:Ba("tx",{hash:n}),hash:n}}if(t.orphan){const n=t;return{type:"orphan",tag:Ba("orphan",n),filter:Qk(n)}}if(t.address||t.topics){const n=t,r={topics:(n.topics||[]).map(i=>i==null?null:Array.isArray(i)?cd(i.map(s=>s.toLowerCase())):i.toLowerCase())};if(n.address){const i=[],s=[],o=a=>{Ke(a)?i.push(a):s.push((async()=>{i.push(await Ot(a,e))})())};Array.isArray(n.address)?n.address.forEach(o):o(n.address),s.length&&await Promise.all(s),r.address=cd(i.map(a=>a.toLowerCase()))}return{filter:r,tag:Ba("event",r),type:"event"}}G(!1,"unknown ProviderEvent","event",t)}function ou(){return new Date().getTime()}const Jk={cacheTimeout:250,pollingInterval:4e3};class Yk{#e;#t;#n;#r;#i;#o;#s;#a;#d;#l;#p;#g;constructor(e,n){if(this.#g=Object.assign({},Jk,n||{}),e==="any")this.#o=!0,this.#i=null;else if(e){const r=Jt.from(e);this.#o=!1,this.#i=Promise.resolve(r),setTimeout(()=>{this.emit("network",r,null)},0)}else this.#o=!1,this.#i=null;this.#a=-1,this.#s=new Map,this.#e=new Map,this.#t=new Map,this.#n=null,this.#r=!1,this.#d=1,this.#l=new Map,this.#p=!1}get pollingInterval(){return this.#g.pollingInterval}get provider(){return this}get plugins(){return Array.from(this.#t.values())}attachPlugin(e){if(this.#t.get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return this.#t.set(e.name,e.connect(this)),this}getPlugin(e){return this.#t.get(e)||null}get disableCcipRead(){return this.#p}set disableCcipRead(e){this.#p=!!e}async#c(e){const n=this.#g.cacheTimeout;if(n<0)return await this._perform(e);const r=Ba(e.method,e);let i=this.#s.get(r);return i||(i=this._perform(e),this.#s.set(r,i),setTimeout(()=>{this.#s.get(r)===i&&this.#s.delete(r)},n)),await i}async ccipReadFetch(e,n,r){if(this.disableCcipRead||r.length===0||e.to==null)return null;const i=e.to.toLowerCase(),s=n.toLowerCase(),o=[];for(let a=0;a<r.length;a++){const c=r[a],l=c.replace("{sender}",i).replace("{data}",s),u=new lr(l);c.indexOf("{data}")===-1&&(u.body={data:s,sender:i}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:r});let d="unknown error",h;try{h=await u.send()}catch(f){o.push(f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:f}});continue}try{const f=h.bodyJson;if(f.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:f}),f.data;f.message&&(d=f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:f})}catch{}te(h.statusCode<400||h.statusCode>=500,`response not found during CCIP fetch: ${d}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:d}}),o.push(d)}te(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:r,errorMessages:o}})}_wrapBlock(e,n){return new mk(Bk(e),this)}_wrapLog(e,n){return new ko(Nk(e),this)}_wrapTransactionReceipt(e,n){return new qv(Fk(e),this)}_wrapTransactionResponse(e,n){return new Po(sb(e),this)}_detectNetwork(){te(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){te(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=_e(await this.#c({method:"getBlockNumber"}),"%response");return this.#a>=0&&(this.#a=e),e}_getAddress(e){return Ot(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(Ke(e))return Ke(e,32)?e:wn(e);if(typeof e=="bigint"&&(e=_e(e,"blockTag")),typeof e=="number")return e>=0?wn(e):this.#a>=0?wn(this.#a+e):this.getBlockNumber().then(n=>wn(n+e));G(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const n=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?cd(c.map(l=>l.toLowerCase())):c.toLowerCase()),r="blockHash"in e?e.blockHash:void 0,i=(c,l,u)=>{let d;switch(c.length){case 0:break;case 1:d=c[0];break;default:c.sort(),d=c}if(r&&(l!=null||u!=null))throw new Error("invalid filter");const h={};return d&&(h.address=d),n.length&&(h.topics=n),l&&(h.fromBlock=l),u&&(h.toBlock=u),r&&(h.blockHash=r),h};let s=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)s.push(this._getAddress(c));else s.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),s.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(s),o,a]).then(c=>i(c[0],c[1],c[2])):i(s,o,a)}_getTransactionRequest(e){const n=yc(e),r=[];if(["to","from"].forEach(i=>{if(n[i]==null)return;const s=Ot(n[i],this);fa(s)?r.push(async function(){n[i]=await s}()):n[i]=s}),n.blockTag!=null){const i=this._getBlockTag(n.blockTag);fa(i)?r.push(async function(){n.blockTag=await i}()):n.blockTag=i}return r.length?async function(){return await Promise.all(r),n}():n}async getNetwork(){if(this.#i==null){const i=(async()=>{try{const s=await this._detectNetwork();return this.emit("network",s,null),s}catch(s){throw this.#i===i&&(this.#i=null),s}})();return this.#i=i,(await i).clone()}const e=this.#i,[n,r]=await Promise.all([e,this._detectNetwork()]);return n.chainId!==r.chainId&&(this.#o?(this.emit("network",r,n),this.#i===e&&(this.#i=Promise.resolve(r))):te(!1,`network changed: ${n.chainId} => ${r.chainId} `,"NETWORK_ERROR",{event:"changed"})),n.clone()}async getFeeData(){const e=await this.getNetwork(),n=async()=>{const{_block:i,gasPrice:s,priorityFee:o}=await _t({_block:this.#y("latest",!1),gasPrice:(async()=>{try{const u=await this.#c({method:"getGasPrice"});return he(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await this.#c({method:"getPriorityFee"});return he(u,"%response")}catch{}return null})()});let a=null,c=null;const l=this._wrapBlock(i,e);return l&&l.baseFeePerGas&&(c=o??BigInt("1000000000"),a=l.baseFeePerGas*qk+c),new ng(s,a,c)},r=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(r){const i=new lr(r.url),s=await r.processFunc(n,this,i);return new ng(s.gasPrice,s.maxFeePerGas,s.maxPriorityFeePerGas)}return await n()}async estimateGas(e){let n=this._getTransactionRequest(e);return fa(n)&&(n=await n),he(await this.#c({method:"estimateGas",transaction:n}),"%response")}async#u(e,n,r){te(r<Wk,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:n,enableCcipRead:!0})});const i=yc(e);try{return ce(await this._perform({method:"call",transaction:i,blockTag:n}))}catch(s){if(!this.disableCcipRead&&rh(s)&&s.data&&r>=0&&n==="latest"&&i.to!=null&&qe(s.data,0,4)==="0x556f1830"){const o=s.data,a=await Ot(i.to,this);let c;try{c=n3(qe(s.data,4))}catch(d){te(!1,d.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:i,info:{data:o}})}te(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:i,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const l=await this.ccipReadFetch(i,c.calldata,c.urls);te(l!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:i,info:{data:s.data,errorArgs:c.errorArgs}});const u={to:a,data:Ye([c.selector,t3([l,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const d=await this.#u(u,n,r+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:d}),d}catch(d){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:d}),d}}throw s}}async#h(e){const{value:n}=await _t({network:this.getNetwork(),value:e});return n}async call(e){const{tx:n,blockTag:r}=await _t({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await this.#h(this.#u(n,r,e.enableCcipRead?0:-1))}async#f(e,n,r){let i=this._getAddress(n),s=this._getBlockTag(r);return(typeof i!="string"||typeof s!="string")&&([i,s]=await Promise.all([i,s])),await this.#h(this.#c(Object.assign(e,{address:i,blockTag:s})))}async getBalance(e,n){return he(await this.#f({method:"getBalance"},e,n),"%response")}async getTransactionCount(e,n){return _e(await this.#f({method:"getTransactionCount"},e,n),"%response")}async getCode(e,n){return ce(await this.#f({method:"getCode"},e,n))}async getStorage(e,n,r){const i=he(n,"position");return ce(await this.#f({method:"getStorage",position:i},e,r))}async broadcastTransaction(e){const{blockNumber:n,hash:r,network:i}=await _t({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),s=gn.from(e);if(s.hash!==r)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(s,i).replaceableTransaction(n)}async#y(e,n){if(Ke(e,32))return await this.#c({method:"getBlock",blockHash:e,includeTransactions:n});let r=this._getBlockTag(e);return typeof r!="string"&&(r=await r),await this.#c({method:"getBlock",blockTag:r,includeTransactions:n})}async getBlock(e,n){const{network:r,params:i}=await _t({network:this.getNetwork(),params:this.#y(e,!!n)});return i==null?null:this._wrapBlock(i,r)}async getTransaction(e){const{network:n,params:r}=await _t({network:this.getNetwork(),params:this.#c({method:"getTransaction",hash:e})});return r==null?null:this._wrapTransactionResponse(r,n)}async getTransactionReceipt(e){const{network:n,params:r}=await _t({network:this.getNetwork(),params:this.#c({method:"getTransactionReceipt",hash:e})});if(r==null)return null;if(r.gasPrice==null&&r.effectiveGasPrice==null){const i=await this.#c({method:"getTransaction",hash:e});if(i==null)throw new Error("report this; could not find tx or effectiveGasPrice");r.effectiveGasPrice=i.gasPrice}return this._wrapTransactionReceipt(r,n)}async getTransactionResult(e){const{result:n}=await _t({network:this.getNetwork(),result:this.#c({method:"getTransactionResult",hash:e})});return n==null?null:ce(n)}async getLogs(e){let n=this._getFilter(e);fa(n)&&(n=await n);const{network:r,params:i}=await _t({network:this.getNetwork(),params:this.#c({method:"getLogs",filter:n})});return i.map(s=>this._wrapLog(s,r))}_getProvider(e){te(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await rs.fromName(this,e)}async getAvatar(e){const n=await this.getResolver(e);return n?await n.getAvatar():null}async resolveName(e){const n=await this.getResolver(e);return n?await n.getAddress():null}async lookupAddress(e){e=De(e);const n=id(e.substring(2).toLowerCase()+".addr.reverse");try{const r=await rs.getEnsAddress(this),s=await new Ws(r,["function resolver(bytes32) view returns (address)"],this).resolver(n);if(s==null||s===ho)return null;const a=await new Ws(s,["function name(bytes32) view returns (string)"],this).name(n);return await this.resolveName(a)!==e?null:a}catch(r){if(yt(r,"BAD_DATA")&&r.value==="0x"||yt(r,"CALL_EXCEPTION"))return null;throw r}return null}async waitForTransaction(e,n,r){const i=n??1;return i===0?this.getTransactionReceipt(e):new Promise(async(s,o)=>{let a=null;const c=async l=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&l-u.blockNumber+1>=i){s(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",c)};r!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o($e("timeout","TIMEOUT",{reason:"timeout"})))},r)),c(await this.getBlockNumber())})}async waitForBlock(e){te(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const n=this.#l.get(e);n&&(n.timer&&clearTimeout(n.timer),this.#l.delete(e))}_setTimeout(e,n){n==null&&(n=0);const r=this.#d++,i=()=>{this.#l.delete(r),e()};if(this.paused)this.#l.set(r,{timer:null,func:i,time:n});else{const s=setTimeout(i,n);this.#l.set(r,{timer:s,func:i,time:ou()})}return r}_forEachSubscriber(e){for(const n of this.#e.values())e(n.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new ob(e.type);case"block":{const n=new jk(this);return n.pollingInterval=this.pollingInterval,n}case"safe":case"finalized":return new zk(this,e.type);case"event":return new Ah(this,e.filter);case"transaction":return new Vk(this,e.hash);case"orphan":return new Gk(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,n){for(const r of this.#e.values())if(r.subscriber===e){r.started&&r.subscriber.stop(),r.subscriber=n,r.started&&n.start(),this.#n!=null&&n.pause(this.#n);break}}async#m(e,n){let r=await su(e,this);return r.type==="event"&&n&&n.length>0&&n[0].removed===!0&&(r=await su({orphan:"drop-log",log:n[0]},this)),this.#e.get(r.tag)||null}async#w(e){const n=await su(e,this),r=n.tag;let i=this.#e.get(r);return i||(i={subscriber:this._getSubscriber(n),tag:r,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},this.#e.set(r,i)),i}async on(e,n){const r=await this.#w(e);return r.listeners.push({listener:n,once:!1}),r.started||(r.subscriber.start(),r.started=!0,this.#n!=null&&r.subscriber.pause(this.#n)),this}async once(e,n){const r=await this.#w(e);return r.listeners.push({listener:n,once:!0}),r.started||(r.subscriber.start(),r.started=!0,this.#n!=null&&r.subscriber.pause(this.#n)),this}async emit(e,...n){const r=await this.#m(e,n);if(!r||r.listeners.length===0)return!1;const i=r.listeners.length;return r.listeners=r.listeners.filter(({listener:s,once:o})=>{const a=new _w(this,o?null:s,e);try{s.call(this,...n,a)}catch{}return!o}),r.listeners.length===0&&(r.started&&r.subscriber.stop(),this.#e.delete(r.tag)),i>0}async listenerCount(e){if(e){const r=await this.#m(e);return r?r.listeners.length:0}let n=0;for(const{listeners:r}of this.#e.values())n+=r.length;return n}async listeners(e){if(e){const r=await this.#m(e);return r?r.listeners.map(({listener:i})=>i):[]}let n=[];for(const{listeners:r}of this.#e.values())n=n.concat(r.map(({listener:i})=>i));return n}async off(e,n){const r=await this.#m(e);if(!r)return this;if(n){const i=r.listeners.map(({listener:s})=>s).indexOf(n);i>=0&&r.listeners.splice(i,1)}return(!n||r.listeners.length===0)&&(r.started&&r.subscriber.stop(),this.#e.delete(r.tag)),this}async removeAllListeners(e){if(e){const{tag:n,started:r,subscriber:i}=await this.#w(e);r&&i.stop(),this.#e.delete(n)}else for(const[n,{started:r,subscriber:i}]of this.#e)r&&i.stop(),this.#e.delete(n);return this}async addListener(e,n){return await this.on(e,n)}async removeListener(e,n){return this.off(e,n)}get destroyed(){return this.#r}destroy(){this.removeAllListeners();for(const e of this.#l.keys())this._clearTimeout(e);this.#r=!0}get paused(){return this.#n!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(this.#a=-1,this.#n!=null){if(this.#n==!!e)return;te(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(n=>n.pause(e)),this.#n=!!e;for(const n of this.#l.values())n.timer&&clearTimeout(n.timer),n.time=ou()-n.time}resume(){if(this.#n!=null){this._forEachSubscriber(e=>e.resume()),this.#n=null;for(const e of this.#l.values()){let n=e.time;n<0&&(n=0),e.time=ou(),setTimeout(e.func,n)}}}}function Zk(t,e){try{const n=ld(t,e);if(n)return uc(n)}catch{}return null}function ld(t,e){if(t==="0x")return null;try{const n=_e(qe(t,e,e+32)),r=_e(qe(t,n,n+32));return qe(t,n+32,n+32+r)}catch{}return null}function ug(t){const e=it(t);if(e.length>32)throw new Error("internal; should not happen");const n=new Uint8Array(32);return n.set(e,32-e.length),n}function Xk(t){if(t.length%32===0)return t;const e=new Uint8Array(Math.ceil(t.length/32)*32);return e.set(t),e}const e3=new Uint8Array([]);function t3(t){const e=[];let n=0;for(let r=0;r<t.length;r++)e.push(e3),n+=32;for(let r=0;r<t.length;r++){const i=ke(t[r]);e[r]=ug(n),e.push(ug(i.length)),e.push(Xk(i)),n+=32+Math.ceil(i.length/32)*32}return Ye(e)}const dg="0x0000000000000000000000000000000000000000000000000000000000000000";function n3(t){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};te(Xi(t)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const n=qe(t,0,32);te(qe(n,0,12)===qe(dg,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=qe(n,12);try{const r=[],i=_e(qe(t,32,64)),s=_e(qe(t,i,i+32)),o=qe(t,i+32);for(let a=0;a<s;a++){const c=Zk(o,a*32);if(c==null)throw new Error("abort");r.push(c)}e.urls=r}catch{te(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const r=ld(t,64);if(r==null)throw new Error("abort");e.calldata=r}catch{te(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}te(qe(t,100,128)===qe(dg,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=qe(t,96,100);try{const r=ld(t,128);if(r==null)throw new Error("abort");e.extraData=r}catch{te(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(r=>e[r]),e}function Yr(t,e){if(t.provider)return t.provider;te(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function hg(t,e){let n=yc(e);if(n.to!=null&&(n.to=Ot(n.to,t)),n.from!=null){const r=n.from;n.from=Promise.all([t.getAddress(),Ot(r,t)]).then(([i,s])=>(G(i.toLowerCase()===s.toLowerCase(),"transaction from mismatch","tx.from",s),i))}else n.from=t.getAddress();return await _t(n)}class r3{provider;constructor(e){ve(this,{provider:e||null})}async getNonce(e){return Yr(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await hg(this,e)}async populateTransaction(e){const n=Yr(this,"populateTransaction"),r=await hg(this,e);r.nonce==null&&(r.nonce=await this.getNonce("pending")),r.gasLimit==null&&(r.gasLimit=await this.estimateGas(r));const i=await this.provider.getNetwork();if(r.chainId!=null){const o=he(r.chainId);G(o===i.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else r.chainId=i.chainId;const s=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||s)?G(!1,"eip-1559 transaction do not support gasPrice","tx",e):(r.type===0||r.type===1)&&s&&G(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1){const o=await n.getFeeData();te(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice)}else{const o=await n.getFeeData();if(r.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(r.authorizationList&&r.authorizationList.length?r.type=4:r.type=2,r.gasPrice!=null){const a=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=a,r.maxPriorityFeePerGas=a}else r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(te(!s,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice),r.type=0):te(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(r.type===2||r.type===3||r.type===4)&&(r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await _t(r)}async populateAuthorization(e){const n=Object.assign({},e);return n.chainId==null&&(n.chainId=(await Yr(this,"getNetwork").getNetwork()).chainId),n.nonce==null&&(n.nonce=await this.getNonce()),n}async estimateGas(e){return Yr(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return Yr(this,"call").call(await this.populateCall(e))}async resolveName(e){return await Yr(this,"resolveName").resolveName(e)}async sendTransaction(e){const n=Yr(this,"sendTransaction"),r=await this.populateTransaction(e);delete r.from;const i=gn.from(r);return await n.broadcastTransaction(await this.signTransaction(i))}authorize(e){te(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}function i3(t){return JSON.parse(JSON.stringify(t))}class ab{#e;#t;#n;#r;#i;#o;constructor(e){this.#e=e,this.#t=null,this.#n=this.#s.bind(this),this.#r=!1,this.#i=null,this.#o=!1}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,n){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}async#s(e){try{this.#t==null&&(this.#t=this._subscribe(this.#e));let n=null;try{n=await this.#t}catch(s){if(!yt(s,"UNSUPPORTED_OPERATION")||s.operation!=="eth_newFilter")throw s}if(n==null){this.#t=null,this.#e._recoverSubscriber(this,this._recover(this.#e));return}const r=await this.#e.getNetwork();if(this.#i||(this.#i=r),this.#i.chainId!==r.chainId)throw new Error("chaid changed");if(this.#o)return;const i=await this.#e.send("eth_getFilterChanges",[n]);await this._emitResults(this.#e,i)}catch(n){console.log("@TODO",n)}this.#e.once("block",this.#n)}#a(){const e=this.#t;e&&(this.#t=null,e.then(n=>{this.#e.destroyed||this.#e.send("eth_uninstallFilter",[n])}))}start(){this.#r||(this.#r=!0,this.#s(-2))}stop(){this.#r&&(this.#r=!1,this.#o=!0,this.#a(),this.#e.off("block",this.#n))}pause(e){e&&this.#a(),this.#e.off("block",this.#n)}resume(){this.start()}}class s3 extends ab{#e;constructor(e,n){super(e),this.#e=i3(n)}_recover(e){return new Ah(e,this.#e)}async _subscribe(e){return await e.send("eth_newFilter",[this.#e])}async _emitResults(e,n){for(const r of n)e.emit(this.#e,e._wrapLog(r,e._network))}}class o3 extends ab{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,n){for(const r of n)e.emit("pending",r)}}const a3="bigint,boolean,function,number,string,symbol".split(/,/g);function La(t){if(t==null||a3.indexOf(typeof t)>=0||typeof t.getAddress=="function")return t;if(Array.isArray(t))return t.map(La);if(typeof t=="object")return Object.keys(t).reduce((e,n)=>(e[n]=t[n],e),{});throw new Error(`should not happen: ${t} (${typeof t})`)}function c3(t){return new Promise(e=>{setTimeout(e,t)})}function Ni(t){return t&&t.toLowerCase()}function fg(t){return t&&typeof t.pollingInterval=="number"}const cb={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class au extends r3{address;constructor(e,n){super(e),n=De(n),ve(this,{address:n})}connect(e){te(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(e){return await this.populateCall(e)}async sendUncheckedTransaction(e){const n=La(e),r=[];if(n.from){const s=n.from;r.push((async()=>{const o=await Ot(s,this.provider);G(o!=null&&o.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),n.from=o})())}else n.from=this.address;if(n.gasLimit==null&&r.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const s=n.to;r.push((async()=>{n.to=await Ot(s,this.provider)})())}r.length&&await Promise.all(r);const i=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(e){const n=await this.provider.getBlockNumber(),r=await this.sendUncheckedTransaction(e);return await new Promise((i,s)=>{const o=[1e3,100];let a=0;const c=async()=>{try{const l=await this.provider.getTransaction(r);if(l!=null){i(l.replaceableTransaction(n));return}}catch(l){if(yt(l,"CANCELLED")||yt(l,"BAD_DATA")||yt(l,"NETWORK_ERROR")||yt(l,"UNSUPPORTED_OPERATION")){l.info==null&&(l.info={}),l.info.sendTransactionHash=r,s(l);return}if(yt(l,"INVALID_ARGUMENT")&&(a++,l.info==null&&(l.info={}),l.info.sendTransactionHash=r,a>10)){s(l);return}this.provider.emit("error",$e("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:l}))}this.provider._setTimeout(()=>{c()},o.pop()||4e3)};c()})}async signTransaction(e){const n=La(e);if(n.from){const i=await Ot(n.from,this.provider);G(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),n.from=i}else n.from=this.address;const r=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[r])}async signMessage(e){const n=typeof e=="string"?sr(e):e;return await this.provider.send("personal_sign",[ce(n),this.address.toLowerCase()])}async signTypedData(e,n,r){const i=La(r),s=await Gt.resolveNames(e,n,i,async o=>{const a=await Ot(o);return G(a!=null,"TypedData does not support null address","value",o),a});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(Gt.getPayload(s.domain,n,s.value))])}async unlock(e){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),e,null])}async _legacySignMessage(e){const n=typeof e=="string"?sr(e):e;return await this.provider.send("eth_sign",[this.address.toLowerCase(),ce(n)])}}class l3 extends Yk{#e;#t;#n;#r;#i;#o;#s;#a(){if(this.#r)return;const e=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");this.#r=setTimeout(()=>{this.#r=null;const n=this.#n;for(this.#n=[];n.length;){const r=[n.shift()];for(;n.length&&r.length!==this.#e.batchMaxCount;)if(r.push(n.shift()),JSON.stringify(r.map(s=>s.payload)).length>this.#e.batchMaxSize){n.unshift(r.pop());break}(async()=>{const i=r.length===1?r[0].payload:r.map(s=>s.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const s=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:s});for(const{resolve:o,reject:a,payload:c}of r){if(this.destroyed){a($e("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:c.method}));continue}const l=s.filter(u=>u.id===c.id)[0];if(l==null){const u=$e("missing response for request","BAD_DATA",{value:s,info:{payload:c}});this.emit("error",u),a(u);continue}if("error"in l){a(this.getRpcError(c,l));continue}o(l.result)}}catch(s){this.emit("debug",{action:"receiveRpcError",error:s});for(const{reject:o}of r)o(s)}})()}},e)}constructor(e,n){super(e,n),this.#t=1,this.#e=Object.assign({},cb,n||{}),this.#n=[],this.#r=null,this.#o=null,this.#s=null;{let i=null;const s=new Promise(o=>{i=o});this.#i={promise:s,resolve:i}}const r=this._getOption("staticNetwork");typeof r=="boolean"?(G(!r||e!=="any","staticNetwork cannot be used on special network 'any'","options",n),r&&e!=null&&(this.#o=Jt.from(e))):r&&(G(e==null||r.matches(e),"staticNetwork MUST match network object","options",n),this.#o=r)}_getOption(e){return this.#e[e]}get _network(){return te(this.#o,"network is not available yet","NETWORK_ERROR"),this.#o}async _perform(e){if(e.method==="call"||e.method==="estimateGas"){let r=e.transaction;if(r&&r.type!=null&&he(r.type)&&r.maxFeePerGas==null&&r.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(e=Object.assign({},e,{transaction:Object.assign({},r,{type:void 0})}))}}const n=this.getRpcRequest(e);return n!=null?await this.send(n.method,n.args):super._perform(e)}async _detectNetwork(){const e=this._getOption("staticNetwork");if(e)if(e===!0){if(this.#o)return this.#o}else return e;return this.#s?await this.#s:this.ready?(this.#s=(async()=>{try{const n=Jt.from(he(await this.send("eth_chainId",[])));return this.#s=null,n}catch(n){throw this.#s=null,n}})(),await this.#s):(this.#s=(async()=>{const n={id:this.#t++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let r;try{r=(await this._send(n))[0],this.#s=null}catch(i){throw this.#s=null,this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:r}),"result"in r)return Jt.from(he(r.result));throw this.getRpcError(n,r)})(),await this.#s)}_start(){this.#i==null||this.#i.resolve==null||(this.#i.resolve(),this.#i=null,(async()=>{for(;this.#o==null&&!this.destroyed;)try{this.#o=await this._detectNetwork()}catch(e){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",$e("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:e}})),await c3(1e3)}this.#a()})())}async _waitUntilReady(){if(this.#i!=null)return await this.#i.promise}_getSubscriber(e){return e.type==="pending"?new o3(this):e.type==="event"?this._getOption("polling")?new Ah(this,e.filter):new s3(this,e.filter):e.type==="orphan"&&e.filter.orphan==="drop-log"?new ob("orphan"):super._getSubscriber(e)}get ready(){return this.#i==null}getRpcTransaction(e){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(r=>{if(e[r]==null)return;let i=r;r==="gasLimit"&&(i="gas"),n[i]=wn(he(e[r],`tx.${r}`))}),["from","to","data"].forEach(r=>{e[r]!=null&&(n[r]=ce(e[r]))}),e.accessList&&(n.accessList=_i(e.accessList)),e.blobVersionedHashes&&(n.blobVersionedHashes=e.blobVersionedHashes.map(r=>r.toLowerCase())),e.authorizationList&&(n.authorizationList=e.authorizationList.map(r=>{const i=fv(r);return{address:i.address,nonce:wn(i.nonce),chainId:wn(i.chainId),yParity:wn(i.signature.yParity),r:wn(i.signature.r),s:wn(i.signature.s)}})),n}getRpcRequest(e){switch(e.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Ni(e.address),e.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Ni(e.address),e.blockTag]};case"getCode":return{method:"eth_getCode",args:[Ni(e.address),e.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Ni(e.address),"0x"+e.position.toString(16),e.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[e.signedTransaction]};case"getBlock":if("blockTag"in e)return{method:"eth_getBlockByNumber",args:[e.blockTag,!!e.includeTransactions]};if("blockHash"in e)return{method:"eth_getBlockByHash",args:[e.blockHash,!!e.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[e.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[e.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(e.transaction),e.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(e.transaction)]};case"getLogs":return e.filter&&e.filter.address!=null&&(Array.isArray(e.filter.address)?e.filter.address=e.filter.address.map(Ni):e.filter.address=Ni(e.filter.address)),{method:"eth_getLogs",args:[e.filter]}}return null}getRpcError(e,n){const{method:r}=e,{error:i}=n;if(r==="eth_estimateGas"&&i.message){const a=i.message;if(!a.match(/revert/i)&&a.match(/insufficient funds/i))return $e("insufficient funds","INSUFFICIENT_FUNDS",{transaction:e.params[0],info:{payload:e,error:i}});if(a.match(/nonce/i)&&a.match(/too low/i))return $e("nonce has already been used","NONCE_EXPIRED",{transaction:e.params[0],info:{payload:e,error:i}})}if(r==="eth_call"||r==="eth_estimateGas"){const a=ud(i),c=ps.getBuiltinCallException(r==="eth_call"?"call":"estimateGas",e.params[0],a?a.data:null);return c.info={error:i,payload:e},c}const s=JSON.stringify(d3(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return $e("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[r]||"unknown",reason:"rejected",info:{payload:e,error:i}});if(r==="eth_sendRawTransaction"||r==="eth_sendTransaction"){const a=e.params[0];if(s.match(/insufficient funds|base fee exceeds gas limit/i))return $e("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:a,info:{error:i}});if(s.match(/nonce/i)&&s.match(/too low/i))return $e("nonce has already been used","NONCE_EXPIRED",{transaction:a,info:{error:i}});if(s.match(/replacement transaction/i)&&s.match(/underpriced/i))return $e("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:a,info:{error:i}});if(s.match(/only replay-protected/i))return $e("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:r,info:{transaction:a,info:{error:i}}})}let o=!!s.match(/the method .* does not exist/i);return o||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(o=!0),o?$e("unsupported operation","UNSUPPORTED_OPERATION",{operation:e.method,info:{error:i,payload:e}}):$e("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:e})}send(e,n){if(this.destroyed)return Promise.reject($e("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e}));const r=this.#t++,i=new Promise((s,o)=>{this.#n.push({resolve:s,reject:o,payload:{method:e,params:n,id:r,jsonrpc:"2.0"}})});return this.#a(),i}async getSigner(e){e==null&&(e=0);const n=this.send("eth_accounts",[]);if(typeof e=="number"){const i=await n;if(e>=i.length)throw new Error("no such account");return new au(this,i[e])}const{accounts:r}=await _t({network:this.getNetwork(),accounts:n});e=De(e);for(const i of r)if(De(i)===e)return new au(this,e);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new au(this,n))}destroy(){this.#r&&(clearTimeout(this.#r),this.#r=null);for(const{payload:e,reject:n}of this.#n)n($e("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e.method}));this.#n=[],super.destroy()}}class u3 extends l3{#e;constructor(e,n){super(e,n);let r=this._getOption("pollingInterval");r==null&&(r=cb.pollingInterval),this.#e=r}_getSubscriber(e){const n=super._getSubscriber(e);return fg(n)&&(n.pollingInterval=this.#e),n}get pollingInterval(){return this.#e}set pollingInterval(e){if(!Number.isInteger(e)||e<0)throw new Error("invalid interval");this.#e=e,this._forEachSubscriber(n=>{fg(n)&&(n.pollingInterval=this.#e)})}}function ud(t){if(t==null)return null;if(typeof t.message=="string"&&t.message.match(/revert/i)&&Ke(t.data))return{message:t.message,data:t.data};if(typeof t=="object"){for(const e in t){const n=ud(t[e]);if(n)return n}return null}if(typeof t=="string")try{return ud(JSON.parse(t))}catch{}return null}function dd(t,e){if(t!=null){if(typeof t.message=="string"&&e.push(t.message),typeof t=="object")for(const n in t)dd(t[n],e);if(typeof t=="string")try{return dd(JSON.parse(t),e)}catch{}}}function d3(t){const e=[];return dd(t,e),e}class Di extends u3{#e;#t;constructor(e,n,r){const i=Object.assign({},r??{},{batchMaxCount:1});G(e&&e.request,"invalid EIP-1193 provider","ethereum",e),super(n,i),this.#t=null,r&&r.providerInfo&&(this.#t=r.providerInfo),this.#e=async(s,o)=>{const a={method:s,params:o};this.emit("debug",{action:"sendEip1193Request",payload:a});try{const c=await e.request(a);return this.emit("debug",{action:"receiveEip1193Result",result:c}),c}catch(c){const l=new Error(c.message);throw l.code=c.code,l.data=c.data,l.payload=a,this.emit("debug",{action:"receiveEip1193Error",error:l}),l}}}get providerInfo(){return this.#t}async send(e,n){return await this._start(),await super.send(e,n)}async _send(e){G(!Array.isArray(e),"EIP-1193 does not support batch request","payload",e);try{const n=await this.#e(e.method,e.params||[]);return[{id:e.id,result:n}]}catch(n){return[{id:e.id,error:{code:n.code,data:n.data,message:n.message}}]}}getRpcError(e,n){switch(n=JSON.parse(JSON.stringify(n)),n.error.code||-1){case 4001:n.error.message=`ethers-user-denied: ${n.error.message}`;break;case 4200:n.error.message=`ethers-unsupported: ${n.error.message}`;break}return super.getRpcError(e,n)}async hasSigner(e){e==null&&(e=0);const n=await this.send("eth_accounts",[]);return typeof e=="number"?n.length>e:(e=e.toLowerCase(),n.filter(r=>r.toLowerCase()===e).length!==0)}async getSigner(e){if(e==null&&(e=0),!await this.hasSigner(e))try{await this.#e("eth_requestAccounts",[])}catch(n){const r=n.payload;throw this.getRpcError(r,{id:r.id,error:n})}return await super.getSigner(e)}static async discover(e){if(e==null&&(e={}),e.provider)return new Di(e.provider);const n=e.window?e.window:typeof window<"u"?window:null;if(n==null)return null;const r=e.anyProvider;if(r&&n.ethereum)return new Di(n.ethereum);if(!("addEventListener"in n&&"dispatchEvent"in n&&"removeEventListener"in n))return null;const i=e.timeout?e.timeout:300;return i===0?null:await new Promise((s,o)=>{let a=[];const c=d=>{a.push(d.detail),r&&l()},l=()=>{if(clearTimeout(u),a.length)if(e&&e.filter){const d=e.filter(a.map(h=>Object.assign({},h.info)));if(d==null)s(null);else if(d instanceof Di)s(d);else{let h=null;if(d.uuid&&(h=a.filter(g=>d.uuid===g.info.uuid)[0]),h){const{provider:f,info:g}=h;s(new Di(f,void 0,{providerInfo:g}))}else o($e("filter returned unknown info","UNSUPPORTED_OPERATION",{value:d}))}}else{const{provider:d,info:h}=a[0];s(new Di(d,void 0,{providerInfo:h}))}else s(null);n.removeEventListener("eip6963:announceProvider",c)},u=setTimeout(()=>{l()},i);n.addEventListener("eip6963:announceProvider",c),n.dispatchEvent(new Event("eip6963:requestProvider"))})}}export{Di as B,Ws as C,f3 as a,p3 as f,yi as i,Nc as t};
